{"version":3,"sources":["node_modules/browser-pack/_prelude.js","dev/javascripts/app.js","dev/javascripts/vendors/modernizr.js","dev/javascripts/xp/xp.js","node_modules/sono/dist/sono.js"],"names":[],"mappings":"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AK,SAAL,CAAe,CAAf,IAAoB,CAApB,GAAsB,CAAlC;;AAEA,oBAAI,MAAM,IAAI,KAAK,YAAT,GAAwB,GAAlC;AACA,qBAAK,SAAL,CAAe,SAAf,GAA2B,SAAS,GAAT,GAAe,cAA1C;AACA,qBAAK,SAAL,CAAe,QAAf,CAAwB,CAAxB,EAA2B,KAAK,MAAL,CAAY,MAAZ,GAAqB,SAAhD,EAA2D,QAA3D,EAAqE,SAArE;;AAEA,qBAAK,WAAW,CAAhB;AACH;;AAID,kCAAsB,KAAK,IAA3B;AAEH;;;;;;kBAMU,IAAI,EAAJ,E;;;AC/Hf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"app.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\n\n// Default Babel Polyfill, be careful, be sure you need it\n// because it's ~6000 lines of code unminified\n// import 'babel-polyfill';\nimport 'modernizr';\n// import * as tools from '@84paris/84.tools';\n\n// Your imports\n// import MyComponent from './component.es6'\nconsole.log('%c 84.Boilerplate ===== Your app is ready.', 'background: #000; color: #FFF');\n\nimport Xp from './xp/xp';\n\n","/*!\n * modernizr v3.3.1\n * Build http://modernizr.com/download?-cssanimations-csscalc-cssgradients-csstransforms3d-history-webgl-setclasses-shiv-dontmin\n *\n * Copyright (c)\n *  Faruk Ates\n *  Paul Irish\n *  Alex Sexton\n *  Ryan Seddon\n *  Patrick Kettner\n *  Stu Cox\n *  Richard Herrera\n\n * MIT License\n */\n\n/*\n * Modernizr tests which native CSS3 and HTML5 features are available in the\n * current UA and makes the results available to you in two ways: as properties on\n * a global `Modernizr` object, and as classes on the `<html>` element. This\n * information allows you to progressively enhance your pages with a granular level\n * of control over the experience.\n*/\n\n;(function(window, document, undefined){\n  var classes = [];\n\n\n  var tests = [];\n\n\n  /**\n   *\n   * ModernizrProto is the constructor for Modernizr\n   *\n   * @class\n   * @access public\n   */\n\n  var ModernizrProto = {\n    // The current version, dummy\n    _version: '3.3.1',\n\n    // Any settings that don't work as separate modules\n    // can go in here as configuration.\n    _config: {\n      'classPrefix': '',\n      'enableClasses': true,\n      'enableJSClass': true,\n      'usePrefixes': true\n    },\n\n    // Queue of tests\n    _q: [],\n\n    // Stub these for people who are listening\n    on: function(test, cb) {\n      // I don't really think people should do this, but we can\n      // safe guard it a bit.\n      // -- NOTE:: this gets WAY overridden in src/addTest for actual async tests.\n      // This is in case people listen to synchronous tests. I would leave it out,\n      // but the code to *disallow* sync tests in the real version of this\n      // function is actually larger than this.\n      var self = this;\n      setTimeout(function() {\n        cb(self[test]);\n      }, 0);\n    },\n\n    addTest: function(name, fn, options) {\n      tests.push({name: name, fn: fn, options: options});\n    },\n\n    addAsyncTest: function(fn) {\n      tests.push({name: null, fn: fn});\n    }\n  };\n\n\n\n  // Fake some of Object.create so we can force non test results to be non \"own\" properties.\n  var Modernizr = function() {};\n  Modernizr.prototype = ModernizrProto;\n\n  // Leak modernizr globally when you `require` it rather than force it here.\n  // Overwrite name so constructor name is nicer :D\n  Modernizr = new Modernizr();\n\n\n/*!\n{\n  \"name\": \"History API\",\n  \"property\": \"history\",\n  \"caniuse\": \"history\",\n  \"tags\": [\"history\"],\n  \"authors\": [\"Hay Kranen\", \"Alexander Farkas\"],\n  \"notes\": [{\n    \"name\": \"W3C Spec\",\n    \"href\": \"https://www.w3.org/TR/html51/browsers.html#the-history-interface\"\n  }, {\n    \"name\": \"MDN documentation\",\n    \"href\": \"https://developer.mozilla.org/en-US/docs/Web/API/window.history\"\n  }],\n  \"polyfills\": [\"historyjs\", \"html5historyapi\"]\n}\n!*/\n/* DOC\nDetects support for the History API for manipulating the browser session history.\n*/\n\n  Modernizr.addTest('history', function() {\n    // Issue #733\n    // The stock browser on Android 2.2 & 2.3, and 4.0.x returns positive on history support\n    // Unfortunately support is really buggy and there is no clean way to detect\n    // these bugs, so we fall back to a user agent sniff :(\n    var ua = navigator.userAgent;\n\n    // We only want Android 2 and 4.0, stock browser, and not Chrome which identifies\n    // itself as 'Mobile Safari' as well, nor Windows Phone (issue #1471).\n    if ((ua.indexOf('Android 2.') !== -1 ||\n        (ua.indexOf('Android 4.0') !== -1)) &&\n        ua.indexOf('Mobile Safari') !== -1 &&\n        ua.indexOf('Chrome') === -1 &&\n        ua.indexOf('Windows Phone') === -1) {\n      return false;\n    }\n\n    // Return the regular check\n    return (window.history && 'pushState' in window.history);\n  });\n\n\n  /**\n   * is returns a boolean if the typeof an obj is exactly type.\n   *\n   * @access private\n   * @function is\n   * @param {*} obj - A thing we want to check the type of\n   * @param {string} type - A string to compare the typeof against\n   * @returns {boolean}\n   */\n\n  function is(obj, type) {\n    return typeof obj === type;\n  }\n  ;\n\n  /**\n   * Run through all tests and detect their support in the current UA.\n   *\n   * @access private\n   */\n\n  function testRunner() {\n    var featureNames;\n    var feature;\n    var aliasIdx;\n    var result;\n    var nameIdx;\n    var featureName;\n    var featureNameSplit;\n\n    for (var featureIdx in tests) {\n      if (tests.hasOwnProperty(featureIdx)) {\n        featureNames = [];\n        feature = tests[featureIdx];\n        // run the test, throw the return value into the Modernizr,\n        // then based on that boolean, define an appropriate className\n        // and push it into an array of classes we'll join later.\n        //\n        // If there is no name, it's an 'async' test that is run,\n        // but not directly added to the object. That should\n        // be done with a post-run addTest call.\n        if (feature.name) {\n          featureNames.push(feature.name.toLowerCase());\n\n          if (feature.options && feature.options.aliases && feature.options.aliases.length) {\n            // Add all the aliases into the names list\n            for (aliasIdx = 0; aliasIdx < feature.options.aliases.length; aliasIdx++) {\n              featureNames.push(feature.options.aliases[aliasIdx].toLowerCase());\n            }\n          }\n        }\n\n        // Run the test, or use the raw value if it's not a function\n        result = is(feature.fn, 'function') ? feature.fn() : feature.fn;\n\n\n        // Set each of the names on the Modernizr object\n        for (nameIdx = 0; nameIdx < featureNames.length; nameIdx++) {\n          featureName = featureNames[nameIdx];\n          // Support dot properties as sub tests. We don't do checking to make sure\n          // that the implied parent tests have been added. You must call them in\n          // order (either in the test, or make the parent test a dependency).\n          //\n          // Cap it to TWO to make the logic simple and because who needs that kind of subtesting\n          // hashtag famous last words\n          featureNameSplit = featureName.split('.');\n\n          if (featureNameSplit.length === 1) {\n            Modernizr[featureNameSplit[0]] = result;\n          } else {\n            // cast to a Boolean, if not one already\n            /* jshint -W053 */\n            if (Modernizr[featureNameSplit[0]] && !(Modernizr[featureNameSplit[0]] instanceof Boolean)) {\n              Modernizr[featureNameSplit[0]] = new Boolean(Modernizr[featureNameSplit[0]]);\n            }\n\n            Modernizr[featureNameSplit[0]][featureNameSplit[1]] = result;\n          }\n\n          classes.push((result ? '' : 'no-') + featureNameSplit.join('-'));\n        }\n      }\n    }\n  }\n  ;\n\n  /**\n   * docElement is a convenience wrapper to grab the root element of the document\n   *\n   * @access private\n   * @returns {HTMLElement|SVGElement} The root element of the document\n   */\n\n  var docElement = document.documentElement;\n\n\n  /**\n   * A convenience helper to check if the document we are running in is an SVG document\n   *\n   * @access private\n   * @returns {boolean}\n   */\n\n  var isSVG = docElement.nodeName.toLowerCase() === 'svg';\n\n\n  /**\n   * setClasses takes an array of class names and adds them to the root element\n   *\n   * @access private\n   * @function setClasses\n   * @param {string[]} classes - Array of class names\n   */\n\n  // Pass in an and array of class names, e.g.:\n  //  ['no-webp', 'borderradius', ...]\n  function setClasses(classes) {\n    var className = docElement.className;\n    var classPrefix = Modernizr._config.classPrefix || '';\n\n    if (isSVG) {\n      className = className.baseVal;\n    }\n\n    // Change `no-js` to `js` (independently of the `enableClasses` option)\n    // Handle classPrefix on this too\n    if (Modernizr._config.enableJSClass) {\n      var reJS = new RegExp('(^|\\\\s)' + classPrefix + 'no-js(\\\\s|$)');\n      className = className.replace(reJS, '$1' + classPrefix + 'js$2');\n    }\n\n    if (Modernizr._config.enableClasses) {\n      // Add the new classes\n      className += ' ' + classPrefix + classes.join(' ' + classPrefix);\n      isSVG ? docElement.className.baseVal = className : docElement.className = className;\n    }\n\n  }\n\n  ;\n\n/**\n  * @optionName html5shiv\n  * @optionProp html5shiv\n  */\n\n  // Take the html5 variable out of the html5shiv scope so we can return it.\n  var html5;\n  if (!isSVG) {\n    /**\n     * @preserve HTML5 Shiv 3.7.3 | @afarkas @jdalton @jon_neal @rem | MIT/GPL2 Licensed\n     */\n    ;(function(window, document) {\n      /*jshint evil:true */\n      /** version */\n      var version = '3.7.3';\n\n      /** Preset options */\n      var options = window.html5 || {};\n\n      /** Used to skip problem elements */\n      var reSkip = /^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i;\n\n      /** Not all elements can be cloned in IE **/\n      var saveClones = /^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i;\n\n      /** Detect whether the browser supports default html5 styles */\n      var supportsHtml5Styles;\n\n      /** Name of the expando, to work with multiple documents or to re-shiv one document */\n      var expando = '_html5shiv';\n\n      /** The id for the the documents expando */\n      var expanID = 0;\n\n      /** Cached data for each document */\n      var expandoData = {};\n\n      /** Detect whether the browser supports unknown elements */\n      var supportsUnknownElements;\n\n      (function() {\n        try {\n          var a = document.createElement('a');\n          a.innerHTML = '<xyz></xyz>';\n          //if the hidden property is implemented we can assume, that the browser supports basic HTML5 Styles\n          supportsHtml5Styles = ('hidden' in a);\n\n          supportsUnknownElements = a.childNodes.length == 1 || (function() {\n            // assign a false positive if unable to shiv\n            (document.createElement)('a');\n            var frag = document.createDocumentFragment();\n            return (\n              typeof frag.cloneNode == 'undefined' ||\n                typeof frag.createDocumentFragment == 'undefined' ||\n                typeof frag.createElement == 'undefined'\n            );\n          }());\n        } catch(e) {\n          // assign a false positive if detection fails => unable to shiv\n          supportsHtml5Styles = true;\n          supportsUnknownElements = true;\n        }\n\n      }());\n\n      /*--------------------------------------------------------------------------*/\n\n      /**\n       * Creates a style sheet with the given CSS text and adds it to the document.\n       * @private\n       * @param {Document} ownerDocument The document.\n       * @param {String} cssText The CSS text.\n       * @returns {StyleSheet} The style element.\n       */\n      function addStyleSheet(ownerDocument, cssText) {\n        var p = ownerDocument.createElement('p'),\n          parent = ownerDocument.getElementsByTagName('head')[0] || ownerDocument.documentElement;\n\n        p.innerHTML = 'x<style>' + cssText + '</style>';\n        return parent.insertBefore(p.lastChild, parent.firstChild);\n      }\n\n      /**\n       * Returns the value of `html5.elements` as an array.\n       * @private\n       * @returns {Array} An array of shived element node names.\n       */\n      function getElements() {\n        var elements = html5.elements;\n        return typeof elements == 'string' ? elements.split(' ') : elements;\n      }\n\n      /**\n       * Extends the built-in list of html5 elements\n       * @memberOf html5\n       * @param {String|Array} newElements whitespace separated list or array of new element names to shiv\n       * @param {Document} ownerDocument The context document.\n       */\n      function addElements(newElements, ownerDocument) {\n        var elements = html5.elements;\n        if(typeof elements != 'string'){\n          elements = elements.join(' ');\n        }\n        if(typeof newElements != 'string'){\n          newElements = newElements.join(' ');\n        }\n        html5.elements = elements +' '+ newElements;\n        shivDocument(ownerDocument);\n      }\n\n      /**\n       * Returns the data associated to the given document\n       * @private\n       * @param {Document} ownerDocument The document.\n       * @returns {Object} An object of data.\n       */\n      function getExpandoData(ownerDocument) {\n        var data = expandoData[ownerDocument[expando]];\n        if (!data) {\n          data = {};\n          expanID++;\n          ownerDocument[expando] = expanID;\n          expandoData[expanID] = data;\n        }\n        return data;\n      }\n\n      /**\n       * returns a shived element for the given nodeName and document\n       * @memberOf html5\n       * @param {String} nodeName name of the element\n       * @param {Document|DocumentFragment} ownerDocument The context document.\n       * @returns {Object} The shived element.\n       */\n      function createElement(nodeName, ownerDocument, data){\n        if (!ownerDocument) {\n          ownerDocument = document;\n        }\n        if(supportsUnknownElements){\n          return ownerDocument.createElement(nodeName);\n        }\n        if (!data) {\n          data = getExpandoData(ownerDocument);\n        }\n        var node;\n\n        if (data.cache[nodeName]) {\n          node = data.cache[nodeName].cloneNode();\n        } else if (saveClones.test(nodeName)) {\n          node = (data.cache[nodeName] = data.createElem(nodeName)).cloneNode();\n        } else {\n          node = data.createElem(nodeName);\n        }\n\n        // Avoid adding some elements to fragments in IE < 9 because\n        // * Attributes like `name` or `type` cannot be set/changed once an element\n        //   is inserted into a document/fragment\n        // * Link elements with `src` attributes that are inaccessible, as with\n        //   a 403 response, will cause the tab/window to crash\n        // * Script elements appended to fragments will execute when their `src`\n        //   or `text` property is set\n        return node.canHaveChildren && !reSkip.test(nodeName) && !node.tagUrn ? data.frag.appendChild(node) : node;\n      }\n\n      /**\n       * returns a shived DocumentFragment for the given document\n       * @memberOf html5\n       * @param {Document} ownerDocument The context document.\n       * @returns {Object} The shived DocumentFragment.\n       */\n      function createDocumentFragment(ownerDocument, data){\n        if (!ownerDocument) {\n          ownerDocument = document;\n        }\n        if(supportsUnknownElements){\n          return ownerDocument.createDocumentFragment();\n        }\n        data = data || getExpandoData(ownerDocument);\n        var clone = data.frag.cloneNode(),\n          i = 0,\n          elems = getElements(),\n          l = elems.length;\n        for(;i<l;i++){\n          clone.createElement(elems[i]);\n        }\n        return clone;\n      }\n\n      /**\n       * Shivs the `createElement` and `createDocumentFragment` methods of the document.\n       * @private\n       * @param {Document|DocumentFragment} ownerDocument The document.\n       * @param {Object} data of the document.\n       */\n      function shivMethods(ownerDocument, data) {\n        if (!data.cache) {\n          data.cache = {};\n          data.createElem = ownerDocument.createElement;\n          data.createFrag = ownerDocument.createDocumentFragment;\n          data.frag = data.createFrag();\n        }\n\n\n        ownerDocument.createElement = function(nodeName) {\n          //abort shiv\n          if (!html5.shivMethods) {\n            return data.createElem(nodeName);\n          }\n          return createElement(nodeName, ownerDocument, data);\n        };\n\n        ownerDocument.createDocumentFragment = Function('h,f', 'return function(){' +\n                                                        'var n=f.cloneNode(),c=n.createElement;' +\n                                                        'h.shivMethods&&(' +\n                                                        // unroll the `createElement` calls\n                                                        getElements().join().replace(/[\\w\\-:]+/g, function(nodeName) {\n          data.createElem(nodeName);\n          data.frag.createElement(nodeName);\n          return 'c(\"' + nodeName + '\")';\n        }) +\n          ');return n}'\n                                                       )(html5, data.frag);\n      }\n\n      /*--------------------------------------------------------------------------*/\n\n      /**\n       * Shivs the given document.\n       * @memberOf html5\n       * @param {Document} ownerDocument The document to shiv.\n       * @returns {Document} The shived document.\n       */\n      function shivDocument(ownerDocument) {\n        if (!ownerDocument) {\n          ownerDocument = document;\n        }\n        var data = getExpandoData(ownerDocument);\n\n        if (html5.shivCSS && !supportsHtml5Styles && !data.hasCSS) {\n          data.hasCSS = !!addStyleSheet(ownerDocument,\n                                        // corrects block display not defined in IE6/7/8/9\n                                        'article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}' +\n                                        // adds styling not present in IE6/7/8/9\n                                        'mark{background:#FF0;color:#000}' +\n                                        // hides non-rendered elements\n                                        'template{display:none}'\n                                       );\n        }\n        if (!supportsUnknownElements) {\n          shivMethods(ownerDocument, data);\n        }\n        return ownerDocument;\n      }\n\n      /*--------------------------------------------------------------------------*/\n\n      /**\n       * The `html5` object is exposed so that more elements can be shived and\n       * existing shiving can be detected on iframes.\n       * @type Object\n       * @example\n       *\n       * // options can be changed before the script is included\n       * html5 = { 'elements': 'mark section', 'shivCSS': false, 'shivMethods': false };\n       */\n      var html5 = {\n\n        /**\n         * An array or space separated string of node names of the elements to shiv.\n         * @memberOf html5\n         * @type Array|String\n         */\n        'elements': options.elements || 'abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output picture progress section summary template time video',\n\n        /**\n         * current version of html5shiv\n         */\n        'version': version,\n\n        /**\n         * A flag to indicate that the HTML5 style sheet should be inserted.\n         * @memberOf html5\n         * @type Boolean\n         */\n        'shivCSS': (options.shivCSS !== false),\n\n        /**\n         * Is equal to true if a browser supports creating unknown/HTML5 elements\n         * @memberOf html5\n         * @type boolean\n         */\n        'supportsUnknownElements': supportsUnknownElements,\n\n        /**\n         * A flag to indicate that the document's `createElement` and `createDocumentFragment`\n         * methods should be overwritten.\n         * @memberOf html5\n         * @type Boolean\n         */\n        'shivMethods': (options.shivMethods !== false),\n\n        /**\n         * A string to describe the type of `html5` object (\"default\" or \"default print\").\n         * @memberOf html5\n         * @type String\n         */\n        'type': 'default',\n\n        // shivs the document according to the specified `html5` object options\n        'shivDocument': shivDocument,\n\n        //creates a shived element\n        createElement: createElement,\n\n        //creates a shived documentFragment\n        createDocumentFragment: createDocumentFragment,\n\n        //extends list of elements\n        addElements: addElements\n      };\n\n      /*--------------------------------------------------------------------------*/\n\n      // expose html5\n      window.html5 = html5;\n\n      // shiv the document\n      shivDocument(document);\n\n      if(typeof module == 'object' && module.exports){\n        module.exports = html5;\n      }\n\n    }(typeof window !== \"undefined\" ? window : this, document));\n  }\n;\n\n  /**\n   * createElement is a convenience wrapper around document.createElement. Since we\n   * use createElement all over the place, this allows for (slightly) smaller code\n   * as well as abstracting away issues with creating elements in contexts other than\n   * HTML documents (e.g. SVG documents).\n   *\n   * @access private\n   * @function createElement\n   * @returns {HTMLElement|SVGElement} An HTML or SVG element\n   */\n\n  function createElement() {\n    if (typeof document.createElement !== 'function') {\n      // This is the case in IE7, where the type of createElement is \"object\".\n      // For this reason, we cannot call apply() as Object is not a Function.\n      return document.createElement(arguments[0]);\n    } else if (isSVG) {\n      return document.createElementNS.call(document, 'http://www.w3.org/2000/svg', arguments[0]);\n    } else {\n      return document.createElement.apply(document, arguments);\n    }\n  }\n\n  ;\n/*!\n{\n  \"name\": \"WebGL\",\n  \"property\": \"webgl\",\n  \"caniuse\": \"webgl\",\n  \"tags\": [\"webgl\", \"graphics\"],\n  \"polyfills\": [\"jebgl\", \"cwebgl\", \"iewebgl\"]\n}\n!*/\n\n  Modernizr.addTest('webgl', function() {\n    var canvas = createElement('canvas');\n    var supports = 'probablySupportsContext' in canvas ? 'probablySupportsContext' :  'supportsContext';\n    if (supports in canvas) {\n      return canvas[supports]('webgl') || canvas[supports]('experimental-webgl');\n    }\n    return 'WebGLRenderingContext' in window;\n  });\n\n\n  /**\n   * List of property values to set for css tests. See ticket #21\n   * http://git.io/vUGl4\n   *\n   * @memberof Modernizr\n   * @name Modernizr._prefixes\n   * @optionName Modernizr._prefixes\n   * @optionProp prefixes\n   * @access public\n   * @example\n   *\n   * Modernizr._prefixes is the internal list of prefixes that we test against\n   * inside of things like [prefixed](#modernizr-prefixed) and [prefixedCSS](#-code-modernizr-prefixedcss). It is simply\n   * an array of kebab-case vendor prefixes you can use within your code.\n   *\n   * Some common use cases include\n   *\n   * Generating all possible prefixed version of a CSS property\n   * ```js\n   * var rule = Modernizr._prefixes.join('transform: rotate(20deg); ');\n   *\n   * rule === 'transform: rotate(20deg); webkit-transform: rotate(20deg); moz-transform: rotate(20deg); o-transform: rotate(20deg); ms-transform: rotate(20deg);'\n   * ```\n   *\n   * Generating all possible prefixed version of a CSS value\n   * ```js\n   * rule = 'display:' +  Modernizr._prefixes.join('flex; display:') + 'flex';\n   *\n   * rule === 'display:flex; display:-webkit-flex; display:-moz-flex; display:-o-flex; display:-ms-flex; display:flex'\n   * ```\n   */\n\n  // we use ['',''] rather than an empty array in order to allow a pattern of .`join()`ing prefixes to test\n  // values in feature detects to continue to work\n  var prefixes = (ModernizrProto._config.usePrefixes ? ' -webkit- -moz- -o- -ms- '.split(' ') : ['','']);\n\n  // expose these for the plugin API. Look in the source for how to join() them against your input\n  ModernizrProto._prefixes = prefixes;\n\n\n/*!\n{\n  \"name\": \"CSS Calc\",\n  \"property\": \"csscalc\",\n  \"caniuse\": \"calc\",\n  \"tags\": [\"css\"],\n  \"builderAliases\": [\"css_calc\"],\n  \"authors\": [\"@calvein\"]\n}\n!*/\n/* DOC\nMethod of allowing calculated values for length units. For example:\n\n```css\n//lem {\n  width: calc(100% - 3em);\n}\n```\n*/\n\n  Modernizr.addTest('csscalc', function() {\n    var prop = 'width:';\n    var value = 'calc(10px);';\n    var el = createElement('a');\n\n    el.style.cssText = prop + prefixes.join(value + prop);\n\n    return !!el.style.length;\n  });\n\n/*!\n{\n  \"name\": \"CSS Gradients\",\n  \"caniuse\": \"css-gradients\",\n  \"property\": \"cssgradients\",\n  \"tags\": [\"css\"],\n  \"knownBugs\": [\"False-positives on webOS (https://github.com/Modernizr/Modernizr/issues/202)\"],\n  \"notes\": [{\n    \"name\": \"Webkit Gradient Syntax\",\n    \"href\": \"https://webkit.org/blog/175/introducing-css-gradients/\"\n  },{\n    \"name\": \"Linear Gradient Syntax\",\n    \"href\": \"https://developer.mozilla.org/en-US/docs/Web/CSS/linear-gradient\"\n  },{\n    \"name\": \"W3C Gradient Spec\",\n    \"href\": \"https://drafts.csswg.org/css-images-3/#gradients\"\n  }]\n}\n!*/\n\n\n  Modernizr.addTest('cssgradients', function() {\n\n    var str1 = 'background-image:';\n    var str2 = 'gradient(linear,left top,right bottom,from(#9f9),to(white));';\n    var css = '';\n    var angle;\n\n    for (var i = 0, len = prefixes.length - 1; i < len; i++) {\n      angle = (i === 0 ? 'to ' : '');\n      css += str1 + prefixes[i] + 'linear-gradient(' + angle + 'left top, #9f9, white);';\n    }\n\n    if (Modernizr._config.usePrefixes) {\n    // legacy webkit syntax (FIXME: remove when syntax not in use anymore)\n      css += str1 + '-webkit-' + str2;\n    }\n\n    var elem = createElement('a');\n    var style = elem.style;\n    style.cssText = css;\n\n    // IE6 returns undefined so cast to string\n    return ('' + style.backgroundImage).indexOf('gradient') > -1;\n  });\n\n/*!\n{\n  \"name\": \"CSS Supports\",\n  \"property\": \"supports\",\n  \"caniuse\": \"css-featurequeries\",\n  \"tags\": [\"css\"],\n  \"builderAliases\": [\"css_supports\"],\n  \"notes\": [{\n    \"name\": \"W3 Spec\",\n    \"href\": \"http://dev.w3.org/csswg/css3-conditional/#at-supports\"\n  },{\n    \"name\": \"Related Github Issue\",\n    \"href\": \"github.com/Modernizr/Modernizr/issues/648\"\n  },{\n    \"name\": \"W3 Info\",\n    \"href\": \"http://dev.w3.org/csswg/css3-conditional/#the-csssupportsrule-interface\"\n  }]\n}\n!*/\n\n  var newSyntax = 'CSS' in window && 'supports' in window.CSS;\n  var oldSyntax = 'supportsCSS' in window;\n  Modernizr.addTest('supports', newSyntax || oldSyntax);\n\n\n  /**\n   * getBody returns the body of a document, or an element that can stand in for\n   * the body if a real body does not exist\n   *\n   * @access private\n   * @function getBody\n   * @returns {HTMLElement|SVGElement} Returns the real body of a document, or an\n   * artificially created element that stands in for the body\n   */\n\n  function getBody() {\n    // After page load injecting a fake body doesn't work so check if body exists\n    var body = document.body;\n\n    if (!body) {\n      // Can't use the real body create a fake one.\n      body = createElement(isSVG ? 'svg' : 'body');\n      body.fake = true;\n    }\n\n    return body;\n  }\n\n  ;\n\n  /**\n   * injectElementWithStyles injects an element with style element and some CSS rules\n   *\n   * @access private\n   * @function injectElementWithStyles\n   * @param {string} rule - String representing a css rule\n   * @param {function} callback - A function that is used to test the injected element\n   * @param {number} [nodes] - An integer representing the number of additional nodes you want injected\n   * @param {string[]} [testnames] - An array of strings that are used as ids for the additional nodes\n   * @returns {boolean}\n   */\n\n  function injectElementWithStyles(rule, callback, nodes, testnames) {\n    var mod = 'modernizr';\n    var style;\n    var ret;\n    var node;\n    var docOverflow;\n    var div = createElement('div');\n    var body = getBody();\n\n    if (parseInt(nodes, 10)) {\n      // In order not to give false positives we create a node for each test\n      // This also allows the method to scale for unspecified uses\n      while (nodes--) {\n        node = createElement('div');\n        node.id = testnames ? testnames[nodes] : mod + (nodes + 1);\n        div.appendChild(node);\n      }\n    }\n\n    style = createElement('style');\n    style.type = 'text/css';\n    style.id = 's' + mod;\n\n    // IE6 will false positive on some tests due to the style element inside the test div somehow interfering offsetHeight, so insert it into body or fakebody.\n    // Opera will act all quirky when injecting elements in documentElement when page is served as xml, needs fakebody too. #270\n    (!body.fake ? div : body).appendChild(style);\n    body.appendChild(div);\n\n    if (style.styleSheet) {\n      style.styleSheet.cssText = rule;\n    } else {\n      style.appendChild(document.createTextNode(rule));\n    }\n    div.id = mod;\n\n    if (body.fake) {\n      //avoid crashing IE8, if background image is used\n      body.style.background = '';\n      //Safari 5.13/5.1.4 OSX stops loading if ::-webkit-scrollbar is used and scrollbars are visible\n      body.style.overflow = 'hidden';\n      docOverflow = docElement.style.overflow;\n      docElement.style.overflow = 'hidden';\n      docElement.appendChild(body);\n    }\n\n    ret = callback(div, rule);\n    // If this is done after page load we don't want to remove the body so check if body exists\n    if (body.fake) {\n      body.parentNode.removeChild(body);\n      docElement.style.overflow = docOverflow;\n      // Trigger layout so kinetic scrolling isn't disabled in iOS6+\n      docElement.offsetHeight;\n    } else {\n      div.parentNode.removeChild(div);\n    }\n\n    return !!ret;\n\n  }\n\n  ;\n\n  /**\n   * testStyles injects an element with style element and some CSS rules\n   *\n   * @memberof Modernizr\n   * @name Modernizr.testStyles\n   * @optionName Modernizr.testStyles()\n   * @optionProp testStyles\n   * @access public\n   * @function testStyles\n   * @param {string} rule - String representing a css rule\n   * @param {function} callback - A function that is used to test the injected element\n   * @param {number} [nodes] - An integer representing the number of additional nodes you want injected\n   * @param {string[]} [testnames] - An array of strings that are used as ids for the additional nodes\n   * @returns {boolean}\n   * @example\n   *\n   * `Modernizr.testStyles` takes a CSS rule and injects it onto the current page\n   * along with (possibly multiple) DOM elements. This lets you check for features\n   * that can not be detected by simply checking the [IDL](https://developer.mozilla.org/en-US/docs/Mozilla/Developer_guide/Interface_development_guide/IDL_interface_rules).\n   *\n   * ```js\n   * Modernizr.testStyles('#modernizr { width: 9px; color: papayawhip; }', function(elem, rule) {\n   *   // elem is the first DOM node in the page (by default #modernizr)\n   *   // rule is the first argument you supplied - the CSS rule in string form\n   *\n   *   addTest('widthworks', elem.style.width === '9px')\n   * });\n   * ```\n   *\n   * If your test requires multiple nodes, you can include a third argument\n   * indicating how many additional div elements to include on the page. The\n   * additional nodes are injected as children of the `elem` that is returned as\n   * the first argument to the callback.\n   *\n   * ```js\n   * Modernizr.testStyles('#modernizr {width: 1px}; #modernizr2 {width: 2px}', function(elem) {\n   *   document.getElementById('modernizr').style.width === '1px'; // true\n   *   document.getElementById('modernizr2').style.width === '2px'; // true\n   *   elem.firstChild === document.getElementById('modernizr2'); // true\n   * }, 1);\n   * ```\n   *\n   * By default, all of the additional elements have an ID of `modernizr[n]`, where\n   * `n` is its index (e.g. the first additional, second overall is `#modernizr2`,\n   * the second additional is `#modernizr3`, etc.).\n   * If you want to have more meaningful IDs for your function, you can provide\n   * them as the fourth argument, as an array of strings\n   *\n   * ```js\n   * Modernizr.testStyles('#foo {width: 10px}; #bar {height: 20px}', function(elem) {\n   *   elem.firstChild === document.getElementById('foo'); // true\n   *   elem.lastChild === document.getElementById('bar'); // true\n   * }, 2, ['foo', 'bar']);\n   * ```\n   *\n   */\n\n  var testStyles = ModernizrProto.testStyles = injectElementWithStyles;\n\n\n  /**\n   * If the browsers follow the spec, then they would expose vendor-specific style as:\n   *   elem.style.WebkitBorderRadius\n   * instead of something like the following, which would be technically incorrect:\n   *   elem.style.webkitBorderRadius\n\n   * Webkit ghosts their properties in lowercase but Opera & Moz do not.\n   * Microsoft uses a lowercase `ms` instead of the correct `Ms` in IE8+\n   *   erik.eae.net/archives/2008/03/10/21.48.10/\n\n   * More here: github.com/Modernizr/Modernizr/issues/issue/21\n   *\n   * @access private\n   * @returns {string} The string representing the vendor-specific style properties\n   */\n\n  var omPrefixes = 'Moz O ms Webkit';\n\n\n  var cssomPrefixes = (ModernizrProto._config.usePrefixes ? omPrefixes.split(' ') : []);\n  ModernizrProto._cssomPrefixes = cssomPrefixes;\n\n\n  /**\n   * List of JavaScript DOM values used for tests\n   *\n   * @memberof Modernizr\n   * @name Modernizr._domPrefixes\n   * @optionName Modernizr._domPrefixes\n   * @optionProp domPrefixes\n   * @access public\n   * @example\n   *\n   * Modernizr._domPrefixes is exactly the same as [_prefixes](#modernizr-_prefixes), but rather\n   * than kebab-case properties, all properties are their Capitalized variant\n   *\n   * ```js\n   * Modernizr._domPrefixes === [ \"Moz\", \"O\", \"ms\", \"Webkit\" ];\n   * ```\n   */\n\n  var domPrefixes = (ModernizrProto._config.usePrefixes ? omPrefixes.toLowerCase().split(' ') : []);\n  ModernizrProto._domPrefixes = domPrefixes;\n\n\n\n  /**\n   * contains checks to see if a string contains another string\n   *\n   * @access private\n   * @function contains\n   * @param {string} str - The string we want to check for substrings\n   * @param {string} substr - The substring we want to search the first string for\n   * @returns {boolean}\n   */\n\n  function contains(str, substr) {\n    return !!~('' + str).indexOf(substr);\n  }\n\n  ;\n\n  /**\n   * cssToDOM takes a kebab-case string and converts it to camelCase\n   * e.g. box-sizing -> boxSizing\n   *\n   * @access private\n   * @function cssToDOM\n   * @param {string} name - String name of kebab-case prop we want to convert\n   * @returns {string} The camelCase version of the supplied name\n   */\n\n  function cssToDOM(name) {\n    return name.replace(/([a-z])-([a-z])/g, function(str, m1, m2) {\n      return m1 + m2.toUpperCase();\n    }).replace(/^-/, '');\n  }\n  ;\n\n  /**\n   * fnBind is a super small [bind](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind) polyfill.\n   *\n   * @access private\n   * @function fnBind\n   * @param {function} fn - a function you want to change `this` reference to\n   * @param {object} that - the `this` you want to call the function with\n   * @returns {function} The wrapped version of the supplied function\n   */\n\n  function fnBind(fn, that) {\n    return function() {\n      return fn.apply(that, arguments);\n    };\n  }\n\n  ;\n\n  /**\n   * testDOMProps is a generic DOM property test; if a browser supports\n   *   a certain property, it won't return undefined for it.\n   *\n   * @access private\n   * @function testDOMProps\n   * @param {array.<string>} props - An array of properties to test for\n   * @param {object} obj - An object or Element you want to use to test the parameters again\n   * @param {boolean|object} elem - An Element to bind the property lookup again. Use `false` to prevent the check\n   */\n  function testDOMProps(props, obj, elem) {\n    var item;\n\n    for (var i in props) {\n      if (props[i] in obj) {\n\n        // return the property name as a string\n        if (elem === false) {\n          return props[i];\n        }\n\n        item = obj[props[i]];\n\n        // let's bind a function\n        if (is(item, 'function')) {\n          // bind to obj unless overriden\n          return fnBind(item, elem || obj);\n        }\n\n        // return the unbound function or obj or value\n        return item;\n      }\n    }\n    return false;\n  }\n\n  ;\n\n  /**\n   * Create our \"modernizr\" element that we do most feature tests on.\n   *\n   * @access private\n   */\n\n  var modElem = {\n    elem: createElement('modernizr')\n  };\n\n  // Clean up this element\n  Modernizr._q.push(function() {\n    delete modElem.elem;\n  });\n\n\n\n  var mStyle = {\n    style: modElem.elem.style\n  };\n\n  // kill ref for gc, must happen before mod.elem is removed, so we unshift on to\n  // the front of the queue.\n  Modernizr._q.unshift(function() {\n    delete mStyle.style;\n  });\n\n\n\n  /**\n   * domToCSS takes a camelCase string and converts it to kebab-case\n   * e.g. boxSizing -> box-sizing\n   *\n   * @access private\n   * @function domToCSS\n   * @param {string} name - String name of camelCase prop we want to convert\n   * @returns {string} The kebab-case version of the supplied name\n   */\n\n  function domToCSS(name) {\n    return name.replace(/([A-Z])/g, function(str, m1) {\n      return '-' + m1.toLowerCase();\n    }).replace(/^ms-/, '-ms-');\n  }\n  ;\n\n  /**\n   * nativeTestProps allows for us to use native feature detection functionality if available.\n   * some prefixed form, or false, in the case of an unsupported rule\n   *\n   * @access private\n   * @function nativeTestProps\n   * @param {array} props - An array of property names\n   * @param {string} value - A string representing the value we want to check via @supports\n   * @returns {boolean|undefined} A boolean when @supports exists, undefined otherwise\n   */\n\n  // Accepts a list of property names and a single value\n  // Returns `undefined` if native detection not available\n  function nativeTestProps(props, value) {\n    var i = props.length;\n    // Start with the JS API: http://www.w3.org/TR/css3-conditional/#the-css-interface\n    if ('CSS' in window && 'supports' in window.CSS) {\n      // Try every prefixed variant of the property\n      while (i--) {\n        if (window.CSS.supports(domToCSS(props[i]), value)) {\n          return true;\n        }\n      }\n      return false;\n    }\n    // Otherwise fall back to at-rule (for Opera 12.x)\n    else if ('CSSSupportsRule' in window) {\n      // Build a condition string for every prefixed variant\n      var conditionText = [];\n      while (i--) {\n        conditionText.push('(' + domToCSS(props[i]) + ':' + value + ')');\n      }\n      conditionText = conditionText.join(' or ');\n      return injectElementWithStyles('@supports (' + conditionText + ') { #modernizr { position: absolute; } }', function(node) {\n        return getComputedStyle(node, null).position == 'absolute';\n      });\n    }\n    return undefined;\n  }\n  ;\n\n  // testProps is a generic CSS / DOM property test.\n\n  // In testing support for a given CSS property, it's legit to test:\n  //    `elem.style[styleName] !== undefined`\n  // If the property is supported it will return an empty string,\n  // if unsupported it will return undefined.\n\n  // We'll take advantage of this quick test and skip setting a style\n  // on our modernizr element, but instead just testing undefined vs\n  // empty string.\n\n  // Property names can be provided in either camelCase or kebab-case.\n\n  function testProps(props, prefixed, value, skipValueTest) {\n    skipValueTest = is(skipValueTest, 'undefined') ? false : skipValueTest;\n\n    // Try native detect first\n    if (!is(value, 'undefined')) {\n      var result = nativeTestProps(props, value);\n      if (!is(result, 'undefined')) {\n        return result;\n      }\n    }\n\n    // Otherwise do it properly\n    var afterInit, i, propsLength, prop, before;\n\n    // If we don't have a style element, that means we're running async or after\n    // the core tests, so we'll need to create our own elements to use\n\n    // inside of an SVG element, in certain browsers, the `style` element is only\n    // defined for valid tags. Therefore, if `modernizr` does not have one, we\n    // fall back to a less used element and hope for the best.\n    var elems = ['modernizr', 'tspan'];\n    while (!mStyle.style) {\n      afterInit = true;\n      mStyle.modElem = createElement(elems.shift());\n      mStyle.style = mStyle.modElem.style;\n    }\n\n    // Delete the objects if we created them.\n    function cleanElems() {\n      if (afterInit) {\n        delete mStyle.style;\n        delete mStyle.modElem;\n      }\n    }\n\n    propsLength = props.length;\n    for (i = 0; i < propsLength; i++) {\n      prop = props[i];\n      before = mStyle.style[prop];\n\n      if (contains(prop, '-')) {\n        prop = cssToDOM(prop);\n      }\n\n      if (mStyle.style[prop] !== undefined) {\n\n        // If value to test has been passed in, do a set-and-check test.\n        // 0 (integer) is a valid property value, so check that `value` isn't\n        // undefined, rather than just checking it's truthy.\n        if (!skipValueTest && !is(value, 'undefined')) {\n\n          // Needs a try catch block because of old IE. This is slow, but will\n          // be avoided in most cases because `skipValueTest` will be used.\n          try {\n            mStyle.style[prop] = value;\n          } catch (e) {}\n\n          // If the property value has changed, we assume the value used is\n          // supported. If `value` is empty string, it'll fail here (because\n          // it hasn't changed), which matches how browsers have implemented\n          // CSS.supports()\n          if (mStyle.style[prop] != before) {\n            cleanElems();\n            return prefixed == 'pfx' ? prop : true;\n          }\n        }\n        // Otherwise just return true, or the property name if this is a\n        // `prefixed()` call\n        else {\n          cleanElems();\n          return prefixed == 'pfx' ? prop : true;\n        }\n      }\n    }\n    cleanElems();\n    return false;\n  }\n\n  ;\n\n  /**\n   * testPropsAll tests a list of DOM properties we want to check against.\n   * We specify literally ALL possible (known and/or likely) properties on\n   * the element including the non-vendor prefixed one, for forward-\n   * compatibility.\n   *\n   * @access private\n   * @function testPropsAll\n   * @param {string} prop - A string of the property to test for\n   * @param {string|object} [prefixed] - An object to check the prefixed properties on. Use a string to skip\n   * @param {HTMLElement|SVGElement} [elem] - An element used to test the property and value against\n   * @param {string} [value] - A string of a css value\n   * @param {boolean} [skipValueTest] - An boolean representing if you want to test if value sticks when set\n   */\n  function testPropsAll(prop, prefixed, elem, value, skipValueTest) {\n\n    var ucProp = prop.charAt(0).toUpperCase() + prop.slice(1),\n    props = (prop + ' ' + cssomPrefixes.join(ucProp + ' ') + ucProp).split(' ');\n\n    // did they call .prefixed('boxSizing') or are we just testing a prop?\n    if (is(prefixed, 'string') || is(prefixed, 'undefined')) {\n      return testProps(props, prefixed, value, skipValueTest);\n\n      // otherwise, they called .prefixed('requestAnimationFrame', window[, elem])\n    } else {\n      props = (prop + ' ' + (domPrefixes).join(ucProp + ' ') + ucProp).split(' ');\n      return testDOMProps(props, prefixed, elem);\n    }\n  }\n\n  // Modernizr.testAllProps() investigates whether a given style property,\n  // or any of its vendor-prefixed variants, is recognized\n  //\n  // Note that the property names must be provided in the camelCase variant.\n  // Modernizr.testAllProps('boxSizing')\n  ModernizrProto.testAllProps = testPropsAll;\n\n\n\n  /**\n   * testAllProps determines whether a given CSS property is supported in the browser\n   *\n   * @memberof Modernizr\n   * @name Modernizr.testAllProps\n   * @optionName Modernizr.testAllProps()\n   * @optionProp testAllProps\n   * @access public\n   * @function testAllProps\n   * @param {string} prop - String naming the property to test (either camelCase or kebab-case)\n   * @param {string} [value] - String of the value to test\n   * @param {boolean} [skipValueTest=false] - Whether to skip testing that the value is supported when using non-native detection\n   * @example\n   *\n   * testAllProps determines whether a given CSS property, in some prefixed form,\n   * is supported by the browser.\n   *\n   * ```js\n   * testAllProps('boxSizing')  // true\n   * ```\n   *\n   * It can optionally be given a CSS value in string form to test if a property\n   * value is valid\n   *\n   * ```js\n   * testAllProps('display', 'block') // true\n   * testAllProps('display', 'penguin') // false\n   * ```\n   *\n   * A boolean can be passed as a third parameter to skip the value check when\n   * native detection (@supports) isn't available.\n   *\n   * ```js\n   * testAllProps('shapeOutside', 'content-box', true);\n   * ```\n   */\n\n  function testAllProps(prop, value, skipValueTest) {\n    return testPropsAll(prop, undefined, undefined, value, skipValueTest);\n  }\n  ModernizrProto.testAllProps = testAllProps;\n\n/*!\n{\n  \"name\": \"CSS Animations\",\n  \"property\": \"cssanimations\",\n  \"caniuse\": \"css-animation\",\n  \"polyfills\": [\"transformie\", \"csssandpaper\"],\n  \"tags\": [\"css\"],\n  \"warnings\": [\"Android < 4 will pass this test, but can only animate a single property at a time\"],\n  \"notes\": [{\n    \"name\" : \"Article: 'Dispelling the Android CSS animation myths'\",\n    \"href\": \"https://goo.gl/OGw5Gm\"\n  }]\n}\n!*/\n/* DOC\nDetects whether or not elements can be animated using CSS\n*/\n\n  Modernizr.addTest('cssanimations', testAllProps('animationName', 'a', true));\n\n/*!\n{\n  \"name\": \"CSS Transforms 3D\",\n  \"property\": \"csstransforms3d\",\n  \"caniuse\": \"transforms3d\",\n  \"tags\": [\"css\"],\n  \"warnings\": [\n    \"Chrome may occassionally fail this test on some systems; more info: https://code.google.com/p/chromium/issues/detail?id=129004\"\n  ]\n}\n!*/\n\n  Modernizr.addTest('csstransforms3d', function() {\n    var ret = !!testAllProps('perspective', '1px', true);\n    var usePrefix = Modernizr._config.usePrefixes;\n\n    // Webkit's 3D transforms are passed off to the browser's own graphics renderer.\n    //   It works fine in Safari on Leopard and Snow Leopard, but not in Chrome in\n    //   some conditions. As a result, Webkit typically recognizes the syntax but\n    //   will sometimes throw a false positive, thus we must do a more thorough check:\n    if (ret && (!usePrefix || 'webkitPerspective' in docElement.style)) {\n      var mq;\n      var defaultStyle = '#modernizr{width:0;height:0}';\n      // Use CSS Conditional Rules if available\n      if (Modernizr.supports) {\n        mq = '@supports (perspective: 1px)';\n      } else {\n        // Otherwise, Webkit allows this media query to succeed only if the feature is enabled.\n        // `@media (transform-3d),(-webkit-transform-3d){ ... }`\n        mq = '@media (transform-3d)';\n        if (usePrefix) {\n          mq += ',(-webkit-transform-3d)';\n        }\n      }\n\n      mq += '{#modernizr{width:7px;height:18px;margin:0;padding:0;border:0}}';\n\n      testStyles(defaultStyle + mq, function(elem) {\n        ret = elem.offsetWidth === 7 && elem.offsetHeight === 18;\n      });\n    }\n\n    return ret;\n  });\n\n\n  // Run each test\n  testRunner();\n\n  // Remove the \"no-js\" class if it exists\n  setClasses(classes);\n\n  delete ModernizrProto.addTest;\n  delete ModernizrProto.addAsyncTest;\n\n  // Run the things that are supposed to run after the tests\n  for (var i = 0; i < Modernizr._q.length; i++) {\n    Modernizr._q[i]();\n  }\n\n  // Leak Modernizr namespace\n  window.Modernizr = Modernizr;\n\n\n;\n\n})(window, document);\n","import sono from 'sono';\n\nclass Xp {\n\n    constructor() {\n\n        console.log(sono);\n\n\n\n        this.draw = this.draw.bind(this);\n        this.events = this.events.bind(this);\n        this.changeFtt = this.changeFtt.bind(this);\n        this.resizeHandler = this.resizeHandler.bind(this);\n\n\n        this.init();\n\n\n    }\n\n    init() {\n\n\n        this.ui = {\n            myAudio: document.querySelector('audio'),\n            frequencyB: document.querySelector('.frequency .block'),\n            amplitudeB: document.querySelector('.amplitude .block'),\n            waveFormB: document.querySelector('.waveForm .block'),\n            ptichB: document.querySelector('.pitch .block'),\n            formFtt: document.querySelector('.fttSize')\n        }\n\n        // New WebAudio API\n        this.audioCtx = new(window.AudioContext || window.webkitAudioContext)();\n\n        //  Create Analyser node\n        this.analyser = this.audioCtx.createAnalyser();\n\n        // Connect nodes together\n        var source = this.audioCtx.createMediaElementSource(this.ui.myAudio);\n        source.connect(this.analyser);\n        this.analyser.connect(this.audioCtx.destination);\n\n\n        // Set Fourier value\n        this.analyser.fftSize = this.ui.formFtt.value;\n        // Get frequency length ( fftSize / 2)\n        this.bufferLength = this.analyser.frequencyBinCount;\n        // Prepare array of frequencies\n        this.dataArray = new Uint8Array(this.bufferLength);\n\n\n        this.canvas = document.querySelector('.canvas');\n        this.canvas.width = window.innerWidth;\n        this.canvas.height = 300;\n        console.log(this.canvas.width);\n        this.canvasCtx = this.canvas.getContext('2d');\n        this.canvasCtx.clearRect(0, 0, 500, 500);\n\n        console.log(this.bufferLength);\n\n        this.events();\n\n        this.draw();\n\n\n    }\n\n    events() {\n\n        this.ui.formFtt.addEventListener('change', this.changeFtt);\n        window.addEventListener('resize', this.resizeHandler);\n\n    }\n\n    changeFtt(e) {\n        // Reset frequencies \n        this.analyser.fftSize = this.ui.formFtt.value;\n        this.bufferLength = this.analyser.frequencyBinCount;\n        this.dataArray = new Uint8Array(this.bufferLength);\n\n        console.log(this.bufferLength, this.dataArray);\n    }\n\n    resizeHandler() {\n        this.canvas.width = window.innerWidth;\n    }\n\n    draw() {\n\n\n        // .getByteFrequencyData() --> For bar graph visualisation (abscisse = Fréquence / ordonnée = intensité)\n        // .getByteTimeDomainData() --> For oscilloscope visualisation \n        this.analyser.getByteFrequencyData(this.dataArray);\n\n        // create background\n        this.canvasCtx.fillStyle = 'rgb(0, 0, 0)';\n        this.canvasCtx.fillRect(0, 0, this.canvas.width, 500);\n\n        let barWidth = (this.canvas.width / this.bufferLength);\n        let barHeight;\n        let x = 0;\n\n        // Value of first Bar\n        // console.log(this.dataArray[0]);\n\n        for (let i = 0; i < this.bufferLength; i++) {\n            barHeight = this.dataArray[i] * 3/4;\n\n            let hue = i / this.bufferLength * 360;\n            this.canvasCtx.fillStyle = 'hsl(' + hue + ', 100%, 50%)';\n            this.canvasCtx.fillRect(x, this.canvas.height - barHeight, barWidth, barHeight);\n\n            x += barWidth + 1;\n        }\n\n\n\n        requestAnimationFrame(this.draw);\n\n    }\n\n\n}\n\n\nexport default new Xp();\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.sono = factory());\n}(this, (function () { 'use strict';\n\nvar browser = {};\n\nbrowser.handlePageVisibility = function (onHidden, onShown) {\n    var hidden = void 0,\n        visibilityChange = void 0;\n\n    if (typeof document.hidden !== 'undefined') {\n        hidden = 'hidden';\n        visibilityChange = 'visibilitychange';\n    } else if (typeof document.mozHidden !== 'undefined') {\n        hidden = 'mozHidden';\n        visibilityChange = 'mozvisibilitychange';\n    } else if (typeof document.msHidden !== 'undefined') {\n        hidden = 'msHidden';\n        visibilityChange = 'msvisibilitychange';\n    } else if (typeof document.webkitHidden !== 'undefined') {\n        hidden = 'webkitHidden';\n        visibilityChange = 'webkitvisibilitychange';\n    }\n\n    function onChange() {\n        if (document[hidden]) {\n            onHidden();\n        } else {\n            onShown();\n        }\n    }\n\n    if (typeof visibilityChange !== 'undefined') {\n        document.addEventListener(visibilityChange, onChange, false);\n    }\n};\n\nbrowser.handleTouchLock = function (context, onUnlock) {\n    var ua = navigator.userAgent,\n        locked = !!ua.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Windows Phone|SymbianOS/i);\n\n    function unlock() {\n        if (context && context.state === 'suspended') {\n            context.resume().then(function () {\n                var buffer = context.createBuffer(1, 1, 44100);\n                var source = context.createBufferSource();\n                source.buffer = buffer;\n                source.connect(context.destination);\n                source.start(0);\n                source.stop(0);\n                source.disconnect();\n\n                document.body.removeEventListener('touchend', unlock);\n                onUnlock();\n            });\n        } else {\n            document.body.removeEventListener('touchend', unlock);\n            onUnlock();\n        }\n    }\n\n    if (locked) {\n        document.body.addEventListener('touchend', unlock, false);\n    }\n\n    return locked;\n};\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj;\n};\n\n\n\n\n\nvar classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\n\n\n\n\n\n\n\n\nvar get$1 = function get$1(object, property, receiver) {\n  if (object === null) object = Function.prototype;\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent === null) {\n      return undefined;\n    } else {\n      return get$1(parent, property, receiver);\n    }\n  } else if (\"value\" in desc) {\n    return desc.value;\n  } else {\n    var getter = desc.get;\n\n    if (getter === undefined) {\n      return undefined;\n    }\n\n    return getter.call(receiver);\n  }\n};\n\nvar inherits = function (subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n};\n\n\n\n\n\n\n\n\n\n\n\nvar possibleConstructorReturn = function (self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n};\n\n\n\nvar set$1 = function set$1(object, property, value, receiver) {\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent !== null) {\n      set$1(parent, property, value, receiver);\n    }\n  } else if (\"value\" in desc && desc.writable) {\n    desc.value = value;\n  } else {\n    var setter = desc.set;\n\n    if (setter !== undefined) {\n      setter.call(receiver, value);\n    }\n  }\n\n  return value;\n};\n\nvar extensions = [];\nvar canPlay = {};\n\n/*\n * Initial tests\n */\n\nvar tests = [{\n    ext: 'ogg',\n    type: 'audio/ogg; codecs=\"vorbis\"'\n}, {\n    ext: 'mp3',\n    type: 'audio/mpeg;'\n}, {\n    ext: 'opus',\n    type: 'audio/ogg; codecs=\"opus\"'\n}, {\n    ext: 'wav',\n    type: 'audio/wav; codecs=\"1\"'\n}, {\n    ext: 'm4a',\n    type: 'audio/x-m4a;'\n}, {\n    ext: 'm4a',\n    type: 'audio/aac;'\n}];\n\nvar el = document.createElement('audio');\nif (el) {\n    tests.forEach(function (test) {\n        var canPlayType = !!el.canPlayType(test.type);\n        if (canPlayType && extensions.indexOf(test.ext) === -1) {\n            extensions.push(test.ext);\n        }\n        canPlay[test.ext] = canPlayType;\n    });\n    el = null;\n}\n\n/*\n * find a supported file\n */\n\nfunction getFileExtension(url) {\n    if (typeof url !== 'string') {\n        return '';\n    }\n    // from DataURL\n    if (url.slice(0, 5) === 'data:') {\n        var match = url.match(/data:audio\\/(ogg|mp3|opus|wav|m4a)/i);\n        if (match && match.length > 1) {\n            return match[1].toLowerCase();\n        }\n    }\n    // from Standard URL\n    url = url.split('?')[0];\n    url = url.slice(url.lastIndexOf('/') + 1);\n\n    var a = url.split('.');\n    if (a.length === 1 || a[0] === '' && a.length === 2) {\n        return '';\n    }\n    return a.pop().toLowerCase();\n}\n\nfunction getSupportedFile(fileNames) {\n    var name = void 0;\n\n    if (Array.isArray(fileNames)) {\n        // if array get the first one that works\n        for (var i = 0; i < fileNames.length; i++) {\n            name = fileNames[i];\n            var ext = getFileExtension(name);\n            if (extensions.indexOf(ext) > -1) {\n                break;\n            }\n        }\n    } else if ((typeof fileNames === 'undefined' ? 'undefined' : _typeof(fileNames)) === 'object') {\n        // if not array and is object\n        Object.keys(fileNames).some(function (key) {\n            name = fileNames[key];\n            var ext = getFileExtension(name);\n            return extensions.indexOf(ext) > -1;\n        });\n    }\n    // if string just return\n    return name || fileNames;\n}\n\n/*\n * infer file types\n */\n\nfunction isAudioBuffer(data) {\n    return !!(data && window.AudioBuffer && data instanceof window.AudioBuffer);\n}\n\nfunction isArrayBuffer(data) {\n    return !!(data && window.ArrayBuffer && data instanceof window.ArrayBuffer);\n}\n\nfunction isMediaElement(data) {\n    return !!(data && window.HTMLMediaElement && data instanceof window.HTMLMediaElement);\n}\n\nfunction isMediaStream(data) {\n    return !!(data && typeof data.getAudioTracks === 'function' && data.getAudioTracks().length && window.MediaStreamTrack && data.getAudioTracks()[0] instanceof window.MediaStreamTrack);\n}\n\nfunction isOscillatorType(data) {\n    return !!(data && typeof data === 'string' && (data === 'sine' || data === 'square' || data === 'sawtooth' || data === 'triangle'));\n}\n\nfunction isScriptConfig(data) {\n    return !!(data && (typeof data === 'undefined' ? 'undefined' : _typeof(data)) === 'object' && data.bufferSize && data.channels && data.callback);\n}\n\nfunction isURL(data) {\n    return !!(data && typeof data === 'string' && (data.indexOf('.') > -1 || data.slice(0, 5) === 'data:'));\n}\n\nfunction containsURL(config) {\n    if (!config || isMediaElement(config)) {\n        return false;\n    }\n    // string, array or object with src/url/data property that is string, array or arraybuffer\n    var src = config.src || config.url || config.data || config;\n    return isURL(src) || isArrayBuffer(src) || Array.isArray(src) && isURL(src[0]);\n}\n\nvar file = {\n    canPlay: canPlay,\n    containsURL: containsURL,\n    extensions: extensions,\n    getFileExtension: getFileExtension,\n    getSupportedFile: getSupportedFile,\n    isAudioBuffer: isAudioBuffer,\n    isMediaElement: isMediaElement,\n    isMediaStream: isMediaStream,\n    isOscillatorType: isOscillatorType,\n    isScriptConfig: isScriptConfig,\n    isURL: isURL\n};\n\nfunction Analyser(context, config) {\n    config = config || {};\n\n    var node = context.createAnalyser();\n\n    var fftSize = config.fftSize || 512,\n        freqFloat = !!config.float,\n        waveFloat = !!config.float,\n        waveform = void 0,\n        frequencies = void 0;\n\n    node.fftSize = fftSize; // frequencyBinCount will be half this value\n    node.smoothingTimeConstant = config.smoothing || config.smoothingTimeConstant || node.smoothingTimeConstant;\n    node.minDecibels = config.minDecibels || node.minDecibels;\n    node.maxDecibels = config.maxDecibels || node.maxDecibels;\n\n    //the worker returns a normalized value\n    //first a sum of all magnitudes devided by the byteLength, then devide  by half the fft (1channel)\n    var amplitudeBlob = new Blob(['onmessage=function(e){var data=e.data;var f=new Float32Array(data.b);for(var i=0;i<f.length;i++){data.sum+=f[i]}data.sum/=f.length;postMessage(Math.max(1.0-(data.sum/data.numSamples*-1.0),0))};']);\n    var pitchBlob = new Blob(['onmessage=function(e){var data=e.data;var sampleRate=data.sampleRate;var buf=new Float32Array(data.b);var SIZE=buf.length;var MAX_SAMPLES=Math.floor(SIZE/2);var best_offset=-1;var best_correlation=0;var rms=0;var foundGoodCorrelation=false;var correlations=new Array(MAX_SAMPLES);for(var i=0;i<SIZE;i++){var val=buf[i];rms+=val*val}rms=Math.sqrt(rms/SIZE);if (rms<0.01){postMessage(-1)}else{var lastCorrelation=1;for(var offset=0;offset<MAX_SAMPLES;offset++){var correlation=0;for(var i=0;i<MAX_SAMPLES;i++){correlation+=Math.abs((buf[i])-(buf[i+offset]))}correlation=1-(correlation/MAX_SAMPLES);correlations[offset]=correlation;if ((correlation>0.9)&&(correlation>lastCorrelation)){foundGoodCorrelation=true;if (correlation>best_correlation){best_correlation=correlation;best_offset=offset}}else if (foundGoodCorrelation){var shift=(correlations[best_offset+1]-correlations[best_offset-1])/correlations[best_offset];postMessage(sampleRate/(best_offset+(8*shift)))}lastCorrelation=correlation}if (best_correlation>0.01){postMessage(sampleRate/best_offset)}else{postMessage(-1)}}};']);\n    var amplitudeBlobURL = URL.createObjectURL(amplitudeBlob);\n    var amplitudeWorker = new Worker(amplitudeBlobURL);\n    var pitchBlobURL = URL.createObjectURL(pitchBlob);\n    var pitchWorker = new Worker(pitchBlobURL);\n\n    var amplitudeCallback = null;\n    var noteStrings = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n    var pitchCallback = null;\n    var pitchCallbackObject = {\n        hertz: null, //number\n        note: null, //string\n        noteIndex: null, //int\n        detuneCents: null, //number\n        detune: null //string\n    };\n\n    function noteFromPitch(frequency) {\n        var noteNum = 12 * (Math.log(frequency / 440) / Math.log(2));\n        return Math.round(noteNum) + 69;\n    }\n\n    function frequencyFromNoteNumber(note) {\n        return 440 * Math.pow(2, (note - 69) / 12);\n    }\n\n    function centsOffFromPitch(frequency, note) {\n        return Math.floor(1200 * Math.log(frequency / frequencyFromNoteNumber(note)) / Math.log(2));\n    }\n\n    amplitudeWorker.onmessage = function (e) {\n        if (amplitudeCallback) {\n            amplitudeCallback(e.data);\n        }\n    };\n\n    pitchWorker.onmessage = function (e) {\n        if (pitchCallback) {\n            var Hz = e.data;\n            if (Hz !== -1) {\n                var note = noteFromPitch(Hz);\n                var detune = centsOffFromPitch(Hz, note);\n                pitchCallbackObject.hertz = Hz;\n                pitchCallbackObject.noteIndex = note % 12;\n                pitchCallbackObject.note = noteStrings[note % 12];\n                pitchCallbackObject.detuneCents = detune;\n                if (detune === 0) {\n                    pitchCallbackObject.detune = '';\n                } else if (detune < 0) {\n                    pitchCallbackObject.detune = 'flat';\n                } else {\n                    pitchCallbackObject.detune = 'sharp';\n                }\n            }\n            pitchCallback(pitchCallbackObject);\n        }\n    };\n\n    function needsUpdate(arr, float) {\n        if (!arr) {\n            return true;\n        }\n        if (node.fftSize !== fftSize) {\n            return true;\n        }\n        if (float && arr instanceof Uint8Array) {\n            return true;\n        }\n        return !float && arr instanceof Float32Array;\n    }\n\n    function createArray(float, length) {\n        return float ? new Float32Array(length) : new Uint8Array(length);\n    }\n\n    node.getWaveform = function (float) {\n        if (!arguments.length) {\n            float = waveFloat;\n        }\n\n        if (needsUpdate(waveform, float)) {\n            fftSize = node.fftSize;\n            waveFloat = float;\n            waveform = createArray(float, fftSize);\n        }\n        if (float && this.getFloatTimeDomainData) {\n            this.getFloatTimeDomainData(waveform);\n        } else {\n            this.getByteTimeDomainData(waveform);\n        }\n\n        return waveform;\n    };\n\n    node.getPitch = function (callback) {\n        pitchCallback = pitchCallback || callback;\n        var f = new Float32Array(node.fftSize);\n        f.set(node.getWaveform(true));\n        pitchWorker.postMessage({\n            sampleRate: context.sampleRate,\n            b: f.buffer\n        }, [f.buffer]);\n    };\n\n    node.getFrequencies = function (float) {\n        if (!arguments.length) {\n            float = freqFloat;\n        }\n\n        if (needsUpdate(frequencies, float)) {\n            fftSize = node.fftSize;\n            freqFloat = float;\n            frequencies = createArray(float, node.frequencyBinCount);\n        }\n\n        if (float) {\n            this.getFloatFrequencyData(frequencies);\n        } else {\n            this.getByteFrequencyData(frequencies);\n        }\n\n        return frequencies;\n    };\n\n    node.getAmplitude = function (callback) {\n        amplitudeCallback = amplitudeCallback || callback;\n        var f = new Float32Array(node.fftSize);\n        f.set(node.getFrequencies(true));\n        amplitudeWorker.postMessage({\n            sum: 0,\n            length: f.byteLength,\n            numSamples: node.fftSize / 2,\n            b: f.buffer\n        }, [f.buffer]);\n    };\n\n    node.update = function () {\n        node.getWaveform();\n        node.getFrequencies();\n    };\n\n    Object.defineProperties(node, {\n        smoothing: {\n            get: function get() {\n                return node.smoothingTimeConstant;\n            },\n            set: function set(value) {\n                node.smoothingTimeConstant = value;\n            }\n        }\n    });\n\n    return node;\n}\n\nfunction number(value, defaultValue) {\n    if (arguments.length < 2) {\n        defaultValue = 0;\n    }\n    if (typeof value !== 'number' || isNaN(value)) {\n        return defaultValue;\n    }\n    return value;\n}\n\nvar n = 22050;\n\nfunction Distortion(context, amount) {\n\n    amount = number(amount, 1);\n\n    var node = context.createWaveShaper();\n    var curve = new Float32Array(n);\n\n    // create waveShaper distortion curve from 0 to 1\n    node.update = function (value) {\n        amount = value;\n        if (amount <= 0) {\n            amount = 0;\n            this.curve = null;\n            return;\n        }\n        var k = value * 100;\n        var deg = Math.PI / 180;\n        var x = void 0;\n\n        for (var i = 0; i < n; i++) {\n            x = i * 2 / n - 1;\n            curve[i] = (3 + k) * x * 20 * deg / (Math.PI + k * Math.abs(x));\n        }\n\n        this.curve = curve;\n    };\n\n    Object.defineProperties(node, {\n        amount: {\n            get: function get() {\n                return amount;\n            },\n            set: function set(value) {\n                this.update(value);\n            }\n        }\n    });\n\n    if (typeof amount !== 'undefined') {\n        node.update(amount);\n    }\n\n    return node;\n}\n\nfunction Echo(context, config) {\n    config = config || {};\n\n    var input = context.createGain();\n    var delay = context.createDelay();\n    var gain = context.createGain();\n    var output = context.createGain();\n\n    delay.delayTime.value = number(config.delayTime, 0.5);\n    gain.gain.value = number(config.feedback, 0.5);\n\n    input.connect(delay);\n    input.connect(output);\n    delay.connect(gain);\n    gain.connect(delay);\n    gain.connect(output);\n\n    var node = input;\n    node.name = 'Echo';\n    node._output = output;\n\n    Object.defineProperties(node, {\n        delay: {\n            get: function get() {\n                return delay.delayTime.value;\n            },\n            set: function set(value) {\n                delay.delayTime.value = value;\n            }\n        },\n        feedback: {\n            get: function get() {\n                return gain.gain.value;\n            },\n            set: function set(value) {\n                gain.gain.value = value;\n            }\n        }\n    });\n\n    return node;\n}\n\nfunction FakeContext() {\n\n    var startTime = Date.now();\n\n    function fn() {}\n\n    function param() {\n        return {\n            value: 1,\n            defaultValue: 1,\n            linearRampToValueAtTime: fn,\n            setValueAtTime: fn,\n            exponentialRampToValueAtTime: fn,\n            setTargetAtTime: fn,\n            setValueCurveAtTime: fn,\n            cancelScheduledValues: fn\n        };\n    }\n\n    function fakeNode() {\n        return {\n            connect: fn,\n            disconnect: fn,\n            // analyser\n            frequencyBinCount: 0,\n            smoothingTimeConstant: 0,\n            fftSize: 0,\n            minDecibels: 0,\n            maxDecibels: 0,\n            getByteTimeDomainData: fn,\n            getByteFrequencyData: fn,\n            getFloatTimeDomainData: fn,\n            getFloatFrequencyData: fn,\n            // gain\n            gain: param(),\n            // panner\n            panningModel: 0,\n            setPosition: fn,\n            setOrientation: fn,\n            setVelocity: fn,\n            distanceModel: 0,\n            refDistance: 0,\n            maxDistance: 0,\n            rolloffFactor: 0,\n            coneInnerAngle: 360,\n            coneOuterAngle: 360,\n            coneOuterGain: 0,\n            // filter:\n            type: 0,\n            frequency: param(),\n            Q: param(),\n            detune: param(),\n            // delay\n            delayTime: param(),\n            // convolver\n            buffer: 0,\n            // compressor\n            threshold: param(),\n            knee: param(),\n            ratio: param(),\n            attack: param(),\n            release: param(),\n            reduction: param(),\n            // distortion\n            oversample: 0,\n            curve: 0,\n            // buffer\n            sampleRate: 1,\n            length: 0,\n            duration: 0,\n            numberOfChannels: 0,\n            getChannelData: function getChannelData() {\n                return [];\n            },\n            copyFromChannel: fn,\n            copyToChannel: fn,\n            // listener\n            dopplerFactor: 0,\n            speedOfSound: 0,\n            // osc\n            start: fn\n        };\n    }\n\n    // ie9\n    if (!window.Uint8Array) {\n        window.Uint8Array = window.Float32Array = Array;\n    }\n\n    return {\n        createAnalyser: fakeNode,\n        createBuffer: fakeNode,\n        createBiquadFilter: fakeNode,\n        createChannelMerger: fakeNode,\n        createChannelSplitter: fakeNode,\n        createDynamicsCompressor: fakeNode,\n        createConvolver: fakeNode,\n        createDelay: fakeNode,\n        createGain: fakeNode,\n        createOscillator: fakeNode,\n        createPanner: fakeNode,\n        createScriptProcessor: fakeNode,\n        createWaveShaper: fakeNode,\n        listener: fakeNode(),\n        get currentTime() {\n            return (Date.now() - startTime) / 1000;\n        }\n    };\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/API/BiquadFilterNode\n// For lowpass and highpass Q indicates how peaked the frequency is around the cutoff.\n// The greater the value is, the greater is the peak\n\nfunction Filter(context) {\n    var config = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n    // Frequency between 40Hz and half of the sampling rate\n    var minFrequency = 40;\n    var maxFrequency = context.sampleRate / 2;\n\n    var node = context.createBiquadFilter();\n    node.type = config.type;\n\n    function getFrequency(value) {\n        // Logarithm (base 2) to compute how many octaves fall in the range.\n        var numberOfOctaves = Math.log(maxFrequency / minFrequency) / Math.LN2;\n        // Compute a multiplier from 0 to 1 based on an exponential scale.\n        var multiplier = Math.pow(2, numberOfOctaves * (value - 1.0));\n        // Get back to the frequency value between min and max.\n        return maxFrequency * multiplier;\n    }\n\n    node.set = function (frequency, q, gain) {\n        if (typeof frequency !== 'undefined' && typeof frequency === 'number') {\n            node.frequency.value = frequency;\n        }\n        if (typeof q !== 'undefined' && typeof q === 'number') {\n            node.Q.value = q;\n        }\n        if (typeof gain !== 'undefined' && typeof gain === 'number') {\n            node.gain.value = gain;\n        }\n        return node;\n    };\n\n    // set filter frequency based on value from 0 to 1\n    node.setByPercent = function (percent, q, gain) {\n        return node.set(getFrequency(percent), q, gain);\n    };\n\n    return node.set(config.frequency, config.q, config.gain);\n}\n\nfunction MonoFlanger(context, config) {\n    var input = context.createGain();\n    var delay = context.createDelay();\n    var feedback = context.createGain();\n    var lfo = context.createOscillator();\n    var gain = context.createGain();\n    var output = context.createGain();\n\n    delay.delayTime.value = number(config.delay, 0.005); // 5-25ms delay (0.005 > 0.025)\n    feedback.gain.value = number(config.feedback, 0.5); // 0 > 1\n\n    lfo.type = 'sine';\n    lfo.frequency.value = number(config.frequency, 0.002); // 0.05 > 5\n    gain.gain.value = number(config.gain, 0.25); // 0.0005 > 0.005\n\n    input.connect(output);\n    input.connect(delay);\n    delay.connect(output);\n    delay.connect(feedback);\n    feedback.connect(input);\n\n    lfo.connect(gain);\n    gain.connect(delay.delayTime);\n    lfo.start(0);\n\n    var node = input;\n    node.name = 'Flanger';\n    node._output = output;\n\n    Object.defineProperties(node, {\n        delay: {\n            get: function get() {\n                return delay.delayTime.value;\n            },\n            set: function set(value) {\n                delay.delayTime.value = value;\n            }\n        },\n        lfoFrequency: {\n            get: function get() {\n                return lfo.frequency.value;\n            },\n            set: function set(value) {\n                lfo.frequency.value = value;\n            }\n        },\n        lfoGain: {\n            get: function get() {\n                return gain.gain.value;\n            },\n            set: function set(value) {\n                gain.gain.value = value;\n            }\n        },\n        feedback: {\n            get: function get() {\n                return feedback.gain.value;\n            },\n            set: function set(value) {\n                feedback.gain.value = value;\n            }\n        }\n    });\n\n    return node;\n}\n\nfunction StereoFlanger(context, config) {\n    var input = context.createGain();\n    var splitter = context.createChannelSplitter(2);\n    var merger = context.createChannelMerger(2);\n    var feedbackL = context.createGain();\n    var feedbackR = context.createGain();\n    var lfo = context.createOscillator();\n    var lfoGainL = context.createGain();\n    var lfoGainR = context.createGain();\n    var delayL = context.createDelay();\n    var delayR = context.createDelay();\n    var output = context.createGain();\n\n    feedbackL.gain.value = feedbackR.gain.value = number(config.feedback, 0.5);\n    delayL.delayTime.value = delayR.delayTime.value = number(config.delay, 0.003);\n\n    lfo.type = 'sine';\n    lfo.frequency.value = number(config.frequency, 0.5);\n    lfoGainL.gain.value = number(config.gain, 0.005);\n    lfoGainR.gain.value = 0 - lfoGainL.gain.value;\n\n    input.connect(splitter);\n\n    splitter.connect(delayL, 0);\n    splitter.connect(delayR, 1);\n\n    delayL.connect(feedbackL);\n    delayR.connect(feedbackR);\n\n    feedbackL.connect(delayR);\n    feedbackR.connect(delayL);\n\n    delayL.connect(merger, 0, 0);\n    delayR.connect(merger, 0, 1);\n\n    merger.connect(output);\n    input.connect(output);\n\n    lfo.connect(lfoGainL);\n    lfo.connect(lfoGainR);\n    lfoGainL.connect(delayL.delayTime);\n    lfoGainR.connect(delayR.delayTime);\n    lfo.start(0);\n\n    var node = input;\n    node.name = 'StereoFlanger';\n    node._output = output;\n\n    Object.defineProperties(node, {\n        delay: {\n            get: function get() {\n                return delayL.delayTime.value;\n            },\n            set: function set(value) {\n                delayL.delayTime.value = delayR.delayTime.value = value;\n            }\n        },\n        lfoFrequency: {\n            get: function get() {\n                return lfo.frequency.value;\n            },\n            set: function set(value) {\n                lfo.frequency.value = value;\n            }\n        },\n        lfoGain: {\n            get: function get() {\n                return lfoGainL.gain.value;\n            },\n            set: function set(value) {\n                lfoGainL.gain.value = lfoGainR.gain.value = value;\n            }\n        },\n        feedback: {\n            get: function get() {\n                return feedbackL.gain.value;\n            },\n            set: function set(value) {\n                feedbackL.gain.value = feedbackR.gain.value = value;\n            }\n        }\n    });\n\n    return node;\n}\n\nfunction Flanger(context, config) {\n    config = config || {};\n    return config.stereo ? new StereoFlanger(context, config) : new MonoFlanger(context, config);\n}\n\nfunction Panner(context) {\n    var node = context.createPanner();\n\n    // Default for stereo is 'HRTF' can also be 'equalpower'\n    node.panningModel = Panner.defaults.panningModel;\n\n    // Distance model and attributes\n    // Can be 'linear' 'inverse' 'exponential'\n    node.distanceModel = Panner.defaults.distanceModel;\n    node.refDistance = Panner.defaults.refDistance;\n    node.maxDistance = Panner.defaults.maxDistance;\n    node.rolloffFactor = Panner.defaults.rolloffFactor;\n    node.coneInnerAngle = Panner.defaults.coneInnerAngle;\n    node.coneOuterAngle = Panner.defaults.coneOuterAngle;\n    node.coneOuterGain = Panner.defaults.coneOuterGain;\n    // set to defaults (needed in Firefox)\n    node.setPosition(0, 0, 1);\n    node.setOrientation(0, 0, 0);\n\n    // simple vec3 object pool\n    var vecPool = {\n        pool: [],\n        get: function get(x, y, z) {\n            var v = this.pool.length ? this.pool.pop() : {\n                x: 0,\n                y: 0,\n                z: 0\n            };\n            // check if a vector has been passed in\n            if (typeof x !== 'undefined' && isNaN(x) && 'x' in x && 'y' in x && 'z' in x) {\n                v.x = number(x.x);\n                v.y = number(x.y);\n                v.z = number(x.z);\n            } else {\n                v.x = number(x);\n                v.y = number(y);\n                v.z = number(z);\n            }\n            return v;\n        },\n        dispose: function dispose(instance) {\n            this.pool.push(instance);\n        }\n    };\n\n    var globalUp = vecPool.get(0, 1, 0),\n        angle45 = Math.PI / 4,\n        angle90 = Math.PI / 2;\n\n    // cross product of 2 vectors\n    function cross(a, b) {\n        var ax = a.x,\n            ay = a.y,\n            az = a.z;\n        var bx = b.x,\n            by = b.y,\n            bz = b.z;\n        a.x = ay * bz - az * by;\n        a.y = az * bx - ax * bz;\n        a.z = ax * by - ay * bx;\n    }\n\n    // normalise to unit vector\n    function normalize(vec3) {\n        if (vec3.x === 0 && vec3.y === 0 && vec3.z === 0) {\n            return vec3;\n        }\n        var length = Math.sqrt(vec3.x * vec3.x + vec3.y * vec3.y + vec3.z * vec3.z);\n        var invScalar = 1 / length;\n        vec3.x *= invScalar;\n        vec3.y *= invScalar;\n        vec3.z *= invScalar;\n        return vec3;\n    }\n\n    // set the orientation of the source (where the audio is coming from)\n    function setOrientation(pannerNode, fw) {\n        // calculate up vec ( up = (forward cross (0, 1, 0)) cross forward )\n        var up = vecPool.get(fw.x, fw.y, fw.z);\n        cross(up, globalUp);\n        cross(up, fw);\n        normalize(up);\n        normalize(fw);\n        // set the audio context's listener position to match the camera position\n        pannerNode.setOrientation(fw.x, fw.y, fw.z, up.x, up.y, up.z);\n        // return the vecs to the pool\n        vecPool.dispose(fw);\n        vecPool.dispose(up);\n    }\n\n    function setPosition(nodeOrListener, vec) {\n        nodeOrListener.setPosition(vec.x, vec.y, vec.z);\n        vecPool.dispose(vec);\n    }\n\n    node.set = function (x, y, z) {\n        var v = vecPool.get(x, y, z);\n\n        if (arguments.length === 1 && v.x) {\n            // pan left to right with value from -1 to 1\n            x = v.x;\n\n            if (x > 1) {\n                x = 1;\n            }\n            if (x < -1) {\n                x = -1;\n            }\n\n            // creates a nice curve with z\n            x = x * angle45;\n            z = x + angle90;\n\n            if (z > angle90) {\n                z = Math.PI - z;\n            }\n\n            v.x = Math.sin(x);\n            v.z = Math.sin(z);\n        }\n        setPosition(node, v);\n    };\n\n    // set the position the audio is coming from)\n    node.setSourcePosition = function (x, y, z) {\n        setPosition(node, vecPool.get(x, y, z));\n    };\n\n    // set the direction the audio is coming from)\n    node.setSourceOrientation = function (x, y, z) {\n        setOrientation(node, vecPool.get(x, y, z));\n    };\n\n    // set the position of who or what is hearing the audio (could be camera or some character)\n    node.setListenerPosition = function (x, y, z) {\n        setPosition(context.listener, vecPool.get(x, y, z));\n    };\n\n    // set the position of who or what is hearing the audio (could be camera or some character)\n    node.setListenerOrientation = function (x, y, z) {\n        setOrientation(context.listener, vecPool.get(x, y, z));\n    };\n\n    node.getDefaults = function () {\n        return Panner.defaults;\n    };\n\n    node.setDefaults = function (defaults) {\n        Object.keys(defaults).forEach(function (key) {\n            Panner.defaults[key] = defaults[key];\n        });\n    };\n\n    return node;\n}\n\nPanner.defaults = {\n    panningModel: 'HRTF',\n    distanceModel: 'linear',\n    refDistance: 1,\n    maxDistance: 1000,\n    rolloffFactor: 1,\n    coneInnerAngle: 360,\n    coneOuterAngle: 0,\n    coneOuterGain: 0\n};\n\nfunction Phaser(context) {\n    var config = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n    var stages = number(config.stages, 8);\n    var filters = [];\n    var filter = void 0;\n\n    var input = context.createGain();\n    var feedback = context.createGain();\n    var lfo = context.createOscillator();\n    var lfoGain = context.createGain();\n    var output = context.createGain();\n\n    feedback.gain.value = number(config.feedback, 0.5);\n\n    lfo.type = 'sine';\n    lfo.frequency.value = number(config.frequency, 0.5);\n    lfoGain.gain.value = number(config.gain, 300);\n\n    for (var i = 0; i < stages; i++) {\n        filter = context.createBiquadFilter();\n        filter.type = 'allpass';\n        filter.frequency.value = 1000 * i;\n        //filter.Q.value = 10;\n        if (i > 0) {\n            filters[i - 1].connect(filter);\n        }\n        lfoGain.connect(filter.frequency);\n\n        filters.push(filter);\n    }\n\n    var first = filters[0];\n    var last = filters[filters.length - 1];\n\n    input.connect(first);\n    input.connect(output);\n    last.connect(output);\n    last.connect(feedback);\n    feedback.connect(first);\n    lfo.connect(lfoGain);\n    lfo.start(0);\n\n    var node = input;\n    node.name = 'Phaser';\n    node._output = output;\n\n    Object.defineProperties(node, {\n        lfoFrequency: {\n            get: function get() {\n                return lfo.frequency.value;\n            },\n            set: function set(value) {\n                lfo.frequency.value = value;\n            }\n        },\n        lfoGain: {\n            get: function get() {\n                return lfoGain.gain.value;\n            },\n            set: function set(value) {\n                lfoGain.gain.value = value;\n            }\n        },\n        feedback: {\n            get: function get() {\n                return feedback.gain.value;\n            },\n            set: function set(value) {\n                feedback.gain.value = value;\n            }\n        }\n    });\n\n    return node;\n}\n\nfunction Recorder(context, passThrough) {\n    var bufferLength = 4096,\n        buffersL = [],\n        buffersR = [];\n    var startedAt = 0,\n        stoppedAt = 0;\n\n    var input = context.createGain();\n    var output = context.createGain();\n    var script = void 0;\n\n    var node = input;\n    node.name = 'Recorder';\n    node._output = output;\n\n    node.isRecording = false;\n\n    function mergeBuffers(buffers, length) {\n        var buffer = new Float32Array(length);\n        var offset = 0;\n        for (var i = 0; i < buffers.length; i++) {\n            buffer.set(buffers[i], offset);\n            offset += buffers[i].length;\n        }\n        return buffer;\n    }\n\n    function getBuffer() {\n        if (!buffersL.length) {\n            return context.createBuffer(2, bufferLength, context.sampleRate);\n        }\n        var recordingLength = buffersL.length * bufferLength;\n        var buffer = context.createBuffer(2, recordingLength, context.sampleRate);\n        buffer.getChannelData(0).set(mergeBuffers(buffersL, recordingLength));\n        buffer.getChannelData(1).set(mergeBuffers(buffersR, recordingLength));\n        return buffer;\n    }\n\n    function destroyScriptProcessor() {\n        if (script) {\n            script.onaudioprocess = null;\n            input.disconnect();\n            script.disconnect();\n        }\n    }\n\n    function createScriptProcessor() {\n        destroyScriptProcessor();\n\n        script = context.createScriptProcessor(bufferLength, 2, 2);\n        input.connect(script);\n        script.connect(context.destination);\n        script.connect(output);\n\n        script.onaudioprocess = function (event) {\n            var inputL = event.inputBuffer.getChannelData(0);\n            var inputR = event.inputBuffer.getChannelData(1);\n\n            if (passThrough) {\n                var outputL = event.outputBuffer.getChannelData(0);\n                var outputR = event.outputBuffer.getChannelData(1);\n                outputL.set(inputL);\n                outputR.set(inputR);\n            }\n\n            if (node.isRecording) {\n                buffersL.push(new Float32Array(inputL));\n                buffersR.push(new Float32Array(inputR));\n            }\n        };\n    }\n\n    node.start = function () {\n        createScriptProcessor();\n        buffersL.length = 0;\n        buffersR.length = 0;\n        startedAt = context.currentTime;\n        stoppedAt = 0;\n        this.isRecording = true;\n    };\n\n    node.stop = function () {\n        stoppedAt = context.currentTime;\n        this.isRecording = false;\n        destroyScriptProcessor();\n        return getBuffer();\n    };\n\n    node.getDuration = function () {\n        if (!this.isRecording) {\n            return stoppedAt - startedAt;\n        }\n        return context.currentTime - startedAt;\n    };\n\n    return node;\n}\n\nfunction Reverb(context) {\n    var config = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n    var rate = context.sampleRate;\n\n    var time = number(config.time, 1);\n    var decay = number(config.decay, 5);\n    var reverse = !!config.reverse;\n    var length = void 0;\n    var impulseResponse = void 0;\n\n    var input = context.createGain();\n    var reverb = context.createConvolver();\n    var output = context.createGain();\n\n    input.connect(reverb);\n    input.connect(output);\n    reverb.connect(output);\n\n    var node = input;\n    node.name = 'Reverb';\n    node._output = output;\n\n    node.update = function (opt) {\n        if (typeof opt.time !== 'undefined') {\n            time = opt.time;\n            length = Math.floor(rate * time);\n            impulseResponse = length ? context.createBuffer(2, length, rate) : null;\n        }\n        if (typeof opt.decay !== 'undefined') {\n            decay = opt.decay;\n        }\n        if (typeof opt.reverse !== 'undefined') {\n            reverse = opt.reverse;\n        }\n\n        if (!impulseResponse) {\n            reverb.buffer = null;\n            return;\n        }\n\n        var left = impulseResponse.getChannelData(0);\n        var right = impulseResponse.getChannelData(1);\n        var n = void 0,\n            e = void 0;\n\n        for (var i = 0; i < length; i++) {\n            n = reverse ? length - i : i;\n            e = Math.pow(1 - n / length, decay);\n            left[i] = (Math.random() * 2 - 1) * e;\n            right[i] = (Math.random() * 2 - 1) * e;\n        }\n\n        reverb.buffer = impulseResponse;\n    };\n\n    node.update({\n        time: time,\n        decay: decay,\n        reverse: reverse\n    });\n\n    Object.defineProperties(node, {\n        time: {\n            get: function get() {\n                return time;\n            },\n            set: function set(value) {\n                if (value === time) {\n                    return;\n                }\n                this.update({\n                    time: value\n                });\n            }\n        },\n        decay: {\n            get: function get() {\n                return decay;\n            },\n            set: function set(value) {\n                if (value === decay) {\n                    return;\n                }\n                this.update({\n                    decay: value\n                });\n            }\n        },\n        reverse: {\n            get: function get() {\n                return reverse;\n            },\n            set: function set(value) {\n                if (value === reverse) {\n                    return;\n                }\n                this.update({\n                    reverse: !!value\n                });\n            }\n        }\n    });\n\n    return node;\n}\n\nfunction Effect(context) {\n    context = context || new FakeContext();\n    var panning = new Panner(context);\n\n    var api = null,\n        destination = void 0,\n        nodeList = [],\n        sourceNode = void 0;\n\n    function connect(a, b) {\n        //console.log('> connect', (a.name || a.constructor.name), 'to', (b.name || b.constructor.name));\n\n        var output = a._output || a;\n        //console.log('> disconnect output: ', (a.name || a.constructor.name));\n        output.disconnect();\n        //console.log('> connect output: ',(a.name || a.constructor.name), 'to input:', (b.name || b.constructor.name));\n        output.connect(b);\n    }\n\n    function connectToDestination(node) {\n        var l = nodeList.length;\n        var lastNode = l ? nodeList[l - 1] : sourceNode;\n\n        if (lastNode) {\n            connect(lastNode, node);\n        }\n\n        destination = node;\n    }\n\n    function updateConnections() {\n        if (!sourceNode) {\n            return;\n        }\n\n        //console.log('updateConnections:', nodeList.length);\n\n        var node = void 0,\n            prev = void 0;\n\n        for (var i = 0; i < nodeList.length; i++) {\n            node = nodeList[i];\n            //console.log(i, node);\n            prev = i === 0 ? sourceNode : nodeList[i - 1];\n            connect(prev, node);\n        }\n\n        if (destination) {\n            connectToDestination(destination);\n        }\n    }\n\n    function has(node) {\n        if (!node) {\n            return false;\n        }\n        return nodeList.indexOf(node) > -1;\n    }\n\n    function add(node) {\n        if (!node) {\n            return null;\n        }\n        if (has(node)) {\n            return node;\n        }\n        nodeList.push(node);\n        updateConnections();\n        return node;\n    }\n\n    function remove(node) {\n        if (!node) {\n            return null;\n        }\n        if (!has(node)) {\n            return node;\n        }\n        var l = nodeList.length;\n        for (var i = 0; i < l; i++) {\n            if (node === nodeList[i]) {\n                nodeList.splice(i, 1);\n                break;\n            }\n        }\n        var output = node._output || node;\n        output.disconnect();\n        updateConnections();\n        return node;\n    }\n\n    function toggle(node, force) {\n        force = !!force;\n        var hasNode = has(node);\n        if (arguments.length > 1 && hasNode === force) {\n            return api;\n        }\n        if (hasNode) {\n            remove(node);\n        } else {\n            add(node);\n        }\n        return api;\n    }\n\n    function removeAll() {\n        while (nodeList.length) {\n            nodeList.pop().disconnect();\n        }\n        updateConnections();\n        return api;\n    }\n\n    function destroy() {\n        removeAll();\n        context = null;\n        destination = null;\n        nodeList = [];\n        if (sourceNode) {\n            sourceNode.disconnect();\n        }\n        sourceNode = null;\n    }\n\n    /*\n     * Effects\n     */\n\n    function analyser(config) {\n        return add(new Analyser(context, config));\n    }\n\n    // lowers the volume of the loudest parts of the signal and raises the volume of the softest parts\n    function compressor(options) {\n        var node = context.createDynamicsCompressor();\n\n        node.update = function (config) {\n            // min decibels to start compressing at from -100 to 0\n            node.threshold.value = typeof config.threshold !== 'undefined' ? config.threshold : -24;\n            // decibel value to start curve to compressed value from 0 to 40\n            node.knee.value = typeof config.knee !== 'undefined' ? config.knee : 30;\n            // amount of change per decibel from 1 to 20\n            node.ratio.value = typeof config.ratio !== 'undefined' ? config.ratio : 12;\n            // gain reduction currently applied by compressor from -20 to 0\n            // node.reduction.value = typeof config.reduction !== 'undefined' ? config.reduction : -10;)\n            // seconds to reduce gain by 10db from 0 to 1 - how quickly signal adapted when volume increased\n            node.attack.value = typeof config.attack !== 'undefined' ? config.attack : 0.0003;\n            // seconds to increase gain by 10db from 0 to 1 - how quickly signal adapted when volume redcuced\n            node.release.value = typeof config.release !== 'undefined' ? config.release : 0.25;\n        };\n\n        node.update(options || {});\n\n        return add(node);\n    }\n\n    function convolver(impulseResponse) {\n        // impulseResponse is an audio file buffer\n        var node = context.createConvolver();\n        node.buffer = impulseResponse;\n        return add(node);\n    }\n\n    function delay(time) {\n        var node = context.createDelay();\n        if (typeof time !== 'undefined') {\n            node.delayTime.value = time;\n        }\n        return add(node);\n    }\n\n    function echo(config) {\n        return add(new Echo(context, config));\n    }\n\n    function distortion(amount) {\n        // Float32Array defining curve (values are interpolated)\n        //node.curve\n        // up-sample before applying curve for better resolution result 'none', '2x' or '4x'\n        //node.oversample = '2x';\n        return add(new Distortion(context, amount));\n    }\n\n    function filter(type, frequency, q, gain) {\n        return add(new Filter(context, { type: type, frequency: frequency, q: q, gain: gain }));\n    }\n\n    function lowpass(frequency, peak) {\n        return filter('lowpass', { frequency: frequency, q: peak });\n    }\n\n    function highpass(frequency, peak) {\n        return filter('highpass', { frequency: frequency, q: peak });\n    }\n\n    function bandpass(frequency, width) {\n        return filter('bandpass', { frequency: frequency, q: width });\n    }\n\n    function lowshelf(frequency, gain) {\n        return filter('lowshelf', { frequency: frequency, q: 0, gain: gain });\n    }\n\n    function highshelf(frequency, gain) {\n        return filter('highshelf', { frequency: frequency, q: 0, gain: gain });\n    }\n\n    function peaking(frequency, width, gain) {\n        return filter('peaking', { frequency: frequency, q: width, gain: gain });\n    }\n\n    function notch(frequency, width, gain) {\n        return filter('notch', { frequency: frequency, q: width, gain: gain });\n    }\n\n    function allpass(frequency, sharpness) {\n        return filter('allpass', { frequency: frequency, q: sharpness });\n    }\n\n    function flanger(config) {\n        return add(new Flanger(context, config));\n    }\n\n    function gainNode(value) {\n        var node = context.createGain();\n        if (typeof value !== 'undefined') {\n            node.gain.value = value;\n        }\n        return node;\n    }\n\n    function panner() {\n        return add(new Panner(context));\n    }\n\n    function phaser(config) {\n        return add(new Phaser(context, config));\n    }\n\n    function recorder(passThrough) {\n        return add(new Recorder(context, passThrough));\n    }\n\n    function reverb(seconds, decay, reverse) {\n        return add(new Reverb(context, seconds, decay, reverse));\n    }\n\n    function script() {\n        var config = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n        // bufferSize 256 - 16384 (pow 2)\n        var bufferSize = config.bufferSize || 1024;\n        var inputChannels = typeof config.inputChannels === 'undefined' ? 0 : config.inputChannels;\n        var outputChannels = typeof config.outputChannels === 'undefined' ? 1 : config.outputChannels;\n\n        var node = context.createScriptProcessor(bufferSize, inputChannels, outputChannels);\n\n        var thisArg = config.thisArg || config.context || node;\n        var callback = config.callback || function () {};\n\n        // available props:\n        /*\n        event.inputBuffer\n        event.outputBuffer\n        event.playbackTime\n        */\n        // Example: generate noise\n        /*\n        const output = event.outputBuffer.getChannelData(0);\n        const l = output.length;\n        for (let i = 0; i < l; i++) {\n            output[i] = Math.random();\n        }\n        */\n        node.onaudioprocess = callback.bind(thisArg);\n\n        return add(node);\n    }\n\n    function setSource(node) {\n        sourceNode = node;\n        updateConnections();\n        return node;\n    }\n\n    function setDestination(node) {\n        connectToDestination(node);\n        return node;\n    }\n\n    //\n\n    api = {\n        context: context,\n        nodeList: nodeList,\n        panning: panning,\n\n        has: has,\n        add: add,\n        remove: remove,\n        toggle: toggle,\n        removeAll: removeAll,\n        destroy: destroy,\n        setSource: setSource,\n        setDestination: setDestination,\n\n        analyser: analyser,\n        compressor: compressor,\n        convolver: convolver,\n        delay: delay,\n        echo: echo,\n        distortion: distortion,\n        filter: filter,\n        lowpass: lowpass,\n        highpass: highpass,\n        bandpass: bandpass,\n        lowshelf: lowshelf,\n        highshelf: highshelf,\n        peaking: peaking,\n        notch: notch,\n        allpass: allpass,\n        flanger: flanger,\n        gain: gainNode,\n        panner: panner,\n        phaser: phaser,\n        recorder: recorder,\n        reverb: reverb,\n        script: script\n    };\n\n    return Object.freeze(api);\n}\n\nfunction Group(context, destination) {\n    var sounds = [];\n    var effect = new Effect(context);\n    var gain = effect.gain();\n    var preMuteVolume = 1;\n    var group = null;\n\n    if (context) {\n        effect.setSource(gain);\n        effect.setDestination(destination || context.destination);\n    }\n\n    /*\n     * Add / remove\n     */\n\n    function find(soundOrId, callback) {\n        var found = void 0;\n\n        if (!soundOrId && soundOrId !== 0) {\n            return found;\n        }\n\n        sounds.some(function (sound) {\n            if (sound === soundOrId || sound.id === soundOrId) {\n                found = sound;\n                return true;\n            }\n            return false;\n        });\n\n        if (found && callback) {\n            return callback(found);\n        }\n\n        return found;\n    }\n\n    function remove(soundOrId) {\n        find(soundOrId, function (sound) {\n            return sounds.splice(sounds.indexOf(sound), 1);\n        });\n        return group;\n    }\n\n    function add(sound) {\n        sound.gain.disconnect();\n        sound.gain.connect(gain);\n\n        sounds.push(sound);\n\n        sound.once('destroy', remove);\n\n        return group;\n    }\n\n    /*\n     * Controls\n     */\n\n    function play(delay, offset) {\n        sounds.forEach(function (sound) {\n            return sound.play(delay, offset);\n        });\n        return group;\n    }\n\n    function pause() {\n        sounds.forEach(function (sound) {\n            if (sound.playing) {\n                sound.pause();\n            }\n        });\n        return group;\n    }\n\n    function resume() {\n        sounds.forEach(function (sound) {\n            if (sound.paused) {\n                sound.play();\n            }\n        });\n        return group;\n    }\n\n    function stop() {\n        sounds.forEach(function (sound) {\n            return sound.stop();\n        });\n        return group;\n    }\n\n    function seek(percent) {\n        sounds.forEach(function (sound) {\n            return sound.seek(percent);\n        });\n        return group;\n    }\n\n    function mute() {\n        preMuteVolume = group.volume;\n        group.volume = 0;\n        return group;\n    }\n\n    function unMute() {\n        group.volume = preMuteVolume || 1;\n        return group;\n    }\n\n    function setVolume(value) {\n        group.volume = value;\n        return group;\n    }\n\n    function fade(volume, duration) {\n        if (context) {\n            var param = gain.gain;\n            var time = context.currentTime;\n\n            param.cancelScheduledValues(time);\n            param.setValueAtTime(param.value, time);\n            // param.setValueAtTime(volume, time + duration);\n            param.linearRampToValueAtTime(volume, time + duration);\n            // param.setTargetAtTime(volume, time, duration);\n            // param.exponentialRampToValueAtTime(Math.max(volume, 0.0001), time + duration);\n        } else {\n            sounds.forEach(function (sound) {\n                return sound.fade(volume, duration);\n            });\n        }\n\n        return group;\n    }\n\n    /*\n     * Load\n     */\n\n    function load() {\n        sounds.forEach(function (sound) {\n            return sound.load(null, true);\n        });\n    }\n\n    /*\n     * Unload\n     */\n\n    function unload() {\n        sounds.forEach(function (sound) {\n            return sound.unload();\n        });\n    }\n\n    /*\n     * Destroy\n     */\n\n    function destroy() {\n        while (sounds.length) {\n            sounds.pop().destroy();\n        }\n    }\n\n    /*\n     * Api\n     */\n\n    group = {\n        add: add,\n        find: find,\n        remove: remove,\n        play: play,\n        pause: pause,\n        resume: resume,\n        stop: stop,\n        seek: seek,\n        setVolume: setVolume,\n        mute: mute,\n        unMute: unMute,\n        fade: fade,\n        load: load,\n        unload: unload,\n        destroy: destroy\n    };\n\n    /*\n     * Getters & Setters\n     */\n\n    Object.defineProperties(group, {\n        effect: {\n            value: effect\n        },\n        gain: {\n            value: gain\n        },\n        sounds: {\n            value: sounds\n        },\n        volume: {\n            get: function get() {\n                return gain.gain.value;\n            },\n            set: function set(value) {\n                if (isNaN(value)) {\n                    return;\n                }\n\n                value = Math.min(Math.max(value, 0), 1);\n\n                if (context) {\n                    gain.gain.cancelScheduledValues(context.currentTime);\n                    gain.gain.value = value;\n                    gain.gain.setValueAtTime(value, context.currentTime);\n                } else {\n                    gain.gain.value = value;\n                }\n                sounds.forEach(function (sound) {\n                    if (!sound.context) {\n                        sound.groupVolume = value;\n                    }\n                });\n            }\n        }\n    });\n\n    return group;\n}\n\nGroup.Effect = Effect;\n\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter$1() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nvar events = EventEmitter$1;\n\n// Backwards-compat with node 0.10.x\nEventEmitter$1.EventEmitter = EventEmitter$1;\n\nEventEmitter$1.prototype._events = undefined;\nEventEmitter$1.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter$1.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter$1.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter$1.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter$1.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter$1.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter$1.prototype.on = EventEmitter$1.prototype.addListener;\n\nEventEmitter$1.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter$1.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter$1.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter$1.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter$1.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter$1.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\nvar EventEmitter = events.EventEmitter;\n\nvar Emitter = function (_EventEmitter) {\n    inherits(Emitter, _EventEmitter);\n\n    function Emitter() {\n        classCallCheck(this, Emitter);\n        return possibleConstructorReturn(this, _EventEmitter.call(this));\n    }\n\n    Emitter.prototype.off = function off(type, listener) {\n        if (listener) {\n            return this.removeListener(type, listener);\n        }\n        if (type) {\n            return this.removeAllListeners(type);\n        }\n        return this.removeAllListeners();\n    };\n\n    return Emitter;\n}(EventEmitter);\n\nfunction Loader(url, deferLoad) {\n    var ERROR_STATE = ['', 'ABORTED', 'NETWORK', 'DECODE', 'SRC_NOT_SUPPORTED'];\n    var emitter = new Emitter();\n    var progress = 0,\n        audioContext = void 0,\n        isTouchLocked = void 0,\n        request = void 0,\n        timeout = void 0,\n        data = void 0;\n\n    // clean up\n\n    function removeListeners() {\n        emitter.off('error');\n        emitter.off('progress');\n        emitter.off('complete');\n        emitter.off('loaded');\n\n        if (data && typeof data.removeEventListener === 'function') {\n            data.removeEventListener('canplaythrough', readyHandler);\n            data.removeEventListener('error', errorHandler);\n        }\n\n        if (request) {\n            request.removeEventListener('progress', progressHandler);\n            request.removeEventListener('load', loadHandler);\n            request.removeEventListener('error', errorHandler);\n        }\n    }\n\n    function dispatchComplete(buffer) {\n        emitter.emit('progress', 1);\n        emitter.emit('loaded', buffer);\n        emitter.emit('complete', buffer);\n\n        removeListeners();\n    }\n\n    function progressHandler(event) {\n        if (event.lengthComputable) {\n            progress = event.loaded / event.total;\n            emitter.emit('progress', progress);\n        }\n    }\n\n    // error\n\n    function errorHandler(event) {\n        window.clearTimeout(timeout);\n\n        var message = event;\n\n        if (data && data.error) {\n            message = 'Media Error: ' + ERROR_STATE[data.error.code] + ' ' + url;\n        }\n\n        if (request) {\n            message = 'XHR Error: ' + request.status + ' ' + request.statusText + ' ' + url;\n        }\n\n        emitter.emit('error', message);\n\n        removeListeners();\n    }\n\n    function decodeArrayBuffer(arraybuffer) {\n        audioContext.decodeAudioData(arraybuffer, function (buffer) {\n            data = buffer;\n            request = null;\n            progress = 1;\n            dispatchComplete(buffer);\n        }, errorHandler);\n    }\n\n    function loadHandler() {\n        decodeArrayBuffer(request.response);\n    }\n\n    function readyHandler() {\n        window.clearTimeout(timeout);\n        if (!data) {\n            return;\n        }\n        progress = 1;\n        dispatchComplete(data);\n    }\n\n    function cancel() {\n        removeListeners();\n\n        if (request && request.readyState !== 4) {\n            request.abort();\n        }\n        request = null;\n\n        window.clearTimeout(timeout);\n    }\n\n    function destroy() {\n        cancel();\n        request = null;\n        data = null;\n        audioContext = null;\n    }\n\n    // audio buffer\n\n    function loadArrayBuffer() {\n        if (url instanceof window.ArrayBuffer) {\n            decodeArrayBuffer(url);\n            return;\n        }\n        request = new XMLHttpRequest();\n        request.open('GET', url, true);\n        request.responseType = 'arraybuffer';\n        request.addEventListener('progress', progressHandler);\n        request.addEventListener('load', loadHandler);\n        request.addEventListener('error', errorHandler);\n        request.send();\n    }\n\n    // audio element\n\n    function loadAudioElement() {\n        if (!data || !data.tagName) {\n            data = document.createElement('audio');\n        }\n\n        if (!isTouchLocked) {\n            // timeout because sometimes canplaythrough doesn't fire\n            window.clearTimeout(timeout);\n            timeout = window.setTimeout(readyHandler, 2000);\n            data.addEventListener('canplaythrough', readyHandler, false);\n        }\n\n        data.addEventListener('error', errorHandler, false);\n        data.preload = 'auto';\n        data.src = url;\n        data.load();\n\n        if (isTouchLocked) {\n            dispatchComplete(data);\n        }\n    }\n\n    function start() {\n        var force = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];\n\n        if (deferLoad && !force) {\n            return;\n        }\n        if (audioContext) {\n            loadArrayBuffer();\n        } else {\n            loadAudioElement();\n        }\n    }\n\n    // reload\n\n    function load(newUrl) {\n        url = newUrl;\n        start();\n    }\n\n    var api = {\n        on: emitter.on.bind(emitter),\n        once: emitter.once.bind(emitter),\n        off: emitter.off.bind(emitter),\n        load: load,\n        start: start,\n        cancel: cancel,\n        destroy: destroy\n    };\n\n    Object.defineProperties(api, {\n        data: {\n            get: function get() {\n                return data;\n            }\n        },\n        progress: {\n            get: function get() {\n                return progress;\n            }\n        },\n        audioContext: {\n            set: function set(value) {\n                audioContext = value;\n            }\n        },\n        isTouchLocked: {\n            set: function set(value) {\n                isTouchLocked = value;\n            }\n        }\n    });\n\n    return Object.freeze(api);\n}\n\nLoader.Group = function () {\n    var emitter = new Emitter();\n    var queue = [];\n    var numLoaded = 0,\n        numTotal = 0,\n        currentLoader = void 0;\n\n    function progressHandler(progress) {\n        var loaded = numLoaded + progress;\n        emitter.emit('progress', loaded / numTotal);\n    }\n\n    function completeHandler() {\n        numLoaded++;\n        removeListeners();\n        emitter.emit('progress', numLoaded / numTotal);\n        next();\n    }\n\n    function errorHandler(e) {\n        console.error(e);\n        removeListeners();\n        emitter.emit('error', e);\n        next();\n    }\n\n    function next() {\n        if (queue.length === 0) {\n            currentLoader = null;\n            emitter.emit('complete');\n            return;\n        }\n\n        currentLoader = queue.pop();\n        currentLoader.on('progress', progressHandler);\n        currentLoader.once('loaded', completeHandler);\n        currentLoader.once('error', errorHandler);\n        currentLoader.start();\n    }\n\n    function removeListeners() {\n        currentLoader.off('progress', progressHandler);\n        currentLoader.off('loaded', completeHandler);\n        currentLoader.off('error', errorHandler);\n    }\n\n    function add(loader) {\n        queue.push(loader);\n        numTotal++;\n        return loader;\n    }\n\n    function start() {\n        numTotal = queue.length;\n        next();\n    }\n\n    return Object.freeze({\n        on: emitter.on.bind(emitter),\n        once: emitter.once.bind(emitter),\n        off: emitter.off.bind(emitter),\n        add: add,\n        start: start\n    });\n};\n\nfunction BufferSource(buffer, context, onEnded) {\n    var api = {};\n    var ended = false,\n        endedCallback = onEnded,\n        loop = false,\n        paused = false,\n        pausedAt = 0,\n        playbackRate = 1,\n        playing = false,\n        sourceNode = null,\n        startedAt = 0;\n\n    function createSourceNode() {\n        if (!sourceNode && context) {\n            sourceNode = context.createBufferSource();\n            sourceNode.buffer = buffer;\n        }\n        return sourceNode;\n    }\n\n    /*\n     * Controls\n     */\n\n    function stop() {\n        if (sourceNode) {\n            sourceNode.onended = null;\n            try {\n                sourceNode.disconnect();\n                sourceNode.stop(0);\n            } catch (e) {}\n            sourceNode = null;\n        }\n\n        paused = false;\n        pausedAt = 0;\n        playing = false;\n        startedAt = 0;\n    }\n\n    function pause() {\n        var elapsed = context.currentTime - startedAt;\n        stop();\n        pausedAt = elapsed;\n        playing = false;\n        paused = true;\n    }\n\n    function endedHandler() {\n        stop();\n        ended = true;\n        if (typeof endedCallback === 'function') {\n            endedCallback(api);\n        }\n    }\n\n    function play(delay) {\n        var offset = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];\n\n        if (playing) {\n            return;\n        }\n\n        delay = delay ? context.currentTime + delay : 0;\n        if (offset) {\n            pausedAt = 0;\n        }\n        if (pausedAt) {\n            offset = pausedAt;\n        }\n        while (offset > api.duration) {\n            offset = offset % api.duration;\n        }\n\n        createSourceNode();\n        sourceNode.onended = endedHandler;\n        sourceNode.start(delay, offset);\n\n        sourceNode.loop = loop;\n        sourceNode.playbackRate.value = playbackRate;\n\n        startedAt = context.currentTime - offset;\n        ended = false;\n        paused = false;\n        pausedAt = 0;\n        playing = true;\n    }\n\n    /*\n     * Destroy\n     */\n\n    function destroy() {\n        stop();\n        buffer = null;\n        context = null;\n        endedCallback = null;\n        sourceNode = null;\n    }\n\n    /*\n     * Getters & Setters\n     */\n\n    Object.defineProperties(api, {\n        play: {\n            value: play\n        },\n        pause: {\n            value: pause\n        },\n        stop: {\n            value: stop\n        },\n        destroy: {\n            value: destroy\n        },\n        currentTime: {\n            get: function get() {\n                if (pausedAt) {\n                    return pausedAt;\n                }\n                if (startedAt) {\n                    var time = context.currentTime - startedAt;\n                    if (time > api.duration) {\n                        time = time % api.duration;\n                    }\n                    return time;\n                }\n                return 0;\n            }\n        },\n        duration: {\n            get: function get() {\n                return buffer ? buffer.duration : 0;\n            }\n        },\n        ended: {\n            get: function get() {\n                return ended;\n            }\n        },\n        loop: {\n            get: function get() {\n                return loop;\n            },\n            set: function set(value) {\n                loop = !!value;\n                if (sourceNode) {\n                    sourceNode.loop = loop;\n                }\n            }\n        },\n        paused: {\n            get: function get() {\n                return paused;\n            }\n        },\n        playbackRate: {\n            get: function get() {\n                return playbackRate;\n            },\n            set: function set(value) {\n                playbackRate = value;\n                if (sourceNode) {\n                    sourceNode.playbackRate.value = playbackRate;\n                }\n            }\n        },\n        playing: {\n            get: function get() {\n                return playing;\n            }\n        },\n        progress: {\n            get: function get() {\n                return api.duration ? api.currentTime / api.duration : 0;\n            }\n        },\n        sourceNode: {\n            get: function get() {\n                return createSourceNode();\n            }\n        }\n    });\n\n    return Object.freeze(api);\n}\n\nfunction MediaSource(el, context, onEnded) {\n    var api = {};\n    var ended = false,\n        endedCallback = onEnded,\n        delayTimeout = void 0,\n        fadeTimeout = void 0,\n        loop = false,\n        paused = false,\n        playbackRate = 1,\n        playing = false,\n        sourceNode = null,\n        groupVolume = 1,\n        volume = 1;\n\n    function createSourceNode() {\n        if (!sourceNode && context) {\n            sourceNode = context.createMediaElementSource(el);\n        }\n        return sourceNode;\n    }\n\n    /*\n     * Load\n     */\n\n    function load(url) {\n        el.src = url;\n        el.load();\n        ended = false;\n        paused = false;\n        playing = false;\n    }\n\n    /*\n     * Controls\n     */\n\n    function readyHandler() {\n        el.removeEventListener('canplaythrough', readyHandler);\n        if (playing) {\n            el.play();\n        }\n    }\n\n    /*\n     * Ended handler\n     */\n\n    function endedHandler() {\n\n        if (loop) {\n            el.currentTime = 0;\n            // fixes bug where server doesn't support seek:\n            if (el.currentTime > 0) {\n                el.load();\n            }\n            el.play();\n\n            return;\n        }\n\n        ended = true;\n        paused = false;\n        playing = false;\n\n        if (typeof endedCallback === 'function') {\n            endedCallback(api);\n        }\n    }\n\n    function play(delay, offset) {\n        clearTimeout(delayTimeout);\n\n        el.volume = volume * groupVolume;\n        el.playbackRate = playbackRate;\n\n        if (offset) {\n            el.currentTime = offset;\n        }\n\n        if (delay) {\n            delayTimeout = setTimeout(play, delay);\n        } else {\n            // el.load();\n            el.play();\n        }\n\n        ended = false;\n        paused = false;\n        playing = true;\n\n        el.removeEventListener('ended', endedHandler);\n        el.addEventListener('ended', endedHandler, false);\n\n        if (el.readyState < 1) {\n            el.removeEventListener('canplaythrough', readyHandler);\n            el.addEventListener('canplaythrough', readyHandler, false);\n            el.load();\n            el.play();\n        }\n    }\n\n    function pause() {\n        clearTimeout(delayTimeout);\n\n        if (!el) {\n            return;\n        }\n\n        el.pause();\n        playing = false;\n        paused = true;\n    }\n\n    function stop() {\n        clearTimeout(delayTimeout);\n\n        if (!el) {\n            return;\n        }\n\n        el.pause();\n\n        try {\n            el.currentTime = 0;\n            // fixes bug where server doesn't support seek:\n            if (el.currentTime > 0) {\n                el.load();\n            }\n        } catch (e) {}\n\n        playing = false;\n        paused = false;\n    }\n\n    /*\n     * Fade for no webaudio\n     */\n\n    function fade(toVolume, duration) {\n        if (context) {\n            return api;\n        }\n\n        function ramp(value, step) {\n            fadeTimeout = window.setTimeout(function () {\n                api.volume = api.volume + (value - api.volume) * 0.2;\n                if (Math.abs(api.volume - value) > 0.05) {\n                    ramp(value, step);\n                    return;\n                }\n                api.volume = value;\n            }, step * 1000);\n        }\n\n        window.clearTimeout(fadeTimeout);\n        ramp(toVolume, duration / 10);\n\n        return api;\n    }\n\n    /*\n     * Destroy\n     */\n\n    function destroy() {\n        el.removeEventListener('ended', endedHandler);\n        el.removeEventListener('canplaythrough', readyHandler);\n        stop();\n        el = null;\n        context = null;\n        endedCallback = null;\n        sourceNode = null;\n    }\n\n    /*\n     * Getters & Setters\n     */\n\n    Object.defineProperties(api, {\n        play: {\n            value: play\n        },\n        pause: {\n            value: pause\n        },\n        stop: {\n            value: stop\n        },\n        load: {\n            value: load\n        },\n        fade: {\n            value: fade\n        },\n        destroy: {\n            value: destroy\n        },\n        currentTime: {\n            get: function get() {\n                return el ? el.currentTime : 0;\n            }\n        },\n        duration: {\n            get: function get() {\n                return el ? el.duration : 0;\n            }\n        },\n        ended: {\n            get: function get() {\n                return ended;\n            }\n        },\n        loop: {\n            get: function get() {\n                return loop;\n            },\n            set: function set(value) {\n                loop = !!value;\n            }\n        },\n        paused: {\n            get: function get() {\n                return paused;\n            }\n        },\n        playbackRate: {\n            get: function get() {\n                return playbackRate;\n            },\n            set: function set(value) {\n                playbackRate = value;\n                if (el) {\n                    el.playbackRate = playbackRate;\n                }\n            }\n        },\n        playing: {\n            get: function get() {\n                return playing;\n            }\n        },\n        progress: {\n            get: function get() {\n                return el && el.duration ? el.currentTime / el.duration : 0;\n            }\n        },\n        sourceNode: {\n            get: function get() {\n                return createSourceNode();\n            }\n        },\n        volume: {\n            get: function get() {\n                return volume;\n            },\n            set: function set(value) {\n                window.clearTimeout(fadeTimeout);\n                volume = value;\n                if (el) {\n                    el.volume = volume * groupVolume;\n                }\n            }\n        },\n        groupVolume: {\n            get: function get() {\n                return groupVolume;\n            },\n            set: function set(value) {\n                groupVolume = value;\n                if (el) {\n                    el.volume = volume * groupVolume;\n                }\n            }\n        }\n    });\n\n    return Object.freeze(api);\n}\n\nfunction MicrophoneSource(stream, context) {\n    var ended = false,\n        paused = false,\n        pausedAt = 0,\n        playing = false,\n        sourceNode = null,\n        // MicrophoneSourceNode\n    startedAt = 0;\n\n    function createSourceNode() {\n        if (!sourceNode && context) {\n            sourceNode = context.createMediaStreamSource(stream);\n            // HACK: stops moz garbage collection killing the stream\n            // see https://support.mozilla.org/en-US/questions/984179\n            if (navigator.mozGetUserMedia) {\n                window.mozHack = sourceNode;\n            }\n        }\n        return sourceNode;\n    }\n\n    /*\n     * Controls\n     */\n\n    function play(delay) {\n        delay = delay ? context.currentTime + delay : 0;\n\n        createSourceNode();\n        sourceNode.start(delay);\n\n        startedAt = context.currentTime - pausedAt;\n        ended = false;\n        playing = true;\n        paused = false;\n        pausedAt = 0;\n    }\n\n    function stop() {\n        if (sourceNode) {\n            try {\n                sourceNode.stop(0);\n            } catch (e) {}\n            sourceNode = null;\n        }\n        ended = true;\n        paused = false;\n        pausedAt = 0;\n        playing = false;\n        startedAt = 0;\n    }\n\n    function pause() {\n        var elapsed = context.currentTime - startedAt;\n        stop();\n        pausedAt = elapsed;\n        playing = false;\n        paused = true;\n    }\n\n    /*\n     * Destroy\n     */\n\n    function destroy() {\n        stop();\n        context = null;\n        sourceNode = null;\n        stream = null;\n        window.mozHack = null;\n    }\n\n    /*\n     * Api\n     */\n\n    var api = {\n        play: play,\n        pause: pause,\n        stop: stop,\n        destroy: destroy,\n\n        duration: 0,\n        progress: 0\n    };\n\n    /*\n     * Getters & Setters\n     */\n\n    Object.defineProperties(api, {\n        currentTime: {\n            get: function get() {\n                if (pausedAt) {\n                    return pausedAt;\n                }\n                if (startedAt) {\n                    return context.currentTime - startedAt;\n                }\n                return 0;\n            }\n        },\n        ended: {\n            get: function get() {\n                return ended;\n            }\n        },\n        paused: {\n            get: function get() {\n                return paused;\n            }\n        },\n        playing: {\n            get: function get() {\n                return playing;\n            }\n        },\n        sourceNode: {\n            get: function get() {\n                return createSourceNode();\n            }\n        }\n    });\n\n    return Object.freeze(api);\n}\n\nfunction OscillatorSource(type, context) {\n    var ended = false,\n        paused = false,\n        pausedAt = 0,\n        playing = false,\n        sourceNode = null,\n        // OscillatorSourceNode\n    startedAt = 0,\n        frequency = 200,\n        api = null;\n\n    function createSourceNode() {\n        if (!sourceNode && context) {\n            sourceNode = context.createOscillator();\n            sourceNode.type = type;\n            sourceNode.frequency.value = frequency;\n        }\n        return sourceNode;\n    }\n\n    /*\n     * Controls\n     */\n\n    function play(delay) {\n        delay = delay || 0;\n        if (delay) {\n            delay = context.currentTime + delay;\n        }\n\n        createSourceNode();\n        sourceNode.start(delay);\n\n        if (pausedAt) {\n            startedAt = context.currentTime - pausedAt;\n        } else {\n            startedAt = context.currentTime;\n        }\n\n        ended = false;\n        playing = true;\n        paused = false;\n        pausedAt = 0;\n    }\n\n    function stop() {\n        if (sourceNode) {\n            try {\n                sourceNode.stop(0);\n            } catch (e) {}\n            sourceNode = null;\n        }\n        ended = true;\n        paused = false;\n        pausedAt = 0;\n        playing = false;\n        startedAt = 0;\n    }\n\n    function pause() {\n        var elapsed = context.currentTime - startedAt;\n        stop();\n        pausedAt = elapsed;\n        playing = false;\n        paused = true;\n    }\n\n    /*\n     * Destroy\n     */\n\n    function destroy() {\n        stop();\n        context = null;\n        sourceNode = null;\n    }\n\n    /*\n     * Api\n     */\n\n    api = {\n        play: play,\n        pause: pause,\n        stop: stop,\n        destroy: destroy\n    };\n\n    /*\n     * Getters & Setters\n     */\n\n    Object.defineProperties(api, {\n        currentTime: {\n            get: function get() {\n                if (pausedAt) {\n                    return pausedAt;\n                }\n                if (startedAt) {\n                    return context.currentTime - startedAt;\n                }\n                return 0;\n            }\n        },\n        duration: {\n            value: 0\n        },\n        ended: {\n            get: function get() {\n                return ended;\n            }\n        },\n        frequency: {\n            get: function get() {\n                return frequency;\n            },\n            set: function set(value) {\n                frequency = value;\n                if (sourceNode) {\n                    sourceNode.frequency.value = value;\n                }\n            }\n        },\n        paused: {\n            get: function get() {\n                return paused;\n            }\n        },\n        playing: {\n            get: function get() {\n                return playing;\n            }\n        },\n        progress: {\n            value: 0\n        },\n        sourceNode: {\n            get: function get() {\n                return createSourceNode();\n            }\n        }\n    });\n\n    return Object.freeze(api);\n}\n\nfunction ScriptSource(data, context) {\n    var bufferSize = data.bufferSize || 1024;\n    var channels = data.channels || 1;\n    var ended = false,\n        onProcess = data.callback.bind(data.thisArg || this),\n        paused = false,\n        pausedAt = 0,\n        playing = false,\n        sourceNode = null,\n        // ScriptSourceNode\n    startedAt = 0,\n        api = null;\n\n    function createSourceNode() {\n        if (!sourceNode && context) {\n            sourceNode = context.createScriptProcessor(bufferSize, 0, channels);\n        }\n        return sourceNode;\n    }\n\n    /*\n     * Controls\n     */\n\n    function play() {\n        createSourceNode();\n        sourceNode.onaudioprocess = onProcess;\n\n        startedAt = context.currentTime - pausedAt;\n        ended = false;\n        paused = false;\n        pausedAt = 0;\n        playing = true;\n    }\n\n    function onPaused(event) {\n        var buffer = event.outputBuffer;\n        for (var i = 0; i < buffer.numberOfChannels; i++) {\n            var channel = buffer.getChannelData(i);\n            for (var j = 0; j < channel.length; j++) {\n                channel[j] = 0;\n            }\n        }\n    }\n\n    function stop() {\n        if (sourceNode) {\n            sourceNode.onaudioprocess = onPaused;\n        }\n        ended = true;\n        paused = false;\n        pausedAt = 0;\n        playing = false;\n        startedAt = 0;\n    }\n\n    function pause() {\n        var elapsed = context.currentTime - startedAt;\n        stop();\n        pausedAt = elapsed;\n        playing = false;\n        paused = true;\n    }\n\n    /*\n     * Destroy\n     */\n\n    function destroy() {\n        stop();\n        context = null;\n        onProcess = null;\n        sourceNode = null;\n    }\n\n    /*\n     * Api\n     */\n\n    api = {\n        play: play,\n        pause: pause,\n        stop: stop,\n        destroy: destroy,\n\n        duration: 0,\n        progress: 0\n    };\n\n    /*\n     * Getters & Setters\n     */\n\n    Object.defineProperties(api, {\n        currentTime: {\n            get: function get() {\n                if (pausedAt) {\n                    return pausedAt;\n                }\n                if (startedAt) {\n                    return context.currentTime - startedAt;\n                }\n                return 0;\n            }\n        },\n        ended: {\n            get: function get() {\n                return ended;\n            }\n        },\n        paused: {\n            get: function get() {\n                return paused;\n            }\n        },\n        playing: {\n            get: function get() {\n                return playing;\n            }\n        },\n        sourceNode: {\n            get: function get() {\n                return createSourceNode();\n            }\n        }\n    });\n\n    return Object.freeze(api);\n}\n\nfunction waveform() {\n    var buffer = void 0,\n        wave = void 0;\n\n    return function (audioBuffer, length) {\n        if (!window.Float32Array || !window.AudioBuffer) {\n            return [];\n        }\n\n        var sameBuffer = buffer === audioBuffer;\n        var sameLength = wave && wave.length === length;\n        if (sameBuffer && sameLength) {\n            return wave;\n        }\n\n        //console.time('waveData');\n        if (!wave || wave.length !== length) {\n            wave = new Float32Array(length);\n        }\n\n        if (!audioBuffer) {\n            return wave;\n        }\n\n        // cache for repeated calls\n        buffer = audioBuffer;\n\n        var chunk = Math.floor(buffer.length / length),\n            resolution = 5,\n            // 10\n        incr = Math.max(Math.floor(chunk / resolution), 1);\n        var greatest = 0;\n\n        for (var i = 0; i < buffer.numberOfChannels; i++) {\n            // check each channel\n            var channel = buffer.getChannelData(i);\n            for (var j = 0; j < length; j++) {\n                // get highest value within the chunk\n                for (var k = j * chunk, l = k + chunk; k < l; k += incr) {\n                    // select highest value from channels\n                    var a = channel[k];\n                    if (a < 0) {\n                        a = -a;\n                    }\n                    if (a > wave[j]) {\n                        wave[j] = a;\n                    }\n                    // update highest overall for scaling\n                    if (a > greatest) {\n                        greatest = a;\n                    }\n                }\n            }\n        }\n        // scale up\n        var scale = 1 / greatest;\n        for (var _i = 0; _i < wave.length; _i++) {\n            wave[_i] *= scale;\n        }\n        //console.timeEnd('waveData');\n\n        return wave;\n    };\n}\n\nfunction Sound(config) {\n    var context = config.context;\n    var destination = config.destination;\n    var effect = new Effect(context);\n    var gain = effect.gain();\n    var wave = waveform();\n\n    var id = null;\n    var data = null;\n    var isTouchLocked = false;\n    var loader = null;\n    var loop = false;\n    var playbackRate = 1;\n    var playWhenReady = null;\n    var source = null;\n    var sound = null;\n\n    if (context) {\n        effect.setDestination(gain);\n        gain.connect(destination || context.destination);\n    }\n\n    /*\n     * Create source\n     */\n\n    function createSource(value) {\n        data = value;\n\n        if (file.isAudioBuffer(data)) {\n            source = new BufferSource(data, context, function () {\n                return sound.emit('ended', sound);\n            });\n        } else if (file.isMediaElement(data)) {\n            source = new MediaSource(data, context, function () {\n                return sound.emit('ended', sound);\n            });\n        } else if (file.isMediaStream(data)) {\n            source = new MicrophoneSource(data, context);\n        } else if (file.isOscillatorType(data && data.type || data)) {\n            source = new OscillatorSource(data.type || data, context);\n        } else if (file.isScriptConfig(data)) {\n            source = new ScriptSource(data, context);\n        } else {\n            throw new Error('Cannot detect data type: ' + data);\n        }\n\n        effect.setSource(source.sourceNode);\n\n        sound.emit('ready', sound);\n\n        if (playWhenReady) {\n            playWhenReady();\n        }\n    }\n\n    /*\n     * Load\n     */\n\n    function onLoad(fileData) {\n        createSource(fileData);\n        sound.emit('loaded', sound);\n    }\n\n    function onLoadError(err) {\n        sound.emit('error', sound, err);\n    }\n\n    function load() {\n        var newConfig = arguments.length <= 0 || arguments[0] === undefined ? null : arguments[0];\n        var force = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];\n\n        var skipLoad = !force && !source && !!config.deferLoad;\n\n        if (newConfig) {\n            var src = file.getSupportedFile(config.src || config.url || config.data || config) || config.src;\n            config = Object.assign(config, newConfig, { src: src });\n        }\n\n        if (source && data && data.tagName) {\n            source.load(config.src);\n        } else {\n            loader = loader || new Loader(config.src, skipLoad);\n            loader.audioContext = !!config.asMediaElement ? null : context;\n            loader.isTouchLocked = isTouchLocked;\n            loader.off('loaded', onLoad);\n            loader.once('loaded', onLoad);\n            loader.off('error', onLoadError);\n            loader.on('error', onLoadError);\n        }\n        return sound;\n    }\n\n    /*\n     * Controls\n     */\n\n    function play(delay, offset) {\n        if (!source || isTouchLocked) {\n            playWhenReady = function playWhenReady() {\n                if (source) {\n                    play(delay, offset);\n                }\n            };\n            if (!!config.deferLoad) {\n                if (!loader) {\n                    load(null, true);\n                }\n                loader.start(true);\n            }\n            return sound;\n        }\n        playWhenReady = null;\n        effect.setSource(source.sourceNode);\n\n        // update volume needed for no webaudio\n        if (!context) {\n            sound.volume = gain.gain.value;\n        }\n\n        source.play(delay, offset);\n\n        if (source.hasOwnProperty('loop')) {\n            source.loop = loop;\n        }\n\n        sound.emit('play', sound);\n\n        return sound;\n    }\n\n    function pause() {\n        source && source.pause();\n        sound.emit('pause', sound);\n        return sound;\n    }\n\n    function stop(delay) {\n        source && source.stop(delay || 0);\n        sound.emit('stop', sound);\n        return sound;\n    }\n\n    function seek(percent) {\n        if (source) {\n            source.stop();\n            play(0, source.duration * percent);\n        }\n        return sound;\n    }\n\n    function fade(volume, duration) {\n        if (!source) {\n            return sound;\n        }\n\n        var param = gain.gain;\n\n        if (context) {\n            var time = context.currentTime;\n            param.cancelScheduledValues(time);\n            param.setValueAtTime(param.value, time);\n            param.linearRampToValueAtTime(volume, time + duration);\n        } else if (typeof source.fade === 'function') {\n            source.fade(volume, duration);\n            param.value = volume;\n        }\n\n        sound.emit('fade', sound, volume);\n\n        return sound;\n    }\n\n    function unload() {\n        source && source.destroy();\n        loader && loader.destroy();\n        data = null;\n        playWhenReady = null;\n        source = null;\n        loader = null;\n        config.deferLoad = true;\n        sound.emit('unload', sound);\n    }\n\n    function reload() {\n        load(null, true);\n    }\n\n    /*\n     * Destroy\n     */\n\n    function destroy() {\n        source && source.destroy();\n        effect && effect.destroy();\n        gain && gain.disconnect();\n        loader && loader.off('loaded');\n        loader && loader.off('error');\n        loader && loader.destroy();\n        sound.off('loaded');\n        sound.off('ended');\n        sound.off('error');\n        gain = null;\n        context = null;\n        destination = null;\n        data = null;\n        playWhenReady = null;\n        source = null;\n        effect = null;\n        loader = null;\n        wave = null;\n        config = null;\n        sound.emit('destroy', sound);\n        sound.off('destroy');\n    }\n\n    sound = Object.create(Emitter.prototype, {\n        _events: {\n            value: {}\n        },\n        constructor: {\n            value: Sound\n        },\n        play: {\n            value: play\n        },\n        pause: {\n            value: pause\n        },\n        load: {\n            value: load\n        },\n        seek: {\n            value: seek\n        },\n        stop: {\n            value: stop\n        },\n        fade: {\n            value: fade\n        },\n        unload: {\n            value: unload\n        },\n        reload: {\n            value: reload\n        },\n        destroy: {\n            value: destroy\n        },\n        context: {\n            value: context\n        },\n        currentTime: {\n            get: function get() {\n                return source ? source.currentTime : 0;\n            },\n            set: function set(value) {\n                // const silent = sound.playing;\n                source && source.stop();\n                // play(0, value, silent);\n                play(0, value);\n            }\n        },\n        data: {\n            get: function get() {\n                return data;\n            },\n            set: function set(value) {\n                if (!value) {\n                    return;\n                }\n                createSource(value);\n            }\n        },\n        duration: {\n            get: function get() {\n                return source ? source.duration : 0;\n            }\n        },\n        effect: {\n            value: effect\n        },\n        ended: {\n            get: function get() {\n                return !!source && source.ended;\n            }\n        },\n        frequency: {\n            get: function get() {\n                return source ? source.frequency : 0;\n            },\n            set: function set(value) {\n                if (source && source.hasOwnProperty('frequency')) {\n                    source.frequency = value;\n                }\n            }\n        },\n        gain: {\n            value: gain\n        },\n        id: {\n            get: function get() {\n                return id;\n            },\n            set: function set(value) {\n                id = value;\n            }\n        },\n        isTouchLocked: {\n            set: function set(value) {\n                isTouchLocked = value;\n                if (loader) {\n                    loader.isTouchLocked = value;\n                }\n                if (!value && playWhenReady) {\n                    playWhenReady();\n                }\n            }\n        },\n        loader: {\n            get: function get() {\n                return loader;\n            }\n        },\n        loop: {\n            get: function get() {\n                return loop;\n            },\n            set: function set(value) {\n                loop = !!value;\n\n                if (source && source.hasOwnProperty('loop') && source.loop !== loop) {\n                    source.loop = loop;\n                }\n            }\n        },\n        config: {\n            get: function get() {\n                return config;\n            }\n        },\n        paused: {\n            get: function get() {\n                return !!source && source.paused;\n            }\n        },\n        playing: {\n            get: function get() {\n                return !!source && source.playing;\n            }\n        },\n        playbackRate: {\n            get: function get() {\n                return playbackRate;\n            },\n            set: function set(value) {\n                playbackRate = value;\n                if (source) {\n                    source.playbackRate = playbackRate;\n                }\n            }\n        },\n        progress: {\n            get: function get() {\n                return source ? source.progress : 0;\n            }\n        },\n        sourceNode: {\n            get: function get() {\n                return source ? source.sourceNode : null;\n            }\n        },\n        volume: {\n            get: function get() {\n                if (context) {\n                    return gain.gain.value;\n                }\n                if (source && source.hasOwnProperty('volume')) {\n                    return source.volume;\n                }\n                return 1;\n            },\n            set: function set(value) {\n                if (isNaN(value)) {\n                    return;\n                }\n\n                value = Math.min(Math.max(value, 0), 1);\n\n                var param = gain.gain;\n\n                if (context) {\n                    var time = context.currentTime;\n                    param.cancelScheduledValues(time);\n                    param.value = value;\n                    param.setValueAtTime(value, time);\n                } else {\n                    param.value = value;\n\n                    if (source && source.hasOwnProperty('volume')) {\n                        source.volume = value;\n                    }\n                }\n            }\n        },\n        // for media element source\n        groupVolume: {\n            get: function get() {\n                return source.groupVolume;\n            },\n            set: function set(value) {\n                if (source && source.hasOwnProperty('groupVolume')) {\n                    source.groupVolume = value;\n                }\n            }\n        },\n        waveform: {\n            value: function value(length) {\n                if (!data) {\n                    sound.once('ready', function () {\n                        return wave(data, length);\n                    });\n                }\n                return wave(data, length);\n            }\n        },\n        userData: {\n            value: {}\n        }\n    });\n\n    return sound;\n}\n\n// expose for unit tests\nSound.__source = {\n    BufferSource: BufferSource,\n    MediaSource: MediaSource,\n    MicrophoneSource: MicrophoneSource,\n    OscillatorSource: OscillatorSource,\n    ScriptSource: ScriptSource\n};\n\nfunction SoundGroup(context, destination) {\n    var group = new Group(context, destination);\n    var sounds = group.sounds;\n    var playbackRate = 1,\n        loop = false,\n        src = void 0;\n\n    function getSource() {\n        if (!sounds.length) {\n            return;\n        }\n\n        src = sounds.slice(0).sort(function (a, b) {\n            return b.duration - a.duration;\n        })[0];\n    }\n\n    var add = group.add;\n    group.add = function (sound) {\n        add(sound);\n        getSource();\n        return group;\n    };\n\n    var remove = group.rmeove;\n    group.remove = function (soundOrId) {\n        remove(soundOrId);\n        getSource();\n        return group;\n    };\n\n    Object.defineProperties(group, {\n        currentTime: {\n            get: function get() {\n                return src ? src.currentTime : 0;\n            },\n            set: function set(value) {\n                this.stop();\n                this.play(0, value);\n            }\n        },\n        duration: {\n            get: function get() {\n                return src ? src.duration : 0;\n            }\n        },\n        // ended: {\n        //     get: function() {\n        //         return src ? src.ended : false;\n        //     }\n        // },\n        loop: {\n            get: function get() {\n                return loop;\n            },\n            set: function set(value) {\n                loop = !!value;\n                sounds.forEach(function (sound) {\n                    sound.loop = loop;\n                });\n            }\n        },\n        paused: {\n            get: function get() {\n                // return src ? src.paused : false;\n                return !!src && src.paused;\n            }\n        },\n        progress: {\n            get: function get() {\n                return src ? src.progress : 0;\n            }\n        },\n        playbackRate: {\n            get: function get() {\n                return playbackRate;\n            },\n            set: function set(value) {\n                playbackRate = value;\n                sounds.forEach(function (sound) {\n                    sound.playbackRate = playbackRate;\n                });\n            }\n        },\n        playing: {\n            get: function get() {\n                // return src ? src.playing : false;\n                return !!src && src.playing;\n            }\n        }\n    });\n\n    return group;\n}\n\nfunction Microphone(connected, denied, error) {\n    navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;\n    error = error || function () {};\n\n    var isSupported = !!navigator.getUserMedia;\n    var api = {};\n    var stream = null;\n\n    function connect() {\n        if (!isSupported) {\n            return api;\n        }\n\n        navigator.getUserMedia({\n            audio: true\n        }, function (micStream) {\n            stream = micStream;\n            connected(stream);\n        }, function (e) {\n            if (denied && e.name === 'PermissionDeniedError' || e === 'PERMISSION_DENIED') {\n                // console.log('Permission denied. Reset by clicking the camera icon with the red cross.');\n                denied();\n            } else {\n                error(e.message || e);\n            }\n        });\n        return api;\n    }\n\n    function disconnect() {\n        if (stream) {\n            stream.stop();\n            stream = null;\n        }\n        return api;\n    }\n\n    Object.defineProperties(api, {\n        connect: {\n            value: connect\n        },\n        disconnect: {\n            value: disconnect\n        },\n        isSupported: {\n            value: isSupported\n        },\n        stream: {\n            get: function get() {\n                return stream;\n            }\n        }\n    });\n\n    return Object.freeze(api);\n}\n\nvar halfPI = Math.PI / 2;\nvar twoPI = Math.PI * 2;\n\nfunction waveformer(config) {\n\n    var style = config.style || 'fill',\n        // 'fill' or 'line'\n    shape = config.shape || 'linear',\n        // 'circular' or 'linear'\n    color = config.color || 0,\n        bgColor = config.bgColor,\n        lineWidth = config.lineWidth || 1,\n        percent = config.percent || 1,\n        originX = config.x || 0,\n        originY = config.y || 0,\n        transform = config.transform;\n\n    var canvas = config.canvas,\n        width = config.width || canvas && canvas.width,\n        height = config.height || canvas && canvas.height;\n\n    var ctx = null,\n        currentColor = void 0,\n        i = void 0,\n        x = void 0,\n        y = void 0,\n        radius = void 0,\n        innerRadius = void 0,\n        centerX = void 0,\n        centerY = void 0;\n\n    if (!canvas && !config.context) {\n        canvas = document.createElement('canvas');\n        width = width || canvas.width;\n        height = height || canvas.height;\n        canvas.width = height;\n        canvas.height = height;\n    }\n\n    if (shape === 'circular') {\n        radius = config.radius || Math.min(height / 2, width / 2);\n        innerRadius = config.innerRadius || radius / 2;\n        centerX = originX + width / 2;\n        centerY = originY + height / 2;\n    }\n\n    ctx = config.context || canvas.getContext('2d');\n\n    function clear() {\n        if (bgColor) {\n            ctx.fillStyle = bgColor;\n            ctx.fillRect(originX, originY, width, height);\n        } else {\n            ctx.clearRect(originX, originY, width, height);\n        }\n\n        ctx.lineWidth = lineWidth;\n\n        currentColor = null;\n\n        if (typeof color !== 'function') {\n            ctx.strokeStyle = color;\n            ctx.beginPath();\n        }\n    }\n\n    function updateColor(position, length, value) {\n        if (typeof color === 'function') {\n            var newColor = color(position, length, value);\n            if (newColor !== currentColor) {\n                currentColor = newColor;\n                ctx.stroke();\n                ctx.strokeStyle = currentColor;\n                ctx.beginPath();\n            }\n        }\n    }\n\n    function getValue(value, position, length) {\n        if (typeof transform === 'function') {\n            return transform(value, position, length);\n        }\n        return value;\n    }\n\n    function getWaveform(value, length) {\n        if (value && typeof value.waveform === 'function') {\n            return value.waveform(length);\n        }\n        if (value) {\n            return value;\n        }\n        if (config.waveform) {\n            return config.waveform;\n        }\n        if (config.sound) {\n            return config.sound.waveform(length);\n        }\n        return null;\n    }\n\n    function update(wave) {\n\n        clear();\n\n        if (shape === 'circular') {\n            var waveform = getWaveform(wave, 360);\n            var length = Math.floor(waveform.length * percent);\n\n            var step = twoPI / length;\n            var angle = void 0,\n                magnitude = void 0,\n                sine = void 0,\n                cosine = void 0;\n\n            for (i = 0; i < length; i++) {\n                var value = getValue(waveform[i], i, length);\n                updateColor(i, length, value);\n\n                angle = i * step - halfPI;\n                cosine = Math.cos(angle);\n                sine = Math.sin(angle);\n\n                if (style === 'fill') {\n                    x = centerX + innerRadius * cosine;\n                    y = centerY + innerRadius * sine;\n                    ctx.moveTo(x, y);\n                }\n\n                magnitude = innerRadius + (radius - innerRadius) * value;\n                x = centerX + magnitude * cosine;\n                y = centerY + magnitude * sine;\n\n                if (style === 'line' && i === 0) {\n                    ctx.moveTo(x, y);\n                }\n\n                ctx.lineTo(x, y);\n            }\n\n            if (style === 'line') {\n                ctx.closePath();\n            }\n        } else {\n\n            var _waveform = getWaveform(wave, width);\n            var _length = Math.min(_waveform.length, width - lineWidth / 2);\n            _length = Math.floor(_length * percent);\n\n            for (i = 0; i < _length; i++) {\n                var _value = getValue(_waveform[i], i, _length);\n                updateColor(i, _length, _value);\n\n                if (style === 'line' && i > 0) {\n                    ctx.lineTo(x, y);\n                }\n\n                x = originX + i;\n                y = originY + height - Math.round(height * _value);\n                y = Math.floor(Math.min(y, originY + height - lineWidth / 2));\n\n                if (style === 'fill') {\n                    ctx.moveTo(x, y);\n                    ctx.lineTo(x, originY + height);\n                } else {\n                    ctx.lineTo(x, y);\n                }\n            }\n        }\n        ctx.stroke();\n    }\n\n    update.canvas = canvas;\n\n    if (config.waveform || config.sound) {\n        update();\n    }\n\n    return update;\n}\n\n/*\n * audio ctx\n */\nvar ctx = void 0;\nvar offlineCtx = void 0;\n\nfunction getContext() {\n\tif (ctx) {\n\t\treturn ctx;\n\t}\n\n\tvar desiredSampleRate = 44100;\n\n\tvar Ctx = window.AudioContext || window.webkitAudioContext;\n\n\tctx = Ctx ? new Ctx() : null;\n\n\t// Check if hack is necessary. Only occurs in iOS6+ devices\n\t// and only when you first boot the iPhone, or play a audio/video\n\t// with a different sample rate\n\t// https://github.com/Jam3/ios-safe-audio-context/blob/master/index.js\n\tif (/(iPhone|iPad)/i.test(navigator.userAgent) && ctx.sampleRate !== desiredSampleRate) {\n\t\tvar buffer = ctx.createBuffer(1, 1, desiredSampleRate);\n\t\tvar dummy = ctx.createBufferSource();\n\t\tdummy.buffer = buffer;\n\t\tdummy.connect(ctx.destination);\n\t\tdummy.start(0);\n\t\tdummy.disconnect();\n\n\t\tctx.close(); // dispose old context\n\t\tctx = Ctx ? new Ctx() : null;\n\t}\n\n\t// Handles bug in Safari 9 OSX where AudioContext instance starts in 'suspended' state\n\n\tvar isSuspended = ctx && ctx.state === 'suspended';\n\n\tif (isSuspended && typeof ctx.resume === 'function') {\n\t\twindow.setTimeout(function () {\n\t\t\tctx.resume();\n\t\t}, 1000);\n\t}\n\n\treturn ctx;\n}\n\n/*\nIn contrast with a standard AudioContext, an OfflineAudioContext doesn't render\nthe audio to the device hardware;\ninstead, it generates it, as fast as it can, and outputs the result to an AudioBuffer.\n*/\nfunction getOfflineContext(numOfChannels, length, sampleRate) {\n\tif (offlineCtx) {\n\t\treturn offlineCtx;\n\t}\n\tnumOfChannels = numOfChannels || 2;\n\tsampleRate = sampleRate || 44100;\n\tlength = sampleRate || numOfChannels;\n\n\tvar OfflineCtx = window.OfflineAudioContext || window.webkitOfflineAudioContext;\n\n\tofflineCtx = OfflineCtx ? new OfflineCtx(numOfChannels, length, sampleRate) : null;\n\n\treturn offlineCtx;\n}\n\n/*\n * clone audio buffer\n */\n\nfunction cloneBuffer(buffer) {\n\tif (!ctx) {\n\t\treturn buffer;\n\t}\n\n\tvar numChannels = buffer.numberOfChannels,\n\t    cloned = ctx.createBuffer(numChannels, buffer.length, buffer.sampleRate);\n\tfor (var i = 0; i < numChannels; i++) {\n\t\tcloned.getChannelData(i).set(buffer.getChannelData(i));\n\t}\n\treturn cloned;\n}\n\n/*\n * reverse audio buffer\n */\n\nfunction reverseBuffer(buffer) {\n\tvar numChannels = buffer.numberOfChannels;\n\tfor (var i = 0; i < numChannels; i++) {\n\t\tArray.prototype.reverse.call(buffer.getChannelData(i));\n\t}\n\treturn buffer;\n}\n\n/*\n * ramp audio param\n */\n\nfunction ramp(param, fromValue, toValue, duration, linear) {\n\tif (!ctx) {\n\t\treturn;\n\t}\n\n\tparam.setValueAtTime(fromValue, ctx.currentTime);\n\n\tif (linear) {\n\t\tparam.linearRampToValueAtTime(toValue, ctx.currentTime + duration);\n\t} else {\n\t\tparam.exponentialRampToValueAtTime(toValue, ctx.currentTime + duration);\n\t}\n}\n\n/*\n * get frequency from min to max by passing 0 to 1\n */\n\nfunction getFrequency(value) {\n\tif (!ctx) {\n\t\treturn 0;\n\t}\n\t// get frequency by passing number from 0 to 1\n\t// Clamp the frequency between the minimum value (40 Hz) and half of the\n\t// sampling rate.\n\tvar minValue = 40;\n\tvar maxValue = ctx.sampleRate / 2;\n\t// Logarithm (base 2) to compute how many octaves fall in the range.\n\tvar numberOfOctaves = Math.log(maxValue / minValue) / Math.LN2;\n\t// Compute a multiplier from 0 to 1 based on an exponential scale.\n\tvar multiplier = Math.pow(2, numberOfOctaves * (value - 1.0));\n\t// Get back to the frequency value between min and max.\n\treturn maxValue * multiplier;\n}\n\n/*\n * microphone util\n */\n\nfunction microphone(connected, denied, error) {\n\treturn new Microphone(connected, denied, error);\n}\n\n/*\n * Format seconds as timecode string\n */\n\nfunction timeCode(seconds) {\n\tvar delim = arguments.length <= 1 || arguments[1] === undefined ? ':' : arguments[1];\n\n\t// const h = Math.floor(seconds / 3600);\n\t// const m = Math.floor((seconds % 3600) / 60);\n\tvar m = Math.floor(seconds / 60);\n\tvar s = Math.floor(seconds % 3600 % 60);\n\t// const hr = (h < 10 ? '0' + h + delim : h + delim);\n\tvar mn = (m < 10 ? '0' + m : m) + delim;\n\tvar sc = s < 10 ? '0' + s : s;\n\t// return hr + mn + sc;\n\treturn mn + sc;\n}\n\nvar utils = Object.freeze({\n\tgetContext: getContext,\n\tgetOfflineContext: getOfflineContext,\n\tcloneBuffer: cloneBuffer,\n\treverseBuffer: reverseBuffer,\n\tramp: ramp,\n\tgetFrequency: getFrequency,\n\tmicrophone: microphone,\n\ttimeCode: timeCode,\n\twaveformer: waveformer\n});\n\nfunction Sono() {\n    var VERSION = '0.1.85';\n    var context = utils.getContext();\n    var destination = context ? context.destination : null;\n    var group = new Group(context, destination);\n\n    var api = null;\n    var isTouchLocked = false;\n\n    /*\n     * Get Sound by id\n     */\n\n    function getSound(id) {\n        return group.find(id);\n    }\n\n    /*\n     * Create group\n     */\n\n    function createGroup(sounds) {\n        var soundGroup = new SoundGroup(context, group.gain);\n        if (sounds) {\n            sounds.forEach(function (sound) {\n                return soundGroup.add(sound);\n            });\n        }\n        return soundGroup;\n    }\n\n    /*\n     * Loading\n     */\n\n    function add(config) {\n        var soundContext = config && config.webAudio === false ? null : context;\n        // const sound = new Sound(soundContext, group.gain);\n        var src = file.getSupportedFile(config.src || config.url || config.data || config);\n        var sound = new Sound(Object.assign({}, config || {}, {\n            src: src,\n            context: soundContext,\n            destination: group.gain\n        }));\n        sound.isTouchLocked = isTouchLocked;\n        if (config) {\n            sound.id = config.id || config.name || '';\n            sound.loop = !!config.loop;\n            sound.volume = config.volume;\n        }\n        group.add(sound);\n        return sound;\n    }\n\n    function queue(config, loaderGroup) {\n        var sound = add(config).load();\n\n        if (loaderGroup) {\n            loaderGroup.add(sound.loader);\n        }\n        return sound;\n    }\n\n    function load(config) {\n        var src = config.src || config.url || config.data || config;\n        var sound = void 0,\n            loader = void 0;\n\n        if (file.containsURL(src)) {\n            sound = queue(config);\n            loader = sound.loader;\n        } else if (Array.isArray(src) && file.containsURL(src[0].src || src[0].url)) {\n            sound = [];\n            loader = new Loader.Group();\n            src.forEach(function (url) {\n                return sound.push(queue(url, loader));\n            });\n        } else {\n            var errorMessage = 'sono.load: No audio file URLs found in config.';\n            if (config.onError) {\n                config.onError('[ERROR] ' + errorMessage);\n            } else {\n                throw new Error(errorMessage);\n            }\n            return null;\n        }\n        if (config.onProgress) {\n            loader.on('progress', function (progress) {\n                return config.onProgress(progress);\n            });\n        }\n        if (config.onComplete) {\n            loader.once('complete', function () {\n                loader.off('progress');\n                config.onComplete(sound);\n            });\n        }\n        loader.once('error', function (err) {\n            loader.off('error');\n            if (config.onError) {\n                config.onError(err);\n            } else {\n                console.error('[ERROR] sono.load: ' + err);\n            }\n        });\n        loader.start();\n\n        return sound;\n    }\n\n    /*\n     * Create Sound\n     *\n     * Accepted values for param config:\n     * Object config e.g. { id:'foo', url:['foo.ogg', 'foo.mp3'] }\n     * Array (of files e.g. ['foo.ogg', 'foo.mp3'])\n     * ArrayBuffer\n     * HTMLMediaElement\n     * Filename string (e.g. 'foo.ogg')\n     * Oscillator type string (i.e. 'sine', 'square', 'sawtooth', 'triangle')\n     * ScriptProcessor config object (e.g. { bufferSize: 1024, channels: 1, callback: fn })\n     */\n\n    function createSound(config) {\n        // try to load if config contains URLs\n        if (file.containsURL(config)) {\n            return load(config);\n        }\n\n        var sound = add(config);\n        sound.data = config.data || config;\n\n        return sound;\n    }\n\n    /*\n     * Destroy\n     */\n\n    function destroySound(soundOrId) {\n        group.find(soundOrId, function (sound) {\n            return sound.destroy();\n        });\n        return api;\n    }\n\n    function destroyAll() {\n        group.destroy();\n        return api;\n    }\n\n    /*\n     * Controls\n     */\n\n    function mute() {\n        group.mute();\n        return api;\n    }\n\n    function unMute() {\n        group.unMute();\n        return api;\n    }\n\n    function fade(volume, duration) {\n        group.fade(volume, duration);\n        return api;\n    }\n\n    function pauseAll() {\n        group.pause();\n        return api;\n    }\n\n    function resumeAll() {\n        group.resume();\n        return api;\n    }\n\n    function stopAll() {\n        group.stop();\n        return api;\n    }\n\n    function play(id, delay, offset) {\n        group.find(id, function (sound) {\n            return sound.play(delay, offset);\n        });\n        return api;\n    }\n\n    function pause(id) {\n        group.find(id, function (sound) {\n            return sound.pause();\n        });\n        return api;\n    }\n\n    function stop(id) {\n        group.find(id, function (sound) {\n            return sound.stop();\n        });\n        return api;\n    }\n\n    /*\n     * Mobile touch lock\n     */\n\n    isTouchLocked = browser.handleTouchLock(context, function () {\n        isTouchLocked = false;\n        group.sounds.forEach(function (sound) {\n            return sound.isTouchLocked = false;\n        });\n    });\n\n    /*\n     * Page visibility events\n     */\n\n    (function () {\n        var pageHiddenPaused = [];\n\n        // pause currently playing sounds and store refs\n        function onHidden() {\n            group.sounds.forEach(function (sound) {\n                if (sound.playing) {\n                    sound.pause();\n                    pageHiddenPaused.push(sound);\n                }\n            });\n        }\n\n        // play sounds that got paused when page was hidden\n        function onShown() {\n            while (pageHiddenPaused.length) {\n                pageHiddenPaused.pop().play();\n            }\n        }\n\n        browser.handlePageVisibility(onHidden, onShown);\n    })();\n\n    /*\n     * Log version & device support info\n     */\n\n    function log() {\n        var title = 'sono ' + VERSION,\n            info = 'Supported:' + api.isSupported + ' WebAudioAPI:' + api.hasWebAudio + ' TouchLocked:' + isTouchLocked + ' State:' + (context && context.state) + ' Extensions:' + file.extensions;\n\n        if (navigator.userAgent.indexOf('Chrome') > -1) {\n            var args = ['%c ♫ ' + title + ' ♫ %c ' + info + ' ', 'color: #FFFFFF; background: #379F7A', 'color: #1F1C0D; background: #E0FBAC'];\n            console.log.apply(console, args);\n        } else if (window.console && window.console.log.call) {\n            console.log.call(console, title + ' ' + info);\n        }\n    }\n\n    api = {\n        createSound: createSound,\n        create: createSound,\n        destroySound: destroySound,\n        destroyAll: destroyAll,\n        getSound: getSound,\n        createGroup: createGroup,\n        file: file,\n        load: load,\n        mute: mute,\n        unMute: unMute,\n        fade: fade,\n        pauseAll: pauseAll,\n        resumeAll: resumeAll,\n        stopAll: stopAll,\n        play: play,\n        pause: pause,\n        stop: stop,\n        log: log,\n\n        canPlay: file.canPlay,\n        context: context,\n        getOfflineContext: utils.getOfflineContext,\n        effect: group.effect,\n        extensions: file.extensions,\n        hasWebAudio: !!context,\n        isSupported: file.extensions.length > 0,\n        gain: group.gain,\n        utils: utils,\n        VERSION: VERSION,\n\n        Sound: Sound,\n        Group: Group\n    };\n\n    /*\n     * Getters & Setters\n     */\n\n    Object.defineProperties(api, {\n        isTouchLocked: {\n            get: function get() {\n                return isTouchLocked;\n            }\n        },\n        sounds: {\n            get: function get() {\n                return group.sounds.slice(0);\n            }\n        },\n        volume: {\n            get: function get() {\n                return group.volume;\n            },\n            set: function set(value) {\n                group.volume = value;\n            }\n        }\n    });\n\n    return Object.freeze(api);\n}\n\nvar sono = new Sono();\n\nreturn sono;\n\n})));\n//# sourceMappingURL=sono.js.map\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJkZXYvamF2YXNjcmlwdHMvYXBwLmpzIiwiZGV2L2phdmFzY3JpcHRzL3ZlbmRvcnMvbW9kZXJuaXpyLmpzIiwiZGV2L2phdmFzY3JpcHRzL3hwL3hwLmpzIiwibm9kZV9tb2R1bGVzL3Nvbm8vZGlzdC9zb25vLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7O0FBRUE7QUFDQTtBQUNBOztBQUNBOztBQU9BOzs7Ozs7QUFOQTs7QUFFQTtBQUNBO0FBQ0EsUUFBUSxHQUFSLENBQVksNENBQVosRUFBMEQsK0JBQTFEOzs7Ozs7OztBQ1ZBOzs7Ozs7Ozs7Ozs7Ozs7O0FBZ0JBOzs7Ozs7OztBQVFBLENBQUMsQ0FBQyxVQUFTLE1BQVQsRUFBaUIsUUFBakIsRUFBMkIsU0FBM0IsRUFBcUM7QUFDckMsTUFBSSxVQUFVLEVBQWQ7O0FBR0EsTUFBSSxRQUFRLEVBQVo7O0FBR0E7Ozs7Ozs7O0FBUUEsTUFBSSxpQkFBaUI7QUFDbkI7QUFDQSxjQUFVLE9BRlM7O0FBSW5CO0FBQ0E7QUFDQSxhQUFTO0FBQ1AscUJBQWUsRUFEUjtBQUVQLHVCQUFpQixJQUZWO0FBR1AsdUJBQWlCLElBSFY7QUFJUCxxQkFBZTtBQUpSLEtBTlU7O0FBYW5CO0FBQ0EsUUFBSSxFQWRlOztBQWdCbkI7QUFDQSxRQUFJLFlBQVMsSUFBVCxFQUFlLEVBQWYsRUFBbUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBSSxPQUFPLElBQVg7QUFDQSxpQkFBVyxZQUFXO0FBQ3BCLFdBQUcsS0FBSyxJQUFMLENBQUg7QUFDRCxPQUZELEVBRUcsQ0FGSDtBQUdELEtBNUJrQjs7QUE4Qm5CLGFBQVMsaUJBQVMsSUFBVCxFQUFlLEVBQWYsRUFBbUIsT0FBbkIsRUFBNEI7QUFDbkMsWUFBTSxJQUFOLENBQVcsRUFBQyxNQUFNLElBQVAsRUFBYSxJQUFJLEVBQWpCLEVBQXFCLFNBQVMsT0FB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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIndXNlIHN0cmljdCc7XG5cbi8vIERlZmF1bHQgQmFiZWwgUG9seWZpbGwsIGJlIGNhcmVmdWwsIGJlIHN1cmUgeW91IG5lZWQgaXRcbi8vIGJlY2F1c2UgaXQncyB+NjAwMCBsaW5lcyBvZiBjb2RlIHVubWluaWZpZWRcbi8vIGltcG9ydCAnYmFiZWwtcG9seWZpbGwnO1xuaW1wb3J0ICdtb2Rlcm5penInO1xuLy8gaW1wb3J0ICogYXMgdG9vbHMgZnJvbSAnQDg0cGFyaXMvODQudG9vbHMnO1xuXG4vLyBZb3VyIGltcG9ydHNcbi8vIGltcG9ydCBNeUNvbXBvbmVudCBmcm9tICcuL2NvbXBvbmVudC5lczYnXG5jb25zb2xlLmxvZygnJWMgODQuQm9pbGVycGxhdGUgPT09PT0gWW91ciBhcHAgaXMgcmVhZHkuJywgJ2JhY2tncm91bmQ6ICMwMDA7IGNvbG9yOiAjRkZGJyk7XG5cbmltcG9ydCBYcCBmcm9tICcuL3hwL3hwJztcblxuIiwiLyohXG4gKiBtb2Rlcm5penIgdjMuMy4xXG4gKiBCdWlsZCBodHRwOi8vbW9kZXJuaXpyLmNvbS9kb3dubG9hZD8tY3NzYW5pbWF0aW9ucy1jc3NjYWxjLWNzc2dyYWRpZW50cy1jc3N0cmFuc2Zvcm1zM2QtaGlzdG9yeS13ZWJnbC1zZXRjbGFzc2VzLXNoaXYtZG9udG1pblxuICpcbiAqIENvcHlyaWdodCAoYylcbiAqICBGYXJ1ayBBdGVzXG4gKiAgUGF1bCBJcmlzaFxuICogIEFsZXggU2V4dG9uXG4gKiAgUnlhbiBTZWRkb25cbiAqICBQYXRyaWNrIEtldHRuZXJcbiAqICBTdHUgQ294XG4gKiAgUmljaGFyZCBIZXJyZXJhXG5cbiAqIE1JVCBMaWNlbnNlXG4gKi9cblxuLypcbiAqIE1vZGVybml6ciB0ZXN0cyB3aGljaCBuYXRpdmUgQ1NTMyBhbmQgSFRNTDUgZmVhdHVyZXMgYXJlIGF2YWlsYWJsZSBpbiB0aGVcbiAqIGN1cnJlbnQgVUEgYW5kIG1ha2VzIHRoZSByZXN1bHRzIGF2YWlsYWJsZSB0byB5b3UgaW4gdHdvIHdheXM6IGFzIHByb3BlcnRpZXMgb25cbiAqIGEgZ2xvYmFsIGBNb2Rlcm5penJgIG9iamVjdCwgYW5kIGFzIGNsYXNzZXMgb24gdGhlIGA8aHRtbD5gIGVsZW1lbnQuIFRoaXNcbiAqIGluZm9ybWF0aW9uIGFsbG93cyB5b3UgdG8gcHJvZ3Jlc3NpdmVseSBlbmhhbmNlIHlvdXIgcGFnZXMgd2l0aCBhIGdyYW51bGFyIGxldmVsXG4gKiBvZiBjb250cm9sIG92ZXIgdGhlIGV4cGVyaWVuY2UuXG4qL1xuXG47KGZ1bmN0aW9uKHdpbmRvdywgZG9jdW1lbnQsIHVuZGVmaW5lZCl7XG4gIHZhciBjbGFzc2VzID0gW107XG5cblxuICB2YXIgdGVzdHMgPSBbXTtcblxuXG4gIC8qKlxuICAgKlxuICAgKiBNb2Rlcm5penJQcm90byBpcyB0aGUgY29uc3RydWN0b3IgZm9yIE1vZGVybml6clxuICAgKlxuICAgKiBAY2xhc3NcbiAgICogQGFjY2VzcyBwdWJsaWNcbiAgICovXG5cbiAgdmFyIE1vZGVybml6clByb3RvID0ge1xuICAgIC8vIFRoZSBjdXJyZW50IHZlcnNpb24sIGR1bW15XG4gICAgX3ZlcnNpb246ICczLjMuMScsXG5cbiAgICAvLyBBbnkgc2V0dGluZ3MgdGhhdCBkb24ndCB3b3JrIGFzIHNlcGFyYXRlIG1vZHVsZXNcbiAgICAvLyBjYW4gZ28gaW4gaGVyZSBhcyBjb25maWd1cmF0aW9uLlxuICAgIF9jb25maWc6IHtcbiAgICAgICdjbGFzc1ByZWZpeCc6ICcnLFxuICAgICAgJ2VuYWJsZUNsYXNzZXMnOiB0cnVlLFxuICAgICAgJ2VuYWJsZUpTQ2xhc3MnOiB0cnVlLFxuICAgICAgJ3VzZVByZWZpeGVzJzogdHJ1ZVxuICAgIH0sXG5cbiAgICAvLyBRdWV1ZSBvZiB0ZXN0c1xuICAgIF9xOiBbXSxcblxuICAgIC8vIFN0dWIgdGhlc2UgZm9yIHBlb3BsZSB3aG8gYXJlIGxpc3RlbmluZ1xuICAgIG9uOiBmdW5jdGlvbih0ZXN0LCBjYikge1xuICAgICAgLy8gSSBkb24ndCByZWFsbHkgdGhpbmsgcGVvcGxlIHNob3VsZCBkbyB0aGlzLCBidXQgd2UgY2FuXG4gICAgICAvLyBzYWZlIGd1YXJkIGl0IGEgYml0LlxuICAgICAgLy8gLS0gTk9URTo6IHRoaXMgZ2V0cyBXQVkgb3ZlcnJpZGRlbiBpbiBzcmMvYWRkVGVzdCBmb3IgYWN0dWFsIGFzeW5jIHRlc3RzLlxuICAgICAgLy8gVGhpcyBpcyBpbiBjYXNlIHBlb3BsZSBsaXN0ZW4gdG8gc3luY2hyb25vdXMgdGVzdHMuIEkgd291bGQgbGVhdmUgaXQgb3V0LFxuICAgICAgLy8gYnV0IHRoZSBjb2RlIHRvICpkaXNhbGxvdyogc3luYyB0ZXN0cyBpbiB0aGUgcmVhbCB2ZXJzaW9uIG9mIHRoaXNcbiAgICAgIC8vIGZ1bmN0aW9uIGlzIGFjdHVhbGx5IGxhcmdlciB0aGFuIHRoaXMuXG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICBjYihzZWxmW3Rlc3RdKTtcbiAgICAgIH0sIDApO1xuICAgIH0sXG5cbiAgICBhZGRUZXN0OiBmdW5jdGlvbihuYW1lLCBmbiwgb3B0aW9ucykge1xuICAgICAgdGVzdHMucHVzaCh7bmFtZTogbmFtZSwgZm46IGZuLCBvcHRpb25zOiBvcHRpb25zfSk7XG4gICAgfSxcblxuICAgIGFkZEFzeW5jVGVzdDogZnVuY3Rpb24oZm4pIHtcbiAgICAgIHRlc3RzLnB1c2goe25hbWU6IG51bGwsIGZuOiBmbn0pO1xuICAgIH1cbiAgfTtcblxuXG5cbiAgLy8gRmFrZSBzb21lIG9mIE9iamVjdC5jcmVhdGUgc28gd2UgY2FuIGZvcmNlIG5vbiB0ZXN0IHJlc3VsdHMgdG8gYmUgbm9uIFwib3duXCIgcHJvcGVydGllcy5cbiAgdmFyIE1vZGVybml6ciA9IGZ1bmN0aW9uKCkge307XG4gIE1vZGVybml6ci5wcm90b3R5cGUgPSBNb2Rlcm5penJQcm90bztcblxuICAvLyBMZWFrIG1vZGVybml6ciBnbG9iYWxseSB3aGVuIHlvdSBgcmVxdWlyZWAgaXQgcmF0aGVyIHRoYW4gZm9yY2UgaXQgaGVyZS5cbiAgLy8gT3ZlcndyaXRlIG5hbWUgc28gY29uc3RydWN0b3IgbmFtZSBpcyBuaWNlciA6RFxuICBNb2Rlcm5penIgPSBuZXcgTW9kZXJuaXpyKCk7XG5cblxuLyohXG57XG4gIFwibmFtZVwiOiBcIkhpc3RvcnkgQVBJXCIsXG4gIFwicHJvcGVydHlcIjogXCJoaXN0b3J5XCIsXG4gIFwiY2FuaXVzZVwiOiBcImhpc3RvcnlcIixcbiAgXCJ0YWdzXCI6IFtcImhpc3RvcnlcIl0sXG4gIFwiYXV0aG9yc1wiOiBbXCJIYXkgS3JhbmVuXCIsIFwiQWxleGFuZGVyIEZhcmthc1wiXSxcbiAgXCJub3Rlc1wiOiBbe1xuICAgIFwibmFtZVwiOiBcIlczQyBTcGVjXCIsXG4gICAgXCJocmVmXCI6IFwiaHR0cHM6Ly93d3cudzMub3JnL1RSL2h0bWw1MS9icm93c2Vycy5odG1sI3RoZS1oaXN0b3J5LWludGVyZmFjZVwiXG4gIH0sIHtcbiAgICBcIm5hbWVcIjogXCJNRE4gZG9jdW1lbnRhdGlvblwiLFxuICAgIFwiaHJlZlwiOiBcImh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS93aW5kb3cuaGlzdG9yeVwiXG4gIH1dLFxuICBcInBvbHlmaWxsc1wiOiBbXCJoaXN0b3J5anNcIiwgXCJodG1sNWhpc3RvcnlhcGlcIl1cbn1cbiEqL1xuLyogRE9DXG5EZXRlY3RzIHN1cHBvcnQgZm9yIHRoZSBIaXN0b3J5IEFQSSBmb3IgbWFuaXB1bGF0aW5nIHRoZSBicm93c2VyIHNlc3Npb24gaGlzdG9yeS5cbiovXG5cbiAgTW9kZXJuaXpyLmFkZFRlc3QoJ2hpc3RvcnknLCBmdW5jdGlvbigpIHtcbiAgICAvLyBJc3N1ZSAjNzMzXG4gICAgLy8gVGhlIHN0b2NrIGJyb3dzZXIgb24gQW5kcm9pZCAyLjIgJiAyLjMsIGFuZCA0LjAueCByZXR1cm5zIHBvc2l0aXZlIG9uIGhpc3Rvcnkgc3VwcG9ydFxuICAgIC8vIFVuZm9ydHVuYXRlbHkgc3VwcG9ydCBpcyByZWFsbHkgYnVnZ3kgYW5kIHRoZXJlIGlzIG5vIGNsZWFuIHdheSB0byBkZXRlY3RcbiAgICAvLyB0aGVzZSBidWdzLCBzbyB3ZSBmYWxsIGJhY2sgdG8gYSB1c2VyIGFnZW50IHNuaWZmIDooXG4gICAgdmFyIHVhID0gbmF2aWdhdG9yLnVzZXJBZ2VudDtcblxuICAgIC8vIFdlIG9ubHkgd2FudCBBbmRyb2lkIDIgYW5kIDQuMCwgc3RvY2sgYnJvd3NlciwgYW5kIG5vdCBDaHJvbWUgd2hpY2ggaWRlbnRpZmllc1xuICAgIC8vIGl0c2VsZiBhcyAnTW9iaWxlIFNhZmFyaScgYXMgd2VsbCwgbm9yIFdpbmRvd3MgUGhvbmUgKGlzc3VlICMxNDcxKS5cbiAgICBpZiAoKHVhLmluZGV4T2YoJ0FuZHJvaWQgMi4nKSAhPT0gLTEgfHxcbiAgICAgICAgKHVhLmluZGV4T2YoJ0FuZHJvaWQgNC4wJykgIT09IC0xKSkgJiZcbiAgICAgICAgdWEuaW5kZXhPZignTW9iaWxlIFNhZmFyaScpICE9PSAtMSAmJlxuICAgICAgICB1YS5pbmRleE9mKCdDaHJvbWUnKSA9PT0gLTEgJiZcbiAgICAgICAgdWEuaW5kZXhPZignV2luZG93cyBQaG9uZScpID09PSAtMSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIFJldHVybiB0aGUgcmVndWxhciBjaGVja1xuICAgIHJldHVybiAod2luZG93Lmhpc3RvcnkgJiYgJ3B1c2hTdGF0ZScgaW4gd2luZG93Lmhpc3RvcnkpO1xuICB9KTtcblxuXG4gIC8qKlxuICAgKiBpcyByZXR1cm5zIGEgYm9vbGVhbiBpZiB0aGUgdHlwZW9mIGFuIG9iaiBpcyBleGFjdGx5IHR5cGUuXG4gICAqXG4gICAqIEBhY2Nlc3MgcHJpdmF0ZVxuICAgKiBAZnVuY3Rpb24gaXNcbiAgICogQHBhcmFtIHsqfSBvYmogLSBBIHRoaW5nIHdlIHdhbnQgdG8gY2hlY2sgdGhlIHR5cGUgb2ZcbiAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgLSBBIHN0cmluZyB0byBjb21wYXJlIHRoZSB0eXBlb2YgYWdhaW5zdFxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICovXG5cbiAgZnVuY3Rpb24gaXMob2JqLCB0eXBlKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBvYmogPT09IHR5cGU7XG4gIH1cbiAgO1xuXG4gIC8qKlxuICAgKiBSdW4gdGhyb3VnaCBhbGwgdGVzdHMgYW5kIGRldGVjdCB0aGVpciBzdXBwb3J0IGluIHRoZSBjdXJyZW50IFVBLlxuICAgKlxuICAgKiBAYWNjZXNzIHByaXZhdGVcbiAgICovXG5cbiAgZnVuY3Rpb24gdGVzdFJ1bm5lcigpIHtcbiAgICB2YXIgZmVhdHVyZU5hbWVzO1xuICAgIHZhciBmZWF0dXJlO1xuICAgIHZhciBhbGlhc0lkeDtcbiAgICB2YXIgcmVzdWx0O1xuICAgIHZhciBuYW1lSWR4O1xuICAgIHZhciBmZWF0dXJlTmFtZTtcbiAgICB2YXIgZmVhdHVyZU5hbWVTcGxpdDtcblxuICAgIGZvciAodmFyIGZlYXR1cmVJZHggaW4gdGVzdHMpIHtcbiAgICAgIGlmICh0ZXN0cy5oYXNPd25Qcm9wZXJ0eShmZWF0dXJlSWR4KSkge1xuICAgICAgICBmZWF0dXJlTmFtZXMgPSBbXTtcbiAgICAgICAgZmVhdHVyZSA9IHRlc3RzW2ZlYXR1cmVJZHhdO1xuICAgICAgICAvLyBydW4gdGhlIHRlc3QsIHRocm93IHRoZSByZXR1cm4gdmFsdWUgaW50byB0aGUgTW9kZXJuaXpyLFxuICAgICAgICAvLyB0aGVuIGJhc2VkIG9uIHRoYXQgYm9vbGVhbiwgZGVmaW5lIGFuIGFwcHJvcHJpYXRlIGNsYXNzTmFtZVxuICAgICAgICAvLyBhbmQgcHVzaCBpdCBpbnRvIGFuIGFycmF5IG9mIGNsYXNzZXMgd2UnbGwgam9pbiBsYXRlci5cbiAgICAgICAgLy9cbiAgICAgICAgLy8gSWYgdGhlcmUgaXMgbm8gbmFtZSwgaXQncyBhbiAnYXN5bmMnIHRlc3QgdGhhdCBpcyBydW4sXG4gICAgICAgIC8vIGJ1dCBub3QgZGlyZWN0bHkgYWRkZWQgdG8gdGhlIG9iamVjdC4gVGhhdCBzaG91bGRcbiAgICAgICAgLy8gYmUgZG9uZSB3aXRoIGEgcG9zdC1ydW4gYWRkVGVzdCBjYWxsLlxuICAgICAgICBpZiAoZmVhdHVyZS5uYW1lKSB7XG4gICAgICAgICAgZmVhdHVyZU5hbWVzLnB1c2goZmVhdHVyZS5uYW1lLnRvTG93ZXJDYXNlKCkpO1xuXG4gICAgICAgICAgaWYgKGZlYXR1cmUub3B0aW9ucyAmJiBmZWF0dXJlLm9wdGlvbnMuYWxpYXNlcyAmJiBmZWF0dXJlLm9wdGlvbnMuYWxpYXNlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIC8vIEFkZCBhbGwgdGhlIGFsaWFzZXMgaW50byB0aGUgbmFtZXMgbGlzdFxuICAgICAgICAgICAgZm9yIChhbGlhc0lkeCA9IDA7IGFsaWFzSWR4IDwgZmVhdHVyZS5vcHRpb25zLmFsaWFzZXMubGVuZ3RoOyBhbGlhc0lkeCsrKSB7XG4gICAgICAgICAgICAgIGZlYXR1cmVOYW1lcy5wdXNoKGZlYXR1cmUub3B0aW9ucy5hbGlhc2VzW2FsaWFzSWR4XS50b0xvd2VyQ2FzZSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSdW4gdGhlIHRlc3QsIG9yIHVzZSB0aGUgcmF3IHZhbHVlIGlmIGl0J3Mgbm90IGEgZnVuY3Rpb25cbiAgICAgICAgcmVzdWx0ID0gaXMoZmVhdHVyZS5mbiwgJ2Z1bmN0aW9uJykgPyBmZWF0dXJlLmZuKCkgOiBmZWF0dXJlLmZuO1xuXG5cbiAgICAgICAgLy8gU2V0IGVhY2ggb2YgdGhlIG5hbWVzIG9uIHRoZSBNb2Rlcm5penIgb2JqZWN0XG4gICAgICAgIGZvciAobmFtZUlkeCA9IDA7IG5hbWVJZHggPCBmZWF0dXJlTmFtZXMubGVuZ3RoOyBuYW1lSWR4KyspIHtcbiAgICAgICAgICBmZWF0dXJlTmFtZSA9IGZlYXR1cmVOYW1lc1tuYW1lSWR4XTtcbiAgICAgICAgICAvLyBTdXBwb3J0IGRvdCBwcm9wZXJ0aWVzIGFzIHN1YiB0ZXN0cy4gV2UgZG9uJ3QgZG8gY2hlY2tpbmcgdG8gbWFrZSBzdXJlXG4gICAgICAgICAgLy8gdGhhdCB0aGUgaW1wbGllZCBwYXJlbnQgdGVzdHMgaGF2ZSBiZWVuIGFkZGVkLiBZb3UgbXVzdCBjYWxsIHRoZW0gaW5cbiAgICAgICAgICAvLyBvcmRlciAoZWl0aGVyIGluIHRoZSB0ZXN0LCBvciBtYWtlIHRoZSBwYXJlbnQgdGVzdCBhIGRlcGVuZGVuY3kpLlxuICAgICAgICAgIC8vXG4gICAgICAgICAgLy8gQ2FwIGl0IHRvIFRXTyB0byBtYWtlIHRoZSBsb2dpYyBzaW1wbGUgYW5kIGJlY2F1c2Ugd2hvIG5lZWRzIHRoYXQga2luZCBvZiBzdWJ0ZXN0aW5nXG4gICAgICAgICAgLy8gaGFzaHRhZyBmYW1vdXMgbGFzdCB3b3Jkc1xuICAgICAgICAgIGZlYXR1cmVOYW1lU3BsaXQgPSBmZWF0dXJlTmFtZS5zcGxpdCgnLicpO1xuXG4gICAgICAgICAgaWYgKGZlYXR1cmVOYW1lU3BsaXQubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICBNb2Rlcm5penJbZmVhdHVyZU5hbWVTcGxpdFswXV0gPSByZXN1bHQ7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGNhc3QgdG8gYSBCb29sZWFuLCBpZiBub3Qgb25lIGFscmVhZHlcbiAgICAgICAgICAgIC8qIGpzaGludCAtVzA1MyAqL1xuICAgICAgICAgICAgaWYgKE1vZGVybml6cltmZWF0dXJlTmFtZVNwbGl0WzBdXSAmJiAhKE1vZGVybml6cltmZWF0dXJlTmFtZVNwbGl0WzBdXSBpbnN0YW5jZW9mIEJvb2xlYW4pKSB7XG4gICAgICAgICAgICAgIE1vZGVybml6cltmZWF0dXJlTmFtZVNwbGl0WzBdXSA9IG5ldyBCb29sZWFuKE1vZGVybml6cltmZWF0dXJlTmFtZVNwbGl0WzBdXSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIE1vZGVybml6cltmZWF0dXJlTmFtZVNwbGl0WzBdXVtmZWF0dXJlTmFtZVNwbGl0WzFdXSA9IHJlc3VsdDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjbGFzc2VzLnB1c2goKHJlc3VsdCA/ICcnIDogJ25vLScpICsgZmVhdHVyZU5hbWVTcGxpdC5qb2luKCctJykpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIDtcblxuICAvKipcbiAgICogZG9jRWxlbWVudCBpcyBhIGNvbnZlbmllbmNlIHdyYXBwZXIgdG8gZ3JhYiB0aGUgcm9vdCBlbGVtZW50IG9mIHRoZSBkb2N1bWVudFxuICAgKlxuICAgKiBAYWNjZXNzIHByaXZhdGVcbiAgICogQHJldHVybnMge0hUTUxFbGVtZW50fFNWR0VsZW1lbnR9IFRoZSByb290IGVsZW1lbnQgb2YgdGhlIGRvY3VtZW50XG4gICAqL1xuXG4gIHZhciBkb2NFbGVtZW50ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xuXG5cbiAgLyoqXG4gICAqIEEgY29udmVuaWVuY2UgaGVscGVyIHRvIGNoZWNrIGlmIHRoZSBkb2N1bWVudCB3ZSBhcmUgcnVubmluZyBpbiBpcyBhbiBTVkcgZG9jdW1lbnRcbiAgICpcbiAgICogQGFjY2VzcyBwcml2YXRlXG4gICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgKi9cblxuICB2YXIgaXNTVkcgPSBkb2NFbGVtZW50Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdzdmcnO1xuXG5cbiAgLyoqXG4gICAqIHNldENsYXNzZXMgdGFrZXMgYW4gYXJyYXkgb2YgY2xhc3MgbmFtZXMgYW5kIGFkZHMgdGhlbSB0byB0aGUgcm9vdCBlbGVtZW50XG4gICAqXG4gICAqIEBhY2Nlc3MgcHJpdmF0ZVxuICAgKiBAZnVuY3Rpb24gc2V0Q2xhc3Nlc1xuICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBjbGFzc2VzIC0gQXJyYXkgb2YgY2xhc3MgbmFtZXNcbiAgICovXG5cbiAgLy8gUGFzcyBpbiBhbiBhbmQgYXJyYXkgb2YgY2xhc3MgbmFtZXMsIGUuZy46XG4gIC8vICBbJ25vLXdlYnAnLCAnYm9yZGVycmFkaXVzJywgLi4uXVxuICBmdW5jdGlvbiBzZXRDbGFzc2VzKGNsYXNzZXMpIHtcbiAgICB2YXIgY2xhc3NOYW1lID0gZG9jRWxlbWVudC5jbGFzc05hbWU7XG4gICAgdmFyIGNsYXNzUHJlZml4ID0gTW9kZXJuaXpyLl9jb25maWcuY2xhc3NQcmVmaXggfHwgJyc7XG5cbiAgICBpZiAoaXNTVkcpIHtcbiAgICAgIGNsYXNzTmFtZSA9IGNsYXNzTmFtZS5iYXNlVmFsO1xuICAgIH1cblxuICAgIC8vIENoYW5nZSBgbm8tanNgIHRvIGBqc2AgKGluZGVwZW5kZW50bHkgb2YgdGhlIGBlbmFibGVDbGFzc2VzYCBvcHRpb24pXG4gICAgLy8gSGFuZGxlIGNsYXNzUHJlZml4IG9uIHRoaXMgdG9vXG4gICAgaWYgKE1vZGVybml6ci5fY29uZmlnLmVuYWJsZUpTQ2xhc3MpIHtcbiAgICAgIHZhciByZUpTID0gbmV3IFJlZ0V4cCgnKF58XFxcXHMpJyArIGNsYXNzUHJlZml4ICsgJ25vLWpzKFxcXFxzfCQpJyk7XG4gICAgICBjbGFzc05hbWUgPSBjbGFzc05hbWUucmVwbGFjZShyZUpTLCAnJDEnICsgY2xhc3NQcmVmaXggKyAnanMkMicpO1xuICAgIH1cblxuICAgIGlmIChNb2Rlcm5penIuX2NvbmZpZy5lbmFibGVDbGFzc2VzKSB7XG4gICAgICAvLyBBZGQgdGhlIG5ldyBjbGFzc2VzXG4gICAgICBjbGFzc05hbWUgKz0gJyAnICsgY2xhc3NQcmVmaXggKyBjbGFzc2VzLmpvaW4oJyAnICsgY2xhc3NQcmVmaXgpO1xuICAgICAgaXNTVkcgPyBkb2NFbGVtZW50LmNsYXNzTmFtZS5iYXNlVmFsID0gY2xhc3NOYW1lIDogZG9jRWxlbWVudC5jbGFzc05hbWUgPSBjbGFzc05hbWU7XG4gICAgfVxuXG4gIH1cblxuICA7XG5cbi8qKlxuICAqIEBvcHRpb25OYW1lIGh0bWw1c2hpdlxuICAqIEBvcHRpb25Qcm9wIGh0bWw1c2hpdlxuICAqL1xuXG4gIC8vIFRha2UgdGhlIGh0bWw1IHZhcmlhYmxlIG91dCBvZiB0aGUgaHRtbDVzaGl2IHNjb3BlIHNvIHdlIGNhbiByZXR1cm4gaXQuXG4gIHZhciBodG1sNTtcbiAgaWYgKCFpc1NWRykge1xuICAgIC8qKlxuICAgICAqIEBwcmVzZXJ2ZSBIVE1MNSBTaGl2IDMuNy4zIHwgQGFmYXJrYXMgQGpkYWx0b24gQGpvbl9uZWFsIEByZW0gfCBNSVQvR1BMMiBMaWNlbnNlZFxuICAgICAqL1xuICAgIDsoZnVuY3Rpb24od2luZG93LCBkb2N1bWVudCkge1xuICAgICAgLypqc2hpbnQgZXZpbDp0cnVlICovXG4gICAgICAvKiogdmVyc2lvbiAqL1xuICAgICAgdmFyIHZlcnNpb24gPSAnMy43LjMnO1xuXG4gICAgICAvKiogUHJlc2V0IG9wdGlvbnMgKi9cbiAgICAgIHZhciBvcHRpb25zID0gd2luZG93Lmh0bWw1IHx8IHt9O1xuXG4gICAgICAvKiogVXNlZCB0byBza2lwIHByb2JsZW0gZWxlbWVudHMgKi9cbiAgICAgIHZhciByZVNraXAgPSAvXjx8Xig/OmJ1dHRvbnxtYXB8c2VsZWN0fHRleHRhcmVhfG9iamVjdHxpZnJhbWV8b3B0aW9ufG9wdGdyb3VwKSQvaTtcblxuICAgICAgLyoqIE5vdCBhbGwgZWxlbWVudHMgY2FuIGJlIGNsb25lZCBpbiBJRSAqKi9cbiAgICAgIHZhciBzYXZlQ2xvbmVzID0gL14oPzphfGJ8Y29kZXxkaXZ8ZmllbGRzZXR8aDF8aDJ8aDN8aDR8aDV8aDZ8aXxsYWJlbHxsaXxvbHxwfHF8c3BhbnxzdHJvbmd8c3R5bGV8dGFibGV8dGJvZHl8dGR8dGh8dHJ8dWwpJC9pO1xuXG4gICAgICAvKiogRGV0ZWN0IHdoZXRoZXIgdGhlIGJyb3dzZXIgc3VwcG9ydHMgZGVmYXVsdCBodG1sNSBzdHlsZXMgKi9cbiAgICAgIHZhciBzdXBwb3J0c0h0bWw1U3R5bGVzO1xuXG4gICAgICAvKiogTmFtZSBvZiB0aGUgZXhwYW5kbywgdG8gd29yayB3aXRoIG11bHRpcGxlIGRvY3VtZW50cyBvciB0byByZS1zaGl2IG9uZSBkb2N1bWVudCAqL1xuICAgICAgdmFyIGV4cGFuZG8gPSAnX2h0bWw1c2hpdic7XG5cbiAgICAgIC8qKiBUaGUgaWQgZm9yIHRoZSB0aGUgZG9jdW1lbnRzIGV4cGFuZG8gKi9cbiAgICAgIHZhciBleHBhbklEID0gMDtcblxuICAgICAgLyoqIENhY2hlZCBkYXRhIGZvciBlYWNoIGRvY3VtZW50ICovXG4gICAgICB2YXIgZXhwYW5kb0RhdGEgPSB7fTtcblxuICAgICAgLyoqIERldGVjdCB3aGV0aGVyIHRoZSBicm93c2VyIHN1cHBvcnRzIHVua25vd24gZWxlbWVudHMgKi9cbiAgICAgIHZhciBzdXBwb3J0c1Vua25vd25FbGVtZW50cztcblxuICAgICAgKGZ1bmN0aW9uKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHZhciBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgICAgICAgIGEuaW5uZXJIVE1MID0gJzx4eXo+PC94eXo+JztcbiAgICAgICAgICAvL2lmIHRoZSBoaWRkZW4gcHJvcGVydHkgaXMgaW1wbGVtZW50ZWQgd2UgY2FuIGFzc3VtZSwgdGhhdCB0aGUgYnJvd3NlciBzdXBwb3J0cyBiYXNpYyBIVE1MNSBTdHlsZXNcbiAgICAgICAgICBzdXBwb3J0c0h0bWw1U3R5bGVzID0gKCdoaWRkZW4nIGluIGEpO1xuXG4gICAgICAgICAgc3VwcG9ydHNVbmtub3duRWxlbWVudHMgPSBhLmNoaWxkTm9kZXMubGVuZ3RoID09IDEgfHwgKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy8gYXNzaWduIGEgZmFsc2UgcG9zaXRpdmUgaWYgdW5hYmxlIHRvIHNoaXZcbiAgICAgICAgICAgIChkb2N1bWVudC5jcmVhdGVFbGVtZW50KSgnYScpO1xuICAgICAgICAgICAgdmFyIGZyYWcgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICB0eXBlb2YgZnJhZy5jbG9uZU5vZGUgPT0gJ3VuZGVmaW5lZCcgfHxcbiAgICAgICAgICAgICAgICB0eXBlb2YgZnJhZy5jcmVhdGVEb2N1bWVudEZyYWdtZW50ID09ICd1bmRlZmluZWQnIHx8XG4gICAgICAgICAgICAgICAgdHlwZW9mIGZyYWcuY3JlYXRlRWxlbWVudCA9PSAndW5kZWZpbmVkJ1xuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9KCkpO1xuICAgICAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgICAvLyBhc3NpZ24gYSBmYWxzZSBwb3NpdGl2ZSBpZiBkZXRlY3Rpb24gZmFpbHMgPT4gdW5hYmxlIHRvIHNoaXZcbiAgICAgICAgICBzdXBwb3J0c0h0bWw1U3R5bGVzID0gdHJ1ZTtcbiAgICAgICAgICBzdXBwb3J0c1Vua25vd25FbGVtZW50cyA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgfSgpKTtcblxuICAgICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgICAgIC8qKlxuICAgICAgICogQ3JlYXRlcyBhIHN0eWxlIHNoZWV0IHdpdGggdGhlIGdpdmVuIENTUyB0ZXh0IGFuZCBhZGRzIGl0IHRvIHRoZSBkb2N1bWVudC5cbiAgICAgICAqIEBwcml2YXRlXG4gICAgICAgKiBAcGFyYW0ge0RvY3VtZW50fSBvd25lckRvY3VtZW50IFRoZSBkb2N1bWVudC5cbiAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjc3NUZXh0IFRoZSBDU1MgdGV4dC5cbiAgICAgICAqIEByZXR1cm5zIHtTdHlsZVNoZWV0fSBUaGUgc3R5bGUgZWxlbWVudC5cbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gYWRkU3R5bGVTaGVldChvd25lckRvY3VtZW50LCBjc3NUZXh0KSB7XG4gICAgICAgIHZhciBwID0gb3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyksXG4gICAgICAgICAgcGFyZW50ID0gb3duZXJEb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaGVhZCcpWzBdIHx8IG93bmVyRG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xuXG4gICAgICAgIHAuaW5uZXJIVE1MID0gJ3g8c3R5bGU+JyArIGNzc1RleHQgKyAnPC9zdHlsZT4nO1xuICAgICAgICByZXR1cm4gcGFyZW50Lmluc2VydEJlZm9yZShwLmxhc3RDaGlsZCwgcGFyZW50LmZpcnN0Q2hpbGQpO1xuICAgICAgfVxuXG4gICAgICAvKipcbiAgICAgICAqIFJldHVybnMgdGhlIHZhbHVlIG9mIGBodG1sNS5lbGVtZW50c2AgYXMgYW4gYXJyYXkuXG4gICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICogQHJldHVybnMge0FycmF5fSBBbiBhcnJheSBvZiBzaGl2ZWQgZWxlbWVudCBub2RlIG5hbWVzLlxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiBnZXRFbGVtZW50cygpIHtcbiAgICAgICAgdmFyIGVsZW1lbnRzID0gaHRtbDUuZWxlbWVudHM7XG4gICAgICAgIHJldHVybiB0eXBlb2YgZWxlbWVudHMgPT0gJ3N0cmluZycgPyBlbGVtZW50cy5zcGxpdCgnICcpIDogZWxlbWVudHM7XG4gICAgICB9XG5cbiAgICAgIC8qKlxuICAgICAgICogRXh0ZW5kcyB0aGUgYnVpbHQtaW4gbGlzdCBvZiBodG1sNSBlbGVtZW50c1xuICAgICAgICogQG1lbWJlck9mIGh0bWw1XG4gICAgICAgKiBAcGFyYW0ge1N0cmluZ3xBcnJheX0gbmV3RWxlbWVudHMgd2hpdGVzcGFjZSBzZXBhcmF0ZWQgbGlzdCBvciBhcnJheSBvZiBuZXcgZWxlbWVudCBuYW1lcyB0byBzaGl2XG4gICAgICAgKiBAcGFyYW0ge0RvY3VtZW50fSBvd25lckRvY3VtZW50IFRoZSBjb250ZXh0IGRvY3VtZW50LlxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiBhZGRFbGVtZW50cyhuZXdFbGVtZW50cywgb3duZXJEb2N1bWVudCkge1xuICAgICAgICB2YXIgZWxlbWVudHMgPSBodG1sNS5lbGVtZW50cztcbiAgICAgICAgaWYodHlwZW9mIGVsZW1lbnRzICE9ICdzdHJpbmcnKXtcbiAgICAgICAgICBlbGVtZW50cyA9IGVsZW1lbnRzLmpvaW4oJyAnKTtcbiAgICAgICAgfVxuICAgICAgICBpZih0eXBlb2YgbmV3RWxlbWVudHMgIT0gJ3N0cmluZycpe1xuICAgICAgICAgIG5ld0VsZW1lbnRzID0gbmV3RWxlbWVudHMuam9pbignICcpO1xuICAgICAgICB9XG4gICAgICAgIGh0bWw1LmVsZW1lbnRzID0gZWxlbWVudHMgKycgJysgbmV3RWxlbWVudHM7XG4gICAgICAgIHNoaXZEb2N1bWVudChvd25lckRvY3VtZW50KTtcbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiBSZXR1cm5zIHRoZSBkYXRhIGFzc29jaWF0ZWQgdG8gdGhlIGdpdmVuIGRvY3VtZW50XG4gICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICogQHBhcmFtIHtEb2N1bWVudH0gb3duZXJEb2N1bWVudCBUaGUgZG9jdW1lbnQuXG4gICAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBBbiBvYmplY3Qgb2YgZGF0YS5cbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gZ2V0RXhwYW5kb0RhdGEob3duZXJEb2N1bWVudCkge1xuICAgICAgICB2YXIgZGF0YSA9IGV4cGFuZG9EYXRhW293bmVyRG9jdW1lbnRbZXhwYW5kb11dO1xuICAgICAgICBpZiAoIWRhdGEpIHtcbiAgICAgICAgICBkYXRhID0ge307XG4gICAgICAgICAgZXhwYW5JRCsrO1xuICAgICAgICAgIG93bmVyRG9jdW1lbnRbZXhwYW5kb10gPSBleHBhbklEO1xuICAgICAgICAgIGV4cGFuZG9EYXRhW2V4cGFuSURdID0gZGF0YTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiByZXR1cm5zIGEgc2hpdmVkIGVsZW1lbnQgZm9yIHRoZSBnaXZlbiBub2RlTmFtZSBhbmQgZG9jdW1lbnRcbiAgICAgICAqIEBtZW1iZXJPZiBodG1sNVxuICAgICAgICogQHBhcmFtIHtTdHJpbmd9IG5vZGVOYW1lIG5hbWUgb2YgdGhlIGVsZW1lbnRcbiAgICAgICAqIEBwYXJhbSB7RG9jdW1lbnR8RG9jdW1lbnRGcmFnbWVudH0gb3duZXJEb2N1bWVudCBUaGUgY29udGV4dCBkb2N1bWVudC5cbiAgICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBzaGl2ZWQgZWxlbWVudC5cbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gY3JlYXRlRWxlbWVudChub2RlTmFtZSwgb3duZXJEb2N1bWVudCwgZGF0YSl7XG4gICAgICAgIGlmICghb3duZXJEb2N1bWVudCkge1xuICAgICAgICAgIG93bmVyRG9jdW1lbnQgPSBkb2N1bWVudDtcbiAgICAgICAgfVxuICAgICAgICBpZihzdXBwb3J0c1Vua25vd25FbGVtZW50cyl7XG4gICAgICAgICAgcmV0dXJuIG93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudChub2RlTmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFkYXRhKSB7XG4gICAgICAgICAgZGF0YSA9IGdldEV4cGFuZG9EYXRhKG93bmVyRG9jdW1lbnQpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBub2RlO1xuXG4gICAgICAgIGlmIChkYXRhLmNhY2hlW25vZGVOYW1lXSkge1xuICAgICAgICAgIG5vZGUgPSBkYXRhLmNhY2hlW25vZGVOYW1lXS5jbG9uZU5vZGUoKTtcbiAgICAgICAgfSBlbHNlIGlmIChzYXZlQ2xvbmVzLnRlc3Qobm9kZU5hbWUpKSB7XG4gICAgICAgICAgbm9kZSA9IChkYXRhLmNhY2hlW25vZGVOYW1lXSA9IGRhdGEuY3JlYXRlRWxlbShub2RlTmFtZSkpLmNsb25lTm9kZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5vZGUgPSBkYXRhLmNyZWF0ZUVsZW0obm9kZU5hbWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQXZvaWQgYWRkaW5nIHNvbWUgZWxlbWVudHMgdG8gZnJhZ21lbnRzIGluIElFIDwgOSBiZWNhdXNlXG4gICAgICAgIC8vICogQXR0cmlidXRlcyBsaWtlIGBuYW1lYCBvciBgdHlwZWAgY2Fubm90IGJlIHNldC9jaGFuZ2VkIG9uY2UgYW4gZWxlbWVudFxuICAgICAgICAvLyAgIGlzIGluc2VydGVkIGludG8gYSBkb2N1bWVudC9mcmFnbWVudFxuICAgICAgICAvLyAqIExpbmsgZWxlbWVudHMgd2l0aCBgc3JjYCBhdHRyaWJ1dGVzIHRoYXQgYXJlIGluYWNjZXNzaWJsZSwgYXMgd2l0aFxuICAgICAgICAvLyAgIGEgNDAzIHJlc3BvbnNlLCB3aWxsIGNhdXNlIHRoZSB0YWIvd2luZG93IHRvIGNyYXNoXG4gICAgICAgIC8vICogU2NyaXB0IGVsZW1lbnRzIGFwcGVuZGVkIHRvIGZyYWdtZW50cyB3aWxsIGV4ZWN1dGUgd2hlbiB0aGVpciBgc3JjYFxuICAgICAgICAvLyAgIG9yIGB0ZXh0YCBwcm9wZXJ0eSBpcyBzZXRcbiAgICAgICAgcmV0dXJuIG5vZGUuY2FuSGF2ZUNoaWxkcmVuICYmICFyZVNraXAudGVzdChub2RlTmFtZSkgJiYgIW5vZGUudGFnVXJuID8gZGF0YS5mcmFnLmFwcGVuZENoaWxkKG5vZGUpIDogbm9kZTtcbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiByZXR1cm5zIGEgc2hpdmVkIERvY3VtZW50RnJhZ21lbnQgZm9yIHRoZSBnaXZlbiBkb2N1bWVudFxuICAgICAgICogQG1lbWJlck9mIGh0bWw1XG4gICAgICAgKiBAcGFyYW0ge0RvY3VtZW50fSBvd25lckRvY3VtZW50IFRoZSBjb250ZXh0IGRvY3VtZW50LlxuICAgICAgICogQHJldHVybnMge09iamVjdH0gVGhlIHNoaXZlZCBEb2N1bWVudEZyYWdtZW50LlxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiBjcmVhdGVEb2N1bWVudEZyYWdtZW50KG93bmVyRG9jdW1lbnQsIGRhdGEpe1xuICAgICAgICBpZiAoIW93bmVyRG9jdW1lbnQpIHtcbiAgICAgICAgICBvd25lckRvY3VtZW50ID0gZG9jdW1lbnQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYoc3VwcG9ydHNVbmtub3duRWxlbWVudHMpe1xuICAgICAgICAgIHJldHVybiBvd25lckRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgfVxuICAgICAgICBkYXRhID0gZGF0YSB8fCBnZXRFeHBhbmRvRGF0YShvd25lckRvY3VtZW50KTtcbiAgICAgICAgdmFyIGNsb25lID0gZGF0YS5mcmFnLmNsb25lTm9kZSgpLFxuICAgICAgICAgIGkgPSAwLFxuICAgICAgICAgIGVsZW1zID0gZ2V0RWxlbWVudHMoKSxcbiAgICAgICAgICBsID0gZWxlbXMubGVuZ3RoO1xuICAgICAgICBmb3IoO2k8bDtpKyspe1xuICAgICAgICAgIGNsb25lLmNyZWF0ZUVsZW1lbnQoZWxlbXNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiBTaGl2cyB0aGUgYGNyZWF0ZUVsZW1lbnRgIGFuZCBgY3JlYXRlRG9jdW1lbnRGcmFnbWVudGAgbWV0aG9kcyBvZiB0aGUgZG9jdW1lbnQuXG4gICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICogQHBhcmFtIHtEb2N1bWVudHxEb2N1bWVudEZyYWdtZW50fSBvd25lckRvY3VtZW50IFRoZSBkb2N1bWVudC5cbiAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhIG9mIHRoZSBkb2N1bWVudC5cbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gc2hpdk1ldGhvZHMob3duZXJEb2N1bWVudCwgZGF0YSkge1xuICAgICAgICBpZiAoIWRhdGEuY2FjaGUpIHtcbiAgICAgICAgICBkYXRhLmNhY2hlID0ge307XG4gICAgICAgICAgZGF0YS5jcmVhdGVFbGVtID0gb3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50O1xuICAgICAgICAgIGRhdGEuY3JlYXRlRnJhZyA9IG93bmVyRG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudDtcbiAgICAgICAgICBkYXRhLmZyYWcgPSBkYXRhLmNyZWF0ZUZyYWcoKTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgb3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50ID0gZnVuY3Rpb24obm9kZU5hbWUpIHtcbiAgICAgICAgICAvL2Fib3J0IHNoaXZcbiAgICAgICAgICBpZiAoIWh0bWw1LnNoaXZNZXRob2RzKSB7XG4gICAgICAgICAgICByZXR1cm4gZGF0YS5jcmVhdGVFbGVtKG5vZGVOYW1lKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGNyZWF0ZUVsZW1lbnQobm9kZU5hbWUsIG93bmVyRG9jdW1lbnQsIGRhdGEpO1xuICAgICAgICB9O1xuXG4gICAgICAgIG93bmVyRG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCA9IEZ1bmN0aW9uKCdoLGYnLCAncmV0dXJuIGZ1bmN0aW9uKCl7JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd2YXIgbj1mLmNsb25lTm9kZSgpLGM9bi5jcmVhdGVFbGVtZW50OycgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaC5zaGl2TWV0aG9kcyYmKCcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB1bnJvbGwgdGhlIGBjcmVhdGVFbGVtZW50YCBjYWxsc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRFbGVtZW50cygpLmpvaW4oKS5yZXBsYWNlKC9bXFx3XFwtOl0rL2csIGZ1bmN0aW9uKG5vZGVOYW1lKSB7XG4gICAgICAgICAgZGF0YS5jcmVhdGVFbGVtKG5vZGVOYW1lKTtcbiAgICAgICAgICBkYXRhLmZyYWcuY3JlYXRlRWxlbWVudChub2RlTmFtZSk7XG4gICAgICAgICAgcmV0dXJuICdjKFwiJyArIG5vZGVOYW1lICsgJ1wiKSc7XG4gICAgICAgIH0pICtcbiAgICAgICAgICAnKTtyZXR1cm4gbn0nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKShodG1sNSwgZGF0YS5mcmFnKTtcbiAgICAgIH1cblxuICAgICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgICAgIC8qKlxuICAgICAgICogU2hpdnMgdGhlIGdpdmVuIGRvY3VtZW50LlxuICAgICAgICogQG1lbWJlck9mIGh0bWw1XG4gICAgICAgKiBAcGFyYW0ge0RvY3VtZW50fSBvd25lckRvY3VtZW50IFRoZSBkb2N1bWVudCB0byBzaGl2LlxuICAgICAgICogQHJldHVybnMge0RvY3VtZW50fSBUaGUgc2hpdmVkIGRvY3VtZW50LlxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiBzaGl2RG9jdW1lbnQob3duZXJEb2N1bWVudCkge1xuICAgICAgICBpZiAoIW93bmVyRG9jdW1lbnQpIHtcbiAgICAgICAgICBvd25lckRvY3VtZW50ID0gZG9jdW1lbnQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRhdGEgPSBnZXRFeHBhbmRvRGF0YShvd25lckRvY3VtZW50KTtcblxuICAgICAgICBpZiAoaHRtbDUuc2hpdkNTUyAmJiAhc3VwcG9ydHNIdG1sNVN0eWxlcyAmJiAhZGF0YS5oYXNDU1MpIHtcbiAgICAgICAgICBkYXRhLmhhc0NTUyA9ICEhYWRkU3R5bGVTaGVldChvd25lckRvY3VtZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvcnJlY3RzIGJsb2NrIGRpc3BsYXkgbm90IGRlZmluZWQgaW4gSUU2LzcvOC85XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2FydGljbGUsYXNpZGUsZGlhbG9nLGZpZ2NhcHRpb24sZmlndXJlLGZvb3RlcixoZWFkZXIsaGdyb3VwLG1haW4sbmF2LHNlY3Rpb257ZGlzcGxheTpibG9ja30nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhZGRzIHN0eWxpbmcgbm90IHByZXNlbnQgaW4gSUU2LzcvOC85XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ21hcmt7YmFja2dyb3VuZDojRkYwO2NvbG9yOiMwMDB9JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaGlkZXMgbm9uLXJlbmRlcmVkIGVsZW1lbnRzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RlbXBsYXRle2Rpc3BsYXk6bm9uZX0nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGlmICghc3VwcG9ydHNVbmtub3duRWxlbWVudHMpIHtcbiAgICAgICAgICBzaGl2TWV0aG9kcyhvd25lckRvY3VtZW50LCBkYXRhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3duZXJEb2N1bWVudDtcbiAgICAgIH1cblxuICAgICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgICAgIC8qKlxuICAgICAgICogVGhlIGBodG1sNWAgb2JqZWN0IGlzIGV4cG9zZWQgc28gdGhhdCBtb3JlIGVsZW1lbnRzIGNhbiBiZSBzaGl2ZWQgYW5kXG4gICAgICAgKiBleGlzdGluZyBzaGl2aW5nIGNhbiBiZSBkZXRlY3RlZCBvbiBpZnJhbWVzLlxuICAgICAgICogQHR5cGUgT2JqZWN0XG4gICAgICAgKiBAZXhhbXBsZVxuICAgICAgICpcbiAgICAgICAqIC8vIG9wdGlvbnMgY2FuIGJlIGNoYW5nZWQgYmVmb3JlIHRoZSBzY3JpcHQgaXMgaW5jbHVkZWRcbiAgICAgICAqIGh0bWw1ID0geyAnZWxlbWVudHMnOiAnbWFyayBzZWN0aW9uJywgJ3NoaXZDU1MnOiBmYWxzZSwgJ3NoaXZNZXRob2RzJzogZmFsc2UgfTtcbiAgICAgICAqL1xuICAgICAgdmFyIGh0bWw1ID0ge1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBbiBhcnJheSBvciBzcGFjZSBzZXBhcmF0ZWQgc3RyaW5nIG9mIG5vZGUgbmFtZXMgb2YgdGhlIGVsZW1lbnRzIHRvIHNoaXYuXG4gICAgICAgICAqIEBtZW1iZXJPZiBodG1sNVxuICAgICAgICAgKiBAdHlwZSBBcnJheXxTdHJpbmdcbiAgICAgICAgICovXG4gICAgICAgICdlbGVtZW50cyc6IG9wdGlvbnMuZWxlbWVudHMgfHwgJ2FiYnIgYXJ0aWNsZSBhc2lkZSBhdWRpbyBiZGkgY2FudmFzIGRhdGEgZGF0YWxpc3QgZGV0YWlscyBkaWFsb2cgZmlnY2FwdGlvbiBmaWd1cmUgZm9vdGVyIGhlYWRlciBoZ3JvdXAgbWFpbiBtYXJrIG1ldGVyIG5hdiBvdXRwdXQgcGljdHVyZSBwcm9ncmVzcyBzZWN0aW9uIHN1bW1hcnkgdGVtcGxhdGUgdGltZSB2aWRlbycsXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIGN1cnJlbnQgdmVyc2lvbiBvZiBodG1sNXNoaXZcbiAgICAgICAgICovXG4gICAgICAgICd2ZXJzaW9uJzogdmVyc2lvbixcblxuICAgICAgICAvKipcbiAgICAgICAgICogQSBmbGFnIHRvIGluZGljYXRlIHRoYXQgdGhlIEhUTUw1IHN0eWxlIHNoZWV0IHNob3VsZCBiZSBpbnNlcnRlZC5cbiAgICAgICAgICogQG1lbWJlck9mIGh0bWw1XG4gICAgICAgICAqIEB0eXBlIEJvb2xlYW5cbiAgICAgICAgICovXG4gICAgICAgICdzaGl2Q1NTJzogKG9wdGlvbnMuc2hpdkNTUyAhPT0gZmFsc2UpLFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJcyBlcXVhbCB0byB0cnVlIGlmIGEgYnJvd3NlciBzdXBwb3J0cyBjcmVhdGluZyB1bmtub3duL0hUTUw1IGVsZW1lbnRzXG4gICAgICAgICAqIEBtZW1iZXJPZiBodG1sNVxuICAgICAgICAgKiBAdHlwZSBib29sZWFuXG4gICAgICAgICAqL1xuICAgICAgICAnc3VwcG9ydHNVbmtub3duRWxlbWVudHMnOiBzdXBwb3J0c1Vua25vd25FbGVtZW50cyxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQSBmbGFnIHRvIGluZGljYXRlIHRoYXQgdGhlIGRvY3VtZW50J3MgYGNyZWF0ZUVsZW1lbnRgIGFuZCBgY3JlYXRlRG9jdW1lbnRGcmFnbWVudGBcbiAgICAgICAgICogbWV0aG9kcyBzaG91bGQgYmUgb3ZlcndyaXR0ZW4uXG4gICAgICAgICAqIEBtZW1iZXJPZiBodG1sNVxuICAgICAgICAgKiBAdHlwZSBCb29sZWFuXG4gICAgICAgICAqL1xuICAgICAgICAnc2hpdk1ldGhvZHMnOiAob3B0aW9ucy5zaGl2TWV0aG9kcyAhPT0gZmFsc2UpLFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIHN0cmluZyB0byBkZXNjcmliZSB0aGUgdHlwZSBvZiBgaHRtbDVgIG9iamVjdCAoXCJkZWZhdWx0XCIgb3IgXCJkZWZhdWx0IHByaW50XCIpLlxuICAgICAgICAgKiBAbWVtYmVyT2YgaHRtbDVcbiAgICAgICAgICogQHR5cGUgU3RyaW5nXG4gICAgICAgICAqL1xuICAgICAgICAndHlwZSc6ICdkZWZhdWx0JyxcblxuICAgICAgICAvLyBzaGl2cyB0aGUgZG9jdW1lbnQgYWNjb3JkaW5nIHRvIHRoZSBzcGVjaWZpZWQgYGh0bWw1YCBvYmplY3Qgb3B0aW9uc1xuICAgICAgICAnc2hpdkRvY3VtZW50Jzogc2hpdkRvY3VtZW50LFxuXG4gICAgICAgIC8vY3JlYXRlcyBhIHNoaXZlZCBlbGVtZW50XG4gICAgICAgIGNyZWF0ZUVsZW1lbnQ6IGNyZWF0ZUVsZW1lbnQsXG5cbiAgICAgICAgLy9jcmVhdGVzIGEgc2hpdmVkIGRvY3VtZW50RnJhZ21lbnRcbiAgICAgICAgY3JlYXRlRG9jdW1lbnRGcmFnbWVudDogY3JlYXRlRG9jdW1lbnRGcmFnbWVudCxcblxuICAgICAgICAvL2V4dGVuZHMgbGlzdCBvZiBlbGVtZW50c1xuICAgICAgICBhZGRFbGVtZW50czogYWRkRWxlbWVudHNcbiAgICAgIH07XG5cbiAgICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgICAvLyBleHBvc2UgaHRtbDVcbiAgICAgIHdpbmRvdy5odG1sNSA9IGh0bWw1O1xuXG4gICAgICAvLyBzaGl2IHRoZSBkb2N1bWVudFxuICAgICAgc2hpdkRvY3VtZW50KGRvY3VtZW50KTtcblxuICAgICAgaWYodHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cyl7XG4gICAgICAgIG1vZHVsZS5leHBvcnRzID0gaHRtbDU7XG4gICAgICB9XG5cbiAgICB9KHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB0aGlzLCBkb2N1bWVudCkpO1xuICB9XG47XG5cbiAgLyoqXG4gICAqIGNyZWF0ZUVsZW1lbnQgaXMgYSBjb252ZW5pZW5jZSB3cmFwcGVyIGFyb3VuZCBkb2N1bWVudC5jcmVhdGVFbGVtZW50LiBTaW5jZSB3ZVxuICAgKiB1c2UgY3JlYXRlRWxlbWVudCBhbGwgb3ZlciB0aGUgcGxhY2UsIHRoaXMgYWxsb3dzIGZvciAoc2xpZ2h0bHkpIHNtYWxsZXIgY29kZVxuICAgKiBhcyB3ZWxsIGFzIGFic3RyYWN0aW5nIGF3YXkgaXNzdWVzIHdpdGggY3JlYXRpbmcgZWxlbWVudHMgaW4gY29udGV4dHMgb3RoZXIgdGhhblxuICAgKiBIVE1MIGRvY3VtZW50cyAoZS5nLiBTVkcgZG9jdW1lbnRzKS5cbiAgICpcbiAgICogQGFjY2VzcyBwcml2YXRlXG4gICAqIEBmdW5jdGlvbiBjcmVhdGVFbGVtZW50XG4gICAqIEByZXR1cm5zIHtIVE1MRWxlbWVudHxTVkdFbGVtZW50fSBBbiBIVE1MIG9yIFNWRyBlbGVtZW50XG4gICAqL1xuXG4gIGZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnQoKSB7XG4gICAgaWYgKHR5cGVvZiBkb2N1bWVudC5jcmVhdGVFbGVtZW50ICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAvLyBUaGlzIGlzIHRoZSBjYXNlIGluIElFNywgd2hlcmUgdGhlIHR5cGUgb2YgY3JlYXRlRWxlbWVudCBpcyBcIm9iamVjdFwiLlxuICAgICAgLy8gRm9yIHRoaXMgcmVhc29uLCB3ZSBjYW5ub3QgY2FsbCBhcHBseSgpIGFzIE9iamVjdCBpcyBub3QgYSBGdW5jdGlvbi5cbiAgICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGFyZ3VtZW50c1swXSk7XG4gICAgfSBlbHNlIGlmIChpc1NWRykge1xuICAgICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUy5jYWxsKGRvY3VtZW50LCAnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCBhcmd1bWVudHNbMF0pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudC5hcHBseShkb2N1bWVudCwgYXJndW1lbnRzKTtcbiAgICB9XG4gIH1cblxuICA7XG4vKiFcbntcbiAgXCJuYW1lXCI6IFwiV2ViR0xcIixcbiAgXCJwcm9wZXJ0eVwiOiBcIndlYmdsXCIsXG4gIFwiY2FuaXVzZVwiOiBcIndlYmdsXCIsXG4gIFwidGFnc1wiOiBbXCJ3ZWJnbFwiLCBcImdyYXBoaWNzXCJdLFxuICBcInBvbHlmaWxsc1wiOiBbXCJqZWJnbFwiLCBcImN3ZWJnbFwiLCBcImlld2ViZ2xcIl1cbn1cbiEqL1xuXG4gIE1vZGVybml6ci5hZGRUZXN0KCd3ZWJnbCcsIGZ1bmN0aW9uKCkge1xuICAgIHZhciBjYW52YXMgPSBjcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICB2YXIgc3VwcG9ydHMgPSAncHJvYmFibHlTdXBwb3J0c0NvbnRleHQnIGluIGNhbnZhcyA/ICdwcm9iYWJseVN1cHBvcnRzQ29udGV4dCcgOiAgJ3N1cHBvcnRzQ29udGV4dCc7XG4gICAgaWYgKHN1cHBvcnRzIGluIGNhbnZhcykge1xuICAgICAgcmV0dXJuIGNhbnZhc1tzdXBwb3J0c10oJ3dlYmdsJykgfHwgY2FudmFzW3N1cHBvcnRzXSgnZXhwZXJpbWVudGFsLXdlYmdsJyk7XG4gICAgfVxuICAgIHJldHVybiAnV2ViR0xSZW5kZXJpbmdDb250ZXh0JyBpbiB3aW5kb3c7XG4gIH0pO1xuXG5cbiAgLyoqXG4gICAqIExpc3Qgb2YgcHJvcGVydHkgdmFsdWVzIHRvIHNldCBmb3IgY3NzIHRlc3RzLiBTZWUgdGlja2V0ICMyMVxuICAgKiBodHRwOi8vZ2l0LmlvL3ZVR2w0XG4gICAqXG4gICAqIEBtZW1iZXJvZiBNb2Rlcm5penJcbiAgICogQG5hbWUgTW9kZXJuaXpyLl9wcmVmaXhlc1xuICAgKiBAb3B0aW9uTmFtZSBNb2Rlcm5penIuX3ByZWZpeGVzXG4gICAqIEBvcHRpb25Qcm9wIHByZWZpeGVzXG4gICAqIEBhY2Nlc3MgcHVibGljXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIE1vZGVybml6ci5fcHJlZml4ZXMgaXMgdGhlIGludGVybmFsIGxpc3Qgb2YgcHJlZml4ZXMgdGhhdCB3ZSB0ZXN0IGFnYWluc3RcbiAgICogaW5zaWRlIG9mIHRoaW5ncyBsaWtlIFtwcmVmaXhlZF0oI21vZGVybml6ci1wcmVmaXhlZCkgYW5kIFtwcmVmaXhlZENTU10oIy1jb2RlLW1vZGVybml6ci1wcmVmaXhlZGNzcykuIEl0IGlzIHNpbXBseVxuICAgKiBhbiBhcnJheSBvZiBrZWJhYi1jYXNlIHZlbmRvciBwcmVmaXhlcyB5b3UgY2FuIHVzZSB3aXRoaW4geW91ciBjb2RlLlxuICAgKlxuICAgKiBTb21lIGNvbW1vbiB1c2UgY2FzZXMgaW5jbHVkZVxuICAgKlxuICAgKiBHZW5lcmF0aW5nIGFsbCBwb3NzaWJsZSBwcmVmaXhlZCB2ZXJzaW9uIG9mIGEgQ1NTIHByb3BlcnR5XG4gICAqIGBgYGpzXG4gICAqIHZhciBydWxlID0gTW9kZXJuaXpyLl9wcmVmaXhlcy5qb2luKCd0cmFuc2Zvcm06IHJvdGF0ZSgyMGRlZyk7ICcpO1xuICAgKlxuICAgKiBydWxlID09PSAndHJhbnNmb3JtOiByb3RhdGUoMjBkZWcpOyB3ZWJraXQtdHJhbnNmb3JtOiByb3RhdGUoMjBkZWcpOyBtb3otdHJhbnNmb3JtOiByb3RhdGUoMjBkZWcpOyBvLXRyYW5zZm9ybTogcm90YXRlKDIwZGVnKTsgbXMtdHJhbnNmb3JtOiByb3RhdGUoMjBkZWcpOydcbiAgICogYGBgXG4gICAqXG4gICAqIEdlbmVyYXRpbmcgYWxsIHBvc3NpYmxlIHByZWZpeGVkIHZlcnNpb24gb2YgYSBDU1MgdmFsdWVcbiAgICogYGBganNcbiAgICogcnVsZSA9ICdkaXNwbGF5OicgKyAgTW9kZXJuaXpyLl9wcmVmaXhlcy5qb2luKCdmbGV4OyBkaXNwbGF5OicpICsgJ2ZsZXgnO1xuICAgKlxuICAgKiBydWxlID09PSAnZGlzcGxheTpmbGV4OyBkaXNwbGF5Oi13ZWJraXQtZmxleDsgZGlzcGxheTotbW96LWZsZXg7IGRpc3BsYXk6LW8tZmxleDsgZGlzcGxheTotbXMtZmxleDsgZGlzcGxheTpmbGV4J1xuICAgKiBgYGBcbiAgICovXG5cbiAgLy8gd2UgdXNlIFsnJywnJ10gcmF0aGVyIHRoYW4gYW4gZW1wdHkgYXJyYXkgaW4gb3JkZXIgdG8gYWxsb3cgYSBwYXR0ZXJuIG9mIC5gam9pbigpYGluZyBwcmVmaXhlcyB0byB0ZXN0XG4gIC8vIHZhbHVlcyBpbiBmZWF0dXJlIGRldGVjdHMgdG8gY29udGludWUgdG8gd29ya1xuICB2YXIgcHJlZml4ZXMgPSAoTW9kZXJuaXpyUHJvdG8uX2NvbmZpZy51c2VQcmVmaXhlcyA/ICcgLXdlYmtpdC0gLW1vei0gLW8tIC1tcy0gJy5zcGxpdCgnICcpIDogWycnLCcnXSk7XG5cbiAgLy8gZXhwb3NlIHRoZXNlIGZvciB0aGUgcGx1Z2luIEFQSS4gTG9vayBpbiB0aGUgc291cmNlIGZvciBob3cgdG8gam9pbigpIHRoZW0gYWdhaW5zdCB5b3VyIGlucHV0XG4gIE1vZGVybml6clByb3RvLl9wcmVmaXhlcyA9IHByZWZpeGVzO1xuXG5cbi8qIVxue1xuICBcIm5hbWVcIjogXCJDU1MgQ2FsY1wiLFxuICBcInByb3BlcnR5XCI6IFwiY3NzY2FsY1wiLFxuICBcImNhbml1c2VcIjogXCJjYWxjXCIsXG4gIFwidGFnc1wiOiBbXCJjc3NcIl0sXG4gIFwiYnVpbGRlckFsaWFzZXNcIjogW1wiY3NzX2NhbGNcIl0sXG4gIFwiYXV0aG9yc1wiOiBbXCJAY2FsdmVpblwiXVxufVxuISovXG4vKiBET0Ncbk1ldGhvZCBvZiBhbGxvd2luZyBjYWxjdWxhdGVkIHZhbHVlcyBmb3IgbGVuZ3RoIHVuaXRzLiBGb3IgZXhhbXBsZTpcblxuYGBgY3NzXG4vL2xlbSB7XG4gIHdpZHRoOiBjYWxjKDEwMCUgLSAzZW0pO1xufVxuYGBgXG4qL1xuXG4gIE1vZGVybml6ci5hZGRUZXN0KCdjc3NjYWxjJywgZnVuY3Rpb24oKSB7XG4gICAgdmFyIHByb3AgPSAnd2lkdGg6JztcbiAgICB2YXIgdmFsdWUgPSAnY2FsYygxMHB4KTsnO1xuICAgIHZhciBlbCA9IGNyZWF0ZUVsZW1lbnQoJ2EnKTtcblxuICAgIGVsLnN0eWxlLmNzc1RleHQgPSBwcm9wICsgcHJlZml4ZXMuam9pbih2YWx1ZSArIHByb3ApO1xuXG4gICAgcmV0dXJuICEhZWwuc3R5bGUubGVuZ3RoO1xuICB9KTtcblxuLyohXG57XG4gIFwibmFtZVwiOiBcIkNTUyBHcmFkaWVudHNcIixcbiAgXCJjYW5pdXNlXCI6IFwiY3NzLWdyYWRpZW50c1wiLFxuICBcInByb3BlcnR5XCI6IFwiY3NzZ3JhZGllbnRzXCIsXG4gIFwidGFnc1wiOiBbXCJjc3NcIl0sXG4gIFwia25vd25CdWdzXCI6IFtcIkZhbHNlLXBvc2l0aXZlcyBvbiB3ZWJPUyAoaHR0cHM6Ly9naXRodWIuY29tL01vZGVybml6ci9Nb2Rlcm5penIvaXNzdWVzLzIwMilcIl0sXG4gIFwibm90ZXNcIjogW3tcbiAgICBcIm5hbWVcIjogXCJXZWJraXQgR3JhZGllbnQgU3ludGF4XCIsXG4gICAgXCJocmVmXCI6IFwiaHR0cHM6Ly93ZWJraXQub3JnL2Jsb2cvMTc1L2ludHJvZHVjaW5nLWNzcy1ncmFkaWVudHMvXCJcbiAgfSx7XG4gICAgXCJuYW1lXCI6IFwiTGluZWFyIEdyYWRpZW50IFN5bnRheFwiLFxuICAgIFwiaHJlZlwiOiBcImh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0NTUy9saW5lYXItZ3JhZGllbnRcIlxuICB9LHtcbiAgICBcIm5hbWVcIjogXCJXM0MgR3JhZGllbnQgU3BlY1wiLFxuICAgIFwiaHJlZlwiOiBcImh0dHBzOi8vZHJhZnRzLmNzc3dnLm9yZy9jc3MtaW1hZ2VzLTMvI2dyYWRpZW50c1wiXG4gIH1dXG59XG4hKi9cblxuXG4gIE1vZGVybml6ci5hZGRUZXN0KCdjc3NncmFkaWVudHMnLCBmdW5jdGlvbigpIHtcblxuICAgIHZhciBzdHIxID0gJ2JhY2tncm91bmQtaW1hZ2U6JztcbiAgICB2YXIgc3RyMiA9ICdncmFkaWVudChsaW5lYXIsbGVmdCB0b3AscmlnaHQgYm90dG9tLGZyb20oIzlmOSksdG8od2hpdGUpKTsnO1xuICAgIHZhciBjc3MgPSAnJztcbiAgICB2YXIgYW5nbGU7XG5cbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gcHJlZml4ZXMubGVuZ3RoIC0gMTsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICBhbmdsZSA9IChpID09PSAwID8gJ3RvICcgOiAnJyk7XG4gICAgICBjc3MgKz0gc3RyMSArIHByZWZpeGVzW2ldICsgJ2xpbmVhci1ncmFkaWVudCgnICsgYW5nbGUgKyAnbGVmdCB0b3AsICM5ZjksIHdoaXRlKTsnO1xuICAgIH1cblxuICAgIGlmIChNb2Rlcm5penIuX2NvbmZpZy51c2VQcmVmaXhlcykge1xuICAgIC8vIGxlZ2FjeSB3ZWJraXQgc3ludGF4IChGSVhNRTogcmVtb3ZlIHdoZW4gc3ludGF4IG5vdCBpbiB1c2UgYW55bW9yZSlcbiAgICAgIGNzcyArPSBzdHIxICsgJy13ZWJraXQtJyArIHN0cjI7XG4gICAgfVxuXG4gICAgdmFyIGVsZW0gPSBjcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgdmFyIHN0eWxlID0gZWxlbS5zdHlsZTtcbiAgICBzdHlsZS5jc3NUZXh0ID0gY3NzO1xuXG4gICAgLy8gSUU2IHJldHVybnMgdW5kZWZpbmVkIHNvIGNhc3QgdG8gc3RyaW5nXG4gICAgcmV0dXJuICgnJyArIHN0eWxlLmJhY2tncm91bmRJbWFnZSkuaW5kZXhPZignZ3JhZGllbnQnKSA+IC0xO1xuICB9KTtcblxuLyohXG57XG4gIFwibmFtZVwiOiBcIkNTUyBTdXBwb3J0c1wiLFxuICBcInByb3BlcnR5XCI6IFwic3VwcG9ydHNcIixcbiAgXCJjYW5pdXNlXCI6IFwiY3NzLWZlYXR1cmVxdWVyaWVzXCIsXG4gIFwidGFnc1wiOiBbXCJjc3NcIl0sXG4gIFwiYnVpbGRlckFsaWFzZXNcIjogW1wiY3NzX3N1cHBvcnRzXCJdLFxuICBcIm5vdGVzXCI6IFt7XG4gICAgXCJuYW1lXCI6IFwiVzMgU3BlY1wiLFxuICAgIFwiaHJlZlwiOiBcImh0dHA6Ly9kZXYudzMub3JnL2Nzc3dnL2NzczMtY29uZGl0aW9uYWwvI2F0LXN1cHBvcnRzXCJcbiAgfSx7XG4gICAgXCJuYW1lXCI6IFwiUmVsYXRlZCBHaXRodWIgSXNzdWVcIixcbiAgICBcImhyZWZcIjogXCJnaXRodWIuY29tL01vZGVybml6ci9Nb2Rlcm5penIvaXNzdWVzLzY0OFwiXG4gIH0se1xuICAgIFwibmFtZVwiOiBcIlczIEluZm9cIixcbiAgICBcImhyZWZcIjogXCJodHRwOi8vZGV2LnczLm9yZy9jc3N3Zy9jc3MzLWNvbmRpdGlvbmFsLyN0aGUtY3Nzc3VwcG9ydHNydWxlLWludGVyZmFjZVwiXG4gIH1dXG59XG4hKi9cblxuICB2YXIgbmV3U3ludGF4ID0gJ0NTUycgaW4gd2luZG93ICYmICdzdXBwb3J0cycgaW4gd2luZG93LkNTUztcbiAgdmFyIG9sZFN5bnRheCA9ICdzdXBwb3J0c0NTUycgaW4gd2luZG93O1xuICBNb2Rlcm5penIuYWRkVGVzdCgnc3VwcG9ydHMnLCBuZXdTeW50YXggfHwgb2xkU3ludGF4KTtcblxuXG4gIC8qKlxuICAgKiBnZXRCb2R5IHJldHVybnMgdGhlIGJvZHkgb2YgYSBkb2N1bWVudCwgb3IgYW4gZWxlbWVudCB0aGF0IGNhbiBzdGFuZCBpbiBmb3JcbiAgICogdGhlIGJvZHkgaWYgYSByZWFsIGJvZHkgZG9lcyBub3QgZXhpc3RcbiAgICpcbiAgICogQGFjY2VzcyBwcml2YXRlXG4gICAqIEBmdW5jdGlvbiBnZXRCb2R5XG4gICAqIEByZXR1cm5zIHtIVE1MRWxlbWVudHxTVkdFbGVtZW50fSBSZXR1cm5zIHRoZSByZWFsIGJvZHkgb2YgYSBkb2N1bWVudCwgb3IgYW5cbiAgICogYXJ0aWZpY2lhbGx5IGNyZWF0ZWQgZWxlbWVudCB0aGF0IHN0YW5kcyBpbiBmb3IgdGhlIGJvZHlcbiAgICovXG5cbiAgZnVuY3Rpb24gZ2V0Qm9keSgpIHtcbiAgICAvLyBBZnRlciBwYWdlIGxvYWQgaW5qZWN0aW5nIGEgZmFrZSBib2R5IGRvZXNuJ3Qgd29yayBzbyBjaGVjayBpZiBib2R5IGV4aXN0c1xuICAgIHZhciBib2R5ID0gZG9jdW1lbnQuYm9keTtcblxuICAgIGlmICghYm9keSkge1xuICAgICAgLy8gQ2FuJ3QgdXNlIHRoZSByZWFsIGJvZHkgY3JlYXRlIGEgZmFrZSBvbmUuXG4gICAgICBib2R5ID0gY3JlYXRlRWxlbWVudChpc1NWRyA/ICdzdmcnIDogJ2JvZHknKTtcbiAgICAgIGJvZHkuZmFrZSA9IHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJvZHk7XG4gIH1cblxuICA7XG5cbiAgLyoqXG4gICAqIGluamVjdEVsZW1lbnRXaXRoU3R5bGVzIGluamVjdHMgYW4gZWxlbWVudCB3aXRoIHN0eWxlIGVsZW1lbnQgYW5kIHNvbWUgQ1NTIHJ1bGVzXG4gICAqXG4gICAqIEBhY2Nlc3MgcHJpdmF0ZVxuICAgKiBAZnVuY3Rpb24gaW5qZWN0RWxlbWVudFdpdGhTdHlsZXNcbiAgICogQHBhcmFtIHtzdHJpbmd9IHJ1bGUgLSBTdHJpbmcgcmVwcmVzZW50aW5nIGEgY3NzIHJ1bGVcbiAgICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2sgLSBBIGZ1bmN0aW9uIHRoYXQgaXMgdXNlZCB0byB0ZXN0IHRoZSBpbmplY3RlZCBlbGVtZW50XG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbbm9kZXNdIC0gQW4gaW50ZWdlciByZXByZXNlbnRpbmcgdGhlIG51bWJlciBvZiBhZGRpdGlvbmFsIG5vZGVzIHlvdSB3YW50IGluamVjdGVkXG4gICAqIEBwYXJhbSB7c3RyaW5nW119IFt0ZXN0bmFtZXNdIC0gQW4gYXJyYXkgb2Ygc3RyaW5ncyB0aGF0IGFyZSB1c2VkIGFzIGlkcyBmb3IgdGhlIGFkZGl0aW9uYWwgbm9kZXNcbiAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAqL1xuXG4gIGZ1bmN0aW9uIGluamVjdEVsZW1lbnRXaXRoU3R5bGVzKHJ1bGUsIGNhbGxiYWNrLCBub2RlcywgdGVzdG5hbWVzKSB7XG4gICAgdmFyIG1vZCA9ICdtb2Rlcm5penInO1xuICAgIHZhciBzdHlsZTtcbiAgICB2YXIgcmV0O1xuICAgIHZhciBub2RlO1xuICAgIHZhciBkb2NPdmVyZmxvdztcbiAgICB2YXIgZGl2ID0gY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdmFyIGJvZHkgPSBnZXRCb2R5KCk7XG5cbiAgICBpZiAocGFyc2VJbnQobm9kZXMsIDEwKSkge1xuICAgICAgLy8gSW4gb3JkZXIgbm90IHRvIGdpdmUgZmFsc2UgcG9zaXRpdmVzIHdlIGNyZWF0ZSBhIG5vZGUgZm9yIGVhY2ggdGVzdFxuICAgICAgLy8gVGhpcyBhbHNvIGFsbG93cyB0aGUgbWV0aG9kIHRvIHNjYWxlIGZvciB1bnNwZWNpZmllZCB1c2VzXG4gICAgICB3aGlsZSAobm9kZXMtLSkge1xuICAgICAgICBub2RlID0gY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIG5vZGUuaWQgPSB0ZXN0bmFtZXMgPyB0ZXN0bmFtZXNbbm9kZXNdIDogbW9kICsgKG5vZGVzICsgMSk7XG4gICAgICAgIGRpdi5hcHBlbmRDaGlsZChub2RlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBzdHlsZSA9IGNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XG4gICAgc3R5bGUudHlwZSA9ICd0ZXh0L2Nzcyc7XG4gICAgc3R5bGUuaWQgPSAncycgKyBtb2Q7XG5cbiAgICAvLyBJRTYgd2lsbCBmYWxzZSBwb3NpdGl2ZSBvbiBzb21lIHRlc3RzIGR1ZSB0byB0aGUgc3R5bGUgZWxlbWVudCBpbnNpZGUgdGhlIHRlc3QgZGl2IHNvbWVob3cgaW50ZXJmZXJpbmcgb2Zmc2V0SGVpZ2h0LCBzbyBpbnNlcnQgaXQgaW50byBib2R5IG9yIGZha2Vib2R5LlxuICAgIC8vIE9wZXJhIHdpbGwgYWN0IGFsbCBxdWlya3kgd2hlbiBpbmplY3RpbmcgZWxlbWVudHMgaW4gZG9jdW1lbnRFbGVtZW50IHdoZW4gcGFnZSBpcyBzZXJ2ZWQgYXMgeG1sLCBuZWVkcyBmYWtlYm9keSB0b28uICMyNzBcbiAgICAoIWJvZHkuZmFrZSA/IGRpdiA6IGJvZHkpLmFwcGVuZENoaWxkKHN0eWxlKTtcbiAgICBib2R5LmFwcGVuZENoaWxkKGRpdik7XG5cbiAgICBpZiAoc3R5bGUuc3R5bGVTaGVldCkge1xuICAgICAgc3R5bGUuc3R5bGVTaGVldC5jc3NUZXh0ID0gcnVsZTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3R5bGUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUocnVsZSkpO1xuICAgIH1cbiAgICBkaXYuaWQgPSBtb2Q7XG5cbiAgICBpZiAoYm9keS5mYWtlKSB7XG4gICAgICAvL2F2b2lkIGNyYXNoaW5nIElFOCwgaWYgYmFja2dyb3VuZCBpbWFnZSBpcyB1c2VkXG4gICAgICBib2R5LnN0eWxlLmJhY2tncm91bmQgPSAnJztcbiAgICAgIC8vU2FmYXJpIDUuMTMvNS4xLjQgT1NYIHN0b3BzIGxvYWRpbmcgaWYgOjotd2Via2l0LXNjcm9sbGJhciBpcyB1c2VkIGFuZCBzY3JvbGxiYXJzIGFyZSB2aXNpYmxlXG4gICAgICBib2R5LnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7XG4gICAgICBkb2NPdmVyZmxvdyA9IGRvY0VsZW1lbnQuc3R5bGUub3ZlcmZsb3c7XG4gICAgICBkb2NFbGVtZW50LnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7XG4gICAgICBkb2NFbGVtZW50LmFwcGVuZENoaWxkKGJvZHkpO1xuICAgIH1cblxuICAgIHJldCA9IGNhbGxiYWNrKGRpdiwgcnVsZSk7XG4gICAgLy8gSWYgdGhpcyBpcyBkb25lIGFmdGVyIHBhZ2UgbG9hZCB3ZSBkb24ndCB3YW50IHRvIHJlbW92ZSB0aGUgYm9keSBzbyBjaGVjayBpZiBib2R5IGV4aXN0c1xuICAgIGlmIChib2R5LmZha2UpIHtcbiAgICAgIGJvZHkucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChib2R5KTtcbiAgICAgIGRvY0VsZW1lbnQuc3R5bGUub3ZlcmZsb3cgPSBkb2NPdmVyZmxvdztcbiAgICAgIC8vIFRyaWdnZXIgbGF5b3V0IHNvIGtpbmV0aWMgc2Nyb2xsaW5nIGlzbid0IGRpc2FibGVkIGluIGlPUzYrXG4gICAgICBkb2NFbGVtZW50Lm9mZnNldEhlaWdodDtcbiAgICB9IGVsc2Uge1xuICAgICAgZGl2LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZGl2KTtcbiAgICB9XG5cbiAgICByZXR1cm4gISFyZXQ7XG5cbiAgfVxuXG4gIDtcblxuICAvKipcbiAgICogdGVzdFN0eWxlcyBpbmplY3RzIGFuIGVsZW1lbnQgd2l0aCBzdHlsZSBlbGVtZW50IGFuZCBzb21lIENTUyBydWxlc1xuICAgKlxuICAgKiBAbWVtYmVyb2YgTW9kZXJuaXpyXG4gICAqIEBuYW1lIE1vZGVybml6ci50ZXN0U3R5bGVzXG4gICAqIEBvcHRpb25OYW1lIE1vZGVybml6ci50ZXN0U3R5bGVzKClcbiAgICogQG9wdGlvblByb3AgdGVzdFN0eWxlc1xuICAgKiBAYWNjZXNzIHB1YmxpY1xuICAgKiBAZnVuY3Rpb24gdGVzdFN0eWxlc1xuICAgKiBAcGFyYW0ge3N0cmluZ30gcnVsZSAtIFN0cmluZyByZXByZXNlbnRpbmcgYSBjc3MgcnVsZVxuICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjayAtIEEgZnVuY3Rpb24gdGhhdCBpcyB1c2VkIHRvIHRlc3QgdGhlIGluamVjdGVkIGVsZW1lbnRcbiAgICogQHBhcmFtIHtudW1iZXJ9IFtub2Rlc10gLSBBbiBpbnRlZ2VyIHJlcHJlc2VudGluZyB0aGUgbnVtYmVyIG9mIGFkZGl0aW9uYWwgbm9kZXMgeW91IHdhbnQgaW5qZWN0ZWRcbiAgICogQHBhcmFtIHtzdHJpbmdbXX0gW3Rlc3RuYW1lc10gLSBBbiBhcnJheSBvZiBzdHJpbmdzIHRoYXQgYXJlIHVzZWQgYXMgaWRzIGZvciB0aGUgYWRkaXRpb25hbCBub2Rlc1xuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogYE1vZGVybml6ci50ZXN0U3R5bGVzYCB0YWtlcyBhIENTUyBydWxlIGFuZCBpbmplY3RzIGl0IG9udG8gdGhlIGN1cnJlbnQgcGFnZVxuICAgKiBhbG9uZyB3aXRoIChwb3NzaWJseSBtdWx0aXBsZSkgRE9NIGVsZW1lbnRzLiBUaGlzIGxldHMgeW91IGNoZWNrIGZvciBmZWF0dXJlc1xuICAgKiB0aGF0IGNhbiBub3QgYmUgZGV0ZWN0ZWQgYnkgc2ltcGx5IGNoZWNraW5nIHRoZSBbSURMXShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL01vemlsbGEvRGV2ZWxvcGVyX2d1aWRlL0ludGVyZmFjZV9kZXZlbG9wbWVudF9ndWlkZS9JRExfaW50ZXJmYWNlX3J1bGVzKS5cbiAgICpcbiAgICogYGBganNcbiAgICogTW9kZXJuaXpyLnRlc3RTdHlsZXMoJyNtb2Rlcm5penIgeyB3aWR0aDogOXB4OyBjb2xvcjogcGFwYXlhd2hpcDsgfScsIGZ1bmN0aW9uKGVsZW0sIHJ1bGUpIHtcbiAgICogICAvLyBlbGVtIGlzIHRoZSBmaXJzdCBET00gbm9kZSBpbiB0aGUgcGFnZSAoYnkgZGVmYXVsdCAjbW9kZXJuaXpyKVxuICAgKiAgIC8vIHJ1bGUgaXMgdGhlIGZpcnN0IGFyZ3VtZW50IHlvdSBzdXBwbGllZCAtIHRoZSBDU1MgcnVsZSBpbiBzdHJpbmcgZm9ybVxuICAgKlxuICAgKiAgIGFkZFRlc3QoJ3dpZHRod29ya3MnLCBlbGVtLnN0eWxlLndpZHRoID09PSAnOXB4JylcbiAgICogfSk7XG4gICAqIGBgYFxuICAgKlxuICAgKiBJZiB5b3VyIHRlc3QgcmVxdWlyZXMgbXVsdGlwbGUgbm9kZXMsIHlvdSBjYW4gaW5jbHVkZSBhIHRoaXJkIGFyZ3VtZW50XG4gICAqIGluZGljYXRpbmcgaG93IG1hbnkgYWRkaXRpb25hbCBkaXYgZWxlbWVudHMgdG8gaW5jbHVkZSBvbiB0aGUgcGFnZS4gVGhlXG4gICAqIGFkZGl0aW9uYWwgbm9kZXMgYXJlIGluamVjdGVkIGFzIGNoaWxkcmVuIG9mIHRoZSBgZWxlbWAgdGhhdCBpcyByZXR1cm5lZCBhc1xuICAgKiB0aGUgZmlyc3QgYXJndW1lbnQgdG8gdGhlIGNhbGxiYWNrLlxuICAgKlxuICAgKiBgYGBqc1xuICAgKiBNb2Rlcm5penIudGVzdFN0eWxlcygnI21vZGVybml6ciB7d2lkdGg6IDFweH07ICNtb2Rlcm5penIyIHt3aWR0aDogMnB4fScsIGZ1bmN0aW9uKGVsZW0pIHtcbiAgICogICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kZXJuaXpyJykuc3R5bGUud2lkdGggPT09ICcxcHgnOyAvLyB0cnVlXG4gICAqICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGVybml6cjInKS5zdHlsZS53aWR0aCA9PT0gJzJweCc7IC8vIHRydWVcbiAgICogICBlbGVtLmZpcnN0Q2hpbGQgPT09IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2Rlcm5penIyJyk7IC8vIHRydWVcbiAgICogfSwgMSk7XG4gICAqIGBgYFxuICAgKlxuICAgKiBCeSBkZWZhdWx0LCBhbGwgb2YgdGhlIGFkZGl0aW9uYWwgZWxlbWVudHMgaGF2ZSBhbiBJRCBvZiBgbW9kZXJuaXpyW25dYCwgd2hlcmVcbiAgICogYG5gIGlzIGl0cyBpbmRleCAoZS5nLiB0aGUgZmlyc3QgYWRkaXRpb25hbCwgc2Vjb25kIG92ZXJhbGwgaXMgYCNtb2Rlcm5penIyYCxcbiAgICogdGhlIHNlY29uZCBhZGRpdGlvbmFsIGlzIGAjbW9kZXJuaXpyM2AsIGV0Yy4pLlxuICAgKiBJZiB5b3Ugd2FudCB0byBoYXZlIG1vcmUgbWVhbmluZ2Z1bCBJRHMgZm9yIHlvdXIgZnVuY3Rpb24sIHlvdSBjYW4gcHJvdmlkZVxuICAgKiB0aGVtIGFzIHRoZSBmb3VydGggYXJndW1lbnQsIGFzIGFuIGFycmF5IG9mIHN0cmluZ3NcbiAgICpcbiAgICogYGBganNcbiAgICogTW9kZXJuaXpyLnRlc3RTdHlsZXMoJyNmb28ge3dpZHRoOiAxMHB4fTsgI2JhciB7aGVpZ2h0OiAyMHB4fScsIGZ1bmN0aW9uKGVsZW0pIHtcbiAgICogICBlbGVtLmZpcnN0Q2hpbGQgPT09IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb28nKTsgLy8gdHJ1ZVxuICAgKiAgIGVsZW0ubGFzdENoaWxkID09PSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmFyJyk7IC8vIHRydWVcbiAgICogfSwgMiwgWydmb28nLCAnYmFyJ10pO1xuICAgKiBgYGBcbiAgICpcbiAgICovXG5cbiAgdmFyIHRlc3RTdHlsZXMgPSBNb2Rlcm5penJQcm90by50ZXN0U3R5bGVzID0gaW5qZWN0RWxlbWVudFdpdGhTdHlsZXM7XG5cblxuICAvKipcbiAgICogSWYgdGhlIGJyb3dzZXJzIGZvbGxvdyB0aGUgc3BlYywgdGhlbiB0aGV5IHdvdWxkIGV4cG9zZSB2ZW5kb3Itc3BlY2lmaWMgc3R5bGUgYXM6XG4gICAqICAgZWxlbS5zdHlsZS5XZWJraXRCb3JkZXJSYWRpdXNcbiAgICogaW5zdGVhZCBvZiBzb21ldGhpbmcgbGlrZSB0aGUgZm9sbG93aW5nLCB3aGljaCB3b3VsZCBiZSB0ZWNobmljYWxseSBpbmNvcnJlY3Q6XG4gICAqICAgZWxlbS5zdHlsZS53ZWJraXRCb3JkZXJSYWRpdXNcblxuICAgKiBXZWJraXQgZ2hvc3RzIHRoZWlyIHByb3BlcnRpZXMgaW4gbG93ZXJjYXNlIGJ1dCBPcGVyYSAmIE1veiBkbyBub3QuXG4gICAqIE1pY3Jvc29mdCB1c2VzIGEgbG93ZXJjYXNlIGBtc2AgaW5zdGVhZCBvZiB0aGUgY29ycmVjdCBgTXNgIGluIElFOCtcbiAgICogICBlcmlrLmVhZS5uZXQvYXJjaGl2ZXMvMjAwOC8wMy8xMC8yMS40OC4xMC9cblxuICAgKiBNb3JlIGhlcmU6IGdpdGh1Yi5jb20vTW9kZXJuaXpyL01vZGVybml6ci9pc3N1ZXMvaXNzdWUvMjFcbiAgICpcbiAgICogQGFjY2VzcyBwcml2YXRlXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSB2ZW5kb3Itc3BlY2lmaWMgc3R5bGUgcHJvcGVydGllc1xuICAgKi9cblxuICB2YXIgb21QcmVmaXhlcyA9ICdNb3ogTyBtcyBXZWJraXQnO1xuXG5cbiAgdmFyIGNzc29tUHJlZml4ZXMgPSAoTW9kZXJuaXpyUHJvdG8uX2NvbmZpZy51c2VQcmVmaXhlcyA/IG9tUHJlZml4ZXMuc3BsaXQoJyAnKSA6IFtdKTtcbiAgTW9kZXJuaXpyUHJvdG8uX2Nzc29tUHJlZml4ZXMgPSBjc3NvbVByZWZpeGVzO1xuXG5cbiAgLyoqXG4gICAqIExpc3Qgb2YgSmF2YVNjcmlwdCBET00gdmFsdWVzIHVzZWQgZm9yIHRlc3RzXG4gICAqXG4gICAqIEBtZW1iZXJvZiBNb2Rlcm5penJcbiAgICogQG5hbWUgTW9kZXJuaXpyLl9kb21QcmVmaXhlc1xuICAgKiBAb3B0aW9uTmFtZSBNb2Rlcm5penIuX2RvbVByZWZpeGVzXG4gICAqIEBvcHRpb25Qcm9wIGRvbVByZWZpeGVzXG4gICAqIEBhY2Nlc3MgcHVibGljXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIE1vZGVybml6ci5fZG9tUHJlZml4ZXMgaXMgZXhhY3RseSB0aGUgc2FtZSBhcyBbX3ByZWZpeGVzXSgjbW9kZXJuaXpyLV9wcmVmaXhlcyksIGJ1dCByYXRoZXJcbiAgICogdGhhbiBrZWJhYi1jYXNlIHByb3BlcnRpZXMsIGFsbCBwcm9wZXJ0aWVzIGFyZSB0aGVpciBDYXBpdGFsaXplZCB2YXJpYW50XG4gICAqXG4gICAqIGBgYGpzXG4gICAqIE1vZGVybml6ci5fZG9tUHJlZml4ZXMgPT09IFsgXCJNb3pcIiwgXCJPXCIsIFwibXNcIiwgXCJXZWJraXRcIiBdO1xuICAgKiBgYGBcbiAgICovXG5cbiAgdmFyIGRvbVByZWZpeGVzID0gKE1vZGVybml6clByb3RvLl9jb25maWcudXNlUHJlZml4ZXMgPyBvbVByZWZpeGVzLnRvTG93ZXJDYXNlKCkuc3BsaXQoJyAnKSA6IFtdKTtcbiAgTW9kZXJuaXpyUHJvdG8uX2RvbVByZWZpeGVzID0gZG9tUHJlZml4ZXM7XG5cblxuXG4gIC8qKlxuICAgKiBjb250YWlucyBjaGVja3MgdG8gc2VlIGlmIGEgc3RyaW5nIGNvbnRhaW5zIGFub3RoZXIgc3RyaW5nXG4gICAqXG4gICAqIEBhY2Nlc3MgcHJpdmF0ZVxuICAgKiBAZnVuY3Rpb24gY29udGFpbnNcbiAgICogQHBhcmFtIHtzdHJpbmd9IHN0ciAtIFRoZSBzdHJpbmcgd2Ugd2FudCB0byBjaGVjayBmb3Igc3Vic3RyaW5nc1xuICAgKiBAcGFyYW0ge3N0cmluZ30gc3Vic3RyIC0gVGhlIHN1YnN0cmluZyB3ZSB3YW50IHRvIHNlYXJjaCB0aGUgZmlyc3Qgc3RyaW5nIGZvclxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICovXG5cbiAgZnVuY3Rpb24gY29udGFpbnMoc3RyLCBzdWJzdHIpIHtcbiAgICByZXR1cm4gISF+KCcnICsgc3RyKS5pbmRleE9mKHN1YnN0cik7XG4gIH1cblxuICA7XG5cbiAgLyoqXG4gICAqIGNzc1RvRE9NIHRha2VzIGEga2ViYWItY2FzZSBzdHJpbmcgYW5kIGNvbnZlcnRzIGl0IHRvIGNhbWVsQ2FzZVxuICAgKiBlLmcuIGJveC1zaXppbmcgLT4gYm94U2l6aW5nXG4gICAqXG4gICAqIEBhY2Nlc3MgcHJpdmF0ZVxuICAgKiBAZnVuY3Rpb24gY3NzVG9ET01cbiAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgLSBTdHJpbmcgbmFtZSBvZiBrZWJhYi1jYXNlIHByb3Agd2Ugd2FudCB0byBjb252ZXJ0XG4gICAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSBjYW1lbENhc2UgdmVyc2lvbiBvZiB0aGUgc3VwcGxpZWQgbmFtZVxuICAgKi9cblxuICBmdW5jdGlvbiBjc3NUb0RPTShuYW1lKSB7XG4gICAgcmV0dXJuIG5hbWUucmVwbGFjZSgvKFthLXpdKS0oW2Etel0pL2csIGZ1bmN0aW9uKHN0ciwgbTEsIG0yKSB7XG4gICAgICByZXR1cm4gbTEgKyBtMi50b1VwcGVyQ2FzZSgpO1xuICAgIH0pLnJlcGxhY2UoL14tLywgJycpO1xuICB9XG4gIDtcblxuICAvKipcbiAgICogZm5CaW5kIGlzIGEgc3VwZXIgc21hbGwgW2JpbmRdKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0Z1bmN0aW9uL2JpbmQpIHBvbHlmaWxsLlxuICAgKlxuICAgKiBAYWNjZXNzIHByaXZhdGVcbiAgICogQGZ1bmN0aW9uIGZuQmluZFxuICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBmbiAtIGEgZnVuY3Rpb24geW91IHdhbnQgdG8gY2hhbmdlIGB0aGlzYCByZWZlcmVuY2UgdG9cbiAgICogQHBhcmFtIHtvYmplY3R9IHRoYXQgLSB0aGUgYHRoaXNgIHlvdSB3YW50IHRvIGNhbGwgdGhlIGZ1bmN0aW9uIHdpdGhcbiAgICogQHJldHVybnMge2Z1bmN0aW9ufSBUaGUgd3JhcHBlZCB2ZXJzaW9uIG9mIHRoZSBzdXBwbGllZCBmdW5jdGlvblxuICAgKi9cblxuICBmdW5jdGlvbiBmbkJpbmQoZm4sIHRoYXQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZm4uYXBwbHkodGhhdCwgYXJndW1lbnRzKTtcbiAgICB9O1xuICB9XG5cbiAgO1xuXG4gIC8qKlxuICAgKiB0ZXN0RE9NUHJvcHMgaXMgYSBnZW5lcmljIERPTSBwcm9wZXJ0eSB0ZXN0OyBpZiBhIGJyb3dzZXIgc3VwcG9ydHNcbiAgICogICBhIGNlcnRhaW4gcHJvcGVydHksIGl0IHdvbid0IHJldHVybiB1bmRlZmluZWQgZm9yIGl0LlxuICAgKlxuICAgKiBAYWNjZXNzIHByaXZhdGVcbiAgICogQGZ1bmN0aW9uIHRlc3RET01Qcm9wc1xuICAgKiBAcGFyYW0ge2FycmF5LjxzdHJpbmc+fSBwcm9wcyAtIEFuIGFycmF5IG9mIHByb3BlcnRpZXMgdG8gdGVzdCBmb3JcbiAgICogQHBhcmFtIHtvYmplY3R9IG9iaiAtIEFuIG9iamVjdCBvciBFbGVtZW50IHlvdSB3YW50IHRvIHVzZSB0byB0ZXN0IHRoZSBwYXJhbWV0ZXJzIGFnYWluXG4gICAqIEBwYXJhbSB7Ym9vbGVhbnxvYmplY3R9IGVsZW0gLSBBbiBFbGVtZW50IHRvIGJpbmQgdGhlIHByb3BlcnR5IGxvb2t1cCBhZ2Fpbi4gVXNlIGBmYWxzZWAgdG8gcHJldmVudCB0aGUgY2hlY2tcbiAgICovXG4gIGZ1bmN0aW9uIHRlc3RET01Qcm9wcyhwcm9wcywgb2JqLCBlbGVtKSB7XG4gICAgdmFyIGl0ZW07XG5cbiAgICBmb3IgKHZhciBpIGluIHByb3BzKSB7XG4gICAgICBpZiAocHJvcHNbaV0gaW4gb2JqKSB7XG5cbiAgICAgICAgLy8gcmV0dXJuIHRoZSBwcm9wZXJ0eSBuYW1lIGFzIGEgc3RyaW5nXG4gICAgICAgIGlmIChlbGVtID09PSBmYWxzZSkge1xuICAgICAgICAgIHJldHVybiBwcm9wc1tpXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGl0ZW0gPSBvYmpbcHJvcHNbaV1dO1xuXG4gICAgICAgIC8vIGxldCdzIGJpbmQgYSBmdW5jdGlvblxuICAgICAgICBpZiAoaXMoaXRlbSwgJ2Z1bmN0aW9uJykpIHtcbiAgICAgICAgICAvLyBiaW5kIHRvIG9iaiB1bmxlc3Mgb3ZlcnJpZGVuXG4gICAgICAgICAgcmV0dXJuIGZuQmluZChpdGVtLCBlbGVtIHx8IG9iaik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyByZXR1cm4gdGhlIHVuYm91bmQgZnVuY3Rpb24gb3Igb2JqIG9yIHZhbHVlXG4gICAgICAgIHJldHVybiBpdGVtO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICA7XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBvdXIgXCJtb2Rlcm5penJcIiBlbGVtZW50IHRoYXQgd2UgZG8gbW9zdCBmZWF0dXJlIHRlc3RzIG9uLlxuICAgKlxuICAgKiBAYWNjZXNzIHByaXZhdGVcbiAgICovXG5cbiAgdmFyIG1vZEVsZW0gPSB7XG4gICAgZWxlbTogY3JlYXRlRWxlbWVudCgnbW9kZXJuaXpyJylcbiAgfTtcblxuICAvLyBDbGVhbiB1cCB0aGlzIGVsZW1lbnRcbiAgTW9kZXJuaXpyLl9xLnB1c2goZnVuY3Rpb24oKSB7XG4gICAgZGVsZXRlIG1vZEVsZW0uZWxlbTtcbiAgfSk7XG5cblxuXG4gIHZhciBtU3R5bGUgPSB7XG4gICAgc3R5bGU6IG1vZEVsZW0uZWxlbS5zdHlsZVxuICB9O1xuXG4gIC8vIGtpbGwgcmVmIGZvciBnYywgbXVzdCBoYXBwZW4gYmVmb3JlIG1vZC5lbGVtIGlzIHJlbW92ZWQsIHNvIHdlIHVuc2hpZnQgb24gdG9cbiAgLy8gdGhlIGZyb250IG9mIHRoZSBxdWV1ZS5cbiAgTW9kZXJuaXpyLl9xLnVuc2hpZnQoZnVuY3Rpb24oKSB7XG4gICAgZGVsZXRlIG1TdHlsZS5zdHlsZTtcbiAgfSk7XG5cblxuXG4gIC8qKlxuICAgKiBkb21Ub0NTUyB0YWtlcyBhIGNhbWVsQ2FzZSBzdHJpbmcgYW5kIGNvbnZlcnRzIGl0IHRvIGtlYmFiLWNhc2VcbiAgICogZS5nLiBib3hTaXppbmcgLT4gYm94LXNpemluZ1xuICAgKlxuICAgKiBAYWNjZXNzIHByaXZhdGVcbiAgICogQGZ1bmN0aW9uIGRvbVRvQ1NTXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIC0gU3RyaW5nIG5hbWUgb2YgY2FtZWxDYXNlIHByb3Agd2Ugd2FudCB0byBjb252ZXJ0XG4gICAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSBrZWJhYi1jYXNlIHZlcnNpb24gb2YgdGhlIHN1cHBsaWVkIG5hbWVcbiAgICovXG5cbiAgZnVuY3Rpb24gZG9tVG9DU1MobmFtZSkge1xuICAgIHJldHVybiBuYW1lLnJlcGxhY2UoLyhbQS1aXSkvZywgZnVuY3Rpb24oc3RyLCBtMSkge1xuICAgICAgcmV0dXJuICctJyArIG0xLnRvTG93ZXJDYXNlKCk7XG4gICAgfSkucmVwbGFjZSgvXm1zLS8sICctbXMtJyk7XG4gIH1cbiAgO1xuXG4gIC8qKlxuICAgKiBuYXRpdmVUZXN0UHJvcHMgYWxsb3dzIGZvciB1cyB0byB1c2UgbmF0aXZlIGZlYXR1cmUgZGV0ZWN0aW9uIGZ1bmN0aW9uYWxpdHkgaWYgYXZhaWxhYmxlLlxuICAgKiBzb21lIHByZWZpeGVkIGZvcm0sIG9yIGZhbHNlLCBpbiB0aGUgY2FzZSBvZiBhbiB1bnN1cHBvcnRlZCBydWxlXG4gICAqXG4gICAqIEBhY2Nlc3MgcHJpdmF0ZVxuICAgKiBAZnVuY3Rpb24gbmF0aXZlVGVzdFByb3BzXG4gICAqIEBwYXJhbSB7YXJyYXl9IHByb3BzIC0gQW4gYXJyYXkgb2YgcHJvcGVydHkgbmFtZXNcbiAgICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlIC0gQSBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSB2YWx1ZSB3ZSB3YW50IHRvIGNoZWNrIHZpYSBAc3VwcG9ydHNcbiAgICogQHJldHVybnMge2Jvb2xlYW58dW5kZWZpbmVkfSBBIGJvb2xlYW4gd2hlbiBAc3VwcG9ydHMgZXhpc3RzLCB1bmRlZmluZWQgb3RoZXJ3aXNlXG4gICAqL1xuXG4gIC8vIEFjY2VwdHMgYSBsaXN0IG9mIHByb3BlcnR5IG5hbWVzIGFuZCBhIHNpbmdsZSB2YWx1ZVxuICAvLyBSZXR1cm5zIGB1bmRlZmluZWRgIGlmIG5hdGl2ZSBkZXRlY3Rpb24gbm90IGF2YWlsYWJsZVxuICBmdW5jdGlvbiBuYXRpdmVUZXN0UHJvcHMocHJvcHMsIHZhbHVlKSB7XG4gICAgdmFyIGkgPSBwcm9wcy5sZW5ndGg7XG4gICAgLy8gU3RhcnQgd2l0aCB0aGUgSlMgQVBJOiBodHRwOi8vd3d3LnczLm9yZy9UUi9jc3MzLWNvbmRpdGlvbmFsLyN0aGUtY3NzLWludGVyZmFjZVxuICAgIGlmICgnQ1NTJyBpbiB3aW5kb3cgJiYgJ3N1cHBvcnRzJyBpbiB3aW5kb3cuQ1NTKSB7XG4gICAgICAvLyBUcnkgZXZlcnkgcHJlZml4ZWQgdmFyaWFudCBvZiB0aGUgcHJvcGVydHlcbiAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgaWYgKHdpbmRvdy5DU1Muc3VwcG9ydHMoZG9tVG9DU1MocHJvcHNbaV0pLCB2YWx1ZSkpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICAvLyBPdGhlcndpc2UgZmFsbCBiYWNrIHRvIGF0LXJ1bGUgKGZvciBPcGVyYSAxMi54KVxuICAgIGVsc2UgaWYgKCdDU1NTdXBwb3J0c1J1bGUnIGluIHdpbmRvdykge1xuICAgICAgLy8gQnVpbGQgYSBjb25kaXRpb24gc3RyaW5nIGZvciBldmVyeSBwcmVmaXhlZCB2YXJpYW50XG4gICAgICB2YXIgY29uZGl0aW9uVGV4dCA9IFtdO1xuICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICBjb25kaXRpb25UZXh0LnB1c2goJygnICsgZG9tVG9DU1MocHJvcHNbaV0pICsgJzonICsgdmFsdWUgKyAnKScpO1xuICAgICAgfVxuICAgICAgY29uZGl0aW9uVGV4dCA9IGNvbmRpdGlvblRleHQuam9pbignIG9yICcpO1xuICAgICAgcmV0dXJuIGluamVjdEVsZW1lbnRXaXRoU3R5bGVzKCdAc3VwcG9ydHMgKCcgKyBjb25kaXRpb25UZXh0ICsgJykgeyAjbW9kZXJuaXpyIHsgcG9zaXRpb246IGFic29sdXRlOyB9IH0nLCBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIHJldHVybiBnZXRDb21wdXRlZFN0eWxlKG5vZGUsIG51bGwpLnBvc2l0aW9uID09ICdhYnNvbHV0ZSc7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICA7XG5cbiAgLy8gdGVzdFByb3BzIGlzIGEgZ2VuZXJpYyBDU1MgLyBET00gcHJvcGVydHkgdGVzdC5cblxuICAvLyBJbiB0ZXN0aW5nIHN1cHBvcnQgZm9yIGEgZ2l2ZW4gQ1NTIHByb3BlcnR5LCBpdCdzIGxlZ2l0IHRvIHRlc3Q6XG4gIC8vICAgIGBlbGVtLnN0eWxlW3N0eWxlTmFtZV0gIT09IHVuZGVmaW5lZGBcbiAgLy8gSWYgdGhlIHByb3BlcnR5IGlzIHN1cHBvcnRlZCBpdCB3aWxsIHJldHVybiBhbiBlbXB0eSBzdHJpbmcsXG4gIC8vIGlmIHVuc3VwcG9ydGVkIGl0IHdpbGwgcmV0dXJuIHVuZGVmaW5lZC5cblxuICAvLyBXZSdsbCB0YWtlIGFkdmFudGFnZSBvZiB0aGlzIHF1aWNrIHRlc3QgYW5kIHNraXAgc2V0dGluZyBhIHN0eWxlXG4gIC8vIG9uIG91ciBtb2Rlcm5penIgZWxlbWVudCwgYnV0IGluc3RlYWQganVzdCB0ZXN0aW5nIHVuZGVmaW5lZCB2c1xuICAvLyBlbXB0eSBzdHJpbmcuXG5cbiAgLy8gUHJvcGVydHkgbmFtZXMgY2FuIGJlIHByb3ZpZGVkIGluIGVpdGhlciBjYW1lbENhc2Ugb3Iga2ViYWItY2FzZS5cblxuICBmdW5jdGlvbiB0ZXN0UHJvcHMocHJvcHMsIHByZWZpeGVkLCB2YWx1ZSwgc2tpcFZhbHVlVGVzdCkge1xuICAgIHNraXBWYWx1ZVRlc3QgPSBpcyhza2lwVmFsdWVUZXN0LCAndW5kZWZpbmVkJykgPyBmYWxzZSA6IHNraXBWYWx1ZVRlc3Q7XG5cbiAgICAvLyBUcnkgbmF0aXZlIGRldGVjdCBmaXJzdFxuICAgIGlmICghaXModmFsdWUsICd1bmRlZmluZWQnKSkge1xuICAgICAgdmFyIHJlc3VsdCA9IG5hdGl2ZVRlc3RQcm9wcyhwcm9wcywgdmFsdWUpO1xuICAgICAgaWYgKCFpcyhyZXN1bHQsICd1bmRlZmluZWQnKSkge1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIE90aGVyd2lzZSBkbyBpdCBwcm9wZXJseVxuICAgIHZhciBhZnRlckluaXQsIGksIHByb3BzTGVuZ3RoLCBwcm9wLCBiZWZvcmU7XG5cbiAgICAvLyBJZiB3ZSBkb24ndCBoYXZlIGEgc3R5bGUgZWxlbWVudCwgdGhhdCBtZWFucyB3ZSdyZSBydW5uaW5nIGFzeW5jIG9yIGFmdGVyXG4gICAgLy8gdGhlIGNvcmUgdGVzdHMsIHNvIHdlJ2xsIG5lZWQgdG8gY3JlYXRlIG91ciBvd24gZWxlbWVudHMgdG8gdXNlXG5cbiAgICAvLyBpbnNpZGUgb2YgYW4gU1ZHIGVsZW1lbnQsIGluIGNlcnRhaW4gYnJvd3NlcnMsIHRoZSBgc3R5bGVgIGVsZW1lbnQgaXMgb25seVxuICAgIC8vIGRlZmluZWQgZm9yIHZhbGlkIHRhZ3MuIFRoZXJlZm9yZSwgaWYgYG1vZGVybml6cmAgZG9lcyBub3QgaGF2ZSBvbmUsIHdlXG4gICAgLy8gZmFsbCBiYWNrIHRvIGEgbGVzcyB1c2VkIGVsZW1lbnQgYW5kIGhvcGUgZm9yIHRoZSBiZXN0LlxuICAgIHZhciBlbGVtcyA9IFsnbW9kZXJuaXpyJywgJ3RzcGFuJ107XG4gICAgd2hpbGUgKCFtU3R5bGUuc3R5bGUpIHtcbiAgICAgIGFmdGVySW5pdCA9IHRydWU7XG4gICAgICBtU3R5bGUubW9kRWxlbSA9IGNyZWF0ZUVsZW1lbnQoZWxlbXMuc2hpZnQoKSk7XG4gICAgICBtU3R5bGUuc3R5bGUgPSBtU3R5bGUubW9kRWxlbS5zdHlsZTtcbiAgICB9XG5cbiAgICAvLyBEZWxldGUgdGhlIG9iamVjdHMgaWYgd2UgY3JlYXRlZCB0aGVtLlxuICAgIGZ1bmN0aW9uIGNsZWFuRWxlbXMoKSB7XG4gICAgICBpZiAoYWZ0ZXJJbml0KSB7XG4gICAgICAgIGRlbGV0ZSBtU3R5bGUuc3R5bGU7XG4gICAgICAgIGRlbGV0ZSBtU3R5bGUubW9kRWxlbTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBwcm9wc0xlbmd0aCA9IHByb3BzLmxlbmd0aDtcbiAgICBmb3IgKGkgPSAwOyBpIDwgcHJvcHNMZW5ndGg7IGkrKykge1xuICAgICAgcHJvcCA9IHByb3BzW2ldO1xuICAgICAgYmVmb3JlID0gbVN0eWxlLnN0eWxlW3Byb3BdO1xuXG4gICAgICBpZiAoY29udGFpbnMocHJvcCwgJy0nKSkge1xuICAgICAgICBwcm9wID0gY3NzVG9ET00ocHJvcCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChtU3R5bGUuc3R5bGVbcHJvcF0gIT09IHVuZGVmaW5lZCkge1xuXG4gICAgICAgIC8vIElmIHZhbHVlIHRvIHRlc3QgaGFzIGJlZW4gcGFzc2VkIGluLCBkbyBhIHNldC1hbmQtY2hlY2sgdGVzdC5cbiAgICAgICAgLy8gMCAoaW50ZWdlcikgaXMgYSB2YWxpZCBwcm9wZXJ0eSB2YWx1ZSwgc28gY2hlY2sgdGhhdCBgdmFsdWVgIGlzbid0XG4gICAgICAgIC8vIHVuZGVmaW5lZCwgcmF0aGVyIHRoYW4ganVzdCBjaGVja2luZyBpdCdzIHRydXRoeS5cbiAgICAgICAgaWYgKCFza2lwVmFsdWVUZXN0ICYmICFpcyh2YWx1ZSwgJ3VuZGVmaW5lZCcpKSB7XG5cbiAgICAgICAgICAvLyBOZWVkcyBhIHRyeSBjYXRjaCBibG9jayBiZWNhdXNlIG9mIG9sZCBJRS4gVGhpcyBpcyBzbG93LCBidXQgd2lsbFxuICAgICAgICAgIC8vIGJlIGF2b2lkZWQgaW4gbW9zdCBjYXNlcyBiZWNhdXNlIGBza2lwVmFsdWVUZXN0YCB3aWxsIGJlIHVzZWQuXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIG1TdHlsZS5zdHlsZVtwcm9wXSA9IHZhbHVlO1xuICAgICAgICAgIH0gY2F0Y2ggKGUpIHt9XG5cbiAgICAgICAgICAvLyBJZiB0aGUgcHJvcGVydHkgdmFsdWUgaGFzIGNoYW5nZWQsIHdlIGFzc3VtZSB0aGUgdmFsdWUgdXNlZCBpc1xuICAgICAgICAgIC8vIHN1cHBvcnRlZC4gSWYgYHZhbHVlYCBpcyBlbXB0eSBzdHJpbmcsIGl0J2xsIGZhaWwgaGVyZSAoYmVjYXVzZVxuICAgICAgICAgIC8vIGl0IGhhc24ndCBjaGFuZ2VkKSwgd2hpY2ggbWF0Y2hlcyBob3cgYnJvd3NlcnMgaGF2ZSBpbXBsZW1lbnRlZFxuICAgICAgICAgIC8vIENTUy5zdXBwb3J0cygpXG4gICAgICAgICAgaWYgKG1TdHlsZS5zdHlsZVtwcm9wXSAhPSBiZWZvcmUpIHtcbiAgICAgICAgICAgIGNsZWFuRWxlbXMoKTtcbiAgICAgICAgICAgIHJldHVybiBwcmVmaXhlZCA9PSAncGZ4JyA/IHByb3AgOiB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBPdGhlcndpc2UganVzdCByZXR1cm4gdHJ1ZSwgb3IgdGhlIHByb3BlcnR5IG5hbWUgaWYgdGhpcyBpcyBhXG4gICAgICAgIC8vIGBwcmVmaXhlZCgpYCBjYWxsXG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIGNsZWFuRWxlbXMoKTtcbiAgICAgICAgICByZXR1cm4gcHJlZml4ZWQgPT0gJ3BmeCcgPyBwcm9wIDogdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBjbGVhbkVsZW1zKCk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgO1xuXG4gIC8qKlxuICAgKiB0ZXN0UHJvcHNBbGwgdGVzdHMgYSBsaXN0IG9mIERPTSBwcm9wZXJ0aWVzIHdlIHdhbnQgdG8gY2hlY2sgYWdhaW5zdC5cbiAgICogV2Ugc3BlY2lmeSBsaXRlcmFsbHkgQUxMIHBvc3NpYmxlIChrbm93biBhbmQvb3IgbGlrZWx5KSBwcm9wZXJ0aWVzIG9uXG4gICAqIHRoZSBlbGVtZW50IGluY2x1ZGluZyB0aGUgbm9uLXZlbmRvciBwcmVmaXhlZCBvbmUsIGZvciBmb3J3YXJkLVxuICAgKiBjb21wYXRpYmlsaXR5LlxuICAgKlxuICAgKiBAYWNjZXNzIHByaXZhdGVcbiAgICogQGZ1bmN0aW9uIHRlc3RQcm9wc0FsbFxuICAgKiBAcGFyYW0ge3N0cmluZ30gcHJvcCAtIEEgc3RyaW5nIG9mIHRoZSBwcm9wZXJ0eSB0byB0ZXN0IGZvclxuICAgKiBAcGFyYW0ge3N0cmluZ3xvYmplY3R9IFtwcmVmaXhlZF0gLSBBbiBvYmplY3QgdG8gY2hlY2sgdGhlIHByZWZpeGVkIHByb3BlcnRpZXMgb24uIFVzZSBhIHN0cmluZyB0byBza2lwXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR8U1ZHRWxlbWVudH0gW2VsZW1dIC0gQW4gZWxlbWVudCB1c2VkIHRvIHRlc3QgdGhlIHByb3BlcnR5IGFuZCB2YWx1ZSBhZ2FpbnN0XG4gICAqIEBwYXJhbSB7c3RyaW5nfSBbdmFsdWVdIC0gQSBzdHJpbmcgb2YgYSBjc3MgdmFsdWVcbiAgICogQHBhcmFtIHtib29sZWFufSBbc2tpcFZhbHVlVGVzdF0gLSBBbiBib29sZWFuIHJlcHJlc2VudGluZyBpZiB5b3Ugd2FudCB0byB0ZXN0IGlmIHZhbHVlIHN0aWNrcyB3aGVuIHNldFxuICAgKi9cbiAgZnVuY3Rpb24gdGVzdFByb3BzQWxsKHByb3AsIHByZWZpeGVkLCBlbGVtLCB2YWx1ZSwgc2tpcFZhbHVlVGVzdCkge1xuXG4gICAgdmFyIHVjUHJvcCA9IHByb3AuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBwcm9wLnNsaWNlKDEpLFxuICAgIHByb3BzID0gKHByb3AgKyAnICcgKyBjc3NvbVByZWZpeGVzLmpvaW4odWNQcm9wICsgJyAnKSArIHVjUHJvcCkuc3BsaXQoJyAnKTtcblxuICAgIC8vIGRpZCB0aGV5IGNhbGwgLnByZWZpeGVkKCdib3hTaXppbmcnKSBvciBhcmUgd2UganVzdCB0ZXN0aW5nIGEgcHJvcD9cbiAgICBpZiAoaXMocHJlZml4ZWQsICdzdHJpbmcnKSB8fCBpcyhwcmVmaXhlZCwgJ3VuZGVmaW5lZCcpKSB7XG4gICAgICByZXR1cm4gdGVzdFByb3BzKHByb3BzLCBwcmVmaXhlZCwgdmFsdWUsIHNraXBWYWx1ZVRlc3QpO1xuXG4gICAgICAvLyBvdGhlcndpc2UsIHRoZXkgY2FsbGVkIC5wcmVmaXhlZCgncmVxdWVzdEFuaW1hdGlvbkZyYW1lJywgd2luZG93WywgZWxlbV0pXG4gICAgfSBlbHNlIHtcbiAgICAgIHByb3BzID0gKHByb3AgKyAnICcgKyAoZG9tUHJlZml4ZXMpLmpvaW4odWNQcm9wICsgJyAnKSArIHVjUHJvcCkuc3BsaXQoJyAnKTtcbiAgICAgIHJldHVybiB0ZXN0RE9NUHJvcHMocHJvcHMsIHByZWZpeGVkLCBlbGVtKTtcbiAgICB9XG4gIH1cblxuICAvLyBNb2Rlcm5penIudGVzdEFsbFByb3BzKCkgaW52ZXN0aWdhdGVzIHdoZXRoZXIgYSBnaXZlbiBzdHlsZSBwcm9wZXJ0eSxcbiAgLy8gb3IgYW55IG9mIGl0cyB2ZW5kb3ItcHJlZml4ZWQgdmFyaWFudHMsIGlzIHJlY29nbml6ZWRcbiAgLy9cbiAgLy8gTm90ZSB0aGF0IHRoZSBwcm9wZXJ0eSBuYW1lcyBtdXN0IGJlIHByb3ZpZGVkIGluIHRoZSBjYW1lbENhc2UgdmFyaWFudC5cbiAgLy8gTW9kZXJuaXpyLnRlc3RBbGxQcm9wcygnYm94U2l6aW5nJylcbiAgTW9kZXJuaXpyUHJvdG8udGVzdEFsbFByb3BzID0gdGVzdFByb3BzQWxsO1xuXG5cblxuICAvKipcbiAgICogdGVzdEFsbFByb3BzIGRldGVybWluZXMgd2hldGhlciBhIGdpdmVuIENTUyBwcm9wZXJ0eSBpcyBzdXBwb3J0ZWQgaW4gdGhlIGJyb3dzZXJcbiAgICpcbiAgICogQG1lbWJlcm9mIE1vZGVybml6clxuICAgKiBAbmFtZSBNb2Rlcm5penIudGVzdEFsbFByb3BzXG4gICAqIEBvcHRpb25OYW1lIE1vZGVybml6ci50ZXN0QWxsUHJvcHMoKVxuICAgKiBAb3B0aW9uUHJvcCB0ZXN0QWxsUHJvcHNcbiAgICogQGFjY2VzcyBwdWJsaWNcbiAgICogQGZ1bmN0aW9uIHRlc3RBbGxQcm9wc1xuICAgKiBAcGFyYW0ge3N0cmluZ30gcHJvcCAtIFN0cmluZyBuYW1pbmcgdGhlIHByb3BlcnR5IHRvIHRlc3QgKGVpdGhlciBjYW1lbENhc2Ugb3Iga2ViYWItY2FzZSlcbiAgICogQHBhcmFtIHtzdHJpbmd9IFt2YWx1ZV0gLSBTdHJpbmcgb2YgdGhlIHZhbHVlIHRvIHRlc3RcbiAgICogQHBhcmFtIHtib29sZWFufSBbc2tpcFZhbHVlVGVzdD1mYWxzZV0gLSBXaGV0aGVyIHRvIHNraXAgdGVzdGluZyB0aGF0IHRoZSB2YWx1ZSBpcyBzdXBwb3J0ZWQgd2hlbiB1c2luZyBub24tbmF0aXZlIGRldGVjdGlvblxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiB0ZXN0QWxsUHJvcHMgZGV0ZXJtaW5lcyB3aGV0aGVyIGEgZ2l2ZW4gQ1NTIHByb3BlcnR5LCBpbiBzb21lIHByZWZpeGVkIGZvcm0sXG4gICAqIGlzIHN1cHBvcnRlZCBieSB0aGUgYnJvd3Nlci5cbiAgICpcbiAgICogYGBganNcbiAgICogdGVzdEFsbFByb3BzKCdib3hTaXppbmcnKSAgLy8gdHJ1ZVxuICAgKiBgYGBcbiAgICpcbiAgICogSXQgY2FuIG9wdGlvbmFsbHkgYmUgZ2l2ZW4gYSBDU1MgdmFsdWUgaW4gc3RyaW5nIGZvcm0gdG8gdGVzdCBpZiBhIHByb3BlcnR5XG4gICAqIHZhbHVlIGlzIHZhbGlkXG4gICAqXG4gICAqIGBgYGpzXG4gICAqIHRlc3RBbGxQcm9wcygnZGlzcGxheScsICdibG9jaycpIC8vIHRydWVcbiAgICogdGVzdEFsbFByb3BzKCdkaXNwbGF5JywgJ3Blbmd1aW4nKSAvLyBmYWxzZVxuICAgKiBgYGBcbiAgICpcbiAgICogQSBib29sZWFuIGNhbiBiZSBwYXNzZWQgYXMgYSB0aGlyZCBwYXJhbWV0ZXIgdG8gc2tpcCB0aGUgdmFsdWUgY2hlY2sgd2hlblxuICAgKiBuYXRpdmUgZGV0ZWN0aW9uIChAc3VwcG9ydHMpIGlzbid0IGF2YWlsYWJsZS5cbiAgICpcbiAgICogYGBganNcbiAgICogdGVzdEFsbFByb3BzKCdzaGFwZU91dHNpZGUnLCAnY29udGVudC1ib3gnLCB0cnVlKTtcbiAgICogYGBgXG4gICAqL1xuXG4gIGZ1bmN0aW9uIHRlc3RBbGxQcm9wcyhwcm9wLCB2YWx1ZSwgc2tpcFZhbHVlVGVzdCkge1xuICAgIHJldHVybiB0ZXN0UHJvcHNBbGwocHJvcCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHZhbHVlLCBza2lwVmFsdWVUZXN0KTtcbiAgfVxuICBNb2Rlcm5penJQcm90by50ZXN0QWxsUHJvcHMgPSB0ZXN0QWxsUHJvcHM7XG5cbi8qIVxue1xuICBcIm5hbWVcIjogXCJDU1MgQW5pbWF0aW9uc1wiLFxuICBcInByb3BlcnR5XCI6IFwiY3NzYW5pbWF0aW9uc1wiLFxuICBcImNhbml1c2VcIjogXCJjc3MtYW5pbWF0aW9uXCIsXG4gIFwicG9seWZpbGxzXCI6IFtcInRyYW5zZm9ybWllXCIsIFwiY3Nzc2FuZHBhcGVyXCJdLFxuICBcInRhZ3NcIjogW1wiY3NzXCJdLFxuICBcIndhcm5pbmdzXCI6IFtcIkFuZHJvaWQgPCA0IHdpbGwgcGFzcyB0aGlzIHRlc3QsIGJ1dCBjYW4gb25seSBhbmltYXRlIGEgc2luZ2xlIHByb3BlcnR5IGF0IGEgdGltZVwiXSxcbiAgXCJub3Rlc1wiOiBbe1xuICAgIFwibmFtZVwiIDogXCJBcnRpY2xlOiAnRGlzcGVsbGluZyB0aGUgQW5kcm9pZCBDU1MgYW5pbWF0aW9uIG15dGhzJ1wiLFxuICAgIFwiaHJlZlwiOiBcImh0dHBzOi8vZ29vLmdsL09HdzVHbVwiXG4gIH1dXG59XG4hKi9cbi8qIERPQ1xuRGV0ZWN0cyB3aGV0aGVyIG9yIG5vdCBlbGVtZW50cyBjYW4gYmUgYW5pbWF0ZWQgdXNpbmcgQ1NTXG4qL1xuXG4gIE1vZGVybml6ci5hZGRUZXN0KCdjc3NhbmltYXRpb25zJywgdGVzdEFsbFByb3BzKCdhbmltYXRpb25OYW1lJywgJ2EnLCB0cnVlKSk7XG5cbi8qIVxue1xuICBcIm5hbWVcIjogXCJDU1MgVHJhbnNmb3JtcyAzRFwiLFxuICBcInByb3BlcnR5XCI6IFwiY3NzdHJhbnNmb3JtczNkXCIsXG4gIFwiY2FuaXVzZVwiOiBcInRyYW5zZm9ybXMzZFwiLFxuICBcInRhZ3NcIjogW1wiY3NzXCJdLFxuICBcIndhcm5pbmdzXCI6IFtcbiAgICBcIkNocm9tZSBtYXkgb2NjYXNzaW9uYWxseSBmYWlsIHRoaXMgdGVzdCBvbiBzb21lIHN5c3RlbXM7IG1vcmUgaW5mbzogaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTEyOTAwNFwiXG4gIF1cbn1cbiEqL1xuXG4gIE1vZGVybml6ci5hZGRUZXN0KCdjc3N0cmFuc2Zvcm1zM2QnLCBmdW5jdGlvbigpIHtcbiAgICB2YXIgcmV0ID0gISF0ZXN0QWxsUHJvcHMoJ3BlcnNwZWN0aXZlJywgJzFweCcsIHRydWUpO1xuICAgIHZhciB1c2VQcmVmaXggPSBNb2Rlcm5penIuX2NvbmZpZy51c2VQcmVmaXhlcztcblxuICAgIC8vIFdlYmtpdCdzIDNEIHRyYW5zZm9ybXMgYXJlIHBhc3NlZCBvZmYgdG8gdGhlIGJyb3dzZXIncyBvd24gZ3JhcGhpY3MgcmVuZGVyZXIuXG4gICAgLy8gICBJdCB3b3JrcyBmaW5lIGluIFNhZmFyaSBvbiBMZW9wYXJkIGFuZCBTbm93IExlb3BhcmQsIGJ1dCBub3QgaW4gQ2hyb21lIGluXG4gICAgLy8gICBzb21lIGNvbmRpdGlvbnMuIEFzIGEgcmVzdWx0LCBXZWJraXQgdHlwaWNhbGx5IHJlY29nbml6ZXMgdGhlIHN5bnRheCBidXRcbiAgICAvLyAgIHdpbGwgc29tZXRpbWVzIHRocm93IGEgZmFsc2UgcG9zaXRpdmUsIHRodXMgd2UgbXVzdCBkbyBhIG1vcmUgdGhvcm91Z2ggY2hlY2s6XG4gICAgaWYgKHJldCAmJiAoIXVzZVByZWZpeCB8fCAnd2Via2l0UGVyc3BlY3RpdmUnIGluIGRvY0VsZW1lbnQuc3R5bGUpKSB7XG4gICAgICB2YXIgbXE7XG4gICAgICB2YXIgZGVmYXVsdFN0eWxlID0gJyNtb2Rlcm5penJ7d2lkdGg6MDtoZWlnaHQ6MH0nO1xuICAgICAgLy8gVXNlIENTUyBDb25kaXRpb25hbCBSdWxlcyBpZiBhdmFpbGFibGVcbiAgICAgIGlmIChNb2Rlcm5penIuc3VwcG9ydHMpIHtcbiAgICAgICAgbXEgPSAnQHN1cHBvcnRzIChwZXJzcGVjdGl2ZTogMXB4KSc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBPdGhlcndpc2UsIFdlYmtpdCBhbGxvd3MgdGhpcyBtZWRpYSBxdWVyeSB0byBzdWNjZWVkIG9ubHkgaWYgdGhlIGZlYXR1cmUgaXMgZW5hYmxlZC5cbiAgICAgICAgLy8gYEBtZWRpYSAodHJhbnNmb3JtLTNkKSwoLXdlYmtpdC10cmFuc2Zvcm0tM2QpeyAuLi4gfWBcbiAgICAgICAgbXEgPSAnQG1lZGlhICh0cmFuc2Zvcm0tM2QpJztcbiAgICAgICAgaWYgKHVzZVByZWZpeCkge1xuICAgICAgICAgIG1xICs9ICcsKC13ZWJraXQtdHJhbnNmb3JtLTNkKSc7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgbXEgKz0gJ3sjbW9kZXJuaXpye3dpZHRoOjdweDtoZWlnaHQ6MThweDttYXJnaW46MDtwYWRkaW5nOjA7Ym9yZGVyOjB9fSc7XG5cbiAgICAgIHRlc3RTdHlsZXMoZGVmYXVsdFN0eWxlICsgbXEsIGZ1bmN0aW9uKGVsZW0pIHtcbiAgICAgICAgcmV0ID0gZWxlbS5vZmZzZXRXaWR0aCA9PT0gNyAmJiBlbGVtLm9mZnNldEhlaWdodCA9PT0gMTg7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmV0O1xuICB9KTtcblxuXG4gIC8vIFJ1biBlYWNoIHRlc3RcbiAgdGVzdFJ1bm5lcigpO1xuXG4gIC8vIFJlbW92ZSB0aGUgXCJuby1qc1wiIGNsYXNzIGlmIGl0IGV4aXN0c1xuICBzZXRDbGFzc2VzKGNsYXNzZXMpO1xuXG4gIGRlbGV0ZSBNb2Rlcm5penJQcm90by5hZGRUZXN0O1xuICBkZWxldGUgTW9kZXJuaXpyUHJvdG8uYWRkQXN5bmNUZXN0O1xuXG4gIC8vIFJ1biB0aGUgdGhpbmdzIHRoYXQgYXJlIHN1cHBvc2VkIHRvIHJ1biBhZnRlciB0aGUgdGVzdHNcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBNb2Rlcm5penIuX3EubGVuZ3RoOyBpKyspIHtcbiAgICBNb2Rlcm5penIuX3FbaV0oKTtcbiAgfVxuXG4gIC8vIExlYWsgTW9kZXJuaXpyIG5hbWVzcGFjZVxuICB3aW5kb3cuTW9kZXJuaXpyID0gTW9kZXJuaXpyO1xuXG5cbjtcblxufSkod2luZG93LCBkb2N1bWVudCk7XG4iLCJpbXBvcnQgc29ubyBmcm9tICdzb25vJztcblxuY2xhc3MgWHAge1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG5cbiAgICAgICAgY29uc29sZS5sb2coc29ubyk7XG5cblxuXG4gICAgICAgIHRoaXMuZHJhdyA9IHRoaXMuZHJhdy5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLmV2ZW50cyA9IHRoaXMuZXZlbnRzLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuY2hhbmdlRnR0ID0gdGhpcy5jaGFuZ2VGdHQuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5yZXNpemVIYW5kbGVyID0gdGhpcy5yZXNpemVIYW5kbGVyLmJpbmQodGhpcyk7XG5cblxuICAgICAgICB0aGlzLmluaXQoKTtcblxuXG4gICAgfVxuXG4gICAgaW5pdCgpIHtcblxuXG4gICAgICAgIHRoaXMudWkgPSB7XG4gICAgICAgICAgICBteUF1ZGlvOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdhdWRpbycpLFxuICAgICAgICAgICAgZnJlcXVlbmN5QjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZyZXF1ZW5jeSAuYmxvY2snKSxcbiAgICAgICAgICAgIGFtcGxpdHVkZUI6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hbXBsaXR1ZGUgLmJsb2NrJyksXG4gICAgICAgICAgICB3YXZlRm9ybUI6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy53YXZlRm9ybSAuYmxvY2snKSxcbiAgICAgICAgICAgIHB0aWNoQjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBpdGNoIC5ibG9jaycpLFxuICAgICAgICAgICAgZm9ybUZ0dDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZ0dFNpemUnKVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gTmV3IFdlYkF1ZGlvIEFQSVxuICAgICAgICB0aGlzLmF1ZGlvQ3R4ID0gbmV3KHdpbmRvdy5BdWRpb0NvbnRleHQgfHwgd2luZG93LndlYmtpdEF1ZGlvQ29udGV4dCkoKTtcblxuICAgICAgICAvLyAgQ3JlYXRlIEFuYWx5c2VyIG5vZGVcbiAgICAgICAgdGhpcy5hbmFseXNlciA9IHRoaXMuYXVkaW9DdHguY3JlYXRlQW5hbHlzZXIoKTtcblxuICAgICAgICAvLyBDb25uZWN0IG5vZGVzIHRvZ2V0aGVyXG4gICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmF1ZGlvQ3R4LmNyZWF0ZU1lZGlhRWxlbWVudFNvdXJjZSh0aGlzLnVpLm15QXVkaW8pO1xuICAgICAgICBzb3VyY2UuY29ubmVjdCh0aGlzLmFuYWx5c2VyKTtcbiAgICAgICAgdGhpcy5hbmFseXNlci5jb25uZWN0KHRoaXMuYXVkaW9DdHguZGVzdGluYXRpb24pO1xuXG5cbiAgICAgICAgLy8gU2V0IEZvdXJpZXIgdmFsdWVcbiAgICAgICAgdGhpcy5hbmFseXNlci5mZnRTaXplID0gdGhpcy51aS5mb3JtRnR0LnZhbHVlO1xuICAgICAgICAvLyBHZXQgZnJlcXVlbmN5IGxlbmd0aCAoIGZmdFNpemUgLyAyKVxuICAgICAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IHRoaXMuYW5hbHlzZXIuZnJlcXVlbmN5QmluQ291bnQ7XG4gICAgICAgIC8vIFByZXBhcmUgYXJyYXkgb2YgZnJlcXVlbmNpZXNcbiAgICAgICAgdGhpcy5kYXRhQXJyYXkgPSBuZXcgVWludDhBcnJheSh0aGlzLmJ1ZmZlckxlbmd0aCk7XG5cblxuICAgICAgICB0aGlzLmNhbnZhcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYW52YXMnKTtcbiAgICAgICAgdGhpcy5jYW52YXMud2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcbiAgICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ID0gMzAwO1xuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmNhbnZhcy53aWR0aCk7XG4gICAgICAgIHRoaXMuY2FudmFzQ3R4ID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICAgICAgdGhpcy5jYW52YXNDdHguY2xlYXJSZWN0KDAsIDAsIDUwMCwgNTAwKTtcblxuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmJ1ZmZlckxlbmd0aCk7XG5cbiAgICAgICAgdGhpcy5ldmVudHMoKTtcblxuICAgICAgICB0aGlzLmRyYXcoKTtcblxuXG4gICAgfVxuXG4gICAgZXZlbnRzKCkge1xuXG4gICAgICAgIHRoaXMudWkuZm9ybUZ0dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB0aGlzLmNoYW5nZUZ0dCk7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLnJlc2l6ZUhhbmRsZXIpO1xuXG4gICAgfVxuXG4gICAgY2hhbmdlRnR0KGUpIHtcbiAgICAgICAgLy8gUmVzZXQgZnJlcXVlbmNpZXMgXG4gICAgICAgIHRoaXMuYW5hbHlzZXIuZmZ0U2l6ZSA9IHRoaXMudWkuZm9ybUZ0dC52YWx1ZTtcbiAgICAgICAgdGhpcy5idWZmZXJMZW5ndGggPSB0aGlzLmFuYWx5c2VyLmZyZXF1ZW5jeUJpbkNvdW50O1xuICAgICAgICB0aGlzLmRhdGFBcnJheSA9IG5ldyBVaW50OEFycmF5KHRoaXMuYnVmZmVyTGVuZ3RoKTtcblxuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmJ1ZmZlckxlbmd0aCwgdGhpcy5kYXRhQXJyYXkpO1xuICAgIH1cblxuICAgIHJlc2l6ZUhhbmRsZXIoKSB7XG4gICAgICAgIHRoaXMuY2FudmFzLndpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG4gICAgfVxuXG4gICAgZHJhdygpIHtcblxuXG4gICAgICAgIC8vIC5nZXRCeXRlRnJlcXVlbmN5RGF0YSgpIC0tPiBGb3IgYmFyIGdyYXBoIHZpc3VhbGlzYXRpb24gKGFic2Npc3NlID0gRnLDqXF1ZW5jZSAvIG9yZG9ubsOpZSA9IGludGVuc2l0w6kpXG4gICAgICAgIC8vIC5nZXRCeXRlVGltZURvbWFpbkRhdGEoKSAtLT4gRm9yIG9zY2lsbG9zY29wZSB2aXN1YWxpc2F0aW9uIFxuICAgICAgICB0aGlzLmFuYWx5c2VyLmdldEJ5dGVGcmVxdWVuY3lEYXRhKHRoaXMuZGF0YUFycmF5KTtcblxuICAgICAgICAvLyBjcmVhdGUgYmFja2dyb3VuZFxuICAgICAgICB0aGlzLmNhbnZhc0N0eC5maWxsU3R5bGUgPSAncmdiKDAsIDAsIDApJztcbiAgICAgICAgdGhpcy5jYW52YXNDdHguZmlsbFJlY3QoMCwgMCwgdGhpcy5jYW52YXMud2lkdGgsIDUwMCk7XG5cbiAgICAgICAgbGV0IGJhcldpZHRoID0gKHRoaXMuY2FudmFzLndpZHRoIC8gdGhpcy5idWZmZXJMZW5ndGgpO1xuICAgICAgICBsZXQgYmFySGVpZ2h0O1xuICAgICAgICBsZXQgeCA9IDA7XG5cbiAgICAgICAgLy8gVmFsdWUgb2YgZmlyc3QgQmFyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuZGF0YUFycmF5WzBdKTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYnVmZmVyTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGJhckhlaWdodCA9IHRoaXMuZGF0YUFycmF5W2ldICogMy80O1xuXG4gICAgICAgICAgICBsZXQgaHVlID0gaSAvIHRoaXMuYnVmZmVyTGVuZ3RoICogMzYwO1xuICAgICAgICAgICAgdGhpcy5jYW52YXNDdHguZmlsbFN0eWxlID0gJ2hzbCgnICsgaHVlICsgJywgMTAwJSwgNTAlKSc7XG4gICAgICAgICAgICB0aGlzLmNhbnZhc0N0eC5maWxsUmVjdCh4LCB0aGlzLmNhbnZhcy5oZWlnaHQgLSBiYXJIZWlnaHQsIGJhcldpZHRoLCBiYXJIZWlnaHQpO1xuXG4gICAgICAgICAgICB4ICs9IGJhcldpZHRoICsgMTtcbiAgICAgICAgfVxuXG5cblxuICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5kcmF3KTtcblxuICAgIH1cblxuXG59XG5cblxuZXhwb3J0IGRlZmF1bHQgbmV3IFhwKCk7XG4iLCIoZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuXHR0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgPyBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKSA6XG5cdHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShmYWN0b3J5KSA6XG5cdChnbG9iYWwuc29ubyA9IGZhY3RvcnkoKSk7XG59KHRoaXMsIChmdW5jdGlvbiAoKSB7ICd1c2Ugc3RyaWN0JztcblxudmFyIGJyb3dzZXIgPSB7fTtcblxuYnJvd3Nlci5oYW5kbGVQYWdlVmlzaWJpbGl0eSA9IGZ1bmN0aW9uIChvbkhpZGRlbiwgb25TaG93bikge1xuICAgIHZhciBoaWRkZW4gPSB2b2lkIDAsXG4gICAgICAgIHZpc2liaWxpdHlDaGFuZ2UgPSB2b2lkIDA7XG5cbiAgICBpZiAodHlwZW9mIGRvY3VtZW50LmhpZGRlbiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgaGlkZGVuID0gJ2hpZGRlbic7XG4gICAgICAgIHZpc2liaWxpdHlDaGFuZ2UgPSAndmlzaWJpbGl0eWNoYW5nZSc7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZG9jdW1lbnQubW96SGlkZGVuICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBoaWRkZW4gPSAnbW96SGlkZGVuJztcbiAgICAgICAgdmlzaWJpbGl0eUNoYW5nZSA9ICdtb3p2aXNpYmlsaXR5Y2hhbmdlJztcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBkb2N1bWVudC5tc0hpZGRlbiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgaGlkZGVuID0gJ21zSGlkZGVuJztcbiAgICAgICAgdmlzaWJpbGl0eUNoYW5nZSA9ICdtc3Zpc2liaWxpdHljaGFuZ2UnO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGRvY3VtZW50LndlYmtpdEhpZGRlbiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgaGlkZGVuID0gJ3dlYmtpdEhpZGRlbic7XG4gICAgICAgIHZpc2liaWxpdHlDaGFuZ2UgPSAnd2Via2l0dmlzaWJpbGl0eWNoYW5nZSc7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25DaGFuZ2UoKSB7XG4gICAgICAgIGlmIChkb2N1bWVudFtoaWRkZW5dKSB7XG4gICAgICAgICAgICBvbkhpZGRlbigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgb25TaG93bigpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiB2aXNpYmlsaXR5Q2hhbmdlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKHZpc2liaWxpdHlDaGFuZ2UsIG9uQ2hhbmdlLCBmYWxzZSk7XG4gICAgfVxufTtcblxuYnJvd3Nlci5oYW5kbGVUb3VjaExvY2sgPSBmdW5jdGlvbiAoY29udGV4dCwgb25VbmxvY2spIHtcbiAgICB2YXIgdWEgPSBuYXZpZ2F0b3IudXNlckFnZW50LFxuICAgICAgICBsb2NrZWQgPSAhIXVhLm1hdGNoKC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pfFdpbmRvd3MgUGhvbmV8U3ltYmlhbk9TL2kpO1xuXG4gICAgZnVuY3Rpb24gdW5sb2NrKCkge1xuICAgICAgICBpZiAoY29udGV4dCAmJiBjb250ZXh0LnN0YXRlID09PSAnc3VzcGVuZGVkJykge1xuICAgICAgICAgICAgY29udGV4dC5yZXN1bWUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgYnVmZmVyID0gY29udGV4dC5jcmVhdGVCdWZmZXIoMSwgMSwgNDQxMDApO1xuICAgICAgICAgICAgICAgIHZhciBzb3VyY2UgPSBjb250ZXh0LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpO1xuICAgICAgICAgICAgICAgIHNvdXJjZS5idWZmZXIgPSBidWZmZXI7XG4gICAgICAgICAgICAgICAgc291cmNlLmNvbm5lY3QoY29udGV4dC5kZXN0aW5hdGlvbik7XG4gICAgICAgICAgICAgICAgc291cmNlLnN0YXJ0KDApO1xuICAgICAgICAgICAgICAgIHNvdXJjZS5zdG9wKDApO1xuICAgICAgICAgICAgICAgIHNvdXJjZS5kaXNjb25uZWN0KCk7XG5cbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdW5sb2NrKTtcbiAgICAgICAgICAgICAgICBvblVubG9jaygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdW5sb2NrKTtcbiAgICAgICAgICAgIG9uVW5sb2NrKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAobG9ja2VkKSB7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB1bmxvY2ssIGZhbHNlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbG9ja2VkO1xufTtcblxudmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHtcbiAgcmV0dXJuIHR5cGVvZiBvYmo7XG59IDogZnVuY3Rpb24gKG9iaikge1xuICByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqO1xufTtcblxuXG5cblxuXG52YXIgY2xhc3NDYWxsQ2hlY2sgPSBmdW5jdGlvbiAoaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7XG4gIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTtcbiAgfVxufTtcblxuXG5cblxuXG5cblxuXG5cbnZhciBnZXQkMSA9IGZ1bmN0aW9uIGdldCQxKG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7XG4gIGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTtcbiAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpO1xuXG4gIGlmIChkZXNjID09PSB1bmRlZmluZWQpIHtcbiAgICB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7XG5cbiAgICBpZiAocGFyZW50ID09PSBudWxsKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZ2V0JDEocGFyZW50LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpO1xuICAgIH1cbiAgfSBlbHNlIGlmIChcInZhbHVlXCIgaW4gZGVzYykge1xuICAgIHJldHVybiBkZXNjLnZhbHVlO1xuICB9IGVsc2Uge1xuICAgIHZhciBnZXR0ZXIgPSBkZXNjLmdldDtcblxuICAgIGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpO1xuICB9XG59O1xuXG52YXIgaW5oZXJpdHMgPSBmdW5jdGlvbiAoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHtcbiAgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpO1xuICB9XG5cbiAgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7XG4gICAgY29uc3RydWN0b3I6IHtcbiAgICAgIHZhbHVlOiBzdWJDbGFzcyxcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9XG4gIH0pO1xuICBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7XG59O1xuXG5cblxuXG5cblxuXG5cblxuXG5cbnZhciBwb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuID0gZnVuY3Rpb24gKHNlbGYsIGNhbGwpIHtcbiAgaWYgKCFzZWxmKSB7XG4gICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpO1xuICB9XG5cbiAgcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7XG59O1xuXG5cblxudmFyIHNldCQxID0gZnVuY3Rpb24gc2V0JDEob2JqZWN0LCBwcm9wZXJ0eSwgdmFsdWUsIHJlY2VpdmVyKSB7XG4gIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTtcblxuICBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpO1xuXG4gICAgaWYgKHBhcmVudCAhPT0gbnVsbCkge1xuICAgICAgc2V0JDEocGFyZW50LCBwcm9wZXJ0eSwgdmFsdWUsIHJlY2VpdmVyKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MgJiYgZGVzYy53cml0YWJsZSkge1xuICAgIGRlc2MudmFsdWUgPSB2YWx1ZTtcbiAgfSBlbHNlIHtcbiAgICB2YXIgc2V0dGVyID0gZGVzYy5zZXQ7XG5cbiAgICBpZiAoc2V0dGVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHNldHRlci5jYWxsKHJlY2VpdmVyLCB2YWx1ZSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHZhbHVlO1xufTtcblxudmFyIGV4dGVuc2lvbnMgPSBbXTtcbnZhciBjYW5QbGF5ID0ge307XG5cbi8qXG4gKiBJbml0aWFsIHRlc3RzXG4gKi9cblxudmFyIHRlc3RzID0gW3tcbiAgICBleHQ6ICdvZ2cnLFxuICAgIHR5cGU6ICdhdWRpby9vZ2c7IGNvZGVjcz1cInZvcmJpc1wiJ1xufSwge1xuICAgIGV4dDogJ21wMycsXG4gICAgdHlwZTogJ2F1ZGlvL21wZWc7J1xufSwge1xuICAgIGV4dDogJ29wdXMnLFxuICAgIHR5cGU6ICdhdWRpby9vZ2c7IGNvZGVjcz1cIm9wdXNcIidcbn0sIHtcbiAgICBleHQ6ICd3YXYnLFxuICAgIHR5cGU6ICdhdWRpby93YXY7IGNvZGVjcz1cIjFcIidcbn0sIHtcbiAgICBleHQ6ICdtNGEnLFxuICAgIHR5cGU6ICdhdWRpby94LW00YTsnXG59LCB7XG4gICAgZXh0OiAnbTRhJyxcbiAgICB0eXBlOiAnYXVkaW8vYWFjOydcbn1dO1xuXG52YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhdWRpbycpO1xuaWYgKGVsKSB7XG4gICAgdGVzdHMuZm9yRWFjaChmdW5jdGlvbiAodGVzdCkge1xuICAgICAgICB2YXIgY2FuUGxheVR5cGUgPSAhIWVsLmNhblBsYXlUeXBlKHRlc3QudHlwZSk7XG4gICAgICAgIGlmIChjYW5QbGF5VHlwZSAmJiBleHRlbnNpb25zLmluZGV4T2YodGVzdC5leHQpID09PSAtMSkge1xuICAgICAgICAgICAgZXh0ZW5zaW9ucy5wdXNoKHRlc3QuZXh0KTtcbiAgICAgICAgfVxuICAgICAgICBjYW5QbGF5W3Rlc3QuZXh0XSA9IGNhblBsYXlUeXBlO1xuICAgIH0pO1xuICAgIGVsID0gbnVsbDtcbn1cblxuLypcbiAqIGZpbmQgYSBzdXBwb3J0ZWQgZmlsZVxuICovXG5cbmZ1bmN0aW9uIGdldEZpbGVFeHRlbnNpb24odXJsKSB7XG4gICAgaWYgKHR5cGVvZiB1cmwgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG4gICAgLy8gZnJvbSBEYXRhVVJMXG4gICAgaWYgKHVybC5zbGljZSgwLCA1KSA9PT0gJ2RhdGE6Jykge1xuICAgICAgICB2YXIgbWF0Y2ggPSB1cmwubWF0Y2goL2RhdGE6YXVkaW9cXC8ob2dnfG1wM3xvcHVzfHdhdnxtNGEpL2kpO1xuICAgICAgICBpZiAobWF0Y2ggJiYgbWF0Y2gubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgcmV0dXJuIG1hdGNoWzFdLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gZnJvbSBTdGFuZGFyZCBVUkxcbiAgICB1cmwgPSB1cmwuc3BsaXQoJz8nKVswXTtcbiAgICB1cmwgPSB1cmwuc2xpY2UodXJsLmxhc3RJbmRleE9mKCcvJykgKyAxKTtcblxuICAgIHZhciBhID0gdXJsLnNwbGl0KCcuJyk7XG4gICAgaWYgKGEubGVuZ3RoID09PSAxIHx8IGFbMF0gPT09ICcnICYmIGEubGVuZ3RoID09PSAyKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG4gICAgcmV0dXJuIGEucG9wKCkudG9Mb3dlckNhc2UoKTtcbn1cblxuZnVuY3Rpb24gZ2V0U3VwcG9ydGVkRmlsZShmaWxlTmFtZXMpIHtcbiAgICB2YXIgbmFtZSA9IHZvaWQgMDtcblxuICAgIGlmIChBcnJheS5pc0FycmF5KGZpbGVOYW1lcykpIHtcbiAgICAgICAgLy8gaWYgYXJyYXkgZ2V0IHRoZSBmaXJzdCBvbmUgdGhhdCB3b3Jrc1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZpbGVOYW1lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbmFtZSA9IGZpbGVOYW1lc1tpXTtcbiAgICAgICAgICAgIHZhciBleHQgPSBnZXRGaWxlRXh0ZW5zaW9uKG5hbWUpO1xuICAgICAgICAgICAgaWYgKGV4dGVuc2lvbnMuaW5kZXhPZihleHQpID4gLTEpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAoKHR5cGVvZiBmaWxlTmFtZXMgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKGZpbGVOYW1lcykpID09PSAnb2JqZWN0Jykge1xuICAgICAgICAvLyBpZiBub3QgYXJyYXkgYW5kIGlzIG9iamVjdFxuICAgICAgICBPYmplY3Qua2V5cyhmaWxlTmFtZXMpLnNvbWUoZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgbmFtZSA9IGZpbGVOYW1lc1trZXldO1xuICAgICAgICAgICAgdmFyIGV4dCA9IGdldEZpbGVFeHRlbnNpb24obmFtZSk7XG4gICAgICAgICAgICByZXR1cm4gZXh0ZW5zaW9ucy5pbmRleE9mKGV4dCkgPiAtMTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8vIGlmIHN0cmluZyBqdXN0IHJldHVyblxuICAgIHJldHVybiBuYW1lIHx8IGZpbGVOYW1lcztcbn1cblxuLypcbiAqIGluZmVyIGZpbGUgdHlwZXNcbiAqL1xuXG5mdW5jdGlvbiBpc0F1ZGlvQnVmZmVyKGRhdGEpIHtcbiAgICByZXR1cm4gISEoZGF0YSAmJiB3aW5kb3cuQXVkaW9CdWZmZXIgJiYgZGF0YSBpbnN0YW5jZW9mIHdpbmRvdy5BdWRpb0J1ZmZlcik7XG59XG5cbmZ1bmN0aW9uIGlzQXJyYXlCdWZmZXIoZGF0YSkge1xuICAgIHJldHVybiAhIShkYXRhICYmIHdpbmRvdy5BcnJheUJ1ZmZlciAmJiBkYXRhIGluc3RhbmNlb2Ygd2luZG93LkFycmF5QnVmZmVyKTtcbn1cblxuZnVuY3Rpb24gaXNNZWRpYUVsZW1lbnQoZGF0YSkge1xuICAgIHJldHVybiAhIShkYXRhICYmIHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50ICYmIGRhdGEgaW5zdGFuY2VvZiB3aW5kb3cuSFRNTE1lZGlhRWxlbWVudCk7XG59XG5cbmZ1bmN0aW9uIGlzTWVkaWFTdHJlYW0oZGF0YSkge1xuICAgIHJldHVybiAhIShkYXRhICYmIHR5cGVvZiBkYXRhLmdldEF1ZGlvVHJhY2tzID09PSAnZnVuY3Rpb24nICYmIGRhdGEuZ2V0QXVkaW9UcmFja3MoKS5sZW5ndGggJiYgd2luZG93Lk1lZGlhU3RyZWFtVHJhY2sgJiYgZGF0YS5nZXRBdWRpb1RyYWNrcygpWzBdIGluc3RhbmNlb2Ygd2luZG93Lk1lZGlhU3RyZWFtVHJhY2spO1xufVxuXG5mdW5jdGlvbiBpc09zY2lsbGF0b3JUeXBlKGRhdGEpIHtcbiAgICByZXR1cm4gISEoZGF0YSAmJiB0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycgJiYgKGRhdGEgPT09ICdzaW5lJyB8fCBkYXRhID09PSAnc3F1YXJlJyB8fCBkYXRhID09PSAnc2F3dG9vdGgnIHx8IGRhdGEgPT09ICd0cmlhbmdsZScpKTtcbn1cblxuZnVuY3Rpb24gaXNTY3JpcHRDb25maWcoZGF0YSkge1xuICAgIHJldHVybiAhIShkYXRhICYmICh0eXBlb2YgZGF0YSA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YoZGF0YSkpID09PSAnb2JqZWN0JyAmJiBkYXRhLmJ1ZmZlclNpemUgJiYgZGF0YS5jaGFubmVscyAmJiBkYXRhLmNhbGxiYWNrKTtcbn1cblxuZnVuY3Rpb24gaXNVUkwoZGF0YSkge1xuICAgIHJldHVybiAhIShkYXRhICYmIHR5cGVvZiBkYXRhID09PSAnc3RyaW5nJyAmJiAoZGF0YS5pbmRleE9mKCcuJykgPiAtMSB8fCBkYXRhLnNsaWNlKDAsIDUpID09PSAnZGF0YTonKSk7XG59XG5cbmZ1bmN0aW9uIGNvbnRhaW5zVVJMKGNvbmZpZykge1xuICAgIGlmICghY29uZmlnIHx8IGlzTWVkaWFFbGVtZW50KGNvbmZpZykpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICAvLyBzdHJpbmcsIGFycmF5IG9yIG9iamVjdCB3aXRoIHNyYy91cmwvZGF0YSBwcm9wZXJ0eSB0aGF0IGlzIHN0cmluZywgYXJyYXkgb3IgYXJyYXlidWZmZXJcbiAgICB2YXIgc3JjID0gY29uZmlnLnNyYyB8fCBjb25maWcudXJsIHx8IGNvbmZpZy5kYXRhIHx8IGNvbmZpZztcbiAgICByZXR1cm4gaXNVUkwoc3JjKSB8fCBpc0FycmF5QnVmZmVyKHNyYykgfHwgQXJyYXkuaXNBcnJheShzcmMpICYmIGlzVVJMKHNyY1swXSk7XG59XG5cbnZhciBmaWxlID0ge1xuICAgIGNhblBsYXk6IGNhblBsYXksXG4gICAgY29udGFpbnNVUkw6IGNvbnRhaW5zVVJMLFxuICAgIGV4dGVuc2lvbnM6IGV4dGVuc2lvbnMsXG4gICAgZ2V0RmlsZUV4dGVuc2lvbjogZ2V0RmlsZUV4dGVuc2lvbixcbiAgICBnZXRTdXBwb3J0ZWRGaWxlOiBnZXRTdXBwb3J0ZWRGaWxlLFxuICAgIGlzQXVkaW9CdWZmZXI6IGlzQXVkaW9CdWZmZXIsXG4gICAgaXNNZWRpYUVsZW1lbnQ6IGlzTWVkaWFFbGVtZW50LFxuICAgIGlzTWVkaWFTdHJlYW06IGlzTWVkaWFTdHJlYW0sXG4gICAgaXNPc2NpbGxhdG9yVHlwZTogaXNPc2NpbGxhdG9yVHlwZSxcbiAgICBpc1NjcmlwdENvbmZpZzogaXNTY3JpcHRDb25maWcsXG4gICAgaXNVUkw6IGlzVVJMXG59O1xuXG5mdW5jdGlvbiBBbmFseXNlcihjb250ZXh0LCBjb25maWcpIHtcbiAgICBjb25maWcgPSBjb25maWcgfHwge307XG5cbiAgICB2YXIgbm9kZSA9IGNvbnRleHQuY3JlYXRlQW5hbHlzZXIoKTtcblxuICAgIHZhciBmZnRTaXplID0gY29uZmlnLmZmdFNpemUgfHwgNTEyLFxuICAgICAgICBmcmVxRmxvYXQgPSAhIWNvbmZpZy5mbG9hdCxcbiAgICAgICAgd2F2ZUZsb2F0ID0gISFjb25maWcuZmxvYXQsXG4gICAgICAgIHdhdmVmb3JtID0gdm9pZCAwLFxuICAgICAgICBmcmVxdWVuY2llcyA9IHZvaWQgMDtcblxuICAgIG5vZGUuZmZ0U2l6ZSA9IGZmdFNpemU7IC8vIGZyZXF1ZW5jeUJpbkNvdW50IHdpbGwgYmUgaGFsZiB0aGlzIHZhbHVlXG4gICAgbm9kZS5zbW9vdGhpbmdUaW1lQ29uc3RhbnQgPSBjb25maWcuc21vb3RoaW5nIHx8IGNvbmZpZy5zbW9vdGhpbmdUaW1lQ29uc3RhbnQgfHwgbm9kZS5zbW9vdGhpbmdUaW1lQ29uc3RhbnQ7XG4gICAgbm9kZS5taW5EZWNpYmVscyA9IGNvbmZpZy5taW5EZWNpYmVscyB8fCBub2RlLm1pbkRlY2liZWxzO1xuICAgIG5vZGUubWF4RGVjaWJlbHMgPSBjb25maWcubWF4RGVjaWJlbHMgfHwgbm9kZS5tYXhEZWNpYmVscztcblxuICAgIC8vdGhlIHdvcmtlciByZXR1cm5zIGEgbm9ybWFsaXplZCB2YWx1ZVxuICAgIC8vZmlyc3QgYSBzdW0gb2YgYWxsIG1hZ25pdHVkZXMgZGV2aWRlZCBieSB0aGUgYnl0ZUxlbmd0aCwgdGhlbiBkZXZpZGUgIGJ5IGhhbGYgdGhlIGZmdCAoMWNoYW5uZWwpXG4gICAgdmFyIGFtcGxpdHVkZUJsb2IgPSBuZXcgQmxvYihbJ29ubWVzc2FnZT1mdW5jdGlvbihlKXt2YXIgZGF0YT1lLmRhdGE7dmFyIGY9bmV3IEZsb2F0MzJBcnJheShkYXRhLmIpO2Zvcih2YXIgaT0wO2k8Zi5sZW5ndGg7aSsrKXtkYXRhLnN1bSs9ZltpXX1kYXRhLnN1bS89Zi5sZW5ndGg7cG9zdE1lc3NhZ2UoTWF0aC5tYXgoMS4wLShkYXRhLnN1bS9kYXRhLm51bVNhbXBsZXMqLTEuMCksMCkpfTsnXSk7XG4gICAgdmFyIHBpdGNoQmxvYiA9IG5ldyBCbG9iKFsnb25tZXNzYWdlPWZ1bmN0aW9uKGUpe3ZhciBkYXRhPWUuZGF0YTt2YXIgc2FtcGxlUmF0ZT1kYXRhLnNhbXBsZVJhdGU7dmFyIGJ1Zj1uZXcgRmxvYXQzMkFycmF5KGRhdGEuYik7dmFyIFNJWkU9YnVmLmxlbmd0aDt2YXIgTUFYX1NBTVBMRVM9TWF0aC5mbG9vcihTSVpFLzIpO3ZhciBiZXN0X29mZnNldD0tMTt2YXIgYmVzdF9jb3JyZWxhdGlvbj0wO3ZhciBybXM9MDt2YXIgZm91bmRHb29kQ29ycmVsYXRpb249ZmFsc2U7dmFyIGNvcnJlbGF0aW9ucz1uZXcgQXJyYXkoTUFYX1NBTVBMRVMpO2Zvcih2YXIgaT0wO2k8U0laRTtpKyspe3ZhciB2YWw9YnVmW2ldO3Jtcys9dmFsKnZhbH1ybXM9TWF0aC5zcXJ0KHJtcy9TSVpFKTtpZiAocm1zPDAuMDEpe3Bvc3RNZXNzYWdlKC0xKX1lbHNle3ZhciBsYXN0Q29ycmVsYXRpb249MTtmb3IodmFyIG9mZnNldD0wO29mZnNldDxNQVhfU0FNUExFUztvZmZzZXQrKyl7dmFyIGNvcnJlbGF0aW9uPTA7Zm9yKHZhciBpPTA7aTxNQVhfU0FNUExFUztpKyspe2NvcnJlbGF0aW9uKz1NYXRoLmFicygoYnVmW2ldKS0oYnVmW2krb2Zmc2V0XSkpfWNvcnJlbGF0aW9uPTEtKGNvcnJlbGF0aW9uL01BWF9TQU1QTEVTKTtjb3JyZWxhdGlvbnNbb2Zmc2V0XT1jb3JyZWxhdGlvbjtpZiAoKGNvcnJlbGF0aW9uPjAuOSkmJihjb3JyZWxhdGlvbj5sYXN0Q29ycmVsYXRpb24pKXtmb3VuZEdvb2RDb3JyZWxhdGlvbj10cnVlO2lmIChjb3JyZWxhdGlvbj5iZXN0X2NvcnJlbGF0aW9uKXtiZXN0X2NvcnJlbGF0aW9uPWNvcnJlbGF0aW9uO2Jlc3Rfb2Zmc2V0PW9mZnNldH19ZWxzZSBpZiAoZm91bmRHb29kQ29ycmVsYXRpb24pe3ZhciBzaGlmdD0oY29ycmVsYXRpb25zW2Jlc3Rfb2Zmc2V0KzFdLWNvcnJlbGF0aW9uc1tiZXN0X29mZnNldC0xXSkvY29ycmVsYXRpb25zW2Jlc3Rfb2Zmc2V0XTtwb3N0TWVzc2FnZShzYW1wbGVSYXRlLyhiZXN0X29mZnNldCsoOCpzaGlmdCkpKX1sYXN0Q29ycmVsYXRpb249Y29ycmVsYXRpb259aWYgKGJlc3RfY29ycmVsYXRpb24+MC4wMSl7cG9zdE1lc3NhZ2Uoc2FtcGxlUmF0ZS9iZXN0X29mZnNldCl9ZWxzZXtwb3N0TWVzc2FnZSgtMSl9fX07J10pO1xuICAgIHZhciBhbXBsaXR1ZGVCbG9iVVJMID0gVVJMLmNyZWF0ZU9iamVjdFVSTChhbXBsaXR1ZGVCbG9iKTtcbiAgICB2YXIgYW1wbGl0dWRlV29ya2VyID0gbmV3IFdvcmtlcihhbXBsaXR1ZGVCbG9iVVJMKTtcbiAgICB2YXIgcGl0Y2hCbG9iVVJMID0gVVJMLmNyZWF0ZU9iamVjdFVSTChwaXRjaEJsb2IpO1xuICAgIHZhciBwaXRjaFdvcmtlciA9IG5ldyBXb3JrZXIocGl0Y2hCbG9iVVJMKTtcblxuICAgIHZhciBhbXBsaXR1ZGVDYWxsYmFjayA9IG51bGw7XG4gICAgdmFyIG5vdGVTdHJpbmdzID0gWydDJywgJ0MjJywgJ0QnLCAnRCMnLCAnRScsICdGJywgJ0YjJywgJ0cnLCAnRyMnLCAnQScsICdBIycsICdCJ107XG4gICAgdmFyIHBpdGNoQ2FsbGJhY2sgPSBudWxsO1xuICAgIHZhciBwaXRjaENhbGxiYWNrT2JqZWN0ID0ge1xuICAgICAgICBoZXJ0ejogbnVsbCwgLy9udW1iZXJcbiAgICAgICAgbm90ZTogbnVsbCwgLy9zdHJpbmdcbiAgICAgICAgbm90ZUluZGV4OiBudWxsLCAvL2ludFxuICAgICAgICBkZXR1bmVDZW50czogbnVsbCwgLy9udW1iZXJcbiAgICAgICAgZGV0dW5lOiBudWxsIC8vc3RyaW5nXG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIG5vdGVGcm9tUGl0Y2goZnJlcXVlbmN5KSB7XG4gICAgICAgIHZhciBub3RlTnVtID0gMTIgKiAoTWF0aC5sb2coZnJlcXVlbmN5IC8gNDQwKSAvIE1hdGgubG9nKDIpKTtcbiAgICAgICAgcmV0dXJuIE1hdGgucm91bmQobm90ZU51bSkgKyA2OTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmcmVxdWVuY3lGcm9tTm90ZU51bWJlcihub3RlKSB7XG4gICAgICAgIHJldHVybiA0NDAgKiBNYXRoLnBvdygyLCAobm90ZSAtIDY5KSAvIDEyKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjZW50c09mZkZyb21QaXRjaChmcmVxdWVuY3ksIG5vdGUpIHtcbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoMTIwMCAqIE1hdGgubG9nKGZyZXF1ZW5jeSAvIGZyZXF1ZW5jeUZyb21Ob3RlTnVtYmVyKG5vdGUpKSAvIE1hdGgubG9nKDIpKTtcbiAgICB9XG5cbiAgICBhbXBsaXR1ZGVXb3JrZXIub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKGFtcGxpdHVkZUNhbGxiYWNrKSB7XG4gICAgICAgICAgICBhbXBsaXR1ZGVDYWxsYmFjayhlLmRhdGEpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHBpdGNoV29ya2VyLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmIChwaXRjaENhbGxiYWNrKSB7XG4gICAgICAgICAgICB2YXIgSHogPSBlLmRhdGE7XG4gICAgICAgICAgICBpZiAoSHogIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5vdGUgPSBub3RlRnJvbVBpdGNoKEh6KTtcbiAgICAgICAgICAgICAgICB2YXIgZGV0dW5lID0gY2VudHNPZmZGcm9tUGl0Y2goSHosIG5vdGUpO1xuICAgICAgICAgICAgICAgIHBpdGNoQ2FsbGJhY2tPYmplY3QuaGVydHogPSBIejtcbiAgICAgICAgICAgICAgICBwaXRjaENhbGxiYWNrT2JqZWN0Lm5vdGVJbmRleCA9IG5vdGUgJSAxMjtcbiAgICAgICAgICAgICAgICBwaXRjaENhbGxiYWNrT2JqZWN0Lm5vdGUgPSBub3RlU3RyaW5nc1tub3RlICUgMTJdO1xuICAgICAgICAgICAgICAgIHBpdGNoQ2FsbGJhY2tPYmplY3QuZGV0dW5lQ2VudHMgPSBkZXR1bmU7XG4gICAgICAgICAgICAgICAgaWYgKGRldHVuZSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBwaXRjaENhbGxiYWNrT2JqZWN0LmRldHVuZSA9ICcnO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGV0dW5lIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICBwaXRjaENhbGxiYWNrT2JqZWN0LmRldHVuZSA9ICdmbGF0JztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwaXRjaENhbGxiYWNrT2JqZWN0LmRldHVuZSA9ICdzaGFycCc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGl0Y2hDYWxsYmFjayhwaXRjaENhbGxiYWNrT2JqZWN0KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBuZWVkc1VwZGF0ZShhcnIsIGZsb2F0KSB7XG4gICAgICAgIGlmICghYXJyKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobm9kZS5mZnRTaXplICE9PSBmZnRTaXplKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZmxvYXQgJiYgYXJyIGluc3RhbmNlb2YgVWludDhBcnJheSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICFmbG9hdCAmJiBhcnIgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlQXJyYXkoZmxvYXQsIGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmxvYXQgPyBuZXcgRmxvYXQzMkFycmF5KGxlbmd0aCkgOiBuZXcgVWludDhBcnJheShsZW5ndGgpO1xuICAgIH1cblxuICAgIG5vZGUuZ2V0V2F2ZWZvcm0gPSBmdW5jdGlvbiAoZmxvYXQpIHtcbiAgICAgICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICBmbG9hdCA9IHdhdmVGbG9hdDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChuZWVkc1VwZGF0ZSh3YXZlZm9ybSwgZmxvYXQpKSB7XG4gICAgICAgICAgICBmZnRTaXplID0gbm9kZS5mZnRTaXplO1xuICAgICAgICAgICAgd2F2ZUZsb2F0ID0gZmxvYXQ7XG4gICAgICAgICAgICB3YXZlZm9ybSA9IGNyZWF0ZUFycmF5KGZsb2F0LCBmZnRTaXplKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZmxvYXQgJiYgdGhpcy5nZXRGbG9hdFRpbWVEb21haW5EYXRhKSB7XG4gICAgICAgICAgICB0aGlzLmdldEZsb2F0VGltZURvbWFpbkRhdGEod2F2ZWZvcm0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5nZXRCeXRlVGltZURvbWFpbkRhdGEod2F2ZWZvcm0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHdhdmVmb3JtO1xuICAgIH07XG5cbiAgICBub2RlLmdldFBpdGNoID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHBpdGNoQ2FsbGJhY2sgPSBwaXRjaENhbGxiYWNrIHx8IGNhbGxiYWNrO1xuICAgICAgICB2YXIgZiA9IG5ldyBGbG9hdDMyQXJyYXkobm9kZS5mZnRTaXplKTtcbiAgICAgICAgZi5zZXQobm9kZS5nZXRXYXZlZm9ybSh0cnVlKSk7XG4gICAgICAgIHBpdGNoV29ya2VyLnBvc3RNZXNzYWdlKHtcbiAgICAgICAgICAgIHNhbXBsZVJhdGU6IGNvbnRleHQuc2FtcGxlUmF0ZSxcbiAgICAgICAgICAgIGI6IGYuYnVmZmVyXG4gICAgICAgIH0sIFtmLmJ1ZmZlcl0pO1xuICAgIH07XG5cbiAgICBub2RlLmdldEZyZXF1ZW5jaWVzID0gZnVuY3Rpb24gKGZsb2F0KSB7XG4gICAgICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgZmxvYXQgPSBmcmVxRmxvYXQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobmVlZHNVcGRhdGUoZnJlcXVlbmNpZXMsIGZsb2F0KSkge1xuICAgICAgICAgICAgZmZ0U2l6ZSA9IG5vZGUuZmZ0U2l6ZTtcbiAgICAgICAgICAgIGZyZXFGbG9hdCA9IGZsb2F0O1xuICAgICAgICAgICAgZnJlcXVlbmNpZXMgPSBjcmVhdGVBcnJheShmbG9hdCwgbm9kZS5mcmVxdWVuY3lCaW5Db3VudCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZmxvYXQpIHtcbiAgICAgICAgICAgIHRoaXMuZ2V0RmxvYXRGcmVxdWVuY3lEYXRhKGZyZXF1ZW5jaWVzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZ2V0Qnl0ZUZyZXF1ZW5jeURhdGEoZnJlcXVlbmNpZXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZyZXF1ZW5jaWVzO1xuICAgIH07XG5cbiAgICBub2RlLmdldEFtcGxpdHVkZSA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICBhbXBsaXR1ZGVDYWxsYmFjayA9IGFtcGxpdHVkZUNhbGxiYWNrIHx8IGNhbGxiYWNrO1xuICAgICAgICB2YXIgZiA9IG5ldyBGbG9hdDMyQXJyYXkobm9kZS5mZnRTaXplKTtcbiAgICAgICAgZi5zZXQobm9kZS5nZXRGcmVxdWVuY2llcyh0cnVlKSk7XG4gICAgICAgIGFtcGxpdHVkZVdvcmtlci5wb3N0TWVzc2FnZSh7XG4gICAgICAgICAgICBzdW06IDAsXG4gICAgICAgICAgICBsZW5ndGg6IGYuYnl0ZUxlbmd0aCxcbiAgICAgICAgICAgIG51bVNhbXBsZXM6IG5vZGUuZmZ0U2l6ZSAvIDIsXG4gICAgICAgICAgICBiOiBmLmJ1ZmZlclxuICAgICAgICB9LCBbZi5idWZmZXJdKTtcbiAgICB9O1xuXG4gICAgbm9kZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIG5vZGUuZ2V0V2F2ZWZvcm0oKTtcbiAgICAgICAgbm9kZS5nZXRGcmVxdWVuY2llcygpO1xuICAgIH07XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhub2RlLCB7XG4gICAgICAgIHNtb290aGluZzoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vZGUuc21vb3RoaW5nVGltZUNvbnN0YW50O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgbm9kZS5zbW9vdGhpbmdUaW1lQ29uc3RhbnQgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIG5vZGU7XG59XG5cbmZ1bmN0aW9uIG51bWJlcih2YWx1ZSwgZGVmYXVsdFZhbHVlKSB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCAyKSB7XG4gICAgICAgIGRlZmF1bHRWYWx1ZSA9IDA7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdudW1iZXInIHx8IGlzTmFOKHZhbHVlKSkge1xuICAgICAgICByZXR1cm4gZGVmYXVsdFZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG59XG5cbnZhciBuID0gMjIwNTA7XG5cbmZ1bmN0aW9uIERpc3RvcnRpb24oY29udGV4dCwgYW1vdW50KSB7XG5cbiAgICBhbW91bnQgPSBudW1iZXIoYW1vdW50LCAxKTtcblxuICAgIHZhciBub2RlID0gY29udGV4dC5jcmVhdGVXYXZlU2hhcGVyKCk7XG4gICAgdmFyIGN1cnZlID0gbmV3IEZsb2F0MzJBcnJheShuKTtcblxuICAgIC8vIGNyZWF0ZSB3YXZlU2hhcGVyIGRpc3RvcnRpb24gY3VydmUgZnJvbSAwIHRvIDFcbiAgICBub2RlLnVwZGF0ZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBhbW91bnQgPSB2YWx1ZTtcbiAgICAgICAgaWYgKGFtb3VudCA8PSAwKSB7XG4gICAgICAgICAgICBhbW91bnQgPSAwO1xuICAgICAgICAgICAgdGhpcy5jdXJ2ZSA9IG51bGw7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGsgPSB2YWx1ZSAqIDEwMDtcbiAgICAgICAgdmFyIGRlZyA9IE1hdGguUEkgLyAxODA7XG4gICAgICAgIHZhciB4ID0gdm9pZCAwO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgICAgICB4ID0gaSAqIDIgLyBuIC0gMTtcbiAgICAgICAgICAgIGN1cnZlW2ldID0gKDMgKyBrKSAqIHggKiAyMCAqIGRlZyAvIChNYXRoLlBJICsgayAqIE1hdGguYWJzKHgpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY3VydmUgPSBjdXJ2ZTtcbiAgICB9O1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMobm9kZSwge1xuICAgICAgICBhbW91bnQ6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhbW91bnQ7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZSh2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmICh0eXBlb2YgYW1vdW50ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBub2RlLnVwZGF0ZShhbW91bnQpO1xuICAgIH1cblxuICAgIHJldHVybiBub2RlO1xufVxuXG5mdW5jdGlvbiBFY2hvKGNvbnRleHQsIGNvbmZpZykge1xuICAgIGNvbmZpZyA9IGNvbmZpZyB8fCB7fTtcblxuICAgIHZhciBpbnB1dCA9IGNvbnRleHQuY3JlYXRlR2FpbigpO1xuICAgIHZhciBkZWxheSA9IGNvbnRleHQuY3JlYXRlRGVsYXkoKTtcbiAgICB2YXIgZ2FpbiA9IGNvbnRleHQuY3JlYXRlR2FpbigpO1xuICAgIHZhciBvdXRwdXQgPSBjb250ZXh0LmNyZWF0ZUdhaW4oKTtcblxuICAgIGRlbGF5LmRlbGF5VGltZS52YWx1ZSA9IG51bWJlcihjb25maWcuZGVsYXlUaW1lLCAwLjUpO1xuICAgIGdhaW4uZ2Fpbi52YWx1ZSA9IG51bWJlcihjb25maWcuZmVlZGJhY2ssIDAuNSk7XG5cbiAgICBpbnB1dC5jb25uZWN0KGRlbGF5KTtcbiAgICBpbnB1dC5jb25uZWN0KG91dHB1dCk7XG4gICAgZGVsYXkuY29ubmVjdChnYWluKTtcbiAgICBnYWluLmNvbm5lY3QoZGVsYXkpO1xuICAgIGdhaW4uY29ubmVjdChvdXRwdXQpO1xuXG4gICAgdmFyIG5vZGUgPSBpbnB1dDtcbiAgICBub2RlLm5hbWUgPSAnRWNobyc7XG4gICAgbm9kZS5fb3V0cHV0ID0gb3V0cHV0O1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMobm9kZSwge1xuICAgICAgICBkZWxheToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlbGF5LmRlbGF5VGltZS52YWx1ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGRlbGF5LmRlbGF5VGltZS52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBmZWVkYmFjazoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdhaW4uZ2Fpbi52YWx1ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGdhaW4uZ2Fpbi52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gbm9kZTtcbn1cblxuZnVuY3Rpb24gRmFrZUNvbnRleHQoKSB7XG5cbiAgICB2YXIgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcblxuICAgIGZ1bmN0aW9uIGZuKCkge31cblxuICAgIGZ1bmN0aW9uIHBhcmFtKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdmFsdWU6IDEsXG4gICAgICAgICAgICBkZWZhdWx0VmFsdWU6IDEsXG4gICAgICAgICAgICBsaW5lYXJSYW1wVG9WYWx1ZUF0VGltZTogZm4sXG4gICAgICAgICAgICBzZXRWYWx1ZUF0VGltZTogZm4sXG4gICAgICAgICAgICBleHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lOiBmbixcbiAgICAgICAgICAgIHNldFRhcmdldEF0VGltZTogZm4sXG4gICAgICAgICAgICBzZXRWYWx1ZUN1cnZlQXRUaW1lOiBmbixcbiAgICAgICAgICAgIGNhbmNlbFNjaGVkdWxlZFZhbHVlczogZm5cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmYWtlTm9kZSgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNvbm5lY3Q6IGZuLFxuICAgICAgICAgICAgZGlzY29ubmVjdDogZm4sXG4gICAgICAgICAgICAvLyBhbmFseXNlclxuICAgICAgICAgICAgZnJlcXVlbmN5QmluQ291bnQ6IDAsXG4gICAgICAgICAgICBzbW9vdGhpbmdUaW1lQ29uc3RhbnQ6IDAsXG4gICAgICAgICAgICBmZnRTaXplOiAwLFxuICAgICAgICAgICAgbWluRGVjaWJlbHM6IDAsXG4gICAgICAgICAgICBtYXhEZWNpYmVsczogMCxcbiAgICAgICAgICAgIGdldEJ5dGVUaW1lRG9tYWluRGF0YTogZm4sXG4gICAgICAgICAgICBnZXRCeXRlRnJlcXVlbmN5RGF0YTogZm4sXG4gICAgICAgICAgICBnZXRGbG9hdFRpbWVEb21haW5EYXRhOiBmbixcbiAgICAgICAgICAgIGdldEZsb2F0RnJlcXVlbmN5RGF0YTogZm4sXG4gICAgICAgICAgICAvLyBnYWluXG4gICAgICAgICAgICBnYWluOiBwYXJhbSgpLFxuICAgICAgICAgICAgLy8gcGFubmVyXG4gICAgICAgICAgICBwYW5uaW5nTW9kZWw6IDAsXG4gICAgICAgICAgICBzZXRQb3NpdGlvbjogZm4sXG4gICAgICAgICAgICBzZXRPcmllbnRhdGlvbjogZm4sXG4gICAgICAgICAgICBzZXRWZWxvY2l0eTogZm4sXG4gICAgICAgICAgICBkaXN0YW5jZU1vZGVsOiAwLFxuICAgICAgICAgICAgcmVmRGlzdGFuY2U6IDAsXG4gICAgICAgICAgICBtYXhEaXN0YW5jZTogMCxcbiAgICAgICAgICAgIHJvbGxvZmZGYWN0b3I6IDAsXG4gICAgICAgICAgICBjb25lSW5uZXJBbmdsZTogMzYwLFxuICAgICAgICAgICAgY29uZU91dGVyQW5nbGU6IDM2MCxcbiAgICAgICAgICAgIGNvbmVPdXRlckdhaW46IDAsXG4gICAgICAgICAgICAvLyBmaWx0ZXI6XG4gICAgICAgICAgICB0eXBlOiAwLFxuICAgICAgICAgICAgZnJlcXVlbmN5OiBwYXJhbSgpLFxuICAgICAgICAgICAgUTogcGFyYW0oKSxcbiAgICAgICAgICAgIGRldHVuZTogcGFyYW0oKSxcbiAgICAgICAgICAgIC8vIGRlbGF5XG4gICAgICAgICAgICBkZWxheVRpbWU6IHBhcmFtKCksXG4gICAgICAgICAgICAvLyBjb252b2x2ZXJcbiAgICAgICAgICAgIGJ1ZmZlcjogMCxcbiAgICAgICAgICAgIC8vIGNvbXByZXNzb3JcbiAgICAgICAgICAgIHRocmVzaG9sZDogcGFyYW0oKSxcbiAgICAgICAgICAgIGtuZWU6IHBhcmFtKCksXG4gICAgICAgICAgICByYXRpbzogcGFyYW0oKSxcbiAgICAgICAgICAgIGF0dGFjazogcGFyYW0oKSxcbiAgICAgICAgICAgIHJlbGVhc2U6IHBhcmFtKCksXG4gICAgICAgICAgICByZWR1Y3Rpb246IHBhcmFtKCksXG4gICAgICAgICAgICAvLyBkaXN0b3J0aW9uXG4gICAgICAgICAgICBvdmVyc2FtcGxlOiAwLFxuICAgICAgICAgICAgY3VydmU6IDAsXG4gICAgICAgICAgICAvLyBidWZmZXJcbiAgICAgICAgICAgIHNhbXBsZVJhdGU6IDEsXG4gICAgICAgICAgICBsZW5ndGg6IDAsXG4gICAgICAgICAgICBkdXJhdGlvbjogMCxcbiAgICAgICAgICAgIG51bWJlck9mQ2hhbm5lbHM6IDAsXG4gICAgICAgICAgICBnZXRDaGFubmVsRGF0YTogZnVuY3Rpb24gZ2V0Q2hhbm5lbERhdGEoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNvcHlGcm9tQ2hhbm5lbDogZm4sXG4gICAgICAgICAgICBjb3B5VG9DaGFubmVsOiBmbixcbiAgICAgICAgICAgIC8vIGxpc3RlbmVyXG4gICAgICAgICAgICBkb3BwbGVyRmFjdG9yOiAwLFxuICAgICAgICAgICAgc3BlZWRPZlNvdW5kOiAwLFxuICAgICAgICAgICAgLy8gb3NjXG4gICAgICAgICAgICBzdGFydDogZm5cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBpZTlcbiAgICBpZiAoIXdpbmRvdy5VaW50OEFycmF5KSB7XG4gICAgICAgIHdpbmRvdy5VaW50OEFycmF5ID0gd2luZG93LkZsb2F0MzJBcnJheSA9IEFycmF5O1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIGNyZWF0ZUFuYWx5c2VyOiBmYWtlTm9kZSxcbiAgICAgICAgY3JlYXRlQnVmZmVyOiBmYWtlTm9kZSxcbiAgICAgICAgY3JlYXRlQmlxdWFkRmlsdGVyOiBmYWtlTm9kZSxcbiAgICAgICAgY3JlYXRlQ2hhbm5lbE1lcmdlcjogZmFrZU5vZGUsXG4gICAgICAgIGNyZWF0ZUNoYW5uZWxTcGxpdHRlcjogZmFrZU5vZGUsXG4gICAgICAgIGNyZWF0ZUR5bmFtaWNzQ29tcHJlc3NvcjogZmFrZU5vZGUsXG4gICAgICAgIGNyZWF0ZUNvbnZvbHZlcjogZmFrZU5vZGUsXG4gICAgICAgIGNyZWF0ZURlbGF5OiBmYWtlTm9kZSxcbiAgICAgICAgY3JlYXRlR2FpbjogZmFrZU5vZGUsXG4gICAgICAgIGNyZWF0ZU9zY2lsbGF0b3I6IGZha2VOb2RlLFxuICAgICAgICBjcmVhdGVQYW5uZXI6IGZha2VOb2RlLFxuICAgICAgICBjcmVhdGVTY3JpcHRQcm9jZXNzb3I6IGZha2VOb2RlLFxuICAgICAgICBjcmVhdGVXYXZlU2hhcGVyOiBmYWtlTm9kZSxcbiAgICAgICAgbGlzdGVuZXI6IGZha2VOb2RlKCksXG4gICAgICAgIGdldCBjdXJyZW50VGltZSgpIHtcbiAgICAgICAgICAgIHJldHVybiAoRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSkgLyAxMDAwO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0JpcXVhZEZpbHRlck5vZGVcbi8vIEZvciBsb3dwYXNzIGFuZCBoaWdocGFzcyBRIGluZGljYXRlcyBob3cgcGVha2VkIHRoZSBmcmVxdWVuY3kgaXMgYXJvdW5kIHRoZSBjdXRvZmYuXG4vLyBUaGUgZ3JlYXRlciB0aGUgdmFsdWUgaXMsIHRoZSBncmVhdGVyIGlzIHRoZSBwZWFrXG5cbmZ1bmN0aW9uIEZpbHRlcihjb250ZXh0KSB7XG4gICAgdmFyIGNvbmZpZyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/IHt9IDogYXJndW1lbnRzWzFdO1xuXG4gICAgLy8gRnJlcXVlbmN5IGJldHdlZW4gNDBIeiBhbmQgaGFsZiBvZiB0aGUgc2FtcGxpbmcgcmF0ZVxuICAgIHZhciBtaW5GcmVxdWVuY3kgPSA0MDtcbiAgICB2YXIgbWF4RnJlcXVlbmN5ID0gY29udGV4dC5zYW1wbGVSYXRlIC8gMjtcblxuICAgIHZhciBub2RlID0gY29udGV4dC5jcmVhdGVCaXF1YWRGaWx0ZXIoKTtcbiAgICBub2RlLnR5cGUgPSBjb25maWcudHlwZTtcblxuICAgIGZ1bmN0aW9uIGdldEZyZXF1ZW5jeSh2YWx1ZSkge1xuICAgICAgICAvLyBMb2dhcml0aG0gKGJhc2UgMikgdG8gY29tcHV0ZSBob3cgbWFueSBvY3RhdmVzIGZhbGwgaW4gdGhlIHJhbmdlLlxuICAgICAgICB2YXIgbnVtYmVyT2ZPY3RhdmVzID0gTWF0aC5sb2cobWF4RnJlcXVlbmN5IC8gbWluRnJlcXVlbmN5KSAvIE1hdGguTE4yO1xuICAgICAgICAvLyBDb21wdXRlIGEgbXVsdGlwbGllciBmcm9tIDAgdG8gMSBiYXNlZCBvbiBhbiBleHBvbmVudGlhbCBzY2FsZS5cbiAgICAgICAgdmFyIG11bHRpcGxpZXIgPSBNYXRoLnBvdygyLCBudW1iZXJPZk9jdGF2ZXMgKiAodmFsdWUgLSAxLjApKTtcbiAgICAgICAgLy8gR2V0IGJhY2sgdG8gdGhlIGZyZXF1ZW5jeSB2YWx1ZSBiZXR3ZWVuIG1pbiBhbmQgbWF4LlxuICAgICAgICByZXR1cm4gbWF4RnJlcXVlbmN5ICogbXVsdGlwbGllcjtcbiAgICB9XG5cbiAgICBub2RlLnNldCA9IGZ1bmN0aW9uIChmcmVxdWVuY3ksIHEsIGdhaW4pIHtcbiAgICAgICAgaWYgKHR5cGVvZiBmcmVxdWVuY3kgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBmcmVxdWVuY3kgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICBub2RlLmZyZXF1ZW5jeS52YWx1ZSA9IGZyZXF1ZW5jeTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHEgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBxID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgbm9kZS5RLnZhbHVlID0gcTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGdhaW4gIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBnYWluID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgbm9kZS5nYWluLnZhbHVlID0gZ2FpbjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbm9kZTtcbiAgICB9O1xuXG4gICAgLy8gc2V0IGZpbHRlciBmcmVxdWVuY3kgYmFzZWQgb24gdmFsdWUgZnJvbSAwIHRvIDFcbiAgICBub2RlLnNldEJ5UGVyY2VudCA9IGZ1bmN0aW9uIChwZXJjZW50LCBxLCBnYWluKSB7XG4gICAgICAgIHJldHVybiBub2RlLnNldChnZXRGcmVxdWVuY3kocGVyY2VudCksIHEsIGdhaW4pO1xuICAgIH07XG5cbiAgICByZXR1cm4gbm9kZS5zZXQoY29uZmlnLmZyZXF1ZW5jeSwgY29uZmlnLnEsIGNvbmZpZy5nYWluKTtcbn1cblxuZnVuY3Rpb24gTW9ub0ZsYW5nZXIoY29udGV4dCwgY29uZmlnKSB7XG4gICAgdmFyIGlucHV0ID0gY29udGV4dC5jcmVhdGVHYWluKCk7XG4gICAgdmFyIGRlbGF5ID0gY29udGV4dC5jcmVhdGVEZWxheSgpO1xuICAgIHZhciBmZWVkYmFjayA9IGNvbnRleHQuY3JlYXRlR2FpbigpO1xuICAgIHZhciBsZm8gPSBjb250ZXh0LmNyZWF0ZU9zY2lsbGF0b3IoKTtcbiAgICB2YXIgZ2FpbiA9IGNvbnRleHQuY3JlYXRlR2FpbigpO1xuICAgIHZhciBvdXRwdXQgPSBjb250ZXh0LmNyZWF0ZUdhaW4oKTtcblxuICAgIGRlbGF5LmRlbGF5VGltZS52YWx1ZSA9IG51bWJlcihjb25maWcuZGVsYXksIDAuMDA1KTsgLy8gNS0yNW1zIGRlbGF5ICgwLjAwNSA+IDAuMDI1KVxuICAgIGZlZWRiYWNrLmdhaW4udmFsdWUgPSBudW1iZXIoY29uZmlnLmZlZWRiYWNrLCAwLjUpOyAvLyAwID4gMVxuXG4gICAgbGZvLnR5cGUgPSAnc2luZSc7XG4gICAgbGZvLmZyZXF1ZW5jeS52YWx1ZSA9IG51bWJlcihjb25maWcuZnJlcXVlbmN5LCAwLjAwMik7IC8vIDAuMDUgPiA1XG4gICAgZ2Fpbi5nYWluLnZhbHVlID0gbnVtYmVyKGNvbmZpZy5nYWluLCAwLjI1KTsgLy8gMC4wMDA1ID4gMC4wMDVcblxuICAgIGlucHV0LmNvbm5lY3Qob3V0cHV0KTtcbiAgICBpbnB1dC5jb25uZWN0KGRlbGF5KTtcbiAgICBkZWxheS5jb25uZWN0KG91dHB1dCk7XG4gICAgZGVsYXkuY29ubmVjdChmZWVkYmFjayk7XG4gICAgZmVlZGJhY2suY29ubmVjdChpbnB1dCk7XG5cbiAgICBsZm8uY29ubmVjdChnYWluKTtcbiAgICBnYWluLmNvbm5lY3QoZGVsYXkuZGVsYXlUaW1lKTtcbiAgICBsZm8uc3RhcnQoMCk7XG5cbiAgICB2YXIgbm9kZSA9IGlucHV0O1xuICAgIG5vZGUubmFtZSA9ICdGbGFuZ2VyJztcbiAgICBub2RlLl9vdXRwdXQgPSBvdXRwdXQ7XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhub2RlLCB7XG4gICAgICAgIGRlbGF5OiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVsYXkuZGVsYXlUaW1lLnZhbHVlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgZGVsYXkuZGVsYXlUaW1lLnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGxmb0ZyZXF1ZW5jeToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxmby5mcmVxdWVuY3kudmFsdWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBsZm8uZnJlcXVlbmN5LnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGxmb0dhaW46IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBnYWluLmdhaW4udmFsdWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBnYWluLmdhaW4udmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZmVlZGJhY2s6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmZWVkYmFjay5nYWluLnZhbHVlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgZmVlZGJhY2suZ2Fpbi52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gbm9kZTtcbn1cblxuZnVuY3Rpb24gU3RlcmVvRmxhbmdlcihjb250ZXh0LCBjb25maWcpIHtcbiAgICB2YXIgaW5wdXQgPSBjb250ZXh0LmNyZWF0ZUdhaW4oKTtcbiAgICB2YXIgc3BsaXR0ZXIgPSBjb250ZXh0LmNyZWF0ZUNoYW5uZWxTcGxpdHRlcigyKTtcbiAgICB2YXIgbWVyZ2VyID0gY29udGV4dC5jcmVhdGVDaGFubmVsTWVyZ2VyKDIpO1xuICAgIHZhciBmZWVkYmFja0wgPSBjb250ZXh0LmNyZWF0ZUdhaW4oKTtcbiAgICB2YXIgZmVlZGJhY2tSID0gY29udGV4dC5jcmVhdGVHYWluKCk7XG4gICAgdmFyIGxmbyA9IGNvbnRleHQuY3JlYXRlT3NjaWxsYXRvcigpO1xuICAgIHZhciBsZm9HYWluTCA9IGNvbnRleHQuY3JlYXRlR2FpbigpO1xuICAgIHZhciBsZm9HYWluUiA9IGNvbnRleHQuY3JlYXRlR2FpbigpO1xuICAgIHZhciBkZWxheUwgPSBjb250ZXh0LmNyZWF0ZURlbGF5KCk7XG4gICAgdmFyIGRlbGF5UiA9IGNvbnRleHQuY3JlYXRlRGVsYXkoKTtcbiAgICB2YXIgb3V0cHV0ID0gY29udGV4dC5jcmVhdGVHYWluKCk7XG5cbiAgICBmZWVkYmFja0wuZ2Fpbi52YWx1ZSA9IGZlZWRiYWNrUi5nYWluLnZhbHVlID0gbnVtYmVyKGNvbmZpZy5mZWVkYmFjaywgMC41KTtcbiAgICBkZWxheUwuZGVsYXlUaW1lLnZhbHVlID0gZGVsYXlSLmRlbGF5VGltZS52YWx1ZSA9IG51bWJlcihjb25maWcuZGVsYXksIDAuMDAzKTtcblxuICAgIGxmby50eXBlID0gJ3NpbmUnO1xuICAgIGxmby5mcmVxdWVuY3kudmFsdWUgPSBudW1iZXIoY29uZmlnLmZyZXF1ZW5jeSwgMC41KTtcbiAgICBsZm9HYWluTC5nYWluLnZhbHVlID0gbnVtYmVyKGNvbmZpZy5nYWluLCAwLjAwNSk7XG4gICAgbGZvR2FpblIuZ2Fpbi52YWx1ZSA9IDAgLSBsZm9HYWluTC5nYWluLnZhbHVlO1xuXG4gICAgaW5wdXQuY29ubmVjdChzcGxpdHRlcik7XG5cbiAgICBzcGxpdHRlci5jb25uZWN0KGRlbGF5TCwgMCk7XG4gICAgc3BsaXR0ZXIuY29ubmVjdChkZWxheVIsIDEpO1xuXG4gICAgZGVsYXlMLmNvbm5lY3QoZmVlZGJhY2tMKTtcbiAgICBkZWxheVIuY29ubmVjdChmZWVkYmFja1IpO1xuXG4gICAgZmVlZGJhY2tMLmNvbm5lY3QoZGVsYXlSKTtcbiAgICBmZWVkYmFja1IuY29ubmVjdChkZWxheUwpO1xuXG4gICAgZGVsYXlMLmNvbm5lY3QobWVyZ2VyLCAwLCAwKTtcbiAgICBkZWxheVIuY29ubmVjdChtZXJnZXIsIDAsIDEpO1xuXG4gICAgbWVyZ2VyLmNvbm5lY3Qob3V0cHV0KTtcbiAgICBpbnB1dC5jb25uZWN0KG91dHB1dCk7XG5cbiAgICBsZm8uY29ubmVjdChsZm9HYWluTCk7XG4gICAgbGZvLmNvbm5lY3QobGZvR2FpblIpO1xuICAgIGxmb0dhaW5MLmNvbm5lY3QoZGVsYXlMLmRlbGF5VGltZSk7XG4gICAgbGZvR2FpblIuY29ubmVjdChkZWxheVIuZGVsYXlUaW1lKTtcbiAgICBsZm8uc3RhcnQoMCk7XG5cbiAgICB2YXIgbm9kZSA9IGlucHV0O1xuICAgIG5vZGUubmFtZSA9ICdTdGVyZW9GbGFuZ2VyJztcbiAgICBub2RlLl9vdXRwdXQgPSBvdXRwdXQ7XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhub2RlLCB7XG4gICAgICAgIGRlbGF5OiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVsYXlMLmRlbGF5VGltZS52YWx1ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGRlbGF5TC5kZWxheVRpbWUudmFsdWUgPSBkZWxheVIuZGVsYXlUaW1lLnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGxmb0ZyZXF1ZW5jeToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxmby5mcmVxdWVuY3kudmFsdWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBsZm8uZnJlcXVlbmN5LnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGxmb0dhaW46IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBsZm9HYWluTC5nYWluLnZhbHVlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgbGZvR2FpbkwuZ2Fpbi52YWx1ZSA9IGxmb0dhaW5SLmdhaW4udmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZmVlZGJhY2s6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmZWVkYmFja0wuZ2Fpbi52YWx1ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGZlZWRiYWNrTC5nYWluLnZhbHVlID0gZmVlZGJhY2tSLmdhaW4udmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIG5vZGU7XG59XG5cbmZ1bmN0aW9uIEZsYW5nZXIoY29udGV4dCwgY29uZmlnKSB7XG4gICAgY29uZmlnID0gY29uZmlnIHx8IHt9O1xuICAgIHJldHVybiBjb25maWcuc3RlcmVvID8gbmV3IFN0ZXJlb0ZsYW5nZXIoY29udGV4dCwgY29uZmlnKSA6IG5ldyBNb25vRmxhbmdlcihjb250ZXh0LCBjb25maWcpO1xufVxuXG5mdW5jdGlvbiBQYW5uZXIoY29udGV4dCkge1xuICAgIHZhciBub2RlID0gY29udGV4dC5jcmVhdGVQYW5uZXIoKTtcblxuICAgIC8vIERlZmF1bHQgZm9yIHN0ZXJlbyBpcyAnSFJURicgY2FuIGFsc28gYmUgJ2VxdWFscG93ZXInXG4gICAgbm9kZS5wYW5uaW5nTW9kZWwgPSBQYW5uZXIuZGVmYXVsdHMucGFubmluZ01vZGVsO1xuXG4gICAgLy8gRGlzdGFuY2UgbW9kZWwgYW5kIGF0dHJpYnV0ZXNcbiAgICAvLyBDYW4gYmUgJ2xpbmVhcicgJ2ludmVyc2UnICdleHBvbmVudGlhbCdcbiAgICBub2RlLmRpc3RhbmNlTW9kZWwgPSBQYW5uZXIuZGVmYXVsdHMuZGlzdGFuY2VNb2RlbDtcbiAgICBub2RlLnJlZkRpc3RhbmNlID0gUGFubmVyLmRlZmF1bHRzLnJlZkRpc3RhbmNlO1xuICAgIG5vZGUubWF4RGlzdGFuY2UgPSBQYW5uZXIuZGVmYXVsdHMubWF4RGlzdGFuY2U7XG4gICAgbm9kZS5yb2xsb2ZmRmFjdG9yID0gUGFubmVyLmRlZmF1bHRzLnJvbGxvZmZGYWN0b3I7XG4gICAgbm9kZS5jb25lSW5uZXJBbmdsZSA9IFBhbm5lci5kZWZhdWx0cy5jb25lSW5uZXJBbmdsZTtcbiAgICBub2RlLmNvbmVPdXRlckFuZ2xlID0gUGFubmVyLmRlZmF1bHRzLmNvbmVPdXRlckFuZ2xlO1xuICAgIG5vZGUuY29uZU91dGVyR2FpbiA9IFBhbm5lci5kZWZhdWx0cy5jb25lT3V0ZXJHYWluO1xuICAgIC8vIHNldCB0byBkZWZhdWx0cyAobmVlZGVkIGluIEZpcmVmb3gpXG4gICAgbm9kZS5zZXRQb3NpdGlvbigwLCAwLCAxKTtcbiAgICBub2RlLnNldE9yaWVudGF0aW9uKDAsIDAsIDApO1xuXG4gICAgLy8gc2ltcGxlIHZlYzMgb2JqZWN0IHBvb2xcbiAgICB2YXIgdmVjUG9vbCA9IHtcbiAgICAgICAgcG9vbDogW10sXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KHgsIHksIHopIHtcbiAgICAgICAgICAgIHZhciB2ID0gdGhpcy5wb29sLmxlbmd0aCA/IHRoaXMucG9vbC5wb3AoKSA6IHtcbiAgICAgICAgICAgICAgICB4OiAwLFxuICAgICAgICAgICAgICAgIHk6IDAsXG4gICAgICAgICAgICAgICAgejogMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIGEgdmVjdG9yIGhhcyBiZWVuIHBhc3NlZCBpblxuICAgICAgICAgICAgaWYgKHR5cGVvZiB4ICE9PSAndW5kZWZpbmVkJyAmJiBpc05hTih4KSAmJiAneCcgaW4geCAmJiAneScgaW4geCAmJiAneicgaW4geCkge1xuICAgICAgICAgICAgICAgIHYueCA9IG51bWJlcih4LngpO1xuICAgICAgICAgICAgICAgIHYueSA9IG51bWJlcih4LnkpO1xuICAgICAgICAgICAgICAgIHYueiA9IG51bWJlcih4LnopO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2LnggPSBudW1iZXIoeCk7XG4gICAgICAgICAgICAgICAgdi55ID0gbnVtYmVyKHkpO1xuICAgICAgICAgICAgICAgIHYueiA9IG51bWJlcih6KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB2O1xuICAgICAgICB9LFxuICAgICAgICBkaXNwb3NlOiBmdW5jdGlvbiBkaXNwb3NlKGluc3RhbmNlKSB7XG4gICAgICAgICAgICB0aGlzLnBvb2wucHVzaChpbnN0YW5jZSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdmFyIGdsb2JhbFVwID0gdmVjUG9vbC5nZXQoMCwgMSwgMCksXG4gICAgICAgIGFuZ2xlNDUgPSBNYXRoLlBJIC8gNCxcbiAgICAgICAgYW5nbGU5MCA9IE1hdGguUEkgLyAyO1xuXG4gICAgLy8gY3Jvc3MgcHJvZHVjdCBvZiAyIHZlY3RvcnNcbiAgICBmdW5jdGlvbiBjcm9zcyhhLCBiKSB7XG4gICAgICAgIHZhciBheCA9IGEueCxcbiAgICAgICAgICAgIGF5ID0gYS55LFxuICAgICAgICAgICAgYXogPSBhLno7XG4gICAgICAgIHZhciBieCA9IGIueCxcbiAgICAgICAgICAgIGJ5ID0gYi55LFxuICAgICAgICAgICAgYnogPSBiLno7XG4gICAgICAgIGEueCA9IGF5ICogYnogLSBheiAqIGJ5O1xuICAgICAgICBhLnkgPSBheiAqIGJ4IC0gYXggKiBiejtcbiAgICAgICAgYS56ID0gYXggKiBieSAtIGF5ICogYng7XG4gICAgfVxuXG4gICAgLy8gbm9ybWFsaXNlIHRvIHVuaXQgdmVjdG9yXG4gICAgZnVuY3Rpb24gbm9ybWFsaXplKHZlYzMpIHtcbiAgICAgICAgaWYgKHZlYzMueCA9PT0gMCAmJiB2ZWMzLnkgPT09IDAgJiYgdmVjMy56ID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gdmVjMztcbiAgICAgICAgfVxuICAgICAgICB2YXIgbGVuZ3RoID0gTWF0aC5zcXJ0KHZlYzMueCAqIHZlYzMueCArIHZlYzMueSAqIHZlYzMueSArIHZlYzMueiAqIHZlYzMueik7XG4gICAgICAgIHZhciBpbnZTY2FsYXIgPSAxIC8gbGVuZ3RoO1xuICAgICAgICB2ZWMzLnggKj0gaW52U2NhbGFyO1xuICAgICAgICB2ZWMzLnkgKj0gaW52U2NhbGFyO1xuICAgICAgICB2ZWMzLnogKj0gaW52U2NhbGFyO1xuICAgICAgICByZXR1cm4gdmVjMztcbiAgICB9XG5cbiAgICAvLyBzZXQgdGhlIG9yaWVudGF0aW9uIG9mIHRoZSBzb3VyY2UgKHdoZXJlIHRoZSBhdWRpbyBpcyBjb21pbmcgZnJvbSlcbiAgICBmdW5jdGlvbiBzZXRPcmllbnRhdGlvbihwYW5uZXJOb2RlLCBmdykge1xuICAgICAgICAvLyBjYWxjdWxhdGUgdXAgdmVjICggdXAgPSAoZm9yd2FyZCBjcm9zcyAoMCwgMSwgMCkpIGNyb3NzIGZvcndhcmQgKVxuICAgICAgICB2YXIgdXAgPSB2ZWNQb29sLmdldChmdy54LCBmdy55LCBmdy56KTtcbiAgICAgICAgY3Jvc3ModXAsIGdsb2JhbFVwKTtcbiAgICAgICAgY3Jvc3ModXAsIGZ3KTtcbiAgICAgICAgbm9ybWFsaXplKHVwKTtcbiAgICAgICAgbm9ybWFsaXplKGZ3KTtcbiAgICAgICAgLy8gc2V0IHRoZSBhdWRpbyBjb250ZXh0J3MgbGlzdGVuZXIgcG9zaXRpb24gdG8gbWF0Y2ggdGhlIGNhbWVyYSBwb3NpdGlvblxuICAgICAgICBwYW5uZXJOb2RlLnNldE9yaWVudGF0aW9uKGZ3LngsIGZ3LnksIGZ3LnosIHVwLngsIHVwLnksIHVwLnopO1xuICAgICAgICAvLyByZXR1cm4gdGhlIHZlY3MgdG8gdGhlIHBvb2xcbiAgICAgICAgdmVjUG9vbC5kaXNwb3NlKGZ3KTtcbiAgICAgICAgdmVjUG9vbC5kaXNwb3NlKHVwKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRQb3NpdGlvbihub2RlT3JMaXN0ZW5lciwgdmVjKSB7XG4gICAgICAgIG5vZGVPckxpc3RlbmVyLnNldFBvc2l0aW9uKHZlYy54LCB2ZWMueSwgdmVjLnopO1xuICAgICAgICB2ZWNQb29sLmRpc3Bvc2UodmVjKTtcbiAgICB9XG5cbiAgICBub2RlLnNldCA9IGZ1bmN0aW9uICh4LCB5LCB6KSB7XG4gICAgICAgIHZhciB2ID0gdmVjUG9vbC5nZXQoeCwgeSwgeik7XG5cbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgJiYgdi54KSB7XG4gICAgICAgICAgICAvLyBwYW4gbGVmdCB0byByaWdodCB3aXRoIHZhbHVlIGZyb20gLTEgdG8gMVxuICAgICAgICAgICAgeCA9IHYueDtcblxuICAgICAgICAgICAgaWYgKHggPiAxKSB7XG4gICAgICAgICAgICAgICAgeCA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoeCA8IC0xKSB7XG4gICAgICAgICAgICAgICAgeCA9IC0xO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBjcmVhdGVzIGEgbmljZSBjdXJ2ZSB3aXRoIHpcbiAgICAgICAgICAgIHggPSB4ICogYW5nbGU0NTtcbiAgICAgICAgICAgIHogPSB4ICsgYW5nbGU5MDtcblxuICAgICAgICAgICAgaWYgKHogPiBhbmdsZTkwKSB7XG4gICAgICAgICAgICAgICAgeiA9IE1hdGguUEkgLSB6O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2LnggPSBNYXRoLnNpbih4KTtcbiAgICAgICAgICAgIHYueiA9IE1hdGguc2luKHopO1xuICAgICAgICB9XG4gICAgICAgIHNldFBvc2l0aW9uKG5vZGUsIHYpO1xuICAgIH07XG5cbiAgICAvLyBzZXQgdGhlIHBvc2l0aW9uIHRoZSBhdWRpbyBpcyBjb21pbmcgZnJvbSlcbiAgICBub2RlLnNldFNvdXJjZVBvc2l0aW9uID0gZnVuY3Rpb24gKHgsIHksIHopIHtcbiAgICAgICAgc2V0UG9zaXRpb24obm9kZSwgdmVjUG9vbC5nZXQoeCwgeSwgeikpO1xuICAgIH07XG5cbiAgICAvLyBzZXQgdGhlIGRpcmVjdGlvbiB0aGUgYXVkaW8gaXMgY29taW5nIGZyb20pXG4gICAgbm9kZS5zZXRTb3VyY2VPcmllbnRhdGlvbiA9IGZ1bmN0aW9uICh4LCB5LCB6KSB7XG4gICAgICAgIHNldE9yaWVudGF0aW9uKG5vZGUsIHZlY1Bvb2wuZ2V0KHgsIHksIHopKTtcbiAgICB9O1xuXG4gICAgLy8gc2V0IHRoZSBwb3NpdGlvbiBvZiB3aG8gb3Igd2hhdCBpcyBoZWFyaW5nIHRoZSBhdWRpbyAoY291bGQgYmUgY2FtZXJhIG9yIHNvbWUgY2hhcmFjdGVyKVxuICAgIG5vZGUuc2V0TGlzdGVuZXJQb3NpdGlvbiA9IGZ1bmN0aW9uICh4LCB5LCB6KSB7XG4gICAgICAgIHNldFBvc2l0aW9uKGNvbnRleHQubGlzdGVuZXIsIHZlY1Bvb2wuZ2V0KHgsIHksIHopKTtcbiAgICB9O1xuXG4gICAgLy8gc2V0IHRoZSBwb3NpdGlvbiBvZiB3aG8gb3Igd2hhdCBpcyBoZWFyaW5nIHRoZSBhdWRpbyAoY291bGQgYmUgY2FtZXJhIG9yIHNvbWUgY2hhcmFjdGVyKVxuICAgIG5vZGUuc2V0TGlzdGVuZXJPcmllbnRhdGlvbiA9IGZ1bmN0aW9uICh4LCB5LCB6KSB7XG4gICAgICAgIHNldE9yaWVudGF0aW9uKGNvbnRleHQubGlzdGVuZXIsIHZlY1Bvb2wuZ2V0KHgsIHksIHopKTtcbiAgICB9O1xuXG4gICAgbm9kZS5nZXREZWZhdWx0cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFBhbm5lci5kZWZhdWx0cztcbiAgICB9O1xuXG4gICAgbm9kZS5zZXREZWZhdWx0cyA9IGZ1bmN0aW9uIChkZWZhdWx0cykge1xuICAgICAgICBPYmplY3Qua2V5cyhkZWZhdWx0cykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICBQYW5uZXIuZGVmYXVsdHNba2V5XSA9IGRlZmF1bHRzW2tleV07XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICByZXR1cm4gbm9kZTtcbn1cblxuUGFubmVyLmRlZmF1bHRzID0ge1xuICAgIHBhbm5pbmdNb2RlbDogJ0hSVEYnLFxuICAgIGRpc3RhbmNlTW9kZWw6ICdsaW5lYXInLFxuICAgIHJlZkRpc3RhbmNlOiAxLFxuICAgIG1heERpc3RhbmNlOiAxMDAwLFxuICAgIHJvbGxvZmZGYWN0b3I6IDEsXG4gICAgY29uZUlubmVyQW5nbGU6IDM2MCxcbiAgICBjb25lT3V0ZXJBbmdsZTogMCxcbiAgICBjb25lT3V0ZXJHYWluOiAwXG59O1xuXG5mdW5jdGlvbiBQaGFzZXIoY29udGV4dCkge1xuICAgIHZhciBjb25maWcgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1sxXTtcblxuICAgIHZhciBzdGFnZXMgPSBudW1iZXIoY29uZmlnLnN0YWdlcywgOCk7XG4gICAgdmFyIGZpbHRlcnMgPSBbXTtcbiAgICB2YXIgZmlsdGVyID0gdm9pZCAwO1xuXG4gICAgdmFyIGlucHV0ID0gY29udGV4dC5jcmVhdGVHYWluKCk7XG4gICAgdmFyIGZlZWRiYWNrID0gY29udGV4dC5jcmVhdGVHYWluKCk7XG4gICAgdmFyIGxmbyA9IGNvbnRleHQuY3JlYXRlT3NjaWxsYXRvcigpO1xuICAgIHZhciBsZm9HYWluID0gY29udGV4dC5jcmVhdGVHYWluKCk7XG4gICAgdmFyIG91dHB1dCA9IGNvbnRleHQuY3JlYXRlR2FpbigpO1xuXG4gICAgZmVlZGJhY2suZ2Fpbi52YWx1ZSA9IG51bWJlcihjb25maWcuZmVlZGJhY2ssIDAuNSk7XG5cbiAgICBsZm8udHlwZSA9ICdzaW5lJztcbiAgICBsZm8uZnJlcXVlbmN5LnZhbHVlID0gbnVtYmVyKGNvbmZpZy5mcmVxdWVuY3ksIDAuNSk7XG4gICAgbGZvR2Fpbi5nYWluLnZhbHVlID0gbnVtYmVyKGNvbmZpZy5nYWluLCAzMDApO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdGFnZXM7IGkrKykge1xuICAgICAgICBmaWx0ZXIgPSBjb250ZXh0LmNyZWF0ZUJpcXVhZEZpbHRlcigpO1xuICAgICAgICBmaWx0ZXIudHlwZSA9ICdhbGxwYXNzJztcbiAgICAgICAgZmlsdGVyLmZyZXF1ZW5jeS52YWx1ZSA9IDEwMDAgKiBpO1xuICAgICAgICAvL2ZpbHRlci5RLnZhbHVlID0gMTA7XG4gICAgICAgIGlmIChpID4gMCkge1xuICAgICAgICAgICAgZmlsdGVyc1tpIC0gMV0uY29ubmVjdChmaWx0ZXIpO1xuICAgICAgICB9XG4gICAgICAgIGxmb0dhaW4uY29ubmVjdChmaWx0ZXIuZnJlcXVlbmN5KTtcblxuICAgICAgICBmaWx0ZXJzLnB1c2goZmlsdGVyKTtcbiAgICB9XG5cbiAgICB2YXIgZmlyc3QgPSBmaWx0ZXJzWzBdO1xuICAgIHZhciBsYXN0ID0gZmlsdGVyc1tmaWx0ZXJzLmxlbmd0aCAtIDFdO1xuXG4gICAgaW5wdXQuY29ubmVjdChmaXJzdCk7XG4gICAgaW5wdXQuY29ubmVjdChvdXRwdXQpO1xuICAgIGxhc3QuY29ubmVjdChvdXRwdXQpO1xuICAgIGxhc3QuY29ubmVjdChmZWVkYmFjayk7XG4gICAgZmVlZGJhY2suY29ubmVjdChmaXJzdCk7XG4gICAgbGZvLmNvbm5lY3QobGZvR2Fpbik7XG4gICAgbGZvLnN0YXJ0KDApO1xuXG4gICAgdmFyIG5vZGUgPSBpbnB1dDtcbiAgICBub2RlLm5hbWUgPSAnUGhhc2VyJztcbiAgICBub2RlLl9vdXRwdXQgPSBvdXRwdXQ7XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhub2RlLCB7XG4gICAgICAgIGxmb0ZyZXF1ZW5jeToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxmby5mcmVxdWVuY3kudmFsdWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBsZm8uZnJlcXVlbmN5LnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGxmb0dhaW46IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBsZm9HYWluLmdhaW4udmFsdWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBsZm9HYWluLmdhaW4udmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZmVlZGJhY2s6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmZWVkYmFjay5nYWluLnZhbHVlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgZmVlZGJhY2suZ2Fpbi52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gbm9kZTtcbn1cblxuZnVuY3Rpb24gUmVjb3JkZXIoY29udGV4dCwgcGFzc1Rocm91Z2gpIHtcbiAgICB2YXIgYnVmZmVyTGVuZ3RoID0gNDA5NixcbiAgICAgICAgYnVmZmVyc0wgPSBbXSxcbiAgICAgICAgYnVmZmVyc1IgPSBbXTtcbiAgICB2YXIgc3RhcnRlZEF0ID0gMCxcbiAgICAgICAgc3RvcHBlZEF0ID0gMDtcblxuICAgIHZhciBpbnB1dCA9IGNvbnRleHQuY3JlYXRlR2FpbigpO1xuICAgIHZhciBvdXRwdXQgPSBjb250ZXh0LmNyZWF0ZUdhaW4oKTtcbiAgICB2YXIgc2NyaXB0ID0gdm9pZCAwO1xuXG4gICAgdmFyIG5vZGUgPSBpbnB1dDtcbiAgICBub2RlLm5hbWUgPSAnUmVjb3JkZXInO1xuICAgIG5vZGUuX291dHB1dCA9IG91dHB1dDtcblxuICAgIG5vZGUuaXNSZWNvcmRpbmcgPSBmYWxzZTtcblxuICAgIGZ1bmN0aW9uIG1lcmdlQnVmZmVycyhidWZmZXJzLCBsZW5ndGgpIHtcbiAgICAgICAgdmFyIGJ1ZmZlciA9IG5ldyBGbG9hdDMyQXJyYXkobGVuZ3RoKTtcbiAgICAgICAgdmFyIG9mZnNldCA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYnVmZmVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYnVmZmVyLnNldChidWZmZXJzW2ldLCBvZmZzZXQpO1xuICAgICAgICAgICAgb2Zmc2V0ICs9IGJ1ZmZlcnNbaV0ubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBidWZmZXI7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0QnVmZmVyKCkge1xuICAgICAgICBpZiAoIWJ1ZmZlcnNMLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuY3JlYXRlQnVmZmVyKDIsIGJ1ZmZlckxlbmd0aCwgY29udGV4dC5zYW1wbGVSYXRlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVjb3JkaW5nTGVuZ3RoID0gYnVmZmVyc0wubGVuZ3RoICogYnVmZmVyTGVuZ3RoO1xuICAgICAgICB2YXIgYnVmZmVyID0gY29udGV4dC5jcmVhdGVCdWZmZXIoMiwgcmVjb3JkaW5nTGVuZ3RoLCBjb250ZXh0LnNhbXBsZVJhdGUpO1xuICAgICAgICBidWZmZXIuZ2V0Q2hhbm5lbERhdGEoMCkuc2V0KG1lcmdlQnVmZmVycyhidWZmZXJzTCwgcmVjb3JkaW5nTGVuZ3RoKSk7XG4gICAgICAgIGJ1ZmZlci5nZXRDaGFubmVsRGF0YSgxKS5zZXQobWVyZ2VCdWZmZXJzKGJ1ZmZlcnNSLCByZWNvcmRpbmdMZW5ndGgpKTtcbiAgICAgICAgcmV0dXJuIGJ1ZmZlcjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZXN0cm95U2NyaXB0UHJvY2Vzc29yKCkge1xuICAgICAgICBpZiAoc2NyaXB0KSB7XG4gICAgICAgICAgICBzY3JpcHQub25hdWRpb3Byb2Nlc3MgPSBudWxsO1xuICAgICAgICAgICAgaW5wdXQuZGlzY29ubmVjdCgpO1xuICAgICAgICAgICAgc2NyaXB0LmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVNjcmlwdFByb2Nlc3NvcigpIHtcbiAgICAgICAgZGVzdHJveVNjcmlwdFByb2Nlc3NvcigpO1xuXG4gICAgICAgIHNjcmlwdCA9IGNvbnRleHQuY3JlYXRlU2NyaXB0UHJvY2Vzc29yKGJ1ZmZlckxlbmd0aCwgMiwgMik7XG4gICAgICAgIGlucHV0LmNvbm5lY3Qoc2NyaXB0KTtcbiAgICAgICAgc2NyaXB0LmNvbm5lY3QoY29udGV4dC5kZXN0aW5hdGlvbik7XG4gICAgICAgIHNjcmlwdC5jb25uZWN0KG91dHB1dCk7XG5cbiAgICAgICAgc2NyaXB0Lm9uYXVkaW9wcm9jZXNzID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICB2YXIgaW5wdXRMID0gZXZlbnQuaW5wdXRCdWZmZXIuZ2V0Q2hhbm5lbERhdGEoMCk7XG4gICAgICAgICAgICB2YXIgaW5wdXRSID0gZXZlbnQuaW5wdXRCdWZmZXIuZ2V0Q2hhbm5lbERhdGEoMSk7XG5cbiAgICAgICAgICAgIGlmIChwYXNzVGhyb3VnaCkge1xuICAgICAgICAgICAgICAgIHZhciBvdXRwdXRMID0gZXZlbnQub3V0cHV0QnVmZmVyLmdldENoYW5uZWxEYXRhKDApO1xuICAgICAgICAgICAgICAgIHZhciBvdXRwdXRSID0gZXZlbnQub3V0cHV0QnVmZmVyLmdldENoYW5uZWxEYXRhKDEpO1xuICAgICAgICAgICAgICAgIG91dHB1dEwuc2V0KGlucHV0TCk7XG4gICAgICAgICAgICAgICAgb3V0cHV0Ui5zZXQoaW5wdXRSKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG5vZGUuaXNSZWNvcmRpbmcpIHtcbiAgICAgICAgICAgICAgICBidWZmZXJzTC5wdXNoKG5ldyBGbG9hdDMyQXJyYXkoaW5wdXRMKSk7XG4gICAgICAgICAgICAgICAgYnVmZmVyc1IucHVzaChuZXcgRmxvYXQzMkFycmF5KGlucHV0UikpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIG5vZGUuc3RhcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNyZWF0ZVNjcmlwdFByb2Nlc3NvcigpO1xuICAgICAgICBidWZmZXJzTC5sZW5ndGggPSAwO1xuICAgICAgICBidWZmZXJzUi5sZW5ndGggPSAwO1xuICAgICAgICBzdGFydGVkQXQgPSBjb250ZXh0LmN1cnJlbnRUaW1lO1xuICAgICAgICBzdG9wcGVkQXQgPSAwO1xuICAgICAgICB0aGlzLmlzUmVjb3JkaW5nID0gdHJ1ZTtcbiAgICB9O1xuXG4gICAgbm9kZS5zdG9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBzdG9wcGVkQXQgPSBjb250ZXh0LmN1cnJlbnRUaW1lO1xuICAgICAgICB0aGlzLmlzUmVjb3JkaW5nID0gZmFsc2U7XG4gICAgICAgIGRlc3Ryb3lTY3JpcHRQcm9jZXNzb3IoKTtcbiAgICAgICAgcmV0dXJuIGdldEJ1ZmZlcigpO1xuICAgIH07XG5cbiAgICBub2RlLmdldER1cmF0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuaXNSZWNvcmRpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiBzdG9wcGVkQXQgLSBzdGFydGVkQXQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbnRleHQuY3VycmVudFRpbWUgLSBzdGFydGVkQXQ7XG4gICAgfTtcblxuICAgIHJldHVybiBub2RlO1xufVxuXG5mdW5jdGlvbiBSZXZlcmIoY29udGV4dCkge1xuICAgIHZhciBjb25maWcgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1sxXTtcblxuICAgIHZhciByYXRlID0gY29udGV4dC5zYW1wbGVSYXRlO1xuXG4gICAgdmFyIHRpbWUgPSBudW1iZXIoY29uZmlnLnRpbWUsIDEpO1xuICAgIHZhciBkZWNheSA9IG51bWJlcihjb25maWcuZGVjYXksIDUpO1xuICAgIHZhciByZXZlcnNlID0gISFjb25maWcucmV2ZXJzZTtcbiAgICB2YXIgbGVuZ3RoID0gdm9pZCAwO1xuICAgIHZhciBpbXB1bHNlUmVzcG9uc2UgPSB2b2lkIDA7XG5cbiAgICB2YXIgaW5wdXQgPSBjb250ZXh0LmNyZWF0ZUdhaW4oKTtcbiAgICB2YXIgcmV2ZXJiID0gY29udGV4dC5jcmVhdGVDb252b2x2ZXIoKTtcbiAgICB2YXIgb3V0cHV0ID0gY29udGV4dC5jcmVhdGVHYWluKCk7XG5cbiAgICBpbnB1dC5jb25uZWN0KHJldmVyYik7XG4gICAgaW5wdXQuY29ubmVjdChvdXRwdXQpO1xuICAgIHJldmVyYi5jb25uZWN0KG91dHB1dCk7XG5cbiAgICB2YXIgbm9kZSA9IGlucHV0O1xuICAgIG5vZGUubmFtZSA9ICdSZXZlcmInO1xuICAgIG5vZGUuX291dHB1dCA9IG91dHB1dDtcblxuICAgIG5vZGUudXBkYXRlID0gZnVuY3Rpb24gKG9wdCkge1xuICAgICAgICBpZiAodHlwZW9mIG9wdC50aW1lICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgdGltZSA9IG9wdC50aW1lO1xuICAgICAgICAgICAgbGVuZ3RoID0gTWF0aC5mbG9vcihyYXRlICogdGltZSk7XG4gICAgICAgICAgICBpbXB1bHNlUmVzcG9uc2UgPSBsZW5ndGggPyBjb250ZXh0LmNyZWF0ZUJ1ZmZlcigyLCBsZW5ndGgsIHJhdGUpIDogbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIG9wdC5kZWNheSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIGRlY2F5ID0gb3B0LmRlY2F5O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2Ygb3B0LnJldmVyc2UgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICByZXZlcnNlID0gb3B0LnJldmVyc2U7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWltcHVsc2VSZXNwb25zZSkge1xuICAgICAgICAgICAgcmV2ZXJiLmJ1ZmZlciA9IG51bGw7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgbGVmdCA9IGltcHVsc2VSZXNwb25zZS5nZXRDaGFubmVsRGF0YSgwKTtcbiAgICAgICAgdmFyIHJpZ2h0ID0gaW1wdWxzZVJlc3BvbnNlLmdldENoYW5uZWxEYXRhKDEpO1xuICAgICAgICB2YXIgbiA9IHZvaWQgMCxcbiAgICAgICAgICAgIGUgPSB2b2lkIDA7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbiA9IHJldmVyc2UgPyBsZW5ndGggLSBpIDogaTtcbiAgICAgICAgICAgIGUgPSBNYXRoLnBvdygxIC0gbiAvIGxlbmd0aCwgZGVjYXkpO1xuICAgICAgICAgICAgbGVmdFtpXSA9IChNYXRoLnJhbmRvbSgpICogMiAtIDEpICogZTtcbiAgICAgICAgICAgIHJpZ2h0W2ldID0gKE1hdGgucmFuZG9tKCkgKiAyIC0gMSkgKiBlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV2ZXJiLmJ1ZmZlciA9IGltcHVsc2VSZXNwb25zZTtcbiAgICB9O1xuXG4gICAgbm9kZS51cGRhdGUoe1xuICAgICAgICB0aW1lOiB0aW1lLFxuICAgICAgICBkZWNheTogZGVjYXksXG4gICAgICAgIHJldmVyc2U6IHJldmVyc2VcbiAgICB9KTtcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKG5vZGUsIHtcbiAgICAgICAgdGltZToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRpbWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT09IHRpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIHRpbWU6IHZhbHVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGRlY2F5OiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVjYXk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT09IGRlY2F5KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGUoe1xuICAgICAgICAgICAgICAgICAgICBkZWNheTogdmFsdWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcmV2ZXJzZToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldmVyc2U7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT09IHJldmVyc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIHJldmVyc2U6ICEhdmFsdWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIG5vZGU7XG59XG5cbmZ1bmN0aW9uIEVmZmVjdChjb250ZXh0KSB7XG4gICAgY29udGV4dCA9IGNvbnRleHQgfHwgbmV3IEZha2VDb250ZXh0KCk7XG4gICAgdmFyIHBhbm5pbmcgPSBuZXcgUGFubmVyKGNvbnRleHQpO1xuXG4gICAgdmFyIGFwaSA9IG51bGwsXG4gICAgICAgIGRlc3RpbmF0aW9uID0gdm9pZCAwLFxuICAgICAgICBub2RlTGlzdCA9IFtdLFxuICAgICAgICBzb3VyY2VOb2RlID0gdm9pZCAwO1xuXG4gICAgZnVuY3Rpb24gY29ubmVjdChhLCBiKSB7XG4gICAgICAgIC8vY29uc29sZS5sb2coJz4gY29ubmVjdCcsIChhLm5hbWUgfHwgYS5jb25zdHJ1Y3Rvci5uYW1lKSwgJ3RvJywgKGIubmFtZSB8fCBiLmNvbnN0cnVjdG9yLm5hbWUpKTtcblxuICAgICAgICB2YXIgb3V0cHV0ID0gYS5fb3V0cHV0IHx8IGE7XG4gICAgICAgIC8vY29uc29sZS5sb2coJz4gZGlzY29ubmVjdCBvdXRwdXQ6ICcsIChhLm5hbWUgfHwgYS5jb25zdHJ1Y3Rvci5uYW1lKSk7XG4gICAgICAgIG91dHB1dC5kaXNjb25uZWN0KCk7XG4gICAgICAgIC8vY29uc29sZS5sb2coJz4gY29ubmVjdCBvdXRwdXQ6ICcsKGEubmFtZSB8fCBhLmNvbnN0cnVjdG9yLm5hbWUpLCAndG8gaW5wdXQ6JywgKGIubmFtZSB8fCBiLmNvbnN0cnVjdG9yLm5hbWUpKTtcbiAgICAgICAgb3V0cHV0LmNvbm5lY3QoYik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY29ubmVjdFRvRGVzdGluYXRpb24obm9kZSkge1xuICAgICAgICB2YXIgbCA9IG5vZGVMaXN0Lmxlbmd0aDtcbiAgICAgICAgdmFyIGxhc3ROb2RlID0gbCA/IG5vZGVMaXN0W2wgLSAxXSA6IHNvdXJjZU5vZGU7XG5cbiAgICAgICAgaWYgKGxhc3ROb2RlKSB7XG4gICAgICAgICAgICBjb25uZWN0KGxhc3ROb2RlLCBub2RlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGRlc3RpbmF0aW9uID0gbm9kZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1cGRhdGVDb25uZWN0aW9ucygpIHtcbiAgICAgICAgaWYgKCFzb3VyY2VOb2RlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvL2NvbnNvbGUubG9nKCd1cGRhdGVDb25uZWN0aW9uczonLCBub2RlTGlzdC5sZW5ndGgpO1xuXG4gICAgICAgIHZhciBub2RlID0gdm9pZCAwLFxuICAgICAgICAgICAgcHJldiA9IHZvaWQgMDtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBub2RlID0gbm9kZUxpc3RbaV07XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGksIG5vZGUpO1xuICAgICAgICAgICAgcHJldiA9IGkgPT09IDAgPyBzb3VyY2VOb2RlIDogbm9kZUxpc3RbaSAtIDFdO1xuICAgICAgICAgICAgY29ubmVjdChwcmV2LCBub2RlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkZXN0aW5hdGlvbikge1xuICAgICAgICAgICAgY29ubmVjdFRvRGVzdGluYXRpb24oZGVzdGluYXRpb24pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaGFzKG5vZGUpIHtcbiAgICAgICAgaWYgKCFub2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5vZGVMaXN0LmluZGV4T2Yobm9kZSkgPiAtMTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhZGQobm9kZSkge1xuICAgICAgICBpZiAoIW5vZGUpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmIChoYXMobm9kZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgICB9XG4gICAgICAgIG5vZGVMaXN0LnB1c2gobm9kZSk7XG4gICAgICAgIHVwZGF0ZUNvbm5lY3Rpb25zKCk7XG4gICAgICAgIHJldHVybiBub2RlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlbW92ZShub2RlKSB7XG4gICAgICAgIGlmICghbm9kZSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFoYXMobm9kZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsID0gbm9kZUxpc3QubGVuZ3RoO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgaWYgKG5vZGUgPT09IG5vZGVMaXN0W2ldKSB7XG4gICAgICAgICAgICAgICAgbm9kZUxpc3Quc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBvdXRwdXQgPSBub2RlLl9vdXRwdXQgfHwgbm9kZTtcbiAgICAgICAgb3V0cHV0LmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgdXBkYXRlQ29ubmVjdGlvbnMoKTtcbiAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdG9nZ2xlKG5vZGUsIGZvcmNlKSB7XG4gICAgICAgIGZvcmNlID0gISFmb3JjZTtcbiAgICAgICAgdmFyIGhhc05vZGUgPSBoYXMobm9kZSk7XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBoYXNOb2RlID09PSBmb3JjZSkge1xuICAgICAgICAgICAgcmV0dXJuIGFwaTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaGFzTm9kZSkge1xuICAgICAgICAgICAgcmVtb3ZlKG5vZGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYWRkKG5vZGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcGk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVtb3ZlQWxsKCkge1xuICAgICAgICB3aGlsZSAobm9kZUxpc3QubGVuZ3RoKSB7XG4gICAgICAgICAgICBub2RlTGlzdC5wb3AoKS5kaXNjb25uZWN0KCk7XG4gICAgICAgIH1cbiAgICAgICAgdXBkYXRlQ29ubmVjdGlvbnMoKTtcbiAgICAgICAgcmV0dXJuIGFwaTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICByZW1vdmVBbGwoKTtcbiAgICAgICAgY29udGV4dCA9IG51bGw7XG4gICAgICAgIGRlc3RpbmF0aW9uID0gbnVsbDtcbiAgICAgICAgbm9kZUxpc3QgPSBbXTtcbiAgICAgICAgaWYgKHNvdXJjZU5vZGUpIHtcbiAgICAgICAgICAgIHNvdXJjZU5vZGUuZGlzY29ubmVjdCgpO1xuICAgICAgICB9XG4gICAgICAgIHNvdXJjZU5vZGUgPSBudWxsO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogRWZmZWN0c1xuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gYW5hbHlzZXIoY29uZmlnKSB7XG4gICAgICAgIHJldHVybiBhZGQobmV3IEFuYWx5c2VyKGNvbnRleHQsIGNvbmZpZykpO1xuICAgIH1cblxuICAgIC8vIGxvd2VycyB0aGUgdm9sdW1lIG9mIHRoZSBsb3VkZXN0IHBhcnRzIG9mIHRoZSBzaWduYWwgYW5kIHJhaXNlcyB0aGUgdm9sdW1lIG9mIHRoZSBzb2Z0ZXN0IHBhcnRzXG4gICAgZnVuY3Rpb24gY29tcHJlc3NvcihvcHRpb25zKSB7XG4gICAgICAgIHZhciBub2RlID0gY29udGV4dC5jcmVhdGVEeW5hbWljc0NvbXByZXNzb3IoKTtcblxuICAgICAgICBub2RlLnVwZGF0ZSA9IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICAgICAgICAgIC8vIG1pbiBkZWNpYmVscyB0byBzdGFydCBjb21wcmVzc2luZyBhdCBmcm9tIC0xMDAgdG8gMFxuICAgICAgICAgICAgbm9kZS50aHJlc2hvbGQudmFsdWUgPSB0eXBlb2YgY29uZmlnLnRocmVzaG9sZCAhPT0gJ3VuZGVmaW5lZCcgPyBjb25maWcudGhyZXNob2xkIDogLTI0O1xuICAgICAgICAgICAgLy8gZGVjaWJlbCB2YWx1ZSB0byBzdGFydCBjdXJ2ZSB0byBjb21wcmVzc2VkIHZhbHVlIGZyb20gMCB0byA0MFxuICAgICAgICAgICAgbm9kZS5rbmVlLnZhbHVlID0gdHlwZW9mIGNvbmZpZy5rbmVlICE9PSAndW5kZWZpbmVkJyA/IGNvbmZpZy5rbmVlIDogMzA7XG4gICAgICAgICAgICAvLyBhbW91bnQgb2YgY2hhbmdlIHBlciBkZWNpYmVsIGZyb20gMSB0byAyMFxuICAgICAgICAgICAgbm9kZS5yYXRpby52YWx1ZSA9IHR5cGVvZiBjb25maWcucmF0aW8gIT09ICd1bmRlZmluZWQnID8gY29uZmlnLnJhdGlvIDogMTI7XG4gICAgICAgICAgICAvLyBnYWluIHJlZHVjdGlvbiBjdXJyZW50bHkgYXBwbGllZCBieSBjb21wcmVzc29yIGZyb20gLTIwIHRvIDBcbiAgICAgICAgICAgIC8vIG5vZGUucmVkdWN0aW9uLnZhbHVlID0gdHlwZW9mIGNvbmZpZy5yZWR1Y3Rpb24gIT09ICd1bmRlZmluZWQnID8gY29uZmlnLnJlZHVjdGlvbiA6IC0xMDspXG4gICAgICAgICAgICAvLyBzZWNvbmRzIHRvIHJlZHVjZSBnYWluIGJ5IDEwZGIgZnJvbSAwIHRvIDEgLSBob3cgcXVpY2tseSBzaWduYWwgYWRhcHRlZCB3aGVuIHZvbHVtZSBpbmNyZWFzZWRcbiAgICAgICAgICAgIG5vZGUuYXR0YWNrLnZhbHVlID0gdHlwZW9mIGNvbmZpZy5hdHRhY2sgIT09ICd1bmRlZmluZWQnID8gY29uZmlnLmF0dGFjayA6IDAuMDAwMztcbiAgICAgICAgICAgIC8vIHNlY29uZHMgdG8gaW5jcmVhc2UgZ2FpbiBieSAxMGRiIGZyb20gMCB0byAxIC0gaG93IHF1aWNrbHkgc2lnbmFsIGFkYXB0ZWQgd2hlbiB2b2x1bWUgcmVkY3VjZWRcbiAgICAgICAgICAgIG5vZGUucmVsZWFzZS52YWx1ZSA9IHR5cGVvZiBjb25maWcucmVsZWFzZSAhPT0gJ3VuZGVmaW5lZCcgPyBjb25maWcucmVsZWFzZSA6IDAuMjU7XG4gICAgICAgIH07XG5cbiAgICAgICAgbm9kZS51cGRhdGUob3B0aW9ucyB8fCB7fSk7XG5cbiAgICAgICAgcmV0dXJuIGFkZChub2RlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb252b2x2ZXIoaW1wdWxzZVJlc3BvbnNlKSB7XG4gICAgICAgIC8vIGltcHVsc2VSZXNwb25zZSBpcyBhbiBhdWRpbyBmaWxlIGJ1ZmZlclxuICAgICAgICB2YXIgbm9kZSA9IGNvbnRleHQuY3JlYXRlQ29udm9sdmVyKCk7XG4gICAgICAgIG5vZGUuYnVmZmVyID0gaW1wdWxzZVJlc3BvbnNlO1xuICAgICAgICByZXR1cm4gYWRkKG5vZGUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlbGF5KHRpbWUpIHtcbiAgICAgICAgdmFyIG5vZGUgPSBjb250ZXh0LmNyZWF0ZURlbGF5KCk7XG4gICAgICAgIGlmICh0eXBlb2YgdGltZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIG5vZGUuZGVsYXlUaW1lLnZhbHVlID0gdGltZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWRkKG5vZGUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGVjaG8oY29uZmlnKSB7XG4gICAgICAgIHJldHVybiBhZGQobmV3IEVjaG8oY29udGV4dCwgY29uZmlnKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGlzdG9ydGlvbihhbW91bnQpIHtcbiAgICAgICAgLy8gRmxvYXQzMkFycmF5IGRlZmluaW5nIGN1cnZlICh2YWx1ZXMgYXJlIGludGVycG9sYXRlZClcbiAgICAgICAgLy9ub2RlLmN1cnZlXG4gICAgICAgIC8vIHVwLXNhbXBsZSBiZWZvcmUgYXBwbHlpbmcgY3VydmUgZm9yIGJldHRlciByZXNvbHV0aW9uIHJlc3VsdCAnbm9uZScsICcyeCcgb3IgJzR4J1xuICAgICAgICAvL25vZGUub3ZlcnNhbXBsZSA9ICcyeCc7XG4gICAgICAgIHJldHVybiBhZGQobmV3IERpc3RvcnRpb24oY29udGV4dCwgYW1vdW50KSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZmlsdGVyKHR5cGUsIGZyZXF1ZW5jeSwgcSwgZ2Fpbikge1xuICAgICAgICByZXR1cm4gYWRkKG5ldyBGaWx0ZXIoY29udGV4dCwgeyB0eXBlOiB0eXBlLCBmcmVxdWVuY3k6IGZyZXF1ZW5jeSwgcTogcSwgZ2FpbjogZ2FpbiB9KSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG93cGFzcyhmcmVxdWVuY3ksIHBlYWspIHtcbiAgICAgICAgcmV0dXJuIGZpbHRlcignbG93cGFzcycsIHsgZnJlcXVlbmN5OiBmcmVxdWVuY3ksIHE6IHBlYWsgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaGlnaHBhc3MoZnJlcXVlbmN5LCBwZWFrKSB7XG4gICAgICAgIHJldHVybiBmaWx0ZXIoJ2hpZ2hwYXNzJywgeyBmcmVxdWVuY3k6IGZyZXF1ZW5jeSwgcTogcGVhayB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBiYW5kcGFzcyhmcmVxdWVuY3ksIHdpZHRoKSB7XG4gICAgICAgIHJldHVybiBmaWx0ZXIoJ2JhbmRwYXNzJywgeyBmcmVxdWVuY3k6IGZyZXF1ZW5jeSwgcTogd2lkdGggfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG93c2hlbGYoZnJlcXVlbmN5LCBnYWluKSB7XG4gICAgICAgIHJldHVybiBmaWx0ZXIoJ2xvd3NoZWxmJywgeyBmcmVxdWVuY3k6IGZyZXF1ZW5jeSwgcTogMCwgZ2FpbjogZ2FpbiB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBoaWdoc2hlbGYoZnJlcXVlbmN5LCBnYWluKSB7XG4gICAgICAgIHJldHVybiBmaWx0ZXIoJ2hpZ2hzaGVsZicsIHsgZnJlcXVlbmN5OiBmcmVxdWVuY3ksIHE6IDAsIGdhaW46IGdhaW4gfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGVha2luZyhmcmVxdWVuY3ksIHdpZHRoLCBnYWluKSB7XG4gICAgICAgIHJldHVybiBmaWx0ZXIoJ3BlYWtpbmcnLCB7IGZyZXF1ZW5jeTogZnJlcXVlbmN5LCBxOiB3aWR0aCwgZ2FpbjogZ2FpbiB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBub3RjaChmcmVxdWVuY3ksIHdpZHRoLCBnYWluKSB7XG4gICAgICAgIHJldHVybiBmaWx0ZXIoJ25vdGNoJywgeyBmcmVxdWVuY3k6IGZyZXF1ZW5jeSwgcTogd2lkdGgsIGdhaW46IGdhaW4gfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWxscGFzcyhmcmVxdWVuY3ksIHNoYXJwbmVzcykge1xuICAgICAgICByZXR1cm4gZmlsdGVyKCdhbGxwYXNzJywgeyBmcmVxdWVuY3k6IGZyZXF1ZW5jeSwgcTogc2hhcnBuZXNzIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZsYW5nZXIoY29uZmlnKSB7XG4gICAgICAgIHJldHVybiBhZGQobmV3IEZsYW5nZXIoY29udGV4dCwgY29uZmlnKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2Fpbk5vZGUodmFsdWUpIHtcbiAgICAgICAgdmFyIG5vZGUgPSBjb250ZXh0LmNyZWF0ZUdhaW4oKTtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIG5vZGUuZ2Fpbi52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBub2RlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhbm5lcigpIHtcbiAgICAgICAgcmV0dXJuIGFkZChuZXcgUGFubmVyKGNvbnRleHQpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwaGFzZXIoY29uZmlnKSB7XG4gICAgICAgIHJldHVybiBhZGQobmV3IFBoYXNlcihjb250ZXh0LCBjb25maWcpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZWNvcmRlcihwYXNzVGhyb3VnaCkge1xuICAgICAgICByZXR1cm4gYWRkKG5ldyBSZWNvcmRlcihjb250ZXh0LCBwYXNzVGhyb3VnaCkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJldmVyYihzZWNvbmRzLCBkZWNheSwgcmV2ZXJzZSkge1xuICAgICAgICByZXR1cm4gYWRkKG5ldyBSZXZlcmIoY29udGV4dCwgc2Vjb25kcywgZGVjYXksIHJldmVyc2UpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzY3JpcHQoKSB7XG4gICAgICAgIHZhciBjb25maWcgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDAgfHwgYXJndW1lbnRzWzBdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1swXTtcblxuICAgICAgICAvLyBidWZmZXJTaXplIDI1NiAtIDE2Mzg0IChwb3cgMilcbiAgICAgICAgdmFyIGJ1ZmZlclNpemUgPSBjb25maWcuYnVmZmVyU2l6ZSB8fCAxMDI0O1xuICAgICAgICB2YXIgaW5wdXRDaGFubmVscyA9IHR5cGVvZiBjb25maWcuaW5wdXRDaGFubmVscyA9PT0gJ3VuZGVmaW5lZCcgPyAwIDogY29uZmlnLmlucHV0Q2hhbm5lbHM7XG4gICAgICAgIHZhciBvdXRwdXRDaGFubmVscyA9IHR5cGVvZiBjb25maWcub3V0cHV0Q2hhbm5lbHMgPT09ICd1bmRlZmluZWQnID8gMSA6IGNvbmZpZy5vdXRwdXRDaGFubmVscztcblxuICAgICAgICB2YXIgbm9kZSA9IGNvbnRleHQuY3JlYXRlU2NyaXB0UHJvY2Vzc29yKGJ1ZmZlclNpemUsIGlucHV0Q2hhbm5lbHMsIG91dHB1dENoYW5uZWxzKTtcblxuICAgICAgICB2YXIgdGhpc0FyZyA9IGNvbmZpZy50aGlzQXJnIHx8IGNvbmZpZy5jb250ZXh0IHx8IG5vZGU7XG4gICAgICAgIHZhciBjYWxsYmFjayA9IGNvbmZpZy5jYWxsYmFjayB8fCBmdW5jdGlvbiAoKSB7fTtcblxuICAgICAgICAvLyBhdmFpbGFibGUgcHJvcHM6XG4gICAgICAgIC8qXG4gICAgICAgIGV2ZW50LmlucHV0QnVmZmVyXG4gICAgICAgIGV2ZW50Lm91dHB1dEJ1ZmZlclxuICAgICAgICBldmVudC5wbGF5YmFja1RpbWVcbiAgICAgICAgKi9cbiAgICAgICAgLy8gRXhhbXBsZTogZ2VuZXJhdGUgbm9pc2VcbiAgICAgICAgLypcbiAgICAgICAgY29uc3Qgb3V0cHV0ID0gZXZlbnQub3V0cHV0QnVmZmVyLmdldENoYW5uZWxEYXRhKDApO1xuICAgICAgICBjb25zdCBsID0gb3V0cHV0Lmxlbmd0aDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIG91dHB1dFtpXSA9IE1hdGgucmFuZG9tKCk7XG4gICAgICAgIH1cbiAgICAgICAgKi9cbiAgICAgICAgbm9kZS5vbmF1ZGlvcHJvY2VzcyA9IGNhbGxiYWNrLmJpbmQodGhpc0FyZyk7XG5cbiAgICAgICAgcmV0dXJuIGFkZChub2RlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRTb3VyY2Uobm9kZSkge1xuICAgICAgICBzb3VyY2VOb2RlID0gbm9kZTtcbiAgICAgICAgdXBkYXRlQ29ubmVjdGlvbnMoKTtcbiAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0RGVzdGluYXRpb24obm9kZSkge1xuICAgICAgICBjb25uZWN0VG9EZXN0aW5hdGlvbihub2RlKTtcbiAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgfVxuXG4gICAgLy9cblxuICAgIGFwaSA9IHtcbiAgICAgICAgY29udGV4dDogY29udGV4dCxcbiAgICAgICAgbm9kZUxpc3Q6IG5vZGVMaXN0LFxuICAgICAgICBwYW5uaW5nOiBwYW5uaW5nLFxuXG4gICAgICAgIGhhczogaGFzLFxuICAgICAgICBhZGQ6IGFkZCxcbiAgICAgICAgcmVtb3ZlOiByZW1vdmUsXG4gICAgICAgIHRvZ2dsZTogdG9nZ2xlLFxuICAgICAgICByZW1vdmVBbGw6IHJlbW92ZUFsbCxcbiAgICAgICAgZGVzdHJveTogZGVzdHJveSxcbiAgICAgICAgc2V0U291cmNlOiBzZXRTb3VyY2UsXG4gICAgICAgIHNldERlc3RpbmF0aW9uOiBzZXREZXN0aW5hdGlvbixcblxuICAgICAgICBhbmFseXNlcjogYW5hbHlzZXIsXG4gICAgICAgIGNvbXByZXNzb3I6IGNvbXByZXNzb3IsXG4gICAgICAgIGNvbnZvbHZlcjogY29udm9sdmVyLFxuICAgICAgICBkZWxheTogZGVsYXksXG4gICAgICAgIGVjaG86IGVjaG8sXG4gICAgICAgIGRpc3RvcnRpb246IGRpc3RvcnRpb24sXG4gICAgICAgIGZpbHRlcjogZmlsdGVyLFxuICAgICAgICBsb3dwYXNzOiBsb3dwYXNzLFxuICAgICAgICBoaWdocGFzczogaGlnaHBhc3MsXG4gICAgICAgIGJhbmRwYXNzOiBiYW5kcGFzcyxcbiAgICAgICAgbG93c2hlbGY6IGxvd3NoZWxmLFxuICAgICAgICBoaWdoc2hlbGY6IGhpZ2hzaGVsZixcbiAgICAgICAgcGVha2luZzogcGVha2luZyxcbiAgICAgICAgbm90Y2g6IG5vdGNoLFxuICAgICAgICBhbGxwYXNzOiBhbGxwYXNzLFxuICAgICAgICBmbGFuZ2VyOiBmbGFuZ2VyLFxuICAgICAgICBnYWluOiBnYWluTm9kZSxcbiAgICAgICAgcGFubmVyOiBwYW5uZXIsXG4gICAgICAgIHBoYXNlcjogcGhhc2VyLFxuICAgICAgICByZWNvcmRlcjogcmVjb3JkZXIsXG4gICAgICAgIHJldmVyYjogcmV2ZXJiLFxuICAgICAgICBzY3JpcHQ6IHNjcmlwdFxuICAgIH07XG5cbiAgICByZXR1cm4gT2JqZWN0LmZyZWV6ZShhcGkpO1xufVxuXG5mdW5jdGlvbiBHcm91cChjb250ZXh0LCBkZXN0aW5hdGlvbikge1xuICAgIHZhciBzb3VuZHMgPSBbXTtcbiAgICB2YXIgZWZmZWN0ID0gbmV3IEVmZmVjdChjb250ZXh0KTtcbiAgICB2YXIgZ2FpbiA9IGVmZmVjdC5nYWluKCk7XG4gICAgdmFyIHByZU11dGVWb2x1bWUgPSAxO1xuICAgIHZhciBncm91cCA9IG51bGw7XG5cbiAgICBpZiAoY29udGV4dCkge1xuICAgICAgICBlZmZlY3Quc2V0U291cmNlKGdhaW4pO1xuICAgICAgICBlZmZlY3Quc2V0RGVzdGluYXRpb24oZGVzdGluYXRpb24gfHwgY29udGV4dC5kZXN0aW5hdGlvbik7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBBZGQgLyByZW1vdmVcbiAgICAgKi9cblxuICAgIGZ1bmN0aW9uIGZpbmQoc291bmRPcklkLCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgZm91bmQgPSB2b2lkIDA7XG5cbiAgICAgICAgaWYgKCFzb3VuZE9ySWQgJiYgc291bmRPcklkICE9PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gZm91bmQ7XG4gICAgICAgIH1cblxuICAgICAgICBzb3VuZHMuc29tZShmdW5jdGlvbiAoc291bmQpIHtcbiAgICAgICAgICAgIGlmIChzb3VuZCA9PT0gc291bmRPcklkIHx8IHNvdW5kLmlkID09PSBzb3VuZE9ySWQpIHtcbiAgICAgICAgICAgICAgICBmb3VuZCA9IHNvdW5kO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoZm91bmQgJiYgY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHJldHVybiBjYWxsYmFjayhmb3VuZCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZm91bmQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVtb3ZlKHNvdW5kT3JJZCkge1xuICAgICAgICBmaW5kKHNvdW5kT3JJZCwgZnVuY3Rpb24gKHNvdW5kKSB7XG4gICAgICAgICAgICByZXR1cm4gc291bmRzLnNwbGljZShzb3VuZHMuaW5kZXhPZihzb3VuZCksIDEpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGdyb3VwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZChzb3VuZCkge1xuICAgICAgICBzb3VuZC5nYWluLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgc291bmQuZ2Fpbi5jb25uZWN0KGdhaW4pO1xuXG4gICAgICAgIHNvdW5kcy5wdXNoKHNvdW5kKTtcblxuICAgICAgICBzb3VuZC5vbmNlKCdkZXN0cm95JywgcmVtb3ZlKTtcblxuICAgICAgICByZXR1cm4gZ3JvdXA7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBDb250cm9sc1xuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gcGxheShkZWxheSwgb2Zmc2V0KSB7XG4gICAgICAgIHNvdW5kcy5mb3JFYWNoKGZ1bmN0aW9uIChzb3VuZCkge1xuICAgICAgICAgICAgcmV0dXJuIHNvdW5kLnBsYXkoZGVsYXksIG9mZnNldCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZ3JvdXA7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgICAgIHNvdW5kcy5mb3JFYWNoKGZ1bmN0aW9uIChzb3VuZCkge1xuICAgICAgICAgICAgaWYgKHNvdW5kLnBsYXlpbmcpIHtcbiAgICAgICAgICAgICAgICBzb3VuZC5wYXVzZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGdyb3VwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlc3VtZSgpIHtcbiAgICAgICAgc291bmRzLmZvckVhY2goZnVuY3Rpb24gKHNvdW5kKSB7XG4gICAgICAgICAgICBpZiAoc291bmQucGF1c2VkKSB7XG4gICAgICAgICAgICAgICAgc291bmQucGxheSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGdyb3VwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgICAgIHNvdW5kcy5mb3JFYWNoKGZ1bmN0aW9uIChzb3VuZCkge1xuICAgICAgICAgICAgcmV0dXJuIHNvdW5kLnN0b3AoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBncm91cDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZWVrKHBlcmNlbnQpIHtcbiAgICAgICAgc291bmRzLmZvckVhY2goZnVuY3Rpb24gKHNvdW5kKSB7XG4gICAgICAgICAgICByZXR1cm4gc291bmQuc2VlayhwZXJjZW50KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBncm91cDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBtdXRlKCkge1xuICAgICAgICBwcmVNdXRlVm9sdW1lID0gZ3JvdXAudm9sdW1lO1xuICAgICAgICBncm91cC52b2x1bWUgPSAwO1xuICAgICAgICByZXR1cm4gZ3JvdXA7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdW5NdXRlKCkge1xuICAgICAgICBncm91cC52b2x1bWUgPSBwcmVNdXRlVm9sdW1lIHx8IDE7XG4gICAgICAgIHJldHVybiBncm91cDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRWb2x1bWUodmFsdWUpIHtcbiAgICAgICAgZ3JvdXAudm9sdW1lID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBncm91cDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmYWRlKHZvbHVtZSwgZHVyYXRpb24pIHtcbiAgICAgICAgaWYgKGNvbnRleHQpIHtcbiAgICAgICAgICAgIHZhciBwYXJhbSA9IGdhaW4uZ2FpbjtcbiAgICAgICAgICAgIHZhciB0aW1lID0gY29udGV4dC5jdXJyZW50VGltZTtcblxuICAgICAgICAgICAgcGFyYW0uY2FuY2VsU2NoZWR1bGVkVmFsdWVzKHRpbWUpO1xuICAgICAgICAgICAgcGFyYW0uc2V0VmFsdWVBdFRpbWUocGFyYW0udmFsdWUsIHRpbWUpO1xuICAgICAgICAgICAgLy8gcGFyYW0uc2V0VmFsdWVBdFRpbWUodm9sdW1lLCB0aW1lICsgZHVyYXRpb24pO1xuICAgICAgICAgICAgcGFyYW0ubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUodm9sdW1lLCB0aW1lICsgZHVyYXRpb24pO1xuICAgICAgICAgICAgLy8gcGFyYW0uc2V0VGFyZ2V0QXRUaW1lKHZvbHVtZSwgdGltZSwgZHVyYXRpb24pO1xuICAgICAgICAgICAgLy8gcGFyYW0uZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZShNYXRoLm1heCh2b2x1bWUsIDAuMDAwMSksIHRpbWUgKyBkdXJhdGlvbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzb3VuZHMuZm9yRWFjaChmdW5jdGlvbiAoc291bmQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc291bmQuZmFkZSh2b2x1bWUsIGR1cmF0aW9uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGdyb3VwO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogTG9hZFxuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gbG9hZCgpIHtcbiAgICAgICAgc291bmRzLmZvckVhY2goZnVuY3Rpb24gKHNvdW5kKSB7XG4gICAgICAgICAgICByZXR1cm4gc291bmQubG9hZChudWxsLCB0cnVlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBVbmxvYWRcbiAgICAgKi9cblxuICAgIGZ1bmN0aW9uIHVubG9hZCgpIHtcbiAgICAgICAgc291bmRzLmZvckVhY2goZnVuY3Rpb24gKHNvdW5kKSB7XG4gICAgICAgICAgICByZXR1cm4gc291bmQudW5sb2FkKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogRGVzdHJveVxuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgd2hpbGUgKHNvdW5kcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHNvdW5kcy5wb3AoKS5kZXN0cm95KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKlxuICAgICAqIEFwaVxuICAgICAqL1xuXG4gICAgZ3JvdXAgPSB7XG4gICAgICAgIGFkZDogYWRkLFxuICAgICAgICBmaW5kOiBmaW5kLFxuICAgICAgICByZW1vdmU6IHJlbW92ZSxcbiAgICAgICAgcGxheTogcGxheSxcbiAgICAgICAgcGF1c2U6IHBhdXNlLFxuICAgICAgICByZXN1bWU6IHJlc3VtZSxcbiAgICAgICAgc3RvcDogc3RvcCxcbiAgICAgICAgc2Vlazogc2VlayxcbiAgICAgICAgc2V0Vm9sdW1lOiBzZXRWb2x1bWUsXG4gICAgICAgIG11dGU6IG11dGUsXG4gICAgICAgIHVuTXV0ZTogdW5NdXRlLFxuICAgICAgICBmYWRlOiBmYWRlLFxuICAgICAgICBsb2FkOiBsb2FkLFxuICAgICAgICB1bmxvYWQ6IHVubG9hZCxcbiAgICAgICAgZGVzdHJveTogZGVzdHJveVxuICAgIH07XG5cbiAgICAvKlxuICAgICAqIEdldHRlcnMgJiBTZXR0ZXJzXG4gICAgICovXG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhncm91cCwge1xuICAgICAgICBlZmZlY3Q6IHtcbiAgICAgICAgICAgIHZhbHVlOiBlZmZlY3RcbiAgICAgICAgfSxcbiAgICAgICAgZ2Fpbjoge1xuICAgICAgICAgICAgdmFsdWU6IGdhaW5cbiAgICAgICAgfSxcbiAgICAgICAgc291bmRzOiB7XG4gICAgICAgICAgICB2YWx1ZTogc291bmRzXG4gICAgICAgIH0sXG4gICAgICAgIHZvbHVtZToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdhaW4uZ2Fpbi52YWx1ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmIChpc05hTih2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhbHVlID0gTWF0aC5taW4oTWF0aC5tYXgodmFsdWUsIDApLCAxKTtcblxuICAgICAgICAgICAgICAgIGlmIChjb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIGdhaW4uZ2Fpbi5jYW5jZWxTY2hlZHVsZWRWYWx1ZXMoY29udGV4dC5jdXJyZW50VGltZSk7XG4gICAgICAgICAgICAgICAgICAgIGdhaW4uZ2Fpbi52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBnYWluLmdhaW4uc2V0VmFsdWVBdFRpbWUodmFsdWUsIGNvbnRleHQuY3VycmVudFRpbWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGdhaW4uZ2Fpbi52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzb3VuZHMuZm9yRWFjaChmdW5jdGlvbiAoc291bmQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzb3VuZC5jb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VuZC5ncm91cFZvbHVtZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBncm91cDtcbn1cblxuR3JvdXAuRWZmZWN0ID0gRWZmZWN0O1xuXG4vLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy5cbi8vXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYVxuLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZVxuLy8gXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nXG4vLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsXG4vLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0XG4vLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGVcbi8vIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkXG4vLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTXG4vLyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GXG4vLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOXG4vLyBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbi8vIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUlxuLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRVxuLy8gVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxuZnVuY3Rpb24gRXZlbnRFbWl0dGVyJDEoKSB7XG4gIHRoaXMuX2V2ZW50cyA9IHRoaXMuX2V2ZW50cyB8fCB7fTtcbiAgdGhpcy5fbWF4TGlzdGVuZXJzID0gdGhpcy5fbWF4TGlzdGVuZXJzIHx8IHVuZGVmaW5lZDtcbn1cbnZhciBldmVudHMgPSBFdmVudEVtaXR0ZXIkMTtcblxuLy8gQmFja3dhcmRzLWNvbXBhdCB3aXRoIG5vZGUgMC4xMC54XG5FdmVudEVtaXR0ZXIkMS5FdmVudEVtaXR0ZXIgPSBFdmVudEVtaXR0ZXIkMTtcblxuRXZlbnRFbWl0dGVyJDEucHJvdG90eXBlLl9ldmVudHMgPSB1bmRlZmluZWQ7XG5FdmVudEVtaXR0ZXIkMS5wcm90b3R5cGUuX21heExpc3RlbmVycyA9IHVuZGVmaW5lZDtcblxuLy8gQnkgZGVmYXVsdCBFdmVudEVtaXR0ZXJzIHdpbGwgcHJpbnQgYSB3YXJuaW5nIGlmIG1vcmUgdGhhbiAxMCBsaXN0ZW5lcnMgYXJlXG4vLyBhZGRlZCB0byBpdC4gVGhpcyBpcyBhIHVzZWZ1bCBkZWZhdWx0IHdoaWNoIGhlbHBzIGZpbmRpbmcgbWVtb3J5IGxlYWtzLlxuRXZlbnRFbWl0dGVyJDEuZGVmYXVsdE1heExpc3RlbmVycyA9IDEwO1xuXG4vLyBPYnZpb3VzbHkgbm90IGFsbCBFbWl0dGVycyBzaG91bGQgYmUgbGltaXRlZCB0byAxMC4gVGhpcyBmdW5jdGlvbiBhbGxvd3Ncbi8vIHRoYXQgdG8gYmUgaW5jcmVhc2VkLiBTZXQgdG8gemVybyBmb3IgdW5saW1pdGVkLlxuRXZlbnRFbWl0dGVyJDEucHJvdG90eXBlLnNldE1heExpc3RlbmVycyA9IGZ1bmN0aW9uKG4pIHtcbiAgaWYgKCFpc051bWJlcihuKSB8fCBuIDwgMCB8fCBpc05hTihuKSlcbiAgICB0aHJvdyBUeXBlRXJyb3IoJ24gbXVzdCBiZSBhIHBvc2l0aXZlIG51bWJlcicpO1xuICB0aGlzLl9tYXhMaXN0ZW5lcnMgPSBuO1xuICByZXR1cm4gdGhpcztcbn07XG5cbkV2ZW50RW1pdHRlciQxLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24odHlwZSkge1xuICB2YXIgZXIsIGhhbmRsZXIsIGxlbiwgYXJncywgaSwgbGlzdGVuZXJzO1xuXG4gIGlmICghdGhpcy5fZXZlbnRzKVxuICAgIHRoaXMuX2V2ZW50cyA9IHt9O1xuXG4gIC8vIElmIHRoZXJlIGlzIG5vICdlcnJvcicgZXZlbnQgbGlzdGVuZXIgdGhlbiB0aHJvdy5cbiAgaWYgKHR5cGUgPT09ICdlcnJvcicpIHtcbiAgICBpZiAoIXRoaXMuX2V2ZW50cy5lcnJvciB8fFxuICAgICAgICAoaXNPYmplY3QodGhpcy5fZXZlbnRzLmVycm9yKSAmJiAhdGhpcy5fZXZlbnRzLmVycm9yLmxlbmd0aCkpIHtcbiAgICAgIGVyID0gYXJndW1lbnRzWzFdO1xuICAgICAgaWYgKGVyIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgdGhyb3cgZXI7IC8vIFVuaGFuZGxlZCAnZXJyb3InIGV2ZW50XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBBdCBsZWFzdCBnaXZlIHNvbWUga2luZCBvZiBjb250ZXh0IHRvIHRoZSB1c2VyXG4gICAgICAgIHZhciBlcnIgPSBuZXcgRXJyb3IoJ1VuY2F1Z2h0LCB1bnNwZWNpZmllZCBcImVycm9yXCIgZXZlbnQuICgnICsgZXIgKyAnKScpO1xuICAgICAgICBlcnIuY29udGV4dCA9IGVyO1xuICAgICAgICB0aHJvdyBlcnI7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaGFuZGxlciA9IHRoaXMuX2V2ZW50c1t0eXBlXTtcblxuICBpZiAoaXNVbmRlZmluZWQoaGFuZGxlcikpXG4gICAgcmV0dXJuIGZhbHNlO1xuXG4gIGlmIChpc0Z1bmN0aW9uKGhhbmRsZXIpKSB7XG4gICAgc3dpdGNoIChhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICAvLyBmYXN0IGNhc2VzXG4gICAgICBjYXNlIDE6XG4gICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDI6XG4gICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzLCBhcmd1bWVudHNbMV0pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMzpcbiAgICAgICAgaGFuZGxlci5jYWxsKHRoaXMsIGFyZ3VtZW50c1sxXSwgYXJndW1lbnRzWzJdKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICAvLyBzbG93ZXJcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpO1xuICAgICAgICBoYW5kbGVyLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgIH1cbiAgfSBlbHNlIGlmIChpc09iamVjdChoYW5kbGVyKSkge1xuICAgIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpO1xuICAgIGxpc3RlbmVycyA9IGhhbmRsZXIuc2xpY2UoKTtcbiAgICBsZW4gPSBsaXN0ZW5lcnMubGVuZ3RoO1xuICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKylcbiAgICAgIGxpc3RlbmVyc1tpXS5hcHBseSh0aGlzLCBhcmdzKTtcbiAgfVxuXG4gIHJldHVybiB0cnVlO1xufTtcblxuRXZlbnRFbWl0dGVyJDEucHJvdG90eXBlLmFkZExpc3RlbmVyID0gZnVuY3Rpb24odHlwZSwgbGlzdGVuZXIpIHtcbiAgdmFyIG07XG5cbiAgaWYgKCFpc0Z1bmN0aW9uKGxpc3RlbmVyKSlcbiAgICB0aHJvdyBUeXBlRXJyb3IoJ2xpc3RlbmVyIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuXG4gIGlmICghdGhpcy5fZXZlbnRzKVxuICAgIHRoaXMuX2V2ZW50cyA9IHt9O1xuXG4gIC8vIFRvIGF2b2lkIHJlY3Vyc2lvbiBpbiB0aGUgY2FzZSB0aGF0IHR5cGUgPT09IFwibmV3TGlzdGVuZXJcIiEgQmVmb3JlXG4gIC8vIGFkZGluZyBpdCB0byB0aGUgbGlzdGVuZXJzLCBmaXJzdCBlbWl0IFwibmV3TGlzdGVuZXJcIi5cbiAgaWYgKHRoaXMuX2V2ZW50cy5uZXdMaXN0ZW5lcilcbiAgICB0aGlzLmVtaXQoJ25ld0xpc3RlbmVyJywgdHlwZSxcbiAgICAgICAgICAgICAgaXNGdW5jdGlvbihsaXN0ZW5lci5saXN0ZW5lcikgP1xuICAgICAgICAgICAgICBsaXN0ZW5lci5saXN0ZW5lciA6IGxpc3RlbmVyKTtcblxuICBpZiAoIXRoaXMuX2V2ZW50c1t0eXBlXSlcbiAgICAvLyBPcHRpbWl6ZSB0aGUgY2FzZSBvZiBvbmUgbGlzdGVuZXIuIERvbid0IG5lZWQgdGhlIGV4dHJhIGFycmF5IG9iamVjdC5cbiAgICB0aGlzLl9ldmVudHNbdHlwZV0gPSBsaXN0ZW5lcjtcbiAgZWxzZSBpZiAoaXNPYmplY3QodGhpcy5fZXZlbnRzW3R5cGVdKSlcbiAgICAvLyBJZiB3ZSd2ZSBhbHJlYWR5IGdvdCBhbiBhcnJheSwganVzdCBhcHBlbmQuXG4gICAgdGhpcy5fZXZlbnRzW3R5cGVdLnB1c2gobGlzdGVuZXIpO1xuICBlbHNlXG4gICAgLy8gQWRkaW5nIHRoZSBzZWNvbmQgZWxlbWVudCwgbmVlZCB0byBjaGFuZ2UgdG8gYXJyYXkuXG4gICAgdGhpcy5fZXZlbnRzW3R5cGVdID0gW3RoaXMuX2V2ZW50c1t0eXBlXSwgbGlzdGVuZXJdO1xuXG4gIC8vIENoZWNrIGZvciBsaXN0ZW5lciBsZWFrXG4gIGlmIChpc09iamVjdCh0aGlzLl9ldmVudHNbdHlwZV0pICYmICF0aGlzLl9ldmVudHNbdHlwZV0ud2FybmVkKSB7XG4gICAgaWYgKCFpc1VuZGVmaW5lZCh0aGlzLl9tYXhMaXN0ZW5lcnMpKSB7XG4gICAgICBtID0gdGhpcy5fbWF4TGlzdGVuZXJzO1xuICAgIH0gZWxzZSB7XG4gICAgICBtID0gRXZlbnRFbWl0dGVyJDEuZGVmYXVsdE1heExpc3RlbmVycztcbiAgICB9XG5cbiAgICBpZiAobSAmJiBtID4gMCAmJiB0aGlzLl9ldmVudHNbdHlwZV0ubGVuZ3RoID4gbSkge1xuICAgICAgdGhpcy5fZXZlbnRzW3R5cGVdLndhcm5lZCA9IHRydWU7XG4gICAgICBjb25zb2xlLmVycm9yKCcobm9kZSkgd2FybmluZzogcG9zc2libGUgRXZlbnRFbWl0dGVyIG1lbW9yeSAnICtcbiAgICAgICAgICAgICAgICAgICAgJ2xlYWsgZGV0ZWN0ZWQuICVkIGxpc3RlbmVycyBhZGRlZC4gJyArXG4gICAgICAgICAgICAgICAgICAgICdVc2UgZW1pdHRlci5zZXRNYXhMaXN0ZW5lcnMoKSB0byBpbmNyZWFzZSBsaW1pdC4nLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9ldmVudHNbdHlwZV0ubGVuZ3RoKTtcbiAgICAgIGlmICh0eXBlb2YgY29uc29sZS50cmFjZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAvLyBub3Qgc3VwcG9ydGVkIGluIElFIDEwXG4gICAgICAgIGNvbnNvbGUudHJhY2UoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGhpcztcbn07XG5cbkV2ZW50RW1pdHRlciQxLnByb3RvdHlwZS5vbiA9IEV2ZW50RW1pdHRlciQxLnByb3RvdHlwZS5hZGRMaXN0ZW5lcjtcblxuRXZlbnRFbWl0dGVyJDEucHJvdG90eXBlLm9uY2UgPSBmdW5jdGlvbih0eXBlLCBsaXN0ZW5lcikge1xuICBpZiAoIWlzRnVuY3Rpb24obGlzdGVuZXIpKVxuICAgIHRocm93IFR5cGVFcnJvcignbGlzdGVuZXIgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG5cbiAgdmFyIGZpcmVkID0gZmFsc2U7XG5cbiAgZnVuY3Rpb24gZygpIHtcbiAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKHR5cGUsIGcpO1xuXG4gICAgaWYgKCFmaXJlZCkge1xuICAgICAgZmlyZWQgPSB0cnVlO1xuICAgICAgbGlzdGVuZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG4gIH1cblxuICBnLmxpc3RlbmVyID0gbGlzdGVuZXI7XG4gIHRoaXMub24odHlwZSwgZyk7XG5cbiAgcmV0dXJuIHRoaXM7XG59O1xuXG4vLyBlbWl0cyBhICdyZW1vdmVMaXN0ZW5lcicgZXZlbnQgaWZmIHRoZSBsaXN0ZW5lciB3YXMgcmVtb3ZlZFxuRXZlbnRFbWl0dGVyJDEucHJvdG90eXBlLnJlbW92ZUxpc3RlbmVyID0gZnVuY3Rpb24odHlwZSwgbGlzdGVuZXIpIHtcbiAgdmFyIGxpc3QsIHBvc2l0aW9uLCBsZW5ndGgsIGk7XG5cbiAgaWYgKCFpc0Z1bmN0aW9uKGxpc3RlbmVyKSlcbiAgICB0aHJvdyBUeXBlRXJyb3IoJ2xpc3RlbmVyIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuXG4gIGlmICghdGhpcy5fZXZlbnRzIHx8ICF0aGlzLl9ldmVudHNbdHlwZV0pXG4gICAgcmV0dXJuIHRoaXM7XG5cbiAgbGlzdCA9IHRoaXMuX2V2ZW50c1t0eXBlXTtcbiAgbGVuZ3RoID0gbGlzdC5sZW5ndGg7XG4gIHBvc2l0aW9uID0gLTE7XG5cbiAgaWYgKGxpc3QgPT09IGxpc3RlbmVyIHx8XG4gICAgICAoaXNGdW5jdGlvbihsaXN0Lmxpc3RlbmVyKSAmJiBsaXN0Lmxpc3RlbmVyID09PSBsaXN0ZW5lcikpIHtcbiAgICBkZWxldGUgdGhpcy5fZXZlbnRzW3R5cGVdO1xuICAgIGlmICh0aGlzLl9ldmVudHMucmVtb3ZlTGlzdGVuZXIpXG4gICAgICB0aGlzLmVtaXQoJ3JlbW92ZUxpc3RlbmVyJywgdHlwZSwgbGlzdGVuZXIpO1xuXG4gIH0gZWxzZSBpZiAoaXNPYmplY3QobGlzdCkpIHtcbiAgICBmb3IgKGkgPSBsZW5ndGg7IGktLSA+IDA7KSB7XG4gICAgICBpZiAobGlzdFtpXSA9PT0gbGlzdGVuZXIgfHxcbiAgICAgICAgICAobGlzdFtpXS5saXN0ZW5lciAmJiBsaXN0W2ldLmxpc3RlbmVyID09PSBsaXN0ZW5lcikpIHtcbiAgICAgICAgcG9zaXRpb24gPSBpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocG9zaXRpb24gPCAwKVxuICAgICAgcmV0dXJuIHRoaXM7XG5cbiAgICBpZiAobGlzdC5sZW5ndGggPT09IDEpIHtcbiAgICAgIGxpc3QubGVuZ3RoID0gMDtcbiAgICAgIGRlbGV0ZSB0aGlzLl9ldmVudHNbdHlwZV07XG4gICAgfSBlbHNlIHtcbiAgICAgIGxpc3Quc3BsaWNlKHBvc2l0aW9uLCAxKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5fZXZlbnRzLnJlbW92ZUxpc3RlbmVyKVxuICAgICAgdGhpcy5lbWl0KCdyZW1vdmVMaXN0ZW5lcicsIHR5cGUsIGxpc3RlbmVyKTtcbiAgfVxuXG4gIHJldHVybiB0aGlzO1xufTtcblxuRXZlbnRFbWl0dGVyJDEucHJvdG90eXBlLnJlbW92ZUFsbExpc3RlbmVycyA9IGZ1bmN0aW9uKHR5cGUpIHtcbiAgdmFyIGtleSwgbGlzdGVuZXJzO1xuXG4gIGlmICghdGhpcy5fZXZlbnRzKVxuICAgIHJldHVybiB0aGlzO1xuXG4gIC8vIG5vdCBsaXN0ZW5pbmcgZm9yIHJlbW92ZUxpc3RlbmVyLCBubyBuZWVkIHRvIGVtaXRcbiAgaWYgKCF0aGlzLl9ldmVudHMucmVtb3ZlTGlzdGVuZXIpIHtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMClcbiAgICAgIHRoaXMuX2V2ZW50cyA9IHt9O1xuICAgIGVsc2UgaWYgKHRoaXMuX2V2ZW50c1t0eXBlXSlcbiAgICAgIGRlbGV0ZSB0aGlzLl9ldmVudHNbdHlwZV07XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvLyBlbWl0IHJlbW92ZUxpc3RlbmVyIGZvciBhbGwgbGlzdGVuZXJzIG9uIGFsbCBldmVudHNcbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICBmb3IgKGtleSBpbiB0aGlzLl9ldmVudHMpIHtcbiAgICAgIGlmIChrZXkgPT09ICdyZW1vdmVMaXN0ZW5lcicpIGNvbnRpbnVlO1xuICAgICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoa2V5KTtcbiAgICB9XG4gICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoJ3JlbW92ZUxpc3RlbmVyJyk7XG4gICAgdGhpcy5fZXZlbnRzID0ge307XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBsaXN0ZW5lcnMgPSB0aGlzLl9ldmVudHNbdHlwZV07XG5cbiAgaWYgKGlzRnVuY3Rpb24obGlzdGVuZXJzKSkge1xuICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIodHlwZSwgbGlzdGVuZXJzKTtcbiAgfSBlbHNlIGlmIChsaXN0ZW5lcnMpIHtcbiAgICAvLyBMSUZPIG9yZGVyXG4gICAgd2hpbGUgKGxpc3RlbmVycy5sZW5ndGgpXG4gICAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKHR5cGUsIGxpc3RlbmVyc1tsaXN0ZW5lcnMubGVuZ3RoIC0gMV0pO1xuICB9XG4gIGRlbGV0ZSB0aGlzLl9ldmVudHNbdHlwZV07XG5cbiAgcmV0dXJuIHRoaXM7XG59O1xuXG5FdmVudEVtaXR0ZXIkMS5wcm90b3R5cGUubGlzdGVuZXJzID0gZnVuY3Rpb24odHlwZSkge1xuICB2YXIgcmV0O1xuICBpZiAoIXRoaXMuX2V2ZW50cyB8fCAhdGhpcy5fZXZlbnRzW3R5cGVdKVxuICAgIHJldCA9IFtdO1xuICBlbHNlIGlmIChpc0Z1bmN0aW9uKHRoaXMuX2V2ZW50c1t0eXBlXSkpXG4gICAgcmV0ID0gW3RoaXMuX2V2ZW50c1t0eXBlXV07XG4gIGVsc2VcbiAgICByZXQgPSB0aGlzLl9ldmVudHNbdHlwZV0uc2xpY2UoKTtcbiAgcmV0dXJuIHJldDtcbn07XG5cbkV2ZW50RW1pdHRlciQxLnByb3RvdHlwZS5saXN0ZW5lckNvdW50ID0gZnVuY3Rpb24odHlwZSkge1xuICBpZiAodGhpcy5fZXZlbnRzKSB7XG4gICAgdmFyIGV2bGlzdGVuZXIgPSB0aGlzLl9ldmVudHNbdHlwZV07XG5cbiAgICBpZiAoaXNGdW5jdGlvbihldmxpc3RlbmVyKSlcbiAgICAgIHJldHVybiAxO1xuICAgIGVsc2UgaWYgKGV2bGlzdGVuZXIpXG4gICAgICByZXR1cm4gZXZsaXN0ZW5lci5sZW5ndGg7XG4gIH1cbiAgcmV0dXJuIDA7XG59O1xuXG5FdmVudEVtaXR0ZXIkMS5saXN0ZW5lckNvdW50ID0gZnVuY3Rpb24oZW1pdHRlciwgdHlwZSkge1xuICByZXR1cm4gZW1pdHRlci5saXN0ZW5lckNvdW50KHR5cGUpO1xufTtcblxuZnVuY3Rpb24gaXNGdW5jdGlvbihhcmcpIHtcbiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdmdW5jdGlvbic7XG59XG5cbmZ1bmN0aW9uIGlzTnVtYmVyKGFyZykge1xuICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ251bWJlcic7XG59XG5cbmZ1bmN0aW9uIGlzT2JqZWN0KGFyZykge1xuICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ29iamVjdCcgJiYgYXJnICE9PSBudWxsO1xufVxuXG5mdW5jdGlvbiBpc1VuZGVmaW5lZChhcmcpIHtcbiAgcmV0dXJuIGFyZyA9PT0gdm9pZCAwO1xufVxuXG52YXIgRXZlbnRFbWl0dGVyID0gZXZlbnRzLkV2ZW50RW1pdHRlcjtcblxudmFyIEVtaXR0ZXIgPSBmdW5jdGlvbiAoX0V2ZW50RW1pdHRlcikge1xuICAgIGluaGVyaXRzKEVtaXR0ZXIsIF9FdmVudEVtaXR0ZXIpO1xuXG4gICAgZnVuY3Rpb24gRW1pdHRlcigpIHtcbiAgICAgICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgRW1pdHRlcik7XG4gICAgICAgIHJldHVybiBwb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9FdmVudEVtaXR0ZXIuY2FsbCh0aGlzKSk7XG4gICAgfVxuXG4gICAgRW1pdHRlci5wcm90b3R5cGUub2ZmID0gZnVuY3Rpb24gb2ZmKHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgICAgIGlmIChsaXN0ZW5lcikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVtb3ZlTGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnModHlwZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBFbWl0dGVyO1xufShFdmVudEVtaXR0ZXIpO1xuXG5mdW5jdGlvbiBMb2FkZXIodXJsLCBkZWZlckxvYWQpIHtcbiAgICB2YXIgRVJST1JfU1RBVEUgPSBbJycsICdBQk9SVEVEJywgJ05FVFdPUksnLCAnREVDT0RFJywgJ1NSQ19OT1RfU1VQUE9SVEVEJ107XG4gICAgdmFyIGVtaXR0ZXIgPSBuZXcgRW1pdHRlcigpO1xuICAgIHZhciBwcm9ncmVzcyA9IDAsXG4gICAgICAgIGF1ZGlvQ29udGV4dCA9IHZvaWQgMCxcbiAgICAgICAgaXNUb3VjaExvY2tlZCA9IHZvaWQgMCxcbiAgICAgICAgcmVxdWVzdCA9IHZvaWQgMCxcbiAgICAgICAgdGltZW91dCA9IHZvaWQgMCxcbiAgICAgICAgZGF0YSA9IHZvaWQgMDtcblxuICAgIC8vIGNsZWFuIHVwXG5cbiAgICBmdW5jdGlvbiByZW1vdmVMaXN0ZW5lcnMoKSB7XG4gICAgICAgIGVtaXR0ZXIub2ZmKCdlcnJvcicpO1xuICAgICAgICBlbWl0dGVyLm9mZigncHJvZ3Jlc3MnKTtcbiAgICAgICAgZW1pdHRlci5vZmYoJ2NvbXBsZXRlJyk7XG4gICAgICAgIGVtaXR0ZXIub2ZmKCdsb2FkZWQnKTtcblxuICAgICAgICBpZiAoZGF0YSAmJiB0eXBlb2YgZGF0YS5yZW1vdmVFdmVudExpc3RlbmVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBkYXRhLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NhbnBsYXl0aHJvdWdoJywgcmVhZHlIYW5kbGVyKTtcbiAgICAgICAgICAgIGRhdGEucmVtb3ZlRXZlbnRMaXN0ZW5lcignZXJyb3InLCBlcnJvckhhbmRsZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHJlcXVlc3QpIHtcbiAgICAgICAgICAgIHJlcXVlc3QucmVtb3ZlRXZlbnRMaXN0ZW5lcigncHJvZ3Jlc3MnLCBwcm9ncmVzc0hhbmRsZXIpO1xuICAgICAgICAgICAgcmVxdWVzdC5yZW1vdmVFdmVudExpc3RlbmVyKCdsb2FkJywgbG9hZEhhbmRsZXIpO1xuICAgICAgICAgICAgcmVxdWVzdC5yZW1vdmVFdmVudExpc3RlbmVyKCdlcnJvcicsIGVycm9ySGFuZGxlcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkaXNwYXRjaENvbXBsZXRlKGJ1ZmZlcikge1xuICAgICAgICBlbWl0dGVyLmVtaXQoJ3Byb2dyZXNzJywgMSk7XG4gICAgICAgIGVtaXR0ZXIuZW1pdCgnbG9hZGVkJywgYnVmZmVyKTtcbiAgICAgICAgZW1pdHRlci5lbWl0KCdjb21wbGV0ZScsIGJ1ZmZlcik7XG5cbiAgICAgICAgcmVtb3ZlTGlzdGVuZXJzKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcHJvZ3Jlc3NIYW5kbGVyKGV2ZW50KSB7XG4gICAgICAgIGlmIChldmVudC5sZW5ndGhDb21wdXRhYmxlKSB7XG4gICAgICAgICAgICBwcm9ncmVzcyA9IGV2ZW50LmxvYWRlZCAvIGV2ZW50LnRvdGFsO1xuICAgICAgICAgICAgZW1pdHRlci5lbWl0KCdwcm9ncmVzcycsIHByb2dyZXNzKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIGVycm9yXG5cbiAgICBmdW5jdGlvbiBlcnJvckhhbmRsZXIoZXZlbnQpIHtcbiAgICAgICAgd2luZG93LmNsZWFyVGltZW91dCh0aW1lb3V0KTtcblxuICAgICAgICB2YXIgbWVzc2FnZSA9IGV2ZW50O1xuXG4gICAgICAgIGlmIChkYXRhICYmIGRhdGEuZXJyb3IpIHtcbiAgICAgICAgICAgIG1lc3NhZ2UgPSAnTWVkaWEgRXJyb3I6ICcgKyBFUlJPUl9TVEFURVtkYXRhLmVycm9yLmNvZGVdICsgJyAnICsgdXJsO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHJlcXVlc3QpIHtcbiAgICAgICAgICAgIG1lc3NhZ2UgPSAnWEhSIEVycm9yOiAnICsgcmVxdWVzdC5zdGF0dXMgKyAnICcgKyByZXF1ZXN0LnN0YXR1c1RleHQgKyAnICcgKyB1cmw7XG4gICAgICAgIH1cblxuICAgICAgICBlbWl0dGVyLmVtaXQoJ2Vycm9yJywgbWVzc2FnZSk7XG5cbiAgICAgICAgcmVtb3ZlTGlzdGVuZXJzKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVjb2RlQXJyYXlCdWZmZXIoYXJyYXlidWZmZXIpIHtcbiAgICAgICAgYXVkaW9Db250ZXh0LmRlY29kZUF1ZGlvRGF0YShhcnJheWJ1ZmZlciwgZnVuY3Rpb24gKGJ1ZmZlcikge1xuICAgICAgICAgICAgZGF0YSA9IGJ1ZmZlcjtcbiAgICAgICAgICAgIHJlcXVlc3QgPSBudWxsO1xuICAgICAgICAgICAgcHJvZ3Jlc3MgPSAxO1xuICAgICAgICAgICAgZGlzcGF0Y2hDb21wbGV0ZShidWZmZXIpO1xuICAgICAgICB9LCBlcnJvckhhbmRsZXIpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvYWRIYW5kbGVyKCkge1xuICAgICAgICBkZWNvZGVBcnJheUJ1ZmZlcihyZXF1ZXN0LnJlc3BvbnNlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZWFkeUhhbmRsZXIoKSB7XG4gICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGltZW91dCk7XG4gICAgICAgIGlmICghZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHByb2dyZXNzID0gMTtcbiAgICAgICAgZGlzcGF0Y2hDb21wbGV0ZShkYXRhKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjYW5jZWwoKSB7XG4gICAgICAgIHJlbW92ZUxpc3RlbmVycygpO1xuXG4gICAgICAgIGlmIChyZXF1ZXN0ICYmIHJlcXVlc3QucmVhZHlTdGF0ZSAhPT0gNCkge1xuICAgICAgICAgICAgcmVxdWVzdC5hYm9ydCgpO1xuICAgICAgICB9XG4gICAgICAgIHJlcXVlc3QgPSBudWxsO1xuXG4gICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGltZW91dCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgY2FuY2VsKCk7XG4gICAgICAgIHJlcXVlc3QgPSBudWxsO1xuICAgICAgICBkYXRhID0gbnVsbDtcbiAgICAgICAgYXVkaW9Db250ZXh0ID0gbnVsbDtcbiAgICB9XG5cbiAgICAvLyBhdWRpbyBidWZmZXJcblxuICAgIGZ1bmN0aW9uIGxvYWRBcnJheUJ1ZmZlcigpIHtcbiAgICAgICAgaWYgKHVybCBpbnN0YW5jZW9mIHdpbmRvdy5BcnJheUJ1ZmZlcikge1xuICAgICAgICAgICAgZGVjb2RlQXJyYXlCdWZmZXIodXJsKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICByZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgIHJlcXVlc3Qub3BlbignR0VUJywgdXJsLCB0cnVlKTtcbiAgICAgICAgcmVxdWVzdC5yZXNwb25zZVR5cGUgPSAnYXJyYXlidWZmZXInO1xuICAgICAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ3Byb2dyZXNzJywgcHJvZ3Jlc3NIYW5kbGVyKTtcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgbG9hZEhhbmRsZXIpO1xuICAgICAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZXJyb3JIYW5kbGVyKTtcbiAgICAgICAgcmVxdWVzdC5zZW5kKCk7XG4gICAgfVxuXG4gICAgLy8gYXVkaW8gZWxlbWVudFxuXG4gICAgZnVuY3Rpb24gbG9hZEF1ZGlvRWxlbWVudCgpIHtcbiAgICAgICAgaWYgKCFkYXRhIHx8ICFkYXRhLnRhZ05hbWUpIHtcbiAgICAgICAgICAgIGRhdGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhdWRpbycpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFpc1RvdWNoTG9ja2VkKSB7XG4gICAgICAgICAgICAvLyB0aW1lb3V0IGJlY2F1c2Ugc29tZXRpbWVzIGNhbnBsYXl0aHJvdWdoIGRvZXNuJ3QgZmlyZVxuICAgICAgICAgICAgd2luZG93LmNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICAgICAgICAgIHRpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dChyZWFkeUhhbmRsZXIsIDIwMDApO1xuICAgICAgICAgICAgZGF0YS5hZGRFdmVudExpc3RlbmVyKCdjYW5wbGF5dGhyb3VnaCcsIHJlYWR5SGFuZGxlciwgZmFsc2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgZGF0YS5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIGVycm9ySGFuZGxlciwgZmFsc2UpO1xuICAgICAgICBkYXRhLnByZWxvYWQgPSAnYXV0byc7XG4gICAgICAgIGRhdGEuc3JjID0gdXJsO1xuICAgICAgICBkYXRhLmxvYWQoKTtcblxuICAgICAgICBpZiAoaXNUb3VjaExvY2tlZCkge1xuICAgICAgICAgICAgZGlzcGF0Y2hDb21wbGV0ZShkYXRhKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN0YXJ0KCkge1xuICAgICAgICB2YXIgZm9yY2UgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDAgfHwgYXJndW1lbnRzWzBdID09PSB1bmRlZmluZWQgPyBmYWxzZSA6IGFyZ3VtZW50c1swXTtcblxuICAgICAgICBpZiAoZGVmZXJMb2FkICYmICFmb3JjZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhdWRpb0NvbnRleHQpIHtcbiAgICAgICAgICAgIGxvYWRBcnJheUJ1ZmZlcigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbG9hZEF1ZGlvRWxlbWVudCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gcmVsb2FkXG5cbiAgICBmdW5jdGlvbiBsb2FkKG5ld1VybCkge1xuICAgICAgICB1cmwgPSBuZXdVcmw7XG4gICAgICAgIHN0YXJ0KCk7XG4gICAgfVxuXG4gICAgdmFyIGFwaSA9IHtcbiAgICAgICAgb246IGVtaXR0ZXIub24uYmluZChlbWl0dGVyKSxcbiAgICAgICAgb25jZTogZW1pdHRlci5vbmNlLmJpbmQoZW1pdHRlciksXG4gICAgICAgIG9mZjogZW1pdHRlci5vZmYuYmluZChlbWl0dGVyKSxcbiAgICAgICAgbG9hZDogbG9hZCxcbiAgICAgICAgc3RhcnQ6IHN0YXJ0LFxuICAgICAgICBjYW5jZWw6IGNhbmNlbCxcbiAgICAgICAgZGVzdHJveTogZGVzdHJveVxuICAgIH07XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhhcGksIHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHByb2dyZXNzOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvZ3Jlc3M7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGF1ZGlvQ29udGV4dDoge1xuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBhdWRpb0NvbnRleHQgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgaXNUb3VjaExvY2tlZDoge1xuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpc1RvdWNoTG9ja2VkID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBPYmplY3QuZnJlZXplKGFwaSk7XG59XG5cbkxvYWRlci5Hcm91cCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZW1pdHRlciA9IG5ldyBFbWl0dGVyKCk7XG4gICAgdmFyIHF1ZXVlID0gW107XG4gICAgdmFyIG51bUxvYWRlZCA9IDAsXG4gICAgICAgIG51bVRvdGFsID0gMCxcbiAgICAgICAgY3VycmVudExvYWRlciA9IHZvaWQgMDtcblxuICAgIGZ1bmN0aW9uIHByb2dyZXNzSGFuZGxlcihwcm9ncmVzcykge1xuICAgICAgICB2YXIgbG9hZGVkID0gbnVtTG9hZGVkICsgcHJvZ3Jlc3M7XG4gICAgICAgIGVtaXR0ZXIuZW1pdCgncHJvZ3Jlc3MnLCBsb2FkZWQgLyBudW1Ub3RhbCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY29tcGxldGVIYW5kbGVyKCkge1xuICAgICAgICBudW1Mb2FkZWQrKztcbiAgICAgICAgcmVtb3ZlTGlzdGVuZXJzKCk7XG4gICAgICAgIGVtaXR0ZXIuZW1pdCgncHJvZ3Jlc3MnLCBudW1Mb2FkZWQgLyBudW1Ub3RhbCk7XG4gICAgICAgIG5leHQoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBlcnJvckhhbmRsZXIoZSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgICByZW1vdmVMaXN0ZW5lcnMoKTtcbiAgICAgICAgZW1pdHRlci5lbWl0KCdlcnJvcicsIGUpO1xuICAgICAgICBuZXh0KCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbmV4dCgpIHtcbiAgICAgICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgY3VycmVudExvYWRlciA9IG51bGw7XG4gICAgICAgICAgICBlbWl0dGVyLmVtaXQoJ2NvbXBsZXRlJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjdXJyZW50TG9hZGVyID0gcXVldWUucG9wKCk7XG4gICAgICAgIGN1cnJlbnRMb2FkZXIub24oJ3Byb2dyZXNzJywgcHJvZ3Jlc3NIYW5kbGVyKTtcbiAgICAgICAgY3VycmVudExvYWRlci5vbmNlKCdsb2FkZWQnLCBjb21wbGV0ZUhhbmRsZXIpO1xuICAgICAgICBjdXJyZW50TG9hZGVyLm9uY2UoJ2Vycm9yJywgZXJyb3JIYW5kbGVyKTtcbiAgICAgICAgY3VycmVudExvYWRlci5zdGFydCgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlbW92ZUxpc3RlbmVycygpIHtcbiAgICAgICAgY3VycmVudExvYWRlci5vZmYoJ3Byb2dyZXNzJywgcHJvZ3Jlc3NIYW5kbGVyKTtcbiAgICAgICAgY3VycmVudExvYWRlci5vZmYoJ2xvYWRlZCcsIGNvbXBsZXRlSGFuZGxlcik7XG4gICAgICAgIGN1cnJlbnRMb2FkZXIub2ZmKCdlcnJvcicsIGVycm9ySGFuZGxlcik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWRkKGxvYWRlcikge1xuICAgICAgICBxdWV1ZS5wdXNoKGxvYWRlcik7XG4gICAgICAgIG51bVRvdGFsKys7XG4gICAgICAgIHJldHVybiBsb2FkZXI7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3RhcnQoKSB7XG4gICAgICAgIG51bVRvdGFsID0gcXVldWUubGVuZ3RoO1xuICAgICAgICBuZXh0KCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIE9iamVjdC5mcmVlemUoe1xuICAgICAgICBvbjogZW1pdHRlci5vbi5iaW5kKGVtaXR0ZXIpLFxuICAgICAgICBvbmNlOiBlbWl0dGVyLm9uY2UuYmluZChlbWl0dGVyKSxcbiAgICAgICAgb2ZmOiBlbWl0dGVyLm9mZi5iaW5kKGVtaXR0ZXIpLFxuICAgICAgICBhZGQ6IGFkZCxcbiAgICAgICAgc3RhcnQ6IHN0YXJ0XG4gICAgfSk7XG59O1xuXG5mdW5jdGlvbiBCdWZmZXJTb3VyY2UoYnVmZmVyLCBjb250ZXh0LCBvbkVuZGVkKSB7XG4gICAgdmFyIGFwaSA9IHt9O1xuICAgIHZhciBlbmRlZCA9IGZhbHNlLFxuICAgICAgICBlbmRlZENhbGxiYWNrID0gb25FbmRlZCxcbiAgICAgICAgbG9vcCA9IGZhbHNlLFxuICAgICAgICBwYXVzZWQgPSBmYWxzZSxcbiAgICAgICAgcGF1c2VkQXQgPSAwLFxuICAgICAgICBwbGF5YmFja1JhdGUgPSAxLFxuICAgICAgICBwbGF5aW5nID0gZmFsc2UsXG4gICAgICAgIHNvdXJjZU5vZGUgPSBudWxsLFxuICAgICAgICBzdGFydGVkQXQgPSAwO1xuXG4gICAgZnVuY3Rpb24gY3JlYXRlU291cmNlTm9kZSgpIHtcbiAgICAgICAgaWYgKCFzb3VyY2VOb2RlICYmIGNvbnRleHQpIHtcbiAgICAgICAgICAgIHNvdXJjZU5vZGUgPSBjb250ZXh0LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpO1xuICAgICAgICAgICAgc291cmNlTm9kZS5idWZmZXIgPSBidWZmZXI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNvdXJjZU5vZGU7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBDb250cm9sc1xuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICAgICAgaWYgKHNvdXJjZU5vZGUpIHtcbiAgICAgICAgICAgIHNvdXJjZU5vZGUub25lbmRlZCA9IG51bGw7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHNvdXJjZU5vZGUuZGlzY29ubmVjdCgpO1xuICAgICAgICAgICAgICAgIHNvdXJjZU5vZGUuc3RvcCgwKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgICAgICAgICBzb3VyY2VOb2RlID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHBhdXNlZCA9IGZhbHNlO1xuICAgICAgICBwYXVzZWRBdCA9IDA7XG4gICAgICAgIHBsYXlpbmcgPSBmYWxzZTtcbiAgICAgICAgc3RhcnRlZEF0ID0gMDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICAgICAgdmFyIGVsYXBzZWQgPSBjb250ZXh0LmN1cnJlbnRUaW1lIC0gc3RhcnRlZEF0O1xuICAgICAgICBzdG9wKCk7XG4gICAgICAgIHBhdXNlZEF0ID0gZWxhcHNlZDtcbiAgICAgICAgcGxheWluZyA9IGZhbHNlO1xuICAgICAgICBwYXVzZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGVuZGVkSGFuZGxlcigpIHtcbiAgICAgICAgc3RvcCgpO1xuICAgICAgICBlbmRlZCA9IHRydWU7XG4gICAgICAgIGlmICh0eXBlb2YgZW5kZWRDYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgZW5kZWRDYWxsYmFjayhhcGkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGxheShkZWxheSkge1xuICAgICAgICB2YXIgb2Zmc2V0ID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8gMCA6IGFyZ3VtZW50c1sxXTtcblxuICAgICAgICBpZiAocGxheWluZykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZGVsYXkgPSBkZWxheSA/IGNvbnRleHQuY3VycmVudFRpbWUgKyBkZWxheSA6IDA7XG4gICAgICAgIGlmIChvZmZzZXQpIHtcbiAgICAgICAgICAgIHBhdXNlZEF0ID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGF1c2VkQXQpIHtcbiAgICAgICAgICAgIG9mZnNldCA9IHBhdXNlZEF0O1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlIChvZmZzZXQgPiBhcGkuZHVyYXRpb24pIHtcbiAgICAgICAgICAgIG9mZnNldCA9IG9mZnNldCAlIGFwaS5kdXJhdGlvbjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNyZWF0ZVNvdXJjZU5vZGUoKTtcbiAgICAgICAgc291cmNlTm9kZS5vbmVuZGVkID0gZW5kZWRIYW5kbGVyO1xuICAgICAgICBzb3VyY2VOb2RlLnN0YXJ0KGRlbGF5LCBvZmZzZXQpO1xuXG4gICAgICAgIHNvdXJjZU5vZGUubG9vcCA9IGxvb3A7XG4gICAgICAgIHNvdXJjZU5vZGUucGxheWJhY2tSYXRlLnZhbHVlID0gcGxheWJhY2tSYXRlO1xuXG4gICAgICAgIHN0YXJ0ZWRBdCA9IGNvbnRleHQuY3VycmVudFRpbWUgLSBvZmZzZXQ7XG4gICAgICAgIGVuZGVkID0gZmFsc2U7XG4gICAgICAgIHBhdXNlZCA9IGZhbHNlO1xuICAgICAgICBwYXVzZWRBdCA9IDA7XG4gICAgICAgIHBsYXlpbmcgPSB0cnVlO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogRGVzdHJveVxuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgc3RvcCgpO1xuICAgICAgICBidWZmZXIgPSBudWxsO1xuICAgICAgICBjb250ZXh0ID0gbnVsbDtcbiAgICAgICAgZW5kZWRDYWxsYmFjayA9IG51bGw7XG4gICAgICAgIHNvdXJjZU5vZGUgPSBudWxsO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogR2V0dGVycyAmIFNldHRlcnNcbiAgICAgKi9cblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGFwaSwge1xuICAgICAgICBwbGF5OiB7XG4gICAgICAgICAgICB2YWx1ZTogcGxheVxuICAgICAgICB9LFxuICAgICAgICBwYXVzZToge1xuICAgICAgICAgICAgdmFsdWU6IHBhdXNlXG4gICAgICAgIH0sXG4gICAgICAgIHN0b3A6IHtcbiAgICAgICAgICAgIHZhbHVlOiBzdG9wXG4gICAgICAgIH0sXG4gICAgICAgIGRlc3Ryb3k6IHtcbiAgICAgICAgICAgIHZhbHVlOiBkZXN0cm95XG4gICAgICAgIH0sXG4gICAgICAgIGN1cnJlbnRUaW1lOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICBpZiAocGF1c2VkQXQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhdXNlZEF0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc3RhcnRlZEF0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aW1lID0gY29udGV4dC5jdXJyZW50VGltZSAtIHN0YXJ0ZWRBdDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRpbWUgPiBhcGkuZHVyYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWUgPSB0aW1lICUgYXBpLmR1cmF0aW9uO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aW1lO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZHVyYXRpb246IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBidWZmZXIgPyBidWZmZXIuZHVyYXRpb24gOiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbmRlZDoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVuZGVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBsb29wOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbG9vcDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGxvb3AgPSAhIXZhbHVlO1xuICAgICAgICAgICAgICAgIGlmIChzb3VyY2VOb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZU5vZGUubG9vcCA9IGxvb3A7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBwYXVzZWQ6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwYXVzZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHBsYXliYWNrUmF0ZToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBsYXliYWNrUmF0ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHBsYXliYWNrUmF0ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGlmIChzb3VyY2VOb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZU5vZGUucGxheWJhY2tSYXRlLnZhbHVlID0gcGxheWJhY2tSYXRlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcGxheWluZzoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBsYXlpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHByb2dyZXNzOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXBpLmR1cmF0aW9uID8gYXBpLmN1cnJlbnRUaW1lIC8gYXBpLmR1cmF0aW9uIDogMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgc291cmNlTm9kZToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZVNvdXJjZU5vZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIE9iamVjdC5mcmVlemUoYXBpKTtcbn1cblxuZnVuY3Rpb24gTWVkaWFTb3VyY2UoZWwsIGNvbnRleHQsIG9uRW5kZWQpIHtcbiAgICB2YXIgYXBpID0ge307XG4gICAgdmFyIGVuZGVkID0gZmFsc2UsXG4gICAgICAgIGVuZGVkQ2FsbGJhY2sgPSBvbkVuZGVkLFxuICAgICAgICBkZWxheVRpbWVvdXQgPSB2b2lkIDAsXG4gICAgICAgIGZhZGVUaW1lb3V0ID0gdm9pZCAwLFxuICAgICAgICBsb29wID0gZmFsc2UsXG4gICAgICAgIHBhdXNlZCA9IGZhbHNlLFxuICAgICAgICBwbGF5YmFja1JhdGUgPSAxLFxuICAgICAgICBwbGF5aW5nID0gZmFsc2UsXG4gICAgICAgIHNvdXJjZU5vZGUgPSBudWxsLFxuICAgICAgICBncm91cFZvbHVtZSA9IDEsXG4gICAgICAgIHZvbHVtZSA9IDE7XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVTb3VyY2VOb2RlKCkge1xuICAgICAgICBpZiAoIXNvdXJjZU5vZGUgJiYgY29udGV4dCkge1xuICAgICAgICAgICAgc291cmNlTm9kZSA9IGNvbnRleHQuY3JlYXRlTWVkaWFFbGVtZW50U291cmNlKGVsKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc291cmNlTm9kZTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIExvYWRcbiAgICAgKi9cblxuICAgIGZ1bmN0aW9uIGxvYWQodXJsKSB7XG4gICAgICAgIGVsLnNyYyA9IHVybDtcbiAgICAgICAgZWwubG9hZCgpO1xuICAgICAgICBlbmRlZCA9IGZhbHNlO1xuICAgICAgICBwYXVzZWQgPSBmYWxzZTtcbiAgICAgICAgcGxheWluZyA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogQ29udHJvbHNcbiAgICAgKi9cblxuICAgIGZ1bmN0aW9uIHJlYWR5SGFuZGxlcigpIHtcbiAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2FucGxheXRocm91Z2gnLCByZWFkeUhhbmRsZXIpO1xuICAgICAgICBpZiAocGxheWluZykge1xuICAgICAgICAgICAgZWwucGxheSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBFbmRlZCBoYW5kbGVyXG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBlbmRlZEhhbmRsZXIoKSB7XG5cbiAgICAgICAgaWYgKGxvb3ApIHtcbiAgICAgICAgICAgIGVsLmN1cnJlbnRUaW1lID0gMDtcbiAgICAgICAgICAgIC8vIGZpeGVzIGJ1ZyB3aGVyZSBzZXJ2ZXIgZG9lc24ndCBzdXBwb3J0IHNlZWs6XG4gICAgICAgICAgICBpZiAoZWwuY3VycmVudFRpbWUgPiAwKSB7XG4gICAgICAgICAgICAgICAgZWwubG9hZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWwucGxheSgpO1xuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBlbmRlZCA9IHRydWU7XG4gICAgICAgIHBhdXNlZCA9IGZhbHNlO1xuICAgICAgICBwbGF5aW5nID0gZmFsc2U7XG5cbiAgICAgICAgaWYgKHR5cGVvZiBlbmRlZENhbGxiYWNrID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBlbmRlZENhbGxiYWNrKGFwaSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwbGF5KGRlbGF5LCBvZmZzZXQpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KGRlbGF5VGltZW91dCk7XG5cbiAgICAgICAgZWwudm9sdW1lID0gdm9sdW1lICogZ3JvdXBWb2x1bWU7XG4gICAgICAgIGVsLnBsYXliYWNrUmF0ZSA9IHBsYXliYWNrUmF0ZTtcblxuICAgICAgICBpZiAob2Zmc2V0KSB7XG4gICAgICAgICAgICBlbC5jdXJyZW50VGltZSA9IG9mZnNldDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkZWxheSkge1xuICAgICAgICAgICAgZGVsYXlUaW1lb3V0ID0gc2V0VGltZW91dChwbGF5LCBkZWxheSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBlbC5sb2FkKCk7XG4gICAgICAgICAgICBlbC5wbGF5KCk7XG4gICAgICAgIH1cblxuICAgICAgICBlbmRlZCA9IGZhbHNlO1xuICAgICAgICBwYXVzZWQgPSBmYWxzZTtcbiAgICAgICAgcGxheWluZyA9IHRydWU7XG5cbiAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignZW5kZWQnLCBlbmRlZEhhbmRsZXIpO1xuICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdlbmRlZCcsIGVuZGVkSGFuZGxlciwgZmFsc2UpO1xuXG4gICAgICAgIGlmIChlbC5yZWFkeVN0YXRlIDwgMSkge1xuICAgICAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2FucGxheXRocm91Z2gnLCByZWFkeUhhbmRsZXIpO1xuICAgICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2FucGxheXRocm91Z2gnLCByZWFkeUhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgICAgIGVsLmxvYWQoKTtcbiAgICAgICAgICAgIGVsLnBsYXkoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgICAgICBjbGVhclRpbWVvdXQoZGVsYXlUaW1lb3V0KTtcblxuICAgICAgICBpZiAoIWVsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBlbC5wYXVzZSgpO1xuICAgICAgICBwbGF5aW5nID0gZmFsc2U7XG4gICAgICAgIHBhdXNlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KGRlbGF5VGltZW91dCk7XG5cbiAgICAgICAgaWYgKCFlbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZWwucGF1c2UoKTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgZWwuY3VycmVudFRpbWUgPSAwO1xuICAgICAgICAgICAgLy8gZml4ZXMgYnVnIHdoZXJlIHNlcnZlciBkb2Vzbid0IHN1cHBvcnQgc2VlazpcbiAgICAgICAgICAgIGlmIChlbC5jdXJyZW50VGltZSA+IDApIHtcbiAgICAgICAgICAgICAgICBlbC5sb2FkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGUpIHt9XG5cbiAgICAgICAgcGxheWluZyA9IGZhbHNlO1xuICAgICAgICBwYXVzZWQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIEZhZGUgZm9yIG5vIHdlYmF1ZGlvXG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBmYWRlKHRvVm9sdW1lLCBkdXJhdGlvbikge1xuICAgICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIGFwaTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJhbXAodmFsdWUsIHN0ZXApIHtcbiAgICAgICAgICAgIGZhZGVUaW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGFwaS52b2x1bWUgPSBhcGkudm9sdW1lICsgKHZhbHVlIC0gYXBpLnZvbHVtZSkgKiAwLjI7XG4gICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKGFwaS52b2x1bWUgLSB2YWx1ZSkgPiAwLjA1KSB7XG4gICAgICAgICAgICAgICAgICAgIHJhbXAodmFsdWUsIHN0ZXApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFwaS52b2x1bWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIH0sIHN0ZXAgKiAxMDAwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQoZmFkZVRpbWVvdXQpO1xuICAgICAgICByYW1wKHRvVm9sdW1lLCBkdXJhdGlvbiAvIDEwKTtcblxuICAgICAgICByZXR1cm4gYXBpO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogRGVzdHJveVxuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignZW5kZWQnLCBlbmRlZEhhbmRsZXIpO1xuICAgICAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKCdjYW5wbGF5dGhyb3VnaCcsIHJlYWR5SGFuZGxlcik7XG4gICAgICAgIHN0b3AoKTtcbiAgICAgICAgZWwgPSBudWxsO1xuICAgICAgICBjb250ZXh0ID0gbnVsbDtcbiAgICAgICAgZW5kZWRDYWxsYmFjayA9IG51bGw7XG4gICAgICAgIHNvdXJjZU5vZGUgPSBudWxsO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogR2V0dGVycyAmIFNldHRlcnNcbiAgICAgKi9cblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGFwaSwge1xuICAgICAgICBwbGF5OiB7XG4gICAgICAgICAgICB2YWx1ZTogcGxheVxuICAgICAgICB9LFxuICAgICAgICBwYXVzZToge1xuICAgICAgICAgICAgdmFsdWU6IHBhdXNlXG4gICAgICAgIH0sXG4gICAgICAgIHN0b3A6IHtcbiAgICAgICAgICAgIHZhbHVlOiBzdG9wXG4gICAgICAgIH0sXG4gICAgICAgIGxvYWQ6IHtcbiAgICAgICAgICAgIHZhbHVlOiBsb2FkXG4gICAgICAgIH0sXG4gICAgICAgIGZhZGU6IHtcbiAgICAgICAgICAgIHZhbHVlOiBmYWRlXG4gICAgICAgIH0sXG4gICAgICAgIGRlc3Ryb3k6IHtcbiAgICAgICAgICAgIHZhbHVlOiBkZXN0cm95XG4gICAgICAgIH0sXG4gICAgICAgIGN1cnJlbnRUaW1lOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZWwgPyBlbC5jdXJyZW50VGltZSA6IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGR1cmF0aW9uOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZWwgPyBlbC5kdXJhdGlvbiA6IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVuZGVkOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZW5kZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGxvb3A6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBsb29wO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgbG9vcCA9ICEhdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHBhdXNlZDoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhdXNlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcGxheWJhY2tSYXRlOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGxheWJhY2tSYXRlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcGxheWJhY2tSYXRlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKGVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGVsLnBsYXliYWNrUmF0ZSA9IHBsYXliYWNrUmF0ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHBsYXlpbmc6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwbGF5aW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBwcm9ncmVzczoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVsICYmIGVsLmR1cmF0aW9uID8gZWwuY3VycmVudFRpbWUgLyBlbC5kdXJhdGlvbiA6IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHNvdXJjZU5vZGU6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjcmVhdGVTb3VyY2VOb2RlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHZvbHVtZToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZvbHVtZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQoZmFkZVRpbWVvdXQpO1xuICAgICAgICAgICAgICAgIHZvbHVtZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGlmIChlbCkge1xuICAgICAgICAgICAgICAgICAgICBlbC52b2x1bWUgPSB2b2x1bWUgKiBncm91cFZvbHVtZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGdyb3VwVm9sdW1lOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZ3JvdXBWb2x1bWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBncm91cFZvbHVtZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGlmIChlbCkge1xuICAgICAgICAgICAgICAgICAgICBlbC52b2x1bWUgPSB2b2x1bWUgKiBncm91cFZvbHVtZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBPYmplY3QuZnJlZXplKGFwaSk7XG59XG5cbmZ1bmN0aW9uIE1pY3JvcGhvbmVTb3VyY2Uoc3RyZWFtLCBjb250ZXh0KSB7XG4gICAgdmFyIGVuZGVkID0gZmFsc2UsXG4gICAgICAgIHBhdXNlZCA9IGZhbHNlLFxuICAgICAgICBwYXVzZWRBdCA9IDAsXG4gICAgICAgIHBsYXlpbmcgPSBmYWxzZSxcbiAgICAgICAgc291cmNlTm9kZSA9IG51bGwsXG4gICAgICAgIC8vIE1pY3JvcGhvbmVTb3VyY2VOb2RlXG4gICAgc3RhcnRlZEF0ID0gMDtcblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVNvdXJjZU5vZGUoKSB7XG4gICAgICAgIGlmICghc291cmNlTm9kZSAmJiBjb250ZXh0KSB7XG4gICAgICAgICAgICBzb3VyY2VOb2RlID0gY29udGV4dC5jcmVhdGVNZWRpYVN0cmVhbVNvdXJjZShzdHJlYW0pO1xuICAgICAgICAgICAgLy8gSEFDSzogc3RvcHMgbW96IGdhcmJhZ2UgY29sbGVjdGlvbiBraWxsaW5nIHRoZSBzdHJlYW1cbiAgICAgICAgICAgIC8vIHNlZSBodHRwczovL3N1cHBvcnQubW96aWxsYS5vcmcvZW4tVVMvcXVlc3Rpb25zLzk4NDE3OVxuICAgICAgICAgICAgaWYgKG5hdmlnYXRvci5tb3pHZXRVc2VyTWVkaWEpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cubW96SGFjayA9IHNvdXJjZU5vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNvdXJjZU5vZGU7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBDb250cm9sc1xuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gcGxheShkZWxheSkge1xuICAgICAgICBkZWxheSA9IGRlbGF5ID8gY29udGV4dC5jdXJyZW50VGltZSArIGRlbGF5IDogMDtcblxuICAgICAgICBjcmVhdGVTb3VyY2VOb2RlKCk7XG4gICAgICAgIHNvdXJjZU5vZGUuc3RhcnQoZGVsYXkpO1xuXG4gICAgICAgIHN0YXJ0ZWRBdCA9IGNvbnRleHQuY3VycmVudFRpbWUgLSBwYXVzZWRBdDtcbiAgICAgICAgZW5kZWQgPSBmYWxzZTtcbiAgICAgICAgcGxheWluZyA9IHRydWU7XG4gICAgICAgIHBhdXNlZCA9IGZhbHNlO1xuICAgICAgICBwYXVzZWRBdCA9IDA7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICAgICAgaWYgKHNvdXJjZU5vZGUpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgc291cmNlTm9kZS5zdG9wKDApO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge31cbiAgICAgICAgICAgIHNvdXJjZU5vZGUgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGVuZGVkID0gdHJ1ZTtcbiAgICAgICAgcGF1c2VkID0gZmFsc2U7XG4gICAgICAgIHBhdXNlZEF0ID0gMDtcbiAgICAgICAgcGxheWluZyA9IGZhbHNlO1xuICAgICAgICBzdGFydGVkQXQgPSAwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgICAgICB2YXIgZWxhcHNlZCA9IGNvbnRleHQuY3VycmVudFRpbWUgLSBzdGFydGVkQXQ7XG4gICAgICAgIHN0b3AoKTtcbiAgICAgICAgcGF1c2VkQXQgPSBlbGFwc2VkO1xuICAgICAgICBwbGF5aW5nID0gZmFsc2U7XG4gICAgICAgIHBhdXNlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBEZXN0cm95XG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICBzdG9wKCk7XG4gICAgICAgIGNvbnRleHQgPSBudWxsO1xuICAgICAgICBzb3VyY2VOb2RlID0gbnVsbDtcbiAgICAgICAgc3RyZWFtID0gbnVsbDtcbiAgICAgICAgd2luZG93Lm1vekhhY2sgPSBudWxsO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogQXBpXG4gICAgICovXG5cbiAgICB2YXIgYXBpID0ge1xuICAgICAgICBwbGF5OiBwbGF5LFxuICAgICAgICBwYXVzZTogcGF1c2UsXG4gICAgICAgIHN0b3A6IHN0b3AsXG4gICAgICAgIGRlc3Ryb3k6IGRlc3Ryb3ksXG5cbiAgICAgICAgZHVyYXRpb246IDAsXG4gICAgICAgIHByb2dyZXNzOiAwXG4gICAgfTtcblxuICAgIC8qXG4gICAgICogR2V0dGVycyAmIFNldHRlcnNcbiAgICAgKi9cblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGFwaSwge1xuICAgICAgICBjdXJyZW50VGltZToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhdXNlZEF0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXVzZWRBdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHN0YXJ0ZWRBdCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5jdXJyZW50VGltZSAtIHN0YXJ0ZWRBdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVuZGVkOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZW5kZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHBhdXNlZDoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhdXNlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcGxheWluZzoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBsYXlpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHNvdXJjZU5vZGU6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjcmVhdGVTb3VyY2VOb2RlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBPYmplY3QuZnJlZXplKGFwaSk7XG59XG5cbmZ1bmN0aW9uIE9zY2lsbGF0b3JTb3VyY2UodHlwZSwgY29udGV4dCkge1xuICAgIHZhciBlbmRlZCA9IGZhbHNlLFxuICAgICAgICBwYXVzZWQgPSBmYWxzZSxcbiAgICAgICAgcGF1c2VkQXQgPSAwLFxuICAgICAgICBwbGF5aW5nID0gZmFsc2UsXG4gICAgICAgIHNvdXJjZU5vZGUgPSBudWxsLFxuICAgICAgICAvLyBPc2NpbGxhdG9yU291cmNlTm9kZVxuICAgIHN0YXJ0ZWRBdCA9IDAsXG4gICAgICAgIGZyZXF1ZW5jeSA9IDIwMCxcbiAgICAgICAgYXBpID0gbnVsbDtcblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVNvdXJjZU5vZGUoKSB7XG4gICAgICAgIGlmICghc291cmNlTm9kZSAmJiBjb250ZXh0KSB7XG4gICAgICAgICAgICBzb3VyY2VOb2RlID0gY29udGV4dC5jcmVhdGVPc2NpbGxhdG9yKCk7XG4gICAgICAgICAgICBzb3VyY2VOb2RlLnR5cGUgPSB0eXBlO1xuICAgICAgICAgICAgc291cmNlTm9kZS5mcmVxdWVuY3kudmFsdWUgPSBmcmVxdWVuY3k7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNvdXJjZU5vZGU7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBDb250cm9sc1xuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gcGxheShkZWxheSkge1xuICAgICAgICBkZWxheSA9IGRlbGF5IHx8IDA7XG4gICAgICAgIGlmIChkZWxheSkge1xuICAgICAgICAgICAgZGVsYXkgPSBjb250ZXh0LmN1cnJlbnRUaW1lICsgZGVsYXk7XG4gICAgICAgIH1cblxuICAgICAgICBjcmVhdGVTb3VyY2VOb2RlKCk7XG4gICAgICAgIHNvdXJjZU5vZGUuc3RhcnQoZGVsYXkpO1xuXG4gICAgICAgIGlmIChwYXVzZWRBdCkge1xuICAgICAgICAgICAgc3RhcnRlZEF0ID0gY29udGV4dC5jdXJyZW50VGltZSAtIHBhdXNlZEF0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3RhcnRlZEF0ID0gY29udGV4dC5jdXJyZW50VGltZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGVuZGVkID0gZmFsc2U7XG4gICAgICAgIHBsYXlpbmcgPSB0cnVlO1xuICAgICAgICBwYXVzZWQgPSBmYWxzZTtcbiAgICAgICAgcGF1c2VkQXQgPSAwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgICAgIGlmIChzb3VyY2VOb2RlKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHNvdXJjZU5vZGUuc3RvcCgwKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgICAgICAgICBzb3VyY2VOb2RlID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBlbmRlZCA9IHRydWU7XG4gICAgICAgIHBhdXNlZCA9IGZhbHNlO1xuICAgICAgICBwYXVzZWRBdCA9IDA7XG4gICAgICAgIHBsYXlpbmcgPSBmYWxzZTtcbiAgICAgICAgc3RhcnRlZEF0ID0gMDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICAgICAgdmFyIGVsYXBzZWQgPSBjb250ZXh0LmN1cnJlbnRUaW1lIC0gc3RhcnRlZEF0O1xuICAgICAgICBzdG9wKCk7XG4gICAgICAgIHBhdXNlZEF0ID0gZWxhcHNlZDtcbiAgICAgICAgcGxheWluZyA9IGZhbHNlO1xuICAgICAgICBwYXVzZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogRGVzdHJveVxuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgc3RvcCgpO1xuICAgICAgICBjb250ZXh0ID0gbnVsbDtcbiAgICAgICAgc291cmNlTm9kZSA9IG51bGw7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBBcGlcbiAgICAgKi9cblxuICAgIGFwaSA9IHtcbiAgICAgICAgcGxheTogcGxheSxcbiAgICAgICAgcGF1c2U6IHBhdXNlLFxuICAgICAgICBzdG9wOiBzdG9wLFxuICAgICAgICBkZXN0cm95OiBkZXN0cm95XG4gICAgfTtcblxuICAgIC8qXG4gICAgICogR2V0dGVycyAmIFNldHRlcnNcbiAgICAgKi9cblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGFwaSwge1xuICAgICAgICBjdXJyZW50VGltZToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhdXNlZEF0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXVzZWRBdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHN0YXJ0ZWRBdCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5jdXJyZW50VGltZSAtIHN0YXJ0ZWRBdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGR1cmF0aW9uOiB7XG4gICAgICAgICAgICB2YWx1ZTogMFxuICAgICAgICB9LFxuICAgICAgICBlbmRlZDoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVuZGVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBmcmVxdWVuY3k6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmcmVxdWVuY3k7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBmcmVxdWVuY3kgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBpZiAoc291cmNlTm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2VOb2RlLmZyZXF1ZW5jeS52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcGF1c2VkOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGF1c2VkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBwbGF5aW5nOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGxheWluZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcHJvZ3Jlc3M6IHtcbiAgICAgICAgICAgIHZhbHVlOiAwXG4gICAgICAgIH0sXG4gICAgICAgIHNvdXJjZU5vZGU6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjcmVhdGVTb3VyY2VOb2RlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBPYmplY3QuZnJlZXplKGFwaSk7XG59XG5cbmZ1bmN0aW9uIFNjcmlwdFNvdXJjZShkYXRhLCBjb250ZXh0KSB7XG4gICAgdmFyIGJ1ZmZlclNpemUgPSBkYXRhLmJ1ZmZlclNpemUgfHwgMTAyNDtcbiAgICB2YXIgY2hhbm5lbHMgPSBkYXRhLmNoYW5uZWxzIHx8IDE7XG4gICAgdmFyIGVuZGVkID0gZmFsc2UsXG4gICAgICAgIG9uUHJvY2VzcyA9IGRhdGEuY2FsbGJhY2suYmluZChkYXRhLnRoaXNBcmcgfHwgdGhpcyksXG4gICAgICAgIHBhdXNlZCA9IGZhbHNlLFxuICAgICAgICBwYXVzZWRBdCA9IDAsXG4gICAgICAgIHBsYXlpbmcgPSBmYWxzZSxcbiAgICAgICAgc291cmNlTm9kZSA9IG51bGwsXG4gICAgICAgIC8vIFNjcmlwdFNvdXJjZU5vZGVcbiAgICBzdGFydGVkQXQgPSAwLFxuICAgICAgICBhcGkgPSBudWxsO1xuXG4gICAgZnVuY3Rpb24gY3JlYXRlU291cmNlTm9kZSgpIHtcbiAgICAgICAgaWYgKCFzb3VyY2VOb2RlICYmIGNvbnRleHQpIHtcbiAgICAgICAgICAgIHNvdXJjZU5vZGUgPSBjb250ZXh0LmNyZWF0ZVNjcmlwdFByb2Nlc3NvcihidWZmZXJTaXplLCAwLCBjaGFubmVscyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNvdXJjZU5vZGU7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBDb250cm9sc1xuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gcGxheSgpIHtcbiAgICAgICAgY3JlYXRlU291cmNlTm9kZSgpO1xuICAgICAgICBzb3VyY2VOb2RlLm9uYXVkaW9wcm9jZXNzID0gb25Qcm9jZXNzO1xuXG4gICAgICAgIHN0YXJ0ZWRBdCA9IGNvbnRleHQuY3VycmVudFRpbWUgLSBwYXVzZWRBdDtcbiAgICAgICAgZW5kZWQgPSBmYWxzZTtcbiAgICAgICAgcGF1c2VkID0gZmFsc2U7XG4gICAgICAgIHBhdXNlZEF0ID0gMDtcbiAgICAgICAgcGxheWluZyA9IHRydWU7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25QYXVzZWQoZXZlbnQpIHtcbiAgICAgICAgdmFyIGJ1ZmZlciA9IGV2ZW50Lm91dHB1dEJ1ZmZlcjtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBidWZmZXIubnVtYmVyT2ZDaGFubmVsczsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgY2hhbm5lbCA9IGJ1ZmZlci5nZXRDaGFubmVsRGF0YShpKTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgY2hhbm5lbC5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGNoYW5uZWxbal0gPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICAgICAgaWYgKHNvdXJjZU5vZGUpIHtcbiAgICAgICAgICAgIHNvdXJjZU5vZGUub25hdWRpb3Byb2Nlc3MgPSBvblBhdXNlZDtcbiAgICAgICAgfVxuICAgICAgICBlbmRlZCA9IHRydWU7XG4gICAgICAgIHBhdXNlZCA9IGZhbHNlO1xuICAgICAgICBwYXVzZWRBdCA9IDA7XG4gICAgICAgIHBsYXlpbmcgPSBmYWxzZTtcbiAgICAgICAgc3RhcnRlZEF0ID0gMDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICAgICAgdmFyIGVsYXBzZWQgPSBjb250ZXh0LmN1cnJlbnRUaW1lIC0gc3RhcnRlZEF0O1xuICAgICAgICBzdG9wKCk7XG4gICAgICAgIHBhdXNlZEF0ID0gZWxhcHNlZDtcbiAgICAgICAgcGxheWluZyA9IGZhbHNlO1xuICAgICAgICBwYXVzZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogRGVzdHJveVxuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgc3RvcCgpO1xuICAgICAgICBjb250ZXh0ID0gbnVsbDtcbiAgICAgICAgb25Qcm9jZXNzID0gbnVsbDtcbiAgICAgICAgc291cmNlTm9kZSA9IG51bGw7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBBcGlcbiAgICAgKi9cblxuICAgIGFwaSA9IHtcbiAgICAgICAgcGxheTogcGxheSxcbiAgICAgICAgcGF1c2U6IHBhdXNlLFxuICAgICAgICBzdG9wOiBzdG9wLFxuICAgICAgICBkZXN0cm95OiBkZXN0cm95LFxuXG4gICAgICAgIGR1cmF0aW9uOiAwLFxuICAgICAgICBwcm9ncmVzczogMFxuICAgIH07XG5cbiAgICAvKlxuICAgICAqIEdldHRlcnMgJiBTZXR0ZXJzXG4gICAgICovXG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhhcGksIHtcbiAgICAgICAgY3VycmVudFRpbWU6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIGlmIChwYXVzZWRBdCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGF1c2VkQXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChzdGFydGVkQXQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuY3VycmVudFRpbWUgLSBzdGFydGVkQXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbmRlZDoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVuZGVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBwYXVzZWQ6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwYXVzZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHBsYXlpbmc6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwbGF5aW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBzb3VyY2VOb2RlOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY3JlYXRlU291cmNlTm9kZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gT2JqZWN0LmZyZWV6ZShhcGkpO1xufVxuXG5mdW5jdGlvbiB3YXZlZm9ybSgpIHtcbiAgICB2YXIgYnVmZmVyID0gdm9pZCAwLFxuICAgICAgICB3YXZlID0gdm9pZCAwO1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhdWRpb0J1ZmZlciwgbGVuZ3RoKSB7XG4gICAgICAgIGlmICghd2luZG93LkZsb2F0MzJBcnJheSB8fCAhd2luZG93LkF1ZGlvQnVmZmVyKSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc2FtZUJ1ZmZlciA9IGJ1ZmZlciA9PT0gYXVkaW9CdWZmZXI7XG4gICAgICAgIHZhciBzYW1lTGVuZ3RoID0gd2F2ZSAmJiB3YXZlLmxlbmd0aCA9PT0gbGVuZ3RoO1xuICAgICAgICBpZiAoc2FtZUJ1ZmZlciAmJiBzYW1lTGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gd2F2ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vY29uc29sZS50aW1lKCd3YXZlRGF0YScpO1xuICAgICAgICBpZiAoIXdhdmUgfHwgd2F2ZS5sZW5ndGggIT09IGxlbmd0aCkge1xuICAgICAgICAgICAgd2F2ZSA9IG5ldyBGbG9hdDMyQXJyYXkobGVuZ3RoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghYXVkaW9CdWZmZXIpIHtcbiAgICAgICAgICAgIHJldHVybiB3YXZlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY2FjaGUgZm9yIHJlcGVhdGVkIGNhbGxzXG4gICAgICAgIGJ1ZmZlciA9IGF1ZGlvQnVmZmVyO1xuXG4gICAgICAgIHZhciBjaHVuayA9IE1hdGguZmxvb3IoYnVmZmVyLmxlbmd0aCAvIGxlbmd0aCksXG4gICAgICAgICAgICByZXNvbHV0aW9uID0gNSxcbiAgICAgICAgICAgIC8vIDEwXG4gICAgICAgIGluY3IgPSBNYXRoLm1heChNYXRoLmZsb29yKGNodW5rIC8gcmVzb2x1dGlvbiksIDEpO1xuICAgICAgICB2YXIgZ3JlYXRlc3QgPSAwO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYnVmZmVyLm51bWJlck9mQ2hhbm5lbHM7IGkrKykge1xuICAgICAgICAgICAgLy8gY2hlY2sgZWFjaCBjaGFubmVsXG4gICAgICAgICAgICB2YXIgY2hhbm5lbCA9IGJ1ZmZlci5nZXRDaGFubmVsRGF0YShpKTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAvLyBnZXQgaGlnaGVzdCB2YWx1ZSB3aXRoaW4gdGhlIGNodW5rXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IGogKiBjaHVuaywgbCA9IGsgKyBjaHVuazsgayA8IGw7IGsgKz0gaW5jcikge1xuICAgICAgICAgICAgICAgICAgICAvLyBzZWxlY3QgaGlnaGVzdCB2YWx1ZSBmcm9tIGNoYW5uZWxzXG4gICAgICAgICAgICAgICAgICAgIHZhciBhID0gY2hhbm5lbFtrXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGEgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhID0gLWE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGEgPiB3YXZlW2pdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3YXZlW2pdID0gYTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyB1cGRhdGUgaGlnaGVzdCBvdmVyYWxsIGZvciBzY2FsaW5nXG4gICAgICAgICAgICAgICAgICAgIGlmIChhID4gZ3JlYXRlc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyZWF0ZXN0ID0gYTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBzY2FsZSB1cFxuICAgICAgICB2YXIgc2NhbGUgPSAxIC8gZ3JlYXRlc3Q7XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCB3YXZlLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgd2F2ZVtfaV0gKj0gc2NhbGU7XG4gICAgICAgIH1cbiAgICAgICAgLy9jb25zb2xlLnRpbWVFbmQoJ3dhdmVEYXRhJyk7XG5cbiAgICAgICAgcmV0dXJuIHdhdmU7XG4gICAgfTtcbn1cblxuZnVuY3Rpb24gU291bmQoY29uZmlnKSB7XG4gICAgdmFyIGNvbnRleHQgPSBjb25maWcuY29udGV4dDtcbiAgICB2YXIgZGVzdGluYXRpb24gPSBjb25maWcuZGVzdGluYXRpb247XG4gICAgdmFyIGVmZmVjdCA9IG5ldyBFZmZlY3QoY29udGV4dCk7XG4gICAgdmFyIGdhaW4gPSBlZmZlY3QuZ2FpbigpO1xuICAgIHZhciB3YXZlID0gd2F2ZWZvcm0oKTtcblxuICAgIHZhciBpZCA9IG51bGw7XG4gICAgdmFyIGRhdGEgPSBudWxsO1xuICAgIHZhciBpc1RvdWNoTG9ja2VkID0gZmFsc2U7XG4gICAgdmFyIGxvYWRlciA9IG51bGw7XG4gICAgdmFyIGxvb3AgPSBmYWxzZTtcbiAgICB2YXIgcGxheWJhY2tSYXRlID0gMTtcbiAgICB2YXIgcGxheVdoZW5SZWFkeSA9IG51bGw7XG4gICAgdmFyIHNvdXJjZSA9IG51bGw7XG4gICAgdmFyIHNvdW5kID0gbnVsbDtcblxuICAgIGlmIChjb250ZXh0KSB7XG4gICAgICAgIGVmZmVjdC5zZXREZXN0aW5hdGlvbihnYWluKTtcbiAgICAgICAgZ2Fpbi5jb25uZWN0KGRlc3RpbmF0aW9uIHx8IGNvbnRleHQuZGVzdGluYXRpb24pO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogQ3JlYXRlIHNvdXJjZVxuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gY3JlYXRlU291cmNlKHZhbHVlKSB7XG4gICAgICAgIGRhdGEgPSB2YWx1ZTtcblxuICAgICAgICBpZiAoZmlsZS5pc0F1ZGlvQnVmZmVyKGRhdGEpKSB7XG4gICAgICAgICAgICBzb3VyY2UgPSBuZXcgQnVmZmVyU291cmNlKGRhdGEsIGNvbnRleHQsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc291bmQuZW1pdCgnZW5kZWQnLCBzb3VuZCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChmaWxlLmlzTWVkaWFFbGVtZW50KGRhdGEpKSB7XG4gICAgICAgICAgICBzb3VyY2UgPSBuZXcgTWVkaWFTb3VyY2UoZGF0YSwgY29udGV4dCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzb3VuZC5lbWl0KCdlbmRlZCcsIHNvdW5kKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKGZpbGUuaXNNZWRpYVN0cmVhbShkYXRhKSkge1xuICAgICAgICAgICAgc291cmNlID0gbmV3IE1pY3JvcGhvbmVTb3VyY2UoZGF0YSwgY29udGV4dCk7XG4gICAgICAgIH0gZWxzZSBpZiAoZmlsZS5pc09zY2lsbGF0b3JUeXBlKGRhdGEgJiYgZGF0YS50eXBlIHx8IGRhdGEpKSB7XG4gICAgICAgICAgICBzb3VyY2UgPSBuZXcgT3NjaWxsYXRvclNvdXJjZShkYXRhLnR5cGUgfHwgZGF0YSwgY29udGV4dCk7XG4gICAgICAgIH0gZWxzZSBpZiAoZmlsZS5pc1NjcmlwdENvbmZpZyhkYXRhKSkge1xuICAgICAgICAgICAgc291cmNlID0gbmV3IFNjcmlwdFNvdXJjZShkYXRhLCBjb250ZXh0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGRldGVjdCBkYXRhIHR5cGU6ICcgKyBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGVmZmVjdC5zZXRTb3VyY2Uoc291cmNlLnNvdXJjZU5vZGUpO1xuXG4gICAgICAgIHNvdW5kLmVtaXQoJ3JlYWR5Jywgc291bmQpO1xuXG4gICAgICAgIGlmIChwbGF5V2hlblJlYWR5KSB7XG4gICAgICAgICAgICBwbGF5V2hlblJlYWR5KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKlxuICAgICAqIExvYWRcbiAgICAgKi9cblxuICAgIGZ1bmN0aW9uIG9uTG9hZChmaWxlRGF0YSkge1xuICAgICAgICBjcmVhdGVTb3VyY2UoZmlsZURhdGEpO1xuICAgICAgICBzb3VuZC5lbWl0KCdsb2FkZWQnLCBzb3VuZCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25Mb2FkRXJyb3IoZXJyKSB7XG4gICAgICAgIHNvdW5kLmVtaXQoJ2Vycm9yJywgc291bmQsIGVycik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG9hZCgpIHtcbiAgICAgICAgdmFyIG5ld0NvbmZpZyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMCB8fCBhcmd1bWVudHNbMF0gPT09IHVuZGVmaW5lZCA/IG51bGwgOiBhcmd1bWVudHNbMF07XG4gICAgICAgIHZhciBmb3JjZSA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogYXJndW1lbnRzWzFdO1xuXG4gICAgICAgIHZhciBza2lwTG9hZCA9ICFmb3JjZSAmJiAhc291cmNlICYmICEhY29uZmlnLmRlZmVyTG9hZDtcblxuICAgICAgICBpZiAobmV3Q29uZmlnKSB7XG4gICAgICAgICAgICB2YXIgc3JjID0gZmlsZS5nZXRTdXBwb3J0ZWRGaWxlKGNvbmZpZy5zcmMgfHwgY29uZmlnLnVybCB8fCBjb25maWcuZGF0YSB8fCBjb25maWcpIHx8IGNvbmZpZy5zcmM7XG4gICAgICAgICAgICBjb25maWcgPSBPYmplY3QuYXNzaWduKGNvbmZpZywgbmV3Q29uZmlnLCB7IHNyYzogc3JjIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHNvdXJjZSAmJiBkYXRhICYmIGRhdGEudGFnTmFtZSkge1xuICAgICAgICAgICAgc291cmNlLmxvYWQoY29uZmlnLnNyYyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsb2FkZXIgPSBsb2FkZXIgfHwgbmV3IExvYWRlcihjb25maWcuc3JjLCBza2lwTG9hZCk7XG4gICAgICAgICAgICBsb2FkZXIuYXVkaW9Db250ZXh0ID0gISFjb25maWcuYXNNZWRpYUVsZW1lbnQgPyBudWxsIDogY29udGV4dDtcbiAgICAgICAgICAgIGxvYWRlci5pc1RvdWNoTG9ja2VkID0gaXNUb3VjaExvY2tlZDtcbiAgICAgICAgICAgIGxvYWRlci5vZmYoJ2xvYWRlZCcsIG9uTG9hZCk7XG4gICAgICAgICAgICBsb2FkZXIub25jZSgnbG9hZGVkJywgb25Mb2FkKTtcbiAgICAgICAgICAgIGxvYWRlci5vZmYoJ2Vycm9yJywgb25Mb2FkRXJyb3IpO1xuICAgICAgICAgICAgbG9hZGVyLm9uKCdlcnJvcicsIG9uTG9hZEVycm9yKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc291bmQ7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBDb250cm9sc1xuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gcGxheShkZWxheSwgb2Zmc2V0KSB7XG4gICAgICAgIGlmICghc291cmNlIHx8IGlzVG91Y2hMb2NrZWQpIHtcbiAgICAgICAgICAgIHBsYXlXaGVuUmVhZHkgPSBmdW5jdGlvbiBwbGF5V2hlblJlYWR5KCkge1xuICAgICAgICAgICAgICAgIGlmIChzb3VyY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgcGxheShkZWxheSwgb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKCEhY29uZmlnLmRlZmVyTG9hZCkge1xuICAgICAgICAgICAgICAgIGlmICghbG9hZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvYWQobnVsbCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxvYWRlci5zdGFydCh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzb3VuZDtcbiAgICAgICAgfVxuICAgICAgICBwbGF5V2hlblJlYWR5ID0gbnVsbDtcbiAgICAgICAgZWZmZWN0LnNldFNvdXJjZShzb3VyY2Uuc291cmNlTm9kZSk7XG5cbiAgICAgICAgLy8gdXBkYXRlIHZvbHVtZSBuZWVkZWQgZm9yIG5vIHdlYmF1ZGlvXG4gICAgICAgIGlmICghY29udGV4dCkge1xuICAgICAgICAgICAgc291bmQudm9sdW1lID0gZ2Fpbi5nYWluLnZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgc291cmNlLnBsYXkoZGVsYXksIG9mZnNldCk7XG5cbiAgICAgICAgaWYgKHNvdXJjZS5oYXNPd25Qcm9wZXJ0eSgnbG9vcCcpKSB7XG4gICAgICAgICAgICBzb3VyY2UubG9vcCA9IGxvb3A7XG4gICAgICAgIH1cblxuICAgICAgICBzb3VuZC5lbWl0KCdwbGF5Jywgc291bmQpO1xuXG4gICAgICAgIHJldHVybiBzb3VuZDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICAgICAgc291cmNlICYmIHNvdXJjZS5wYXVzZSgpO1xuICAgICAgICBzb3VuZC5lbWl0KCdwYXVzZScsIHNvdW5kKTtcbiAgICAgICAgcmV0dXJuIHNvdW5kO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN0b3AoZGVsYXkpIHtcbiAgICAgICAgc291cmNlICYmIHNvdXJjZS5zdG9wKGRlbGF5IHx8IDApO1xuICAgICAgICBzb3VuZC5lbWl0KCdzdG9wJywgc291bmQpO1xuICAgICAgICByZXR1cm4gc291bmQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2VlayhwZXJjZW50KSB7XG4gICAgICAgIGlmIChzb3VyY2UpIHtcbiAgICAgICAgICAgIHNvdXJjZS5zdG9wKCk7XG4gICAgICAgICAgICBwbGF5KDAsIHNvdXJjZS5kdXJhdGlvbiAqIHBlcmNlbnQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzb3VuZDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmYWRlKHZvbHVtZSwgZHVyYXRpb24pIHtcbiAgICAgICAgaWYgKCFzb3VyY2UpIHtcbiAgICAgICAgICAgIHJldHVybiBzb3VuZDtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBwYXJhbSA9IGdhaW4uZ2FpbjtcblxuICAgICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICAgICAgdmFyIHRpbWUgPSBjb250ZXh0LmN1cnJlbnRUaW1lO1xuICAgICAgICAgICAgcGFyYW0uY2FuY2VsU2NoZWR1bGVkVmFsdWVzKHRpbWUpO1xuICAgICAgICAgICAgcGFyYW0uc2V0VmFsdWVBdFRpbWUocGFyYW0udmFsdWUsIHRpbWUpO1xuICAgICAgICAgICAgcGFyYW0ubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUodm9sdW1lLCB0aW1lICsgZHVyYXRpb24pO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBzb3VyY2UuZmFkZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgc291cmNlLmZhZGUodm9sdW1lLCBkdXJhdGlvbik7XG4gICAgICAgICAgICBwYXJhbS52YWx1ZSA9IHZvbHVtZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNvdW5kLmVtaXQoJ2ZhZGUnLCBzb3VuZCwgdm9sdW1lKTtcblxuICAgICAgICByZXR1cm4gc291bmQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdW5sb2FkKCkge1xuICAgICAgICBzb3VyY2UgJiYgc291cmNlLmRlc3Ryb3koKTtcbiAgICAgICAgbG9hZGVyICYmIGxvYWRlci5kZXN0cm95KCk7XG4gICAgICAgIGRhdGEgPSBudWxsO1xuICAgICAgICBwbGF5V2hlblJlYWR5ID0gbnVsbDtcbiAgICAgICAgc291cmNlID0gbnVsbDtcbiAgICAgICAgbG9hZGVyID0gbnVsbDtcbiAgICAgICAgY29uZmlnLmRlZmVyTG9hZCA9IHRydWU7XG4gICAgICAgIHNvdW5kLmVtaXQoJ3VubG9hZCcsIHNvdW5kKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZWxvYWQoKSB7XG4gICAgICAgIGxvYWQobnVsbCwgdHJ1ZSk7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBEZXN0cm95XG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICBzb3VyY2UgJiYgc291cmNlLmRlc3Ryb3koKTtcbiAgICAgICAgZWZmZWN0ICYmIGVmZmVjdC5kZXN0cm95KCk7XG4gICAgICAgIGdhaW4gJiYgZ2Fpbi5kaXNjb25uZWN0KCk7XG4gICAgICAgIGxvYWRlciAmJiBsb2FkZXIub2ZmKCdsb2FkZWQnKTtcbiAgICAgICAgbG9hZGVyICYmIGxvYWRlci5vZmYoJ2Vycm9yJyk7XG4gICAgICAgIGxvYWRlciAmJiBsb2FkZXIuZGVzdHJveSgpO1xuICAgICAgICBzb3VuZC5vZmYoJ2xvYWRlZCcpO1xuICAgICAgICBzb3VuZC5vZmYoJ2VuZGVkJyk7XG4gICAgICAgIHNvdW5kLm9mZignZXJyb3InKTtcbiAgICAgICAgZ2FpbiA9IG51bGw7XG4gICAgICAgIGNvbnRleHQgPSBudWxsO1xuICAgICAgICBkZXN0aW5hdGlvbiA9IG51bGw7XG4gICAgICAgIGRhdGEgPSBudWxsO1xuICAgICAgICBwbGF5V2hlblJlYWR5ID0gbnVsbDtcbiAgICAgICAgc291cmNlID0gbnVsbDtcbiAgICAgICAgZWZmZWN0ID0gbnVsbDtcbiAgICAgICAgbG9hZGVyID0gbnVsbDtcbiAgICAgICAgd2F2ZSA9IG51bGw7XG4gICAgICAgIGNvbmZpZyA9IG51bGw7XG4gICAgICAgIHNvdW5kLmVtaXQoJ2Rlc3Ryb3knLCBzb3VuZCk7XG4gICAgICAgIHNvdW5kLm9mZignZGVzdHJveScpO1xuICAgIH1cblxuICAgIHNvdW5kID0gT2JqZWN0LmNyZWF0ZShFbWl0dGVyLnByb3RvdHlwZSwge1xuICAgICAgICBfZXZlbnRzOiB7XG4gICAgICAgICAgICB2YWx1ZToge31cbiAgICAgICAgfSxcbiAgICAgICAgY29uc3RydWN0b3I6IHtcbiAgICAgICAgICAgIHZhbHVlOiBTb3VuZFxuICAgICAgICB9LFxuICAgICAgICBwbGF5OiB7XG4gICAgICAgICAgICB2YWx1ZTogcGxheVxuICAgICAgICB9LFxuICAgICAgICBwYXVzZToge1xuICAgICAgICAgICAgdmFsdWU6IHBhdXNlXG4gICAgICAgIH0sXG4gICAgICAgIGxvYWQ6IHtcbiAgICAgICAgICAgIHZhbHVlOiBsb2FkXG4gICAgICAgIH0sXG4gICAgICAgIHNlZWs6IHtcbiAgICAgICAgICAgIHZhbHVlOiBzZWVrXG4gICAgICAgIH0sXG4gICAgICAgIHN0b3A6IHtcbiAgICAgICAgICAgIHZhbHVlOiBzdG9wXG4gICAgICAgIH0sXG4gICAgICAgIGZhZGU6IHtcbiAgICAgICAgICAgIHZhbHVlOiBmYWRlXG4gICAgICAgIH0sXG4gICAgICAgIHVubG9hZDoge1xuICAgICAgICAgICAgdmFsdWU6IHVubG9hZFxuICAgICAgICB9LFxuICAgICAgICByZWxvYWQ6IHtcbiAgICAgICAgICAgIHZhbHVlOiByZWxvYWRcbiAgICAgICAgfSxcbiAgICAgICAgZGVzdHJveToge1xuICAgICAgICAgICAgdmFsdWU6IGRlc3Ryb3lcbiAgICAgICAgfSxcbiAgICAgICAgY29udGV4dDoge1xuICAgICAgICAgICAgdmFsdWU6IGNvbnRleHRcbiAgICAgICAgfSxcbiAgICAgICAgY3VycmVudFRpbWU6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzb3VyY2UgPyBzb3VyY2UuY3VycmVudFRpbWUgOiAwO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgLy8gY29uc3Qgc2lsZW50ID0gc291bmQucGxheWluZztcbiAgICAgICAgICAgICAgICBzb3VyY2UgJiYgc291cmNlLnN0b3AoKTtcbiAgICAgICAgICAgICAgICAvLyBwbGF5KDAsIHZhbHVlLCBzaWxlbnQpO1xuICAgICAgICAgICAgICAgIHBsYXkoMCwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjcmVhdGVTb3VyY2UodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBkdXJhdGlvbjoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNvdXJjZSA/IHNvdXJjZS5kdXJhdGlvbiA6IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVmZmVjdDoge1xuICAgICAgICAgICAgdmFsdWU6IGVmZmVjdFxuICAgICAgICB9LFxuICAgICAgICBlbmRlZDoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICEhc291cmNlICYmIHNvdXJjZS5lbmRlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZnJlcXVlbmN5OiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc291cmNlID8gc291cmNlLmZyZXF1ZW5jeSA6IDA7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoc291cmNlICYmIHNvdXJjZS5oYXNPd25Qcm9wZXJ0eSgnZnJlcXVlbmN5JykpIHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlLmZyZXF1ZW5jeSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZ2Fpbjoge1xuICAgICAgICAgICAgdmFsdWU6IGdhaW5cbiAgICAgICAgfSxcbiAgICAgICAgaWQ6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpZDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlkID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGlzVG91Y2hMb2NrZWQ6IHtcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaXNUb3VjaExvY2tlZCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGlmIChsb2FkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9hZGVyLmlzVG91Y2hMb2NrZWQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCF2YWx1ZSAmJiBwbGF5V2hlblJlYWR5KSB7XG4gICAgICAgICAgICAgICAgICAgIHBsYXlXaGVuUmVhZHkoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGxvYWRlcjoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgbG9vcDoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvb3A7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBsb29wID0gISF2YWx1ZTtcblxuICAgICAgICAgICAgICAgIGlmIChzb3VyY2UgJiYgc291cmNlLmhhc093blByb3BlcnR5KCdsb29wJykgJiYgc291cmNlLmxvb3AgIT09IGxvb3ApIHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlLmxvb3AgPSBsb29wO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBwYXVzZWQ6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAhIXNvdXJjZSAmJiBzb3VyY2UucGF1c2VkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBwbGF5aW5nOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gISFzb3VyY2UgJiYgc291cmNlLnBsYXlpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHBsYXliYWNrUmF0ZToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBsYXliYWNrUmF0ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHBsYXliYWNrUmF0ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGlmIChzb3VyY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlLnBsYXliYWNrUmF0ZSA9IHBsYXliYWNrUmF0ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHByb2dyZXNzOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc291cmNlID8gc291cmNlLnByb2dyZXNzIDogMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgc291cmNlTm9kZToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNvdXJjZSA/IHNvdXJjZS5zb3VyY2VOb2RlIDogbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgdm9sdW1lOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2Fpbi5nYWluLnZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc291cmNlICYmIHNvdXJjZS5oYXNPd25Qcm9wZXJ0eSgndm9sdW1lJykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNvdXJjZS52b2x1bWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzTmFOKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFsdWUgPSBNYXRoLm1pbihNYXRoLm1heCh2YWx1ZSwgMCksIDEpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHBhcmFtID0gZ2Fpbi5nYWluO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRpbWUgPSBjb250ZXh0LmN1cnJlbnRUaW1lO1xuICAgICAgICAgICAgICAgICAgICBwYXJhbS5jYW5jZWxTY2hlZHVsZWRWYWx1ZXModGltZSk7XG4gICAgICAgICAgICAgICAgICAgIHBhcmFtLnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIHBhcmFtLnNldFZhbHVlQXRUaW1lKHZhbHVlLCB0aW1lKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwYXJhbS52YWx1ZSA9IHZhbHVlO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2UgJiYgc291cmNlLmhhc093blByb3BlcnR5KCd2b2x1bWUnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlLnZvbHVtZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvLyBmb3IgbWVkaWEgZWxlbWVudCBzb3VyY2VcbiAgICAgICAgZ3JvdXBWb2x1bWU6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzb3VyY2UuZ3JvdXBWb2x1bWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoc291cmNlICYmIHNvdXJjZS5oYXNPd25Qcm9wZXJ0eSgnZ3JvdXBWb2x1bWUnKSkge1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2UuZ3JvdXBWb2x1bWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHdhdmVmb3JtOiB7XG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUobGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHNvdW5kLm9uY2UoJ3JlYWR5JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdhdmUoZGF0YSwgbGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB3YXZlKGRhdGEsIGxlbmd0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHVzZXJEYXRhOiB7XG4gICAgICAgICAgICB2YWx1ZToge31cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHNvdW5kO1xufVxuXG4vLyBleHBvc2UgZm9yIHVuaXQgdGVzdHNcblNvdW5kLl9fc291cmNlID0ge1xuICAgIEJ1ZmZlclNvdXJjZTogQnVmZmVyU291cmNlLFxuICAgIE1lZGlhU291cmNlOiBNZWRpYVNvdXJjZSxcbiAgICBNaWNyb3Bob25lU291cmNlOiBNaWNyb3Bob25lU291cmNlLFxuICAgIE9zY2lsbGF0b3JTb3VyY2U6IE9zY2lsbGF0b3JTb3VyY2UsXG4gICAgU2NyaXB0U291cmNlOiBTY3JpcHRTb3VyY2Vcbn07XG5cbmZ1bmN0aW9uIFNvdW5kR3JvdXAoY29udGV4dCwgZGVzdGluYXRpb24pIHtcbiAgICB2YXIgZ3JvdXAgPSBuZXcgR3JvdXAoY29udGV4dCwgZGVzdGluYXRpb24pO1xuICAgIHZhciBzb3VuZHMgPSBncm91cC5zb3VuZHM7XG4gICAgdmFyIHBsYXliYWNrUmF0ZSA9IDEsXG4gICAgICAgIGxvb3AgPSBmYWxzZSxcbiAgICAgICAgc3JjID0gdm9pZCAwO1xuXG4gICAgZnVuY3Rpb24gZ2V0U291cmNlKCkge1xuICAgICAgICBpZiAoIXNvdW5kcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHNyYyA9IHNvdW5kcy5zbGljZSgwKS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICByZXR1cm4gYi5kdXJhdGlvbiAtIGEuZHVyYXRpb247XG4gICAgICAgIH0pWzBdO1xuICAgIH1cblxuICAgIHZhciBhZGQgPSBncm91cC5hZGQ7XG4gICAgZ3JvdXAuYWRkID0gZnVuY3Rpb24gKHNvdW5kKSB7XG4gICAgICAgIGFkZChzb3VuZCk7XG4gICAgICAgIGdldFNvdXJjZSgpO1xuICAgICAgICByZXR1cm4gZ3JvdXA7XG4gICAgfTtcblxuICAgIHZhciByZW1vdmUgPSBncm91cC5ybWVvdmU7XG4gICAgZ3JvdXAucmVtb3ZlID0gZnVuY3Rpb24gKHNvdW5kT3JJZCkge1xuICAgICAgICByZW1vdmUoc291bmRPcklkKTtcbiAgICAgICAgZ2V0U291cmNlKCk7XG4gICAgICAgIHJldHVybiBncm91cDtcbiAgICB9O1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZ3JvdXAsIHtcbiAgICAgICAgY3VycmVudFRpbWU6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzcmMgPyBzcmMuY3VycmVudFRpbWUgOiAwO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wbGF5KDAsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZHVyYXRpb246IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzcmMgPyBzcmMuZHVyYXRpb24gOiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvLyBlbmRlZDoge1xuICAgICAgICAvLyAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gICAgICAgICByZXR1cm4gc3JjID8gc3JjLmVuZGVkIDogZmFsc2U7XG4gICAgICAgIC8vICAgICB9XG4gICAgICAgIC8vIH0sXG4gICAgICAgIGxvb3A6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBsb29wO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgbG9vcCA9ICEhdmFsdWU7XG4gICAgICAgICAgICAgICAgc291bmRzLmZvckVhY2goZnVuY3Rpb24gKHNvdW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIHNvdW5kLmxvb3AgPSBsb29wO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBwYXVzZWQ6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIC8vIHJldHVybiBzcmMgPyBzcmMucGF1c2VkIDogZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuICEhc3JjICYmIHNyYy5wYXVzZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHByb2dyZXNzOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3JjID8gc3JjLnByb2dyZXNzIDogMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcGxheWJhY2tSYXRlOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGxheWJhY2tSYXRlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcGxheWJhY2tSYXRlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgc291bmRzLmZvckVhY2goZnVuY3Rpb24gKHNvdW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIHNvdW5kLnBsYXliYWNrUmF0ZSA9IHBsYXliYWNrUmF0ZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcGxheWluZzoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIHNyYyA/IHNyYy5wbGF5aW5nIDogZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuICEhc3JjICYmIHNyYy5wbGF5aW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gZ3JvdXA7XG59XG5cbmZ1bmN0aW9uIE1pY3JvcGhvbmUoY29ubmVjdGVkLCBkZW5pZWQsIGVycm9yKSB7XG4gICAgbmF2aWdhdG9yLmdldFVzZXJNZWRpYSA9IG5hdmlnYXRvci5nZXRVc2VyTWVkaWEgfHwgbmF2aWdhdG9yLndlYmtpdEdldFVzZXJNZWRpYSB8fCBuYXZpZ2F0b3IubW96R2V0VXNlck1lZGlhIHx8IG5hdmlnYXRvci5tc0dldFVzZXJNZWRpYTtcbiAgICBlcnJvciA9IGVycm9yIHx8IGZ1bmN0aW9uICgpIHt9O1xuXG4gICAgdmFyIGlzU3VwcG9ydGVkID0gISFuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhO1xuICAgIHZhciBhcGkgPSB7fTtcbiAgICB2YXIgc3RyZWFtID0gbnVsbDtcblxuICAgIGZ1bmN0aW9uIGNvbm5lY3QoKSB7XG4gICAgICAgIGlmICghaXNTdXBwb3J0ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBhcGk7XG4gICAgICAgIH1cblxuICAgICAgICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhKHtcbiAgICAgICAgICAgIGF1ZGlvOiB0cnVlXG4gICAgICAgIH0sIGZ1bmN0aW9uIChtaWNTdHJlYW0pIHtcbiAgICAgICAgICAgIHN0cmVhbSA9IG1pY1N0cmVhbTtcbiAgICAgICAgICAgIGNvbm5lY3RlZChzdHJlYW0pO1xuICAgICAgICB9LCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgaWYgKGRlbmllZCAmJiBlLm5hbWUgPT09ICdQZXJtaXNzaW9uRGVuaWVkRXJyb3InIHx8IGUgPT09ICdQRVJNSVNTSU9OX0RFTklFRCcpIHtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnUGVybWlzc2lvbiBkZW5pZWQuIFJlc2V0IGJ5IGNsaWNraW5nIHRoZSBjYW1lcmEgaWNvbiB3aXRoIHRoZSByZWQgY3Jvc3MuJyk7XG4gICAgICAgICAgICAgICAgZGVuaWVkKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVycm9yKGUubWVzc2FnZSB8fCBlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBhcGk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGlzY29ubmVjdCgpIHtcbiAgICAgICAgaWYgKHN0cmVhbSkge1xuICAgICAgICAgICAgc3RyZWFtLnN0b3AoKTtcbiAgICAgICAgICAgIHN0cmVhbSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFwaTtcbiAgICB9XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhhcGksIHtcbiAgICAgICAgY29ubmVjdDoge1xuICAgICAgICAgICAgdmFsdWU6IGNvbm5lY3RcbiAgICAgICAgfSxcbiAgICAgICAgZGlzY29ubmVjdDoge1xuICAgICAgICAgICAgdmFsdWU6IGRpc2Nvbm5lY3RcbiAgICAgICAgfSxcbiAgICAgICAgaXNTdXBwb3J0ZWQ6IHtcbiAgICAgICAgICAgIHZhbHVlOiBpc1N1cHBvcnRlZFxuICAgICAgICB9LFxuICAgICAgICBzdHJlYW06IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzdHJlYW07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBPYmplY3QuZnJlZXplKGFwaSk7XG59XG5cbnZhciBoYWxmUEkgPSBNYXRoLlBJIC8gMjtcbnZhciB0d29QSSA9IE1hdGguUEkgKiAyO1xuXG5mdW5jdGlvbiB3YXZlZm9ybWVyKGNvbmZpZykge1xuXG4gICAgdmFyIHN0eWxlID0gY29uZmlnLnN0eWxlIHx8ICdmaWxsJyxcbiAgICAgICAgLy8gJ2ZpbGwnIG9yICdsaW5lJ1xuICAgIHNoYXBlID0gY29uZmlnLnNoYXBlIHx8ICdsaW5lYXInLFxuICAgICAgICAvLyAnY2lyY3VsYXInIG9yICdsaW5lYXInXG4gICAgY29sb3IgPSBjb25maWcuY29sb3IgfHwgMCxcbiAgICAgICAgYmdDb2xvciA9IGNvbmZpZy5iZ0NvbG9yLFxuICAgICAgICBsaW5lV2lkdGggPSBjb25maWcubGluZVdpZHRoIHx8IDEsXG4gICAgICAgIHBlcmNlbnQgPSBjb25maWcucGVyY2VudCB8fCAxLFxuICAgICAgICBvcmlnaW5YID0gY29uZmlnLnggfHwgMCxcbiAgICAgICAgb3JpZ2luWSA9IGNvbmZpZy55IHx8IDAsXG4gICAgICAgIHRyYW5zZm9ybSA9IGNvbmZpZy50cmFuc2Zvcm07XG5cbiAgICB2YXIgY2FudmFzID0gY29uZmlnLmNhbnZhcyxcbiAgICAgICAgd2lkdGggPSBjb25maWcud2lkdGggfHwgY2FudmFzICYmIGNhbnZhcy53aWR0aCxcbiAgICAgICAgaGVpZ2h0ID0gY29uZmlnLmhlaWdodCB8fCBjYW52YXMgJiYgY2FudmFzLmhlaWdodDtcblxuICAgIHZhciBjdHggPSBudWxsLFxuICAgICAgICBjdXJyZW50Q29sb3IgPSB2b2lkIDAsXG4gICAgICAgIGkgPSB2b2lkIDAsXG4gICAgICAgIHggPSB2b2lkIDAsXG4gICAgICAgIHkgPSB2b2lkIDAsXG4gICAgICAgIHJhZGl1cyA9IHZvaWQgMCxcbiAgICAgICAgaW5uZXJSYWRpdXMgPSB2b2lkIDAsXG4gICAgICAgIGNlbnRlclggPSB2b2lkIDAsXG4gICAgICAgIGNlbnRlclkgPSB2b2lkIDA7XG5cbiAgICBpZiAoIWNhbnZhcyAmJiAhY29uZmlnLmNvbnRleHQpIHtcbiAgICAgICAgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgICAgIHdpZHRoID0gd2lkdGggfHwgY2FudmFzLndpZHRoO1xuICAgICAgICBoZWlnaHQgPSBoZWlnaHQgfHwgY2FudmFzLmhlaWdodDtcbiAgICAgICAgY2FudmFzLndpZHRoID0gaGVpZ2h0O1xuICAgICAgICBjYW52YXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgIH1cblxuICAgIGlmIChzaGFwZSA9PT0gJ2NpcmN1bGFyJykge1xuICAgICAgICByYWRpdXMgPSBjb25maWcucmFkaXVzIHx8IE1hdGgubWluKGhlaWdodCAvIDIsIHdpZHRoIC8gMik7XG4gICAgICAgIGlubmVyUmFkaXVzID0gY29uZmlnLmlubmVyUmFkaXVzIHx8IHJhZGl1cyAvIDI7XG4gICAgICAgIGNlbnRlclggPSBvcmlnaW5YICsgd2lkdGggLyAyO1xuICAgICAgICBjZW50ZXJZID0gb3JpZ2luWSArIGhlaWdodCAvIDI7XG4gICAgfVxuXG4gICAgY3R4ID0gY29uZmlnLmNvbnRleHQgfHwgY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG5cbiAgICBmdW5jdGlvbiBjbGVhcigpIHtcbiAgICAgICAgaWYgKGJnQ29sb3IpIHtcbiAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBiZ0NvbG9yO1xuICAgICAgICAgICAgY3R4LmZpbGxSZWN0KG9yaWdpblgsIG9yaWdpblksIHdpZHRoLCBoZWlnaHQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY3R4LmNsZWFyUmVjdChvcmlnaW5YLCBvcmlnaW5ZLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGN0eC5saW5lV2lkdGggPSBsaW5lV2lkdGg7XG5cbiAgICAgICAgY3VycmVudENvbG9yID0gbnVsbDtcblxuICAgICAgICBpZiAodHlwZW9mIGNvbG9yICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSBjb2xvcjtcbiAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVwZGF0ZUNvbG9yKHBvc2l0aW9uLCBsZW5ndGgsIHZhbHVlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgY29sb3IgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHZhciBuZXdDb2xvciA9IGNvbG9yKHBvc2l0aW9uLCBsZW5ndGgsIHZhbHVlKTtcbiAgICAgICAgICAgIGlmIChuZXdDb2xvciAhPT0gY3VycmVudENvbG9yKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudENvbG9yID0gbmV3Q29sb3I7XG4gICAgICAgICAgICAgICAgY3R4LnN0cm9rZSgpO1xuICAgICAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IGN1cnJlbnRDb2xvcjtcbiAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRWYWx1ZSh2YWx1ZSwgcG9zaXRpb24sIGxlbmd0aCkge1xuICAgICAgICBpZiAodHlwZW9mIHRyYW5zZm9ybSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgcmV0dXJuIHRyYW5zZm9ybSh2YWx1ZSwgcG9zaXRpb24sIGxlbmd0aCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFdhdmVmb3JtKHZhbHVlLCBsZW5ndGgpIHtcbiAgICAgICAgaWYgKHZhbHVlICYmIHR5cGVvZiB2YWx1ZS53YXZlZm9ybSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlLndhdmVmb3JtKGxlbmd0aCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbmZpZy53YXZlZm9ybSkge1xuICAgICAgICAgICAgcmV0dXJuIGNvbmZpZy53YXZlZm9ybTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29uZmlnLnNvdW5kKSB7XG4gICAgICAgICAgICByZXR1cm4gY29uZmlnLnNvdW5kLndhdmVmb3JtKGxlbmd0aCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdXBkYXRlKHdhdmUpIHtcblxuICAgICAgICBjbGVhcigpO1xuXG4gICAgICAgIGlmIChzaGFwZSA9PT0gJ2NpcmN1bGFyJykge1xuICAgICAgICAgICAgdmFyIHdhdmVmb3JtID0gZ2V0V2F2ZWZvcm0od2F2ZSwgMzYwKTtcbiAgICAgICAgICAgIHZhciBsZW5ndGggPSBNYXRoLmZsb29yKHdhdmVmb3JtLmxlbmd0aCAqIHBlcmNlbnQpO1xuXG4gICAgICAgICAgICB2YXIgc3RlcCA9IHR3b1BJIC8gbGVuZ3RoO1xuICAgICAgICAgICAgdmFyIGFuZ2xlID0gdm9pZCAwLFxuICAgICAgICAgICAgICAgIG1hZ25pdHVkZSA9IHZvaWQgMCxcbiAgICAgICAgICAgICAgICBzaW5lID0gdm9pZCAwLFxuICAgICAgICAgICAgICAgIGNvc2luZSA9IHZvaWQgMDtcblxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZ2V0VmFsdWUod2F2ZWZvcm1baV0sIGksIGxlbmd0aCk7XG4gICAgICAgICAgICAgICAgdXBkYXRlQ29sb3IoaSwgbGVuZ3RoLCB2YWx1ZSk7XG5cbiAgICAgICAgICAgICAgICBhbmdsZSA9IGkgKiBzdGVwIC0gaGFsZlBJO1xuICAgICAgICAgICAgICAgIGNvc2luZSA9IE1hdGguY29zKGFuZ2xlKTtcbiAgICAgICAgICAgICAgICBzaW5lID0gTWF0aC5zaW4oYW5nbGUpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0eWxlID09PSAnZmlsbCcpIHtcbiAgICAgICAgICAgICAgICAgICAgeCA9IGNlbnRlclggKyBpbm5lclJhZGl1cyAqIGNvc2luZTtcbiAgICAgICAgICAgICAgICAgICAgeSA9IGNlbnRlclkgKyBpbm5lclJhZGl1cyAqIHNpbmU7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5tb3ZlVG8oeCwgeSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbWFnbml0dWRlID0gaW5uZXJSYWRpdXMgKyAocmFkaXVzIC0gaW5uZXJSYWRpdXMpICogdmFsdWU7XG4gICAgICAgICAgICAgICAgeCA9IGNlbnRlclggKyBtYWduaXR1ZGUgKiBjb3NpbmU7XG4gICAgICAgICAgICAgICAgeSA9IGNlbnRlclkgKyBtYWduaXR1ZGUgKiBzaW5lO1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0eWxlID09PSAnbGluZScgJiYgaSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjdHgubW92ZVRvKHgsIHkpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGN0eC5saW5lVG8oeCwgeSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChzdHlsZSA9PT0gJ2xpbmUnKSB7XG4gICAgICAgICAgICAgICAgY3R4LmNsb3NlUGF0aCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICB2YXIgX3dhdmVmb3JtID0gZ2V0V2F2ZWZvcm0od2F2ZSwgd2lkdGgpO1xuICAgICAgICAgICAgdmFyIF9sZW5ndGggPSBNYXRoLm1pbihfd2F2ZWZvcm0ubGVuZ3RoLCB3aWR0aCAtIGxpbmVXaWR0aCAvIDIpO1xuICAgICAgICAgICAgX2xlbmd0aCA9IE1hdGguZmxvb3IoX2xlbmd0aCAqIHBlcmNlbnQpO1xuXG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgX2xlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIF92YWx1ZSA9IGdldFZhbHVlKF93YXZlZm9ybVtpXSwgaSwgX2xlbmd0aCk7XG4gICAgICAgICAgICAgICAgdXBkYXRlQ29sb3IoaSwgX2xlbmd0aCwgX3ZhbHVlKTtcblxuICAgICAgICAgICAgICAgIGlmIChzdHlsZSA9PT0gJ2xpbmUnICYmIGkgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5saW5lVG8oeCwgeSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgeCA9IG9yaWdpblggKyBpO1xuICAgICAgICAgICAgICAgIHkgPSBvcmlnaW5ZICsgaGVpZ2h0IC0gTWF0aC5yb3VuZChoZWlnaHQgKiBfdmFsdWUpO1xuICAgICAgICAgICAgICAgIHkgPSBNYXRoLmZsb29yKE1hdGgubWluKHksIG9yaWdpblkgKyBoZWlnaHQgLSBsaW5lV2lkdGggLyAyKSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3R5bGUgPT09ICdmaWxsJykge1xuICAgICAgICAgICAgICAgICAgICBjdHgubW92ZVRvKHgsIHkpO1xuICAgICAgICAgICAgICAgICAgICBjdHgubGluZVRvKHgsIG9yaWdpblkgKyBoZWlnaHQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5saW5lVG8oeCwgeSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGN0eC5zdHJva2UoKTtcbiAgICB9XG5cbiAgICB1cGRhdGUuY2FudmFzID0gY2FudmFzO1xuXG4gICAgaWYgKGNvbmZpZy53YXZlZm9ybSB8fCBjb25maWcuc291bmQpIHtcbiAgICAgICAgdXBkYXRlKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHVwZGF0ZTtcbn1cblxuLypcbiAqIGF1ZGlvIGN0eFxuICovXG52YXIgY3R4ID0gdm9pZCAwO1xudmFyIG9mZmxpbmVDdHggPSB2b2lkIDA7XG5cbmZ1bmN0aW9uIGdldENvbnRleHQoKSB7XG5cdGlmIChjdHgpIHtcblx0XHRyZXR1cm4gY3R4O1xuXHR9XG5cblx0dmFyIGRlc2lyZWRTYW1wbGVSYXRlID0gNDQxMDA7XG5cblx0dmFyIEN0eCA9IHdpbmRvdy5BdWRpb0NvbnRleHQgfHwgd2luZG93LndlYmtpdEF1ZGlvQ29udGV4dDtcblxuXHRjdHggPSBDdHggPyBuZXcgQ3R4KCkgOiBudWxsO1xuXG5cdC8vIENoZWNrIGlmIGhhY2sgaXMgbmVjZXNzYXJ5LiBPbmx5IG9jY3VycyBpbiBpT1M2KyBkZXZpY2VzXG5cdC8vIGFuZCBvbmx5IHdoZW4geW91IGZpcnN0IGJvb3QgdGhlIGlQaG9uZSwgb3IgcGxheSBhIGF1ZGlvL3ZpZGVvXG5cdC8vIHdpdGggYSBkaWZmZXJlbnQgc2FtcGxlIHJhdGVcblx0Ly8gaHR0cHM6Ly9naXRodWIuY29tL0phbTMvaW9zLXNhZmUtYXVkaW8tY29udGV4dC9ibG9iL21hc3Rlci9pbmRleC5qc1xuXHRpZiAoLyhpUGhvbmV8aVBhZCkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpICYmIGN0eC5zYW1wbGVSYXRlICE9PSBkZXNpcmVkU2FtcGxlUmF0ZSkge1xuXHRcdHZhciBidWZmZXIgPSBjdHguY3JlYXRlQnVmZmVyKDEsIDEsIGRlc2lyZWRTYW1wbGVSYXRlKTtcblx0XHR2YXIgZHVtbXkgPSBjdHguY3JlYXRlQnVmZmVyU291cmNlKCk7XG5cdFx0ZHVtbXkuYnVmZmVyID0gYnVmZmVyO1xuXHRcdGR1bW15LmNvbm5lY3QoY3R4LmRlc3RpbmF0aW9uKTtcblx0XHRkdW1teS5zdGFydCgwKTtcblx0XHRkdW1teS5kaXNjb25uZWN0KCk7XG5cblx0XHRjdHguY2xvc2UoKTsgLy8gZGlzcG9zZSBvbGQgY29udGV4dFxuXHRcdGN0eCA9IEN0eCA/IG5ldyBDdHgoKSA6IG51bGw7XG5cdH1cblxuXHQvLyBIYW5kbGVzIGJ1ZyBpbiBTYWZhcmkgOSBPU1ggd2hlcmUgQXVkaW9Db250ZXh0IGluc3RhbmNlIHN0YXJ0cyBpbiAnc3VzcGVuZGVkJyBzdGF0ZVxuXG5cdHZhciBpc1N1c3BlbmRlZCA9IGN0eCAmJiBjdHguc3RhdGUgPT09ICdzdXNwZW5kZWQnO1xuXG5cdGlmIChpc1N1c3BlbmRlZCAmJiB0eXBlb2YgY3R4LnJlc3VtZSA9PT0gJ2Z1bmN0aW9uJykge1xuXHRcdHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdGN0eC5yZXN1bWUoKTtcblx0XHR9LCAxMDAwKTtcblx0fVxuXG5cdHJldHVybiBjdHg7XG59XG5cbi8qXG5JbiBjb250cmFzdCB3aXRoIGEgc3RhbmRhcmQgQXVkaW9Db250ZXh0LCBhbiBPZmZsaW5lQXVkaW9Db250ZXh0IGRvZXNuJ3QgcmVuZGVyXG50aGUgYXVkaW8gdG8gdGhlIGRldmljZSBoYXJkd2FyZTtcbmluc3RlYWQsIGl0IGdlbmVyYXRlcyBpdCwgYXMgZmFzdCBhcyBpdCBjYW4sIGFuZCBvdXRwdXRzIHRoZSByZXN1bHQgdG8gYW4gQXVkaW9CdWZmZXIuXG4qL1xuZnVuY3Rpb24gZ2V0T2ZmbGluZUNvbnRleHQobnVtT2ZDaGFubmVscywgbGVuZ3RoLCBzYW1wbGVSYXRlKSB7XG5cdGlmIChvZmZsaW5lQ3R4KSB7XG5cdFx0cmV0dXJuIG9mZmxpbmVDdHg7XG5cdH1cblx0bnVtT2ZDaGFubmVscyA9IG51bU9mQ2hhbm5lbHMgfHwgMjtcblx0c2FtcGxlUmF0ZSA9IHNhbXBsZVJhdGUgfHwgNDQxMDA7XG5cdGxlbmd0aCA9IHNhbXBsZVJhdGUgfHwgbnVtT2ZDaGFubmVscztcblxuXHR2YXIgT2ZmbGluZUN0eCA9IHdpbmRvdy5PZmZsaW5lQXVkaW9Db250ZXh0IHx8IHdpbmRvdy53ZWJraXRPZmZsaW5lQXVkaW9Db250ZXh0O1xuXG5cdG9mZmxpbmVDdHggPSBPZmZsaW5lQ3R4ID8gbmV3IE9mZmxpbmVDdHgobnVtT2ZDaGFubmVscywgbGVuZ3RoLCBzYW1wbGVSYXRlKSA6IG51bGw7XG5cblx0cmV0dXJuIG9mZmxpbmVDdHg7XG59XG5cbi8qXG4gKiBjbG9uZSBhdWRpbyBidWZmZXJcbiAqL1xuXG5mdW5jdGlvbiBjbG9uZUJ1ZmZlcihidWZmZXIpIHtcblx0aWYgKCFjdHgpIHtcblx0XHRyZXR1cm4gYnVmZmVyO1xuXHR9XG5cblx0dmFyIG51bUNoYW5uZWxzID0gYnVmZmVyLm51bWJlck9mQ2hhbm5lbHMsXG5cdCAgICBjbG9uZWQgPSBjdHguY3JlYXRlQnVmZmVyKG51bUNoYW5uZWxzLCBidWZmZXIubGVuZ3RoLCBidWZmZXIuc2FtcGxlUmF0ZSk7XG5cdGZvciAodmFyIGkgPSAwOyBpIDwgbnVtQ2hhbm5lbHM7IGkrKykge1xuXHRcdGNsb25lZC5nZXRDaGFubmVsRGF0YShpKS5zZXQoYnVmZmVyLmdldENoYW5uZWxEYXRhKGkpKTtcblx0fVxuXHRyZXR1cm4gY2xvbmVkO1xufVxuXG4vKlxuICogcmV2ZXJzZSBhdWRpbyBidWZmZXJcbiAqL1xuXG5mdW5jdGlvbiByZXZlcnNlQnVmZmVyKGJ1ZmZlcikge1xuXHR2YXIgbnVtQ2hhbm5lbHMgPSBidWZmZXIubnVtYmVyT2ZDaGFubmVscztcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBudW1DaGFubmVsczsgaSsrKSB7XG5cdFx0QXJyYXkucHJvdG90eXBlLnJldmVyc2UuY2FsbChidWZmZXIuZ2V0Q2hhbm5lbERhdGEoaSkpO1xuXHR9XG5cdHJldHVybiBidWZmZXI7XG59XG5cbi8qXG4gKiByYW1wIGF1ZGlvIHBhcmFtXG4gKi9cblxuZnVuY3Rpb24gcmFtcChwYXJhbSwgZnJvbVZhbHVlLCB0b1ZhbHVlLCBkdXJhdGlvbiwgbGluZWFyKSB7XG5cdGlmICghY3R4KSB7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0cGFyYW0uc2V0VmFsdWVBdFRpbWUoZnJvbVZhbHVlLCBjdHguY3VycmVudFRpbWUpO1xuXG5cdGlmIChsaW5lYXIpIHtcblx0XHRwYXJhbS5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSh0b1ZhbHVlLCBjdHguY3VycmVudFRpbWUgKyBkdXJhdGlvbik7XG5cdH0gZWxzZSB7XG5cdFx0cGFyYW0uZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSh0b1ZhbHVlLCBjdHguY3VycmVudFRpbWUgKyBkdXJhdGlvbik7XG5cdH1cbn1cblxuLypcbiAqIGdldCBmcmVxdWVuY3kgZnJvbSBtaW4gdG8gbWF4IGJ5IHBhc3NpbmcgMCB0byAxXG4gKi9cblxuZnVuY3Rpb24gZ2V0RnJlcXVlbmN5KHZhbHVlKSB7XG5cdGlmICghY3R4KSB7XG5cdFx0cmV0dXJuIDA7XG5cdH1cblx0Ly8gZ2V0IGZyZXF1ZW5jeSBieSBwYXNzaW5nIG51bWJlciBmcm9tIDAgdG8gMVxuXHQvLyBDbGFtcCB0aGUgZnJlcXVlbmN5IGJldHdlZW4gdGhlIG1pbmltdW0gdmFsdWUgKDQwIEh6KSBhbmQgaGFsZiBvZiB0aGVcblx0Ly8gc2FtcGxpbmcgcmF0ZS5cblx0dmFyIG1pblZhbHVlID0gNDA7XG5cdHZhciBtYXhWYWx1ZSA9IGN0eC5zYW1wbGVSYXRlIC8gMjtcblx0Ly8gTG9nYXJpdGhtIChiYXNlIDIpIHRvIGNvbXB1dGUgaG93IG1hbnkgb2N0YXZlcyBmYWxsIGluIHRoZSByYW5nZS5cblx0dmFyIG51bWJlck9mT2N0YXZlcyA9IE1hdGgubG9nKG1heFZhbHVlIC8gbWluVmFsdWUpIC8gTWF0aC5MTjI7XG5cdC8vIENvbXB1dGUgYSBtdWx0aXBsaWVyIGZyb20gMCB0byAxIGJhc2VkIG9uIGFuIGV4cG9uZW50aWFsIHNjYWxlLlxuXHR2YXIgbXVsdGlwbGllciA9IE1hdGgucG93KDIsIG51bWJlck9mT2N0YXZlcyAqICh2YWx1ZSAtIDEuMCkpO1xuXHQvLyBHZXQgYmFjayB0byB0aGUgZnJlcXVlbmN5IHZhbHVlIGJldHdlZW4gbWluIGFuZCBtYXguXG5cdHJldHVybiBtYXhWYWx1ZSAqIG11bHRpcGxpZXI7XG59XG5cbi8qXG4gKiBtaWNyb3Bob25lIHV0aWxcbiAqL1xuXG5mdW5jdGlvbiBtaWNyb3Bob25lKGNvbm5lY3RlZCwgZGVuaWVkLCBlcnJvcikge1xuXHRyZXR1cm4gbmV3IE1pY3JvcGhvbmUoY29ubmVjdGVkLCBkZW5pZWQsIGVycm9yKTtcbn1cblxuLypcbiAqIEZvcm1hdCBzZWNvbmRzIGFzIHRpbWVjb2RlIHN0cmluZ1xuICovXG5cbmZ1bmN0aW9uIHRpbWVDb2RlKHNlY29uZHMpIHtcblx0dmFyIGRlbGltID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8gJzonIDogYXJndW1lbnRzWzFdO1xuXG5cdC8vIGNvbnN0IGggPSBNYXRoLmZsb29yKHNlY29uZHMgLyAzNjAwKTtcblx0Ly8gY29uc3QgbSA9IE1hdGguZmxvb3IoKHNlY29uZHMgJSAzNjAwKSAvIDYwKTtcblx0dmFyIG0gPSBNYXRoLmZsb29yKHNlY29uZHMgLyA2MCk7XG5cdHZhciBzID0gTWF0aC5mbG9vcihzZWNvbmRzICUgMzYwMCAlIDYwKTtcblx0Ly8gY29uc3QgaHIgPSAoaCA8IDEwID8gJzAnICsgaCArIGRlbGltIDogaCArIGRlbGltKTtcblx0dmFyIG1uID0gKG0gPCAxMCA/ICcwJyArIG0gOiBtKSArIGRlbGltO1xuXHR2YXIgc2MgPSBzIDwgMTAgPyAnMCcgKyBzIDogcztcblx0Ly8gcmV0dXJuIGhyICsgbW4gKyBzYztcblx0cmV0dXJuIG1uICsgc2M7XG59XG5cbnZhciB1dGlscyA9IE9iamVjdC5mcmVlemUoe1xuXHRnZXRDb250ZXh0OiBnZXRDb250ZXh0LFxuXHRnZXRPZmZsaW5lQ29udGV4dDogZ2V0T2ZmbGluZUNvbnRleHQsXG5cdGNsb25lQnVmZmVyOiBjbG9uZUJ1ZmZlcixcblx0cmV2ZXJzZUJ1ZmZlcjogcmV2ZXJzZUJ1ZmZlcixcblx0cmFtcDogcmFtcCxcblx0Z2V0RnJlcXVlbmN5OiBnZXRGcmVxdWVuY3ksXG5cdG1pY3JvcGhvbmU6IG1pY3JvcGhvbmUsXG5cdHRpbWVDb2RlOiB0aW1lQ29kZSxcblx0d2F2ZWZvcm1lcjogd2F2ZWZvcm1lclxufSk7XG5cbmZ1bmN0aW9uIFNvbm8oKSB7XG4gICAgdmFyIFZFUlNJT04gPSAnMC4xLjg1JztcbiAgICB2YXIgY29udGV4dCA9IHV0aWxzLmdldENvbnRleHQoKTtcbiAgICB2YXIgZGVzdGluYXRpb24gPSBjb250ZXh0ID8gY29udGV4dC5kZXN0aW5hdGlvbiA6IG51bGw7XG4gICAgdmFyIGdyb3VwID0gbmV3IEdyb3VwKGNvbnRleHQsIGRlc3RpbmF0aW9uKTtcblxuICAgIHZhciBhcGkgPSBudWxsO1xuICAgIHZhciBpc1RvdWNoTG9ja2VkID0gZmFsc2U7XG5cbiAgICAvKlxuICAgICAqIEdldCBTb3VuZCBieSBpZFxuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gZ2V0U291bmQoaWQpIHtcbiAgICAgICAgcmV0dXJuIGdyb3VwLmZpbmQoaWQpO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogQ3JlYXRlIGdyb3VwXG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBjcmVhdGVHcm91cChzb3VuZHMpIHtcbiAgICAgICAgdmFyIHNvdW5kR3JvdXAgPSBuZXcgU291bmRHcm91cChjb250ZXh0LCBncm91cC5nYWluKTtcbiAgICAgICAgaWYgKHNvdW5kcykge1xuICAgICAgICAgICAgc291bmRzLmZvckVhY2goZnVuY3Rpb24gKHNvdW5kKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNvdW5kR3JvdXAuYWRkKHNvdW5kKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzb3VuZEdyb3VwO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogTG9hZGluZ1xuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gYWRkKGNvbmZpZykge1xuICAgICAgICB2YXIgc291bmRDb250ZXh0ID0gY29uZmlnICYmIGNvbmZpZy53ZWJBdWRpbyA9PT0gZmFsc2UgPyBudWxsIDogY29udGV4dDtcbiAgICAgICAgLy8gY29uc3Qgc291bmQgPSBuZXcgU291bmQoc291bmRDb250ZXh0LCBncm91cC5nYWluKTtcbiAgICAgICAgdmFyIHNyYyA9IGZpbGUuZ2V0U3VwcG9ydGVkRmlsZShjb25maWcuc3JjIHx8IGNvbmZpZy51cmwgfHwgY29uZmlnLmRhdGEgfHwgY29uZmlnKTtcbiAgICAgICAgdmFyIHNvdW5kID0gbmV3IFNvdW5kKE9iamVjdC5hc3NpZ24oe30sIGNvbmZpZyB8fCB7fSwge1xuICAgICAgICAgICAgc3JjOiBzcmMsXG4gICAgICAgICAgICBjb250ZXh0OiBzb3VuZENvbnRleHQsXG4gICAgICAgICAgICBkZXN0aW5hdGlvbjogZ3JvdXAuZ2FpblxuICAgICAgICB9KSk7XG4gICAgICAgIHNvdW5kLmlzVG91Y2hMb2NrZWQgPSBpc1RvdWNoTG9ja2VkO1xuICAgICAgICBpZiAoY29uZmlnKSB7XG4gICAgICAgICAgICBzb3VuZC5pZCA9IGNvbmZpZy5pZCB8fCBjb25maWcubmFtZSB8fCAnJztcbiAgICAgICAgICAgIHNvdW5kLmxvb3AgPSAhIWNvbmZpZy5sb29wO1xuICAgICAgICAgICAgc291bmQudm9sdW1lID0gY29uZmlnLnZvbHVtZTtcbiAgICAgICAgfVxuICAgICAgICBncm91cC5hZGQoc291bmQpO1xuICAgICAgICByZXR1cm4gc291bmQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcXVldWUoY29uZmlnLCBsb2FkZXJHcm91cCkge1xuICAgICAgICB2YXIgc291bmQgPSBhZGQoY29uZmlnKS5sb2FkKCk7XG5cbiAgICAgICAgaWYgKGxvYWRlckdyb3VwKSB7XG4gICAgICAgICAgICBsb2FkZXJHcm91cC5hZGQoc291bmQubG9hZGVyKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc291bmQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG9hZChjb25maWcpIHtcbiAgICAgICAgdmFyIHNyYyA9IGNvbmZpZy5zcmMgfHwgY29uZmlnLnVybCB8fCBjb25maWcuZGF0YSB8fCBjb25maWc7XG4gICAgICAgIHZhciBzb3VuZCA9IHZvaWQgMCxcbiAgICAgICAgICAgIGxvYWRlciA9IHZvaWQgMDtcblxuICAgICAgICBpZiAoZmlsZS5jb250YWluc1VSTChzcmMpKSB7XG4gICAgICAgICAgICBzb3VuZCA9IHF1ZXVlKGNvbmZpZyk7XG4gICAgICAgICAgICBsb2FkZXIgPSBzb3VuZC5sb2FkZXI7XG4gICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShzcmMpICYmIGZpbGUuY29udGFpbnNVUkwoc3JjWzBdLnNyYyB8fCBzcmNbMF0udXJsKSkge1xuICAgICAgICAgICAgc291bmQgPSBbXTtcbiAgICAgICAgICAgIGxvYWRlciA9IG5ldyBMb2FkZXIuR3JvdXAoKTtcbiAgICAgICAgICAgIHNyYy5mb3JFYWNoKGZ1bmN0aW9uICh1cmwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc291bmQucHVzaChxdWV1ZSh1cmwsIGxvYWRlcikpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgZXJyb3JNZXNzYWdlID0gJ3Nvbm8ubG9hZDogTm8gYXVkaW8gZmlsZSBVUkxzIGZvdW5kIGluIGNvbmZpZy4nO1xuICAgICAgICAgICAgaWYgKGNvbmZpZy5vbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLm9uRXJyb3IoJ1tFUlJPUl0gJyArIGVycm9yTWVzc2FnZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvck1lc3NhZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbmZpZy5vblByb2dyZXNzKSB7XG4gICAgICAgICAgICBsb2FkZXIub24oJ3Byb2dyZXNzJywgZnVuY3Rpb24gKHByb2dyZXNzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpZy5vblByb2dyZXNzKHByb2dyZXNzKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb25maWcub25Db21wbGV0ZSkge1xuICAgICAgICAgICAgbG9hZGVyLm9uY2UoJ2NvbXBsZXRlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGxvYWRlci5vZmYoJ3Byb2dyZXNzJyk7XG4gICAgICAgICAgICAgICAgY29uZmlnLm9uQ29tcGxldGUoc291bmQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgbG9hZGVyLm9uY2UoJ2Vycm9yJywgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgbG9hZGVyLm9mZignZXJyb3InKTtcbiAgICAgICAgICAgIGlmIChjb25maWcub25FcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbmZpZy5vbkVycm9yKGVycik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tFUlJPUl0gc29uby5sb2FkOiAnICsgZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGxvYWRlci5zdGFydCgpO1xuXG4gICAgICAgIHJldHVybiBzb3VuZDtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIENyZWF0ZSBTb3VuZFxuICAgICAqXG4gICAgICogQWNjZXB0ZWQgdmFsdWVzIGZvciBwYXJhbSBjb25maWc6XG4gICAgICogT2JqZWN0IGNvbmZpZyBlLmcuIHsgaWQ6J2ZvbycsIHVybDpbJ2Zvby5vZ2cnLCAnZm9vLm1wMyddIH1cbiAgICAgKiBBcnJheSAob2YgZmlsZXMgZS5nLiBbJ2Zvby5vZ2cnLCAnZm9vLm1wMyddKVxuICAgICAqIEFycmF5QnVmZmVyXG4gICAgICogSFRNTE1lZGlhRWxlbWVudFxuICAgICAqIEZpbGVuYW1lIHN0cmluZyAoZS5nLiAnZm9vLm9nZycpXG4gICAgICogT3NjaWxsYXRvciB0eXBlIHN0cmluZyAoaS5lLiAnc2luZScsICdzcXVhcmUnLCAnc2F3dG9vdGgnLCAndHJpYW5nbGUnKVxuICAgICAqIFNjcmlwdFByb2Nlc3NvciBjb25maWcgb2JqZWN0IChlLmcuIHsgYnVmZmVyU2l6ZTogMTAyNCwgY2hhbm5lbHM6IDEsIGNhbGxiYWNrOiBmbiB9KVxuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gY3JlYXRlU291bmQoY29uZmlnKSB7XG4gICAgICAgIC8vIHRyeSB0byBsb2FkIGlmIGNvbmZpZyBjb250YWlucyBVUkxzXG4gICAgICAgIGlmIChmaWxlLmNvbnRhaW5zVVJMKGNvbmZpZykpIHtcbiAgICAgICAgICAgIHJldHVybiBsb2FkKGNvbmZpZyk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc291bmQgPSBhZGQoY29uZmlnKTtcbiAgICAgICAgc291bmQuZGF0YSA9IGNvbmZpZy5kYXRhIHx8IGNvbmZpZztcblxuICAgICAgICByZXR1cm4gc291bmQ7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBEZXN0cm95XG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBkZXN0cm95U291bmQoc291bmRPcklkKSB7XG4gICAgICAgIGdyb3VwLmZpbmQoc291bmRPcklkLCBmdW5jdGlvbiAoc291bmQpIHtcbiAgICAgICAgICAgIHJldHVybiBzb3VuZC5kZXN0cm95KCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gYXBpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlc3Ryb3lBbGwoKSB7XG4gICAgICAgIGdyb3VwLmRlc3Ryb3koKTtcbiAgICAgICAgcmV0dXJuIGFwaTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIENvbnRyb2xzXG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBtdXRlKCkge1xuICAgICAgICBncm91cC5tdXRlKCk7XG4gICAgICAgIHJldHVybiBhcGk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdW5NdXRlKCkge1xuICAgICAgICBncm91cC51bk11dGUoKTtcbiAgICAgICAgcmV0dXJuIGFwaTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmYWRlKHZvbHVtZSwgZHVyYXRpb24pIHtcbiAgICAgICAgZ3JvdXAuZmFkZSh2b2x1bWUsIGR1cmF0aW9uKTtcbiAgICAgICAgcmV0dXJuIGFwaTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXVzZUFsbCgpIHtcbiAgICAgICAgZ3JvdXAucGF1c2UoKTtcbiAgICAgICAgcmV0dXJuIGFwaTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZXN1bWVBbGwoKSB7XG4gICAgICAgIGdyb3VwLnJlc3VtZSgpO1xuICAgICAgICByZXR1cm4gYXBpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN0b3BBbGwoKSB7XG4gICAgICAgIGdyb3VwLnN0b3AoKTtcbiAgICAgICAgcmV0dXJuIGFwaTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwbGF5KGlkLCBkZWxheSwgb2Zmc2V0KSB7XG4gICAgICAgIGdyb3VwLmZpbmQoaWQsIGZ1bmN0aW9uIChzb3VuZCkge1xuICAgICAgICAgICAgcmV0dXJuIHNvdW5kLnBsYXkoZGVsYXksIG9mZnNldCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gYXBpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhdXNlKGlkKSB7XG4gICAgICAgIGdyb3VwLmZpbmQoaWQsIGZ1bmN0aW9uIChzb3VuZCkge1xuICAgICAgICAgICAgcmV0dXJuIHNvdW5kLnBhdXNlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gYXBpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN0b3AoaWQpIHtcbiAgICAgICAgZ3JvdXAuZmluZChpZCwgZnVuY3Rpb24gKHNvdW5kKSB7XG4gICAgICAgICAgICByZXR1cm4gc291bmQuc3RvcCgpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGFwaTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIE1vYmlsZSB0b3VjaCBsb2NrXG4gICAgICovXG5cbiAgICBpc1RvdWNoTG9ja2VkID0gYnJvd3Nlci5oYW5kbGVUb3VjaExvY2soY29udGV4dCwgZnVuY3Rpb24gKCkge1xuICAgICAgICBpc1RvdWNoTG9ja2VkID0gZmFsc2U7XG4gICAgICAgIGdyb3VwLnNvdW5kcy5mb3JFYWNoKGZ1bmN0aW9uIChzb3VuZCkge1xuICAgICAgICAgICAgcmV0dXJuIHNvdW5kLmlzVG91Y2hMb2NrZWQgPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvKlxuICAgICAqIFBhZ2UgdmlzaWJpbGl0eSBldmVudHNcbiAgICAgKi9cblxuICAgIChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwYWdlSGlkZGVuUGF1c2VkID0gW107XG5cbiAgICAgICAgLy8gcGF1c2UgY3VycmVudGx5IHBsYXlpbmcgc291bmRzIGFuZCBzdG9yZSByZWZzXG4gICAgICAgIGZ1bmN0aW9uIG9uSGlkZGVuKCkge1xuICAgICAgICAgICAgZ3JvdXAuc291bmRzLmZvckVhY2goZnVuY3Rpb24gKHNvdW5kKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNvdW5kLnBsYXlpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgc291bmQucGF1c2UoKTtcbiAgICAgICAgICAgICAgICAgICAgcGFnZUhpZGRlblBhdXNlZC5wdXNoKHNvdW5kKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHBsYXkgc291bmRzIHRoYXQgZ290IHBhdXNlZCB3aGVuIHBhZ2Ugd2FzIGhpZGRlblxuICAgICAgICBmdW5jdGlvbiBvblNob3duKCkge1xuICAgICAgICAgICAgd2hpbGUgKHBhZ2VIaWRkZW5QYXVzZWQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcGFnZUhpZGRlblBhdXNlZC5wb3AoKS5wbGF5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBicm93c2VyLmhhbmRsZVBhZ2VWaXNpYmlsaXR5KG9uSGlkZGVuLCBvblNob3duKTtcbiAgICB9KSgpO1xuXG4gICAgLypcbiAgICAgKiBMb2cgdmVyc2lvbiAmIGRldmljZSBzdXBwb3J0IGluZm9cbiAgICAgKi9cblxuICAgIGZ1bmN0aW9uIGxvZygpIHtcbiAgICAgICAgdmFyIHRpdGxlID0gJ3Nvbm8gJyArIFZFUlNJT04sXG4gICAgICAgICAgICBpbmZvID0gJ1N1cHBvcnRlZDonICsgYXBpLmlzU3VwcG9ydGVkICsgJyBXZWJBdWRpb0FQSTonICsgYXBpLmhhc1dlYkF1ZGlvICsgJyBUb3VjaExvY2tlZDonICsgaXNUb3VjaExvY2tlZCArICcgU3RhdGU6JyArIChjb250ZXh0ICYmIGNvbnRleHQuc3RhdGUpICsgJyBFeHRlbnNpb25zOicgKyBmaWxlLmV4dGVuc2lvbnM7XG5cbiAgICAgICAgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZignQ2hyb21lJykgPiAtMSkge1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbJyVjIOKZqyAnICsgdGl0bGUgKyAnIOKZqyAlYyAnICsgaW5mbyArICcgJywgJ2NvbG9yOiAjRkZGRkZGOyBiYWNrZ3JvdW5kOiAjMzc5RjdBJywgJ2NvbG9yOiAjMUYxQzBEOyBiYWNrZ3JvdW5kOiAjRTBGQkFDJ107XG4gICAgICAgICAgICBjb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBhcmdzKTtcbiAgICAgICAgfSBlbHNlIGlmICh3aW5kb3cuY29uc29sZSAmJiB3aW5kb3cuY29uc29sZS5sb2cuY2FsbCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2cuY2FsbChjb25zb2xlLCB0aXRsZSArICcgJyArIGluZm8pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXBpID0ge1xuICAgICAgICBjcmVhdGVTb3VuZDogY3JlYXRlU291bmQsXG4gICAgICAgIGNyZWF0ZTogY3JlYXRlU291bmQsXG4gICAgICAgIGRlc3Ryb3lTb3VuZDogZGVzdHJveVNvdW5kLFxuICAgICAgICBkZXN0cm95QWxsOiBkZXN0cm95QWxsLFxuICAgICAgICBnZXRTb3VuZDogZ2V0U291bmQsXG4gICAgICAgIGNyZWF0ZUdyb3VwOiBjcmVhdGVHcm91cCxcbiAgICAgICAgZmlsZTogZmlsZSxcbiAgICAgICAgbG9hZDogbG9hZCxcbiAgICAgICAgbXV0ZTogbXV0ZSxcbiAgICAgICAgdW5NdXRlOiB1bk11dGUsXG4gICAgICAgIGZhZGU6IGZhZGUsXG4gICAgICAgIHBhdXNlQWxsOiBwYXVzZUFsbCxcbiAgICAgICAgcmVzdW1lQWxsOiByZXN1bWVBbGwsXG4gICAgICAgIHN0b3BBbGw6IHN0b3BBbGwsXG4gICAgICAgIHBsYXk6IHBsYXksXG4gICAgICAgIHBhdXNlOiBwYXVzZSxcbiAgICAgICAgc3RvcDogc3RvcCxcbiAgICAgICAgbG9nOiBsb2csXG5cbiAgICAgICAgY2FuUGxheTogZmlsZS5jYW5QbGF5LFxuICAgICAgICBjb250ZXh0OiBjb250ZXh0LFxuICAgICAgICBnZXRPZmZsaW5lQ29udGV4dDogdXRpbHMuZ2V0T2ZmbGluZUNvbnRleHQsXG4gICAgICAgIGVmZmVjdDogZ3JvdXAuZWZmZWN0LFxuICAgICAgICBleHRlbnNpb25zOiBmaWxlLmV4dGVuc2lvbnMsXG4gICAgICAgIGhhc1dlYkF1ZGlvOiAhIWNvbnRleHQsXG4gICAgICAgIGlzU3VwcG9ydGVkOiBmaWxlLmV4dGVuc2lvbnMubGVuZ3RoID4gMCxcbiAgICAgICAgZ2FpbjogZ3JvdXAuZ2FpbixcbiAgICAgICAgdXRpbHM6IHV0aWxzLFxuICAgICAgICBWRVJTSU9OOiBWRVJTSU9OLFxuXG4gICAgICAgIFNvdW5kOiBTb3VuZCxcbiAgICAgICAgR3JvdXA6IEdyb3VwXG4gICAgfTtcblxuICAgIC8qXG4gICAgICogR2V0dGVycyAmIFNldHRlcnNcbiAgICAgKi9cblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGFwaSwge1xuICAgICAgICBpc1RvdWNoTG9ja2VkOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaXNUb3VjaExvY2tlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgc291bmRzOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZ3JvdXAuc291bmRzLnNsaWNlKDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB2b2x1bWU6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBncm91cC52b2x1bWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBncm91cC52b2x1bWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIE9iamVjdC5mcmVlemUoYXBpKTtcbn1cblxudmFyIHNvbm8gPSBuZXcgU29ubygpO1xuXG5yZXR1cm4gc29ubztcblxufSkpKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNvbm8uanMubWFwXG4iXX0="}