{"version":3,"sources":["node_modules/browser-pack/_prelude.js","dev/javascripts/app.js","dev/javascripts/vendors/modernizr.js","dev/javascripts/xp/xp.js","node_modules/sono/dist/sono.js"],"names":[],"mappings":"AAAA;ACAA;;AAEA;AACA;AACA;;AACA;;AAOA;;;;;;AANA;;AAEA;AACA;AACA,QAAQ,GAAR,CAAY,4CAAZ,EAA0D,+BAA1D;;;;;;;;ACVA;;;;;;;;;;;;;;;;AAgBA;;;;;;;;AAQA,CAAC,CAAC,UAAS,MAAT,EAAiB,QAAjB,EAA2B,SAA3B,EAAqC;AACrC,MAAI,UAAU,EAAd;;AAGA,MAAI,QAAQ,EAAZ;;AAGA;;;;;;;;AAQA,MAAI,iBAAiB;AACnB;AACA,cAAU,OAFS;;AAInB;AACA;AACA,aAAS;AACP,qBAAe,EADR;AAEP,uBAAiB,IAFV;AAGP,uBAAiB,IAHV;AAIP,qBAAe;AAJR,KANU;;AAanB;AACA,QAAI,EAde;;AAgBnB;AACA,QAAI,YAAS,IAAT,EAAe,EAAf,EAAmB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,UAAI,OAAO,IAAX;AACA,iBAAW,YAAW;AACpB,WAAG,KAAK,IAAL,CAAH;AACD,OAFD,EAEG,CAFH;AAGD,KA5BkB;;AA8BnB,aAAS,iBAAS,IAAT,EAAe,EAAf,EAAmB,OAAnB,EAA4B;AACnC,YAAM,IAAN,CAAW,EAAC,MAAM,IAAP,EAAa,IAAI,EAAjB,EAAqB,SAAS,OAA9B,EAAX;AACD,KAhCkB;;AAkCnB,kBAAc,sBAAS,EAAT,EAAa;AACzB,YAAM,IAAN,CAAW,EAAC,MAAM,IAAP,EAAa,IAAI,EAAjB,EAAX;AACD;AApCkB,GAArB;;AAyCA;AACA,MAAI,YAAY,qBAAW,CAAE,CAA7B;AACA,YAAU,SAAV,GAAsB,cAAtB;;AAEA;AACA;AACA,cAAY,IAAI,SAAJ,EAAZ;;AAGF;;;;;;;;;;;;;;;;;AAiBA;;;;AAIE,YAAU,OAAV,CAAkB,SAAlB,EAA6B,YAAW;AACtC;AACA;AACA;AACA;AACA,QAAI,KAAK,UAAU,SAAnB;;AAEA;AACA;AACA,QAAI,CAAC,GAAG,OAAH,CAAW,YAAX,MAA6B,CAAC,CAA9B,IACA,GAAG,OAAH,CAAW,aAAX,MAA8B,CAAC,CADhC,KAEA,GAAG,OAAH,CAAW,eAAX,MAAgC,CAAC,CAFjC,IAGA,GAAG,OAAH,CAAW,QAAX,MAAyB,CAAC,CAH1B,IAIA,GAAG,OAAH,CAAW,eAAX,MAAgC,CAAC,CAJrC,EAIwC;AACtC,aAAO,KAAP;AACD;;AAED;AACA,WAAQ,OAAO,OAAP,IAAkB,eAAe,OAAO,OAAhD;AACD,GAnBD;;AAsBA;;;;;;;;;;AAUA,WAAS,EAAT,CAAY,GAAZ,EAAiB,IAAjB,EAAuB;AACrB,WAAO,QAAO,GAAP,yCAAO,GAAP,OAAe,IAAtB;AACD;AACD;;AAEA;;;;;;AAMA,WAAS,UAAT,GAAsB;AACpB,QAAI,YAAJ;AACA,QAAI,OAAJ;AACA,QAAI,QAAJ;AACA,QAAI,MAAJ;AACA,QAAI,OAAJ;AACA,QAAI,WAAJ;AACA,QAAI,gBAAJ;;AAEA,SAAK,IAAI,UAAT,IAAuB,KAAvB,EAA8B;AAC5B,UAAI,MAAM,cAAN,CAAqB,UAArB,CAAJ,EAAsC;AACpC,uBAAe,EAAf;AACA,kBAAU,MAAM,UAAN,CAAV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAI,QAAQ,IAAZ,EAAkB;AAChB,uBAAa,IAAb,CAAkB,QAAQ,IAAR,CAAa,WAAb,EAAlB;;AAEA,cAAI,QAAQ,OAAR,IAAmB,QAAQ,OAAR,CAAgB,OAAnC,IAA8C,QAAQ,OAAR,CAAgB,OAAhB,CAAwB,MAA1E,EAAkF;AAChF;AACA,iBAAK,WAAW,CAAhB,EAAmB,WAAW,QAAQ,OAAR,CAAgB,OAAhB,CAAwB,MAAtD,EAA8D,UAA9D,EAA0E;AACxE,2BAAa,IAAb,CAAkB,QAAQ,OAAR,CAAgB,OAAhB,CAAwB,QAAxB,EAAkC,WAAlC,EAAlB;AACD;AACF;AACF;;AAED;AACA,iBAAS,GAAG,QAAQ,EAAX,EAAe,UAAf,IAA6B,QAAQ,EAAR,EAA7B,GAA4C,QAAQ,EAA7D;;AAGA;AACA,aAAK,UAAU,CAAf,EAAkB,UAAU,aAAa,MAAzC,EAAiD,SAAjD,EAA4D;AAC1D,wBAAc,aAAa,OAAb,CAAd;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAAmB,YAAY,KAAZ,CAAkB,GAAlB,CAAnB;;AAEA,cAAI,iBAAiB,MAAjB,KAA4B,CAAhC,EAAmC;AACjC,sBAAU,iBAAiB,CAAjB,CAAV,IAAiC,MAAjC;AACD,WAFD,MAEO;AACL;AACA;AACA,gBAAI,UAAU,iBAAiB,CAAjB,CAAV,KAAkC,EAAE,UAAU,iBAAiB,CAAjB,CAAV,aAA0C,OAA5C,CAAtC,EAA4F;AAC1F,wBAAU,iBAAiB,CAAjB,CAAV,IAAiC,IAAI,OAAJ,CAAY,UAAU,iBAAiB,CAAjB,CAAV,CAAZ,CAAjC;AACD;;AAED,sBAAU,iBAAiB,CAAjB,CAAV,EAA+B,iBAAiB,CAAjB,CAA/B,IAAsD,MAAtD;AACD;;AAED,kBAAQ,IAAR,CAAa,CAAC,SAAS,EAAT,GAAc,KAAf,IAAwB,iBAAiB,IAAjB,CAAsB,GAAtB,CAArC;AACD;AACF;AACF;AACF;AACD;;AAEA;;;;;;;AAOA,MAAI,aAAa,SAAS,eAA1B;;AAGA;;;;;;;AAOA,MAAI,QAAQ,WAAW,QAAX,CAAoB,WAApB,OAAsC,KAAlD;;AAGA;;;;;;;;AAQA;AACA;AACA,WAAS,UAAT,CAAoB,OAApB,EAA6B;AAC3B,QAAI,YAAY,WAAW,SAA3B;AACA,QAAI,cAAc,UAAU,OAAV,CAAkB,WAAlB,IAAiC,EAAnD;;AAEA,QAAI,KAAJ,EAAW;AACT,kBAAY,UAAU,OAAtB;AACD;;AAED;AACA;AACA,QAAI,UAAU,OAAV,CAAkB,aAAtB,EAAqC;AACnC,UAAI,OAAO,IAAI,MAAJ,CAAW,YAAY,WAAZ,GAA0B,cAArC,CAAX;AACA,kBAAY,UAAU,OAAV,CAAkB,IAAlB,EAAwB,OAAO,WAAP,GAAqB,MAA7C,CAAZ;AACD;;AAED,QAAI,UAAU,OAAV,CAAkB,aAAtB,EAAqC;AACnC;AACA,mBAAa,MAAM,WAAN,GAAoB,QAAQ,IAAR,CAAa,MAAM,WAAnB,CAAjC;AACA,cAAQ,WAAW,SAAX,CAAqB,OAArB,GAA+B,SAAvC,GAAmD,WAAW,SAAX,GAAuB,SAA1E;AACD;AAEF;;AAED;;AAEF;;;;;AAKE;AACA,MAAI,KAAJ;AACA,MAAI,CAAC,KAAL,EAAY;AACV;;;AAGA,KAAE,WAAS,MAAT,EAAiB,QAAjB,EAA2B;AAC3B;AACA;AACA,UAAI,UAAU,OAAd;;AAEA;AACA,UAAI,UAAU,OAAO,KAAP,IAAgB,EAA9B;;AAEA;AACA,UAAI,SAAS,oEAAb;;AAEA;AACA,UAAI,aAAa,4GAAjB;;AAEA;AACA,UAAI,mBAAJ;;AAEA;AACA,UAAI,UAAU,YAAd;;AAEA;AACA,UAAI,UAAU,CAAd;;AAEA;AACA,UAAI,cAAc,EAAlB;;AAEA;AACA,UAAI,uBAAJ;;AAEC,mBAAW;AACV,YAAI;AACF,cAAI,IAAI,SAAS,aAAT,CAAuB,GAAvB,CAAR;AACA,YAAE,SAAF,GAAc,aAAd;AACA;AACA,gCAAuB,YAAY,CAAnC;;AAEA,oCAA0B,EAAE,UAAF,CAAa,MAAb,IAAuB,CAAvB,IAA6B,YAAW;AAChE;AACC,qBAAS,aAAV,CAAyB,GAAzB;AACA,gBAAI,OAAO,SAAS,sBAAT,EAAX;AACA,mBACE,OAAO,KAAK,SAAZ,IAAyB,WAAzB,IACE,OAAO,KAAK,sBAAZ,IAAsC,WADxC,IAEE,OAAO,KAAK,aAAZ,IAA6B,WAHjC;AAKD,WATsD,EAAvD;AAUD,SAhBD,CAgBE,OAAM,CAAN,EAAS;AACT;AACA,gCAAsB,IAAtB;AACA,oCAA0B,IAA1B;AACD;AAEF,OAvBA,GAAD;;AAyBA;;AAEA;;;;;;;AAOA,eAAS,aAAT,CAAuB,aAAvB,EAAsC,OAAtC,EAA+C;AAC7C,YAAI,IAAI,cAAc,aAAd,CAA4B,GAA5B,CAAR;AAAA,YACE,SAAS,cAAc,oBAAd,CAAmC,MAAnC,EAA2C,CAA3C,KAAiD,cAAc,eAD1E;;AAGA,UAAE,SAAF,GAAc,aAAa,OAAb,GAAuB,UAArC;AACA,eAAO,OAAO,YAAP,CAAoB,EAAE,SAAtB,EAAiC,OAAO,UAAxC,CAAP;AACD;;AAED;;;;;AAKA,eAAS,WAAT,GAAuB;AACrB,YAAI,WAAW,MAAM,QAArB;AACA,eAAO,OAAO,QAAP,IAAmB,QAAnB,GAA8B,SAAS,KAAT,CAAe,GAAf,CAA9B,GAAoD,QAA3D;AACD;;AAED;;;;;;AAMA,eAAS,WAAT,CAAqB,WAArB,EAAkC,aAAlC,EAAiD;AAC/C,YAAI,WAAW,MAAM,QAArB;AACA,YAAG,OAAO,QAAP,IAAmB,QAAtB,EAA+B;AAC7B,qBAAW,SAAS,IAAT,CAAc,GAAd,CAAX;AACD;AACD,YAAG,OAAO,WAAP,IAAsB,QAAzB,EAAkC;AAChC,wBAAc,YAAY,IAAZ,CAAiB,GAAjB,CAAd;AACD;AACD,cAAM,QAAN,GAAiB,WAAU,GAAV,GAAe,WAAhC;AACA,qBAAa,aAAb;AACD;;AAED;;;;;;AAMA,eAAS,cAAT,CAAwB,aAAxB,EAAuC;AACrC,YAAI,OAAO,YAAY,cAAc,OAAd,CAAZ,CAAX;AACA,YAAI,CAAC,IAAL,EAAW;AACT,iBAAO,EAAP;AACA;AACA,wBAAc,OAAd,IAAyB,OAAzB;AACA,sBAAY,OAAZ,IAAuB,IAAvB;AACD;AACD,eAAO,IAAP;AACD;;AAED;;;;;;;AAOA,eAAS,aAAT,CAAuB,QAAvB,EAAiC,aAAjC,EAAgD,IAAhD,EAAqD;AACnD,YAAI,CAAC,aAAL,EAAoB;AAClB,0BAAgB,QAAhB;AACD;AACD,YAAG,uBAAH,EAA2B;AACzB,iBAAO,cAAc,aAAd,CAA4B,QAA5B,CAAP;AACD;AACD,YAAI,CAAC,IAAL,EAAW;AACT,iBAAO,eAAe,aAAf,CAAP;AACD;AACD,YAAI,IAAJ;;AAEA,YAAI,KAAK,KAAL,CAAW,QAAX,CAAJ,EAA0B;AACxB,iBAAO,KAAK,KAAL,CAAW,QAAX,EAAqB,SAArB,EAAP;AACD,SAFD,MAEO,IAAI,WAAW,IAAX,CAAgB,QAAhB,CAAJ,EAA+B;AACpC,iBAAO,CAAC,KAAK,KAAL,CAAW,QAAX,IAAuB,KAAK,UAAL,CAAgB,QAAhB,CAAxB,EAAmD,SAAnD,EAAP;AACD,SAFM,MAEA;AACL,iBAAO,KAAK,UAAL,CAAgB,QAAhB,CAAP;AACD;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAO,KAAK,eAAL,IAAwB,CAAC,OAAO,IAAP,CAAY,QAAZ,CAAzB,IAAkD,CAAC,KAAK,MAAxD,GAAiE,KAAK,IAAL,CAAU,WAAV,CAAsB,IAAtB,CAAjE,GAA+F,IAAtG;AACD;;AAED;;;;;;AAMA,eAAS,sBAAT,CAAgC,aAAhC,EAA+C,IAA/C,EAAoD;AAClD,YAAI,CAAC,aAAL,EAAoB;AAClB,0BAAgB,QAAhB;AACD;AACD,YAAG,uBAAH,EAA2B;AACzB,iBAAO,cAAc,sBAAd,EAAP;AACD;AACD,eAAO,QAAQ,eAAe,aAAf,CAAf;AACA,YAAI,QAAQ,KAAK,IAAL,CAAU,SAAV,EAAZ;AAAA,YACE,IAAI,CADN;AAAA,YAEE,QAAQ,aAFV;AAAA,YAGE,IAAI,MAAM,MAHZ;AAIA,eAAK,IAAE,CAAP,EAAS,GAAT,EAAa;AACX,gBAAM,aAAN,CAAoB,MAAM,CAAN,CAApB;AACD;AACD,eAAO,KAAP;AACD;;AAED;;;;;;AAMA,eAAS,WAAT,CAAqB,aAArB,EAAoC,IAApC,EAA0C;AACxC,YAAI,CAAC,KAAK,KAAV,EAAiB;AACf,eAAK,KAAL,GAAa,EAAb;AACA,eAAK,UAAL,GAAkB,cAAc,aAAhC;AACA,eAAK,UAAL,GAAkB,cAAc,sBAAhC;AACA,eAAK,IAAL,GAAY,KAAK,UAAL,EAAZ;AACD;;AAGD,sBAAc,aAAd,GAA8B,UAAS,QAAT,EAAmB;AAC/C;AACA,cAAI,CAAC,MAAM,WAAX,EAAwB;AACtB,mBAAO,KAAK,UAAL,CAAgB,QAAhB,CAAP;AACD;AACD,iBAAO,cAAc,QAAd,EAAwB,aAAxB,EAAuC,IAAvC,CAAP;AACD,SAND;;AAQA,sBAAc,sBAAd,GAAuC,SAAS,KAAT,EAAgB,uBACP,wCADO,GAEP,kBAFO;AAGP;AACA,sBAAc,IAAd,GAAqB,OAArB,CAA6B,WAA7B,EAA0C,UAAS,QAAT,EAAmB;AAC3G,eAAK,UAAL,CAAgB,QAAhB;AACA,eAAK,IAAL,CAAU,aAAV,CAAwB,QAAxB;AACA,iBAAO,QAAQ,QAAR,GAAmB,IAA1B;AACD,SAJ+C,CAJO,GASrD,aATqC,EAUU,KAVV,EAUiB,KAAK,IAVtB,CAAvC;AAWD;;AAED;;AAEA;;;;;;AAMA,eAAS,YAAT,CAAsB,aAAtB,EAAqC;AACnC,YAAI,CAAC,aAAL,EAAoB;AAClB,0BAAgB,QAAhB;AACD;AACD,YAAI,OAAO,eAAe,aAAf,CAAX;;AAEA,YAAI,MAAM,OAAN,IAAiB,CAAC,mBAAlB,IAAyC,CAAC,KAAK,MAAnD,EAA2D;AACzD,eAAK,MAAL,GAAc,CAAC,CAAC,cAAc,aAAd;AACc;AACA;AACA;AACA,4CAFA;AAGA;AACA,kCANd,CAAhB;AAQD;AACD,YAAI,CAAC,uBAAL,EAA8B;AAC5B,sBAAY,aAAZ,EAA2B,IAA3B;AACD;AACD,eAAO,aAAP;AACD;;AAED;;AAEA;;;;;;;;;AASA,UAAI,QAAQ;;AAEV;;;;;AAKA,oBAAY,QAAQ,QAAR,IAAoB,yLAPtB;;AASV;;;AAGA,mBAAW,OAZD;;AAcV;;;;;AAKA,mBAAY,QAAQ,OAAR,KAAoB,KAnBtB;;AAqBV;;;;;AAKA,mCAA2B,uBA1BjB;;AA4BV;;;;;;AAMA,uBAAgB,QAAQ,WAAR,KAAwB,KAlC9B;;AAoCV;;;;;AAKA,gBAAQ,SAzCE;;AA2CV;AACA,wBAAgB,YA5CN;;AA8CV;AACA,uBAAe,aA/CL;;AAiDV;AACA,gCAAwB,sBAlDd;;AAoDV;AACA,qBAAa;AArDH,OAAZ;;AAwDA;;AAEA;AACA,aAAO,KAAP,GAAe,KAAf;;AAEA;AACA,mBAAa,QAAb;;AAEA,UAAG,QAAO,MAAP,yCAAO,MAAP,MAAiB,QAAjB,IAA6B,OAAO,OAAvC,EAA+C;AAC7C,eAAO,OAAP,GAAiB,KAAjB;AACD;AAEF,KAlUC,EAkUA,OAAO,MAAP,KAAkB,WAAlB,GAAgC,MAAhC,GAAyC,IAlUzC,EAkU+C,QAlU/C,CAAD;AAmUF;AACH;;AAEE;;;;;;;;;;;AAWA,WAAS,aAAT,GAAyB;AACvB,QAAI,OAAO,SAAS,aAAhB,KAAkC,UAAtC,EAAkD;AAChD;AACA;AACA,aAAO,SAAS,aAAT,CAAuB,UAAU,CAAV,CAAvB,CAAP;AACD,KAJD,MAIO,IAAI,KAAJ,EAAW;AAChB,aAAO,SAAS,eAAT,CAAyB,IAAzB,CAA8B,QAA9B,EAAwC,4BAAxC,EAAsE,UAAU,CAAV,CAAtE,CAAP;AACD,KAFM,MAEA;AACL,aAAO,SAAS,aAAT,CAAuB,KAAvB,CAA6B,QAA7B,EAAuC,SAAvC,CAAP;AACD;AACF;;AAED;AACF;;;;;;;;;;AAUE,YAAU,OAAV,CAAkB,OAAlB,EAA2B,YAAW;AACpC,QAAI,SAAS,cAAc,QAAd,CAAb;AACA,QAAI,WAAW,6BAA6B,MAA7B,GAAsC,yBAAtC,GAAmE,iBAAlF;AACA,QAAI,YAAY,MAAhB,EAAwB;AACtB,aAAO,OAAO,QAAP,EAAiB,OAAjB,KAA6B,OAAO,QAAP,EAAiB,oBAAjB,CAApC;AACD;AACD,WAAO,2BAA2B,MAAlC;AACD,GAPD;;AAUA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCA;AACA;AACA,MAAI,WAAY,eAAe,OAAf,CAAuB,WAAvB,GAAqC,4BAA4B,KAA5B,CAAkC,GAAlC,CAArC,GAA8E,CAAC,EAAD,EAAI,EAAJ,CAA9F;;AAEA;AACA,iBAAe,SAAf,GAA2B,QAA3B;;AAGF;;;;;;;;;;AAUA;;;;;;;;;;AAUE,YAAU,OAAV,CAAkB,SAAlB,EAA6B,YAAW;AACtC,QAAI,OAAO,QAAX;AACA,QAAI,QAAQ,aAAZ;AACA,QAAI,KAAK,cAAc,GAAd,CAAT;;AAEA,OAAG,KAAH,CAAS,OAAT,GAAmB,OAAO,SAAS,IAAT,CAAc,QAAQ,IAAtB,CAA1B;;AAEA,WAAO,CAAC,CAAC,GAAG,KAAH,CAAS,MAAlB;AACD,GARD;;AAUF;;;;;;;;;;;;;;;;;;;;AAqBE,YAAU,OAAV,CAAkB,cAAlB,EAAkC,YAAW;;AAE3C,QAAI,OAAO,mBAAX;AACA,QAAI,OAAO,8DAAX;AACA,QAAI,MAAM,EAAV;AACA,QAAI,KAAJ;;AAEA,SAAK,IAAI,IAAI,CAAR,EAAW,MAAM,SAAS,MAAT,GAAkB,CAAxC,EAA2C,IAAI,GAA/C,EAAoD,GAApD,EAAyD;AACvD,cAAS,MAAM,CAAN,GAAU,KAAV,GAAkB,EAA3B;AACA,aAAO,OAAO,SAAS,CAAT,CAAP,GAAqB,kBAArB,GAA0C,KAA1C,GAAkD,yBAAzD;AACD;;AAED,QAAI,UAAU,OAAV,CAAkB,WAAtB,EAAmC;AACnC;AACE,aAAO,OAAO,UAAP,GAAoB,IAA3B;AACD;;AAED,QAAI,OAAO,cAAc,GAAd,CAAX;AACA,QAAI,QAAQ,KAAK,KAAjB;AACA,UAAM,OAAN,GAAgB,GAAhB;;AAEA;AACA,WAAO,CAAC,KAAK,MAAM,eAAZ,EAA6B,OAA7B,CAAqC,UAArC,IAAmD,CAAC,CAA3D;AACD,GAvBD;;AAyBF;;;;;;;;;;;;;;;;;;;;AAoBE,MAAI,YAAY,SAAS,MAAT,IAAmB,cAAc,OAAO,GAAxD;AACA,MAAI,YAAY,iBAAiB,MAAjC;AACA,YAAU,OAAV,CAAkB,UAAlB,EAA8B,aAAa,SAA3C;;AAGA;;;;;;;;;;AAUA,WAAS,OAAT,GAAmB;AACjB;AACA,QAAI,OAAO,SAAS,IAApB;;AAEA,QAAI,CAAC,IAAL,EAAW;AACT;AACA,aAAO,cAAc,QAAQ,KAAR,GAAgB,MAA9B,CAAP;AACA,WAAK,IAAL,GAAY,IAAZ;AACD;;AAED,WAAO,IAAP;AACD;;AAED;;AAEA;;;;;;;;;;;;AAYA,WAAS,uBAAT,CAAiC,IAAjC,EAAuC,QAAvC,EAAiD,KAAjD,EAAwD,SAAxD,EAAmE;AACjE,QAAI,MAAM,WAAV;AACA,QAAI,KAAJ;AACA,QAAI,GAAJ;AACA,QAAI,IAAJ;AACA,QAAI,WAAJ;AACA,QAAI,MAAM,cAAc,KAAd,CAAV;AACA,QAAI,OAAO,SAAX;;AAEA,QAAI,SAAS,KAAT,EAAgB,EAAhB,CAAJ,EAAyB;AACvB;AACA;AACA,aAAO,OAAP,EAAgB;AACd,eAAO,cAAc,KAAd,CAAP;AACA,aAAK,EAAL,GAAU,YAAY,UAAU,KAAV,CAAZ,GAA+B,OAAO,QAAQ,CAAf,CAAzC;AACA,YAAI,WAAJ,CAAgB,IAAhB;AACD;AACF;;AAED,YAAQ,cAAc,OAAd,CAAR;AACA,UAAM,IAAN,GAAa,UAAb;AACA,UAAM,EAAN,GAAW,MAAM,GAAjB;;AAEA;AACA;AACA,KAAC,CAAC,KAAK,IAAN,GAAa,GAAb,GAAmB,IAApB,EAA0B,WAA1B,CAAsC,KAAtC;AACA,SAAK,WAAL,CAAiB,GAAjB;;AAEA,QAAI,MAAM,UAAV,EAAsB;AACpB,YAAM,UAAN,CAAiB,OAAjB,GAA2B,IAA3B;AACD,KAFD,MAEO;AACL,YAAM,WAAN,CAAkB,SAAS,cAAT,CAAwB,IAAxB,CAAlB;AACD;AACD,QAAI,EAAJ,GAAS,GAAT;;AAEA,QAAI,KAAK,IAAT,EAAe;AACb;AACA,WAAK,KAAL,CAAW,UAAX,GAAwB,EAAxB;AACA;AACA,WAAK,KAAL,CAAW,QAAX,GAAsB,QAAtB;AACA,oBAAc,WAAW,KAAX,CAAiB,QAA/B;AACA,iBAAW,KAAX,CAAiB,QAAjB,GAA4B,QAA5B;AACA,iBAAW,WAAX,CAAuB,IAAvB;AACD;;AAED,UAAM,SAAS,GAAT,EAAc,IAAd,CAAN;AACA;AACA,QAAI,KAAK,IAAT,EAAe;AACb,WAAK,UAAL,CAAgB,WAAhB,CAA4B,IAA5B;AACA,iBAAW,KAAX,CAAiB,QAAjB,GAA4B,WAA5B;AACA;AACA,iBAAW,YAAX;AACD,KALD,MAKO;AACL,UAAI,UAAJ,CAAe,WAAf,CAA2B,GAA3B;AACD;;AAED,WAAO,CAAC,CAAC,GAAT;AAED;;AAED;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyDA,MAAI,aAAa,eAAe,UAAf,GAA4B,uBAA7C;;AAGA;;;;;;;;;;;;;;AAgBA,MAAI,aAAa,iBAAjB;;AAGA,MAAI,gBAAiB,eAAe,OAAf,CAAuB,WAAvB,GAAqC,WAAW,KAAX,CAAiB,GAAjB,CAArC,GAA6D,EAAlF;AACA,iBAAe,cAAf,GAAgC,aAAhC;;AAGA;;;;;;;;;;;;;;;;;;AAkBA,MAAI,cAAe,eAAe,OAAf,CAAuB,WAAvB,GAAqC,WAAW,WAAX,GAAyB,KAAzB,CAA+B,GAA/B,CAArC,GAA2E,EAA9F;AACA,iBAAe,YAAf,GAA8B,WAA9B;;AAIA;;;;;;;;;;AAUA,WAAS,QAAT,CAAkB,GAAlB,EAAuB,MAAvB,EAA+B;AAC7B,WAAO,CAAC,CAAC,CAAC,CAAC,KAAK,GAAN,EAAW,OAAX,CAAmB,MAAnB,CAAV;AACD;;AAED;;AAEA;;;;;;;;;;AAUA,WAAS,QAAT,CAAkB,IAAlB,EAAwB;AACtB,WAAO,KAAK,OAAL,CAAa,kBAAb,EAAiC,UAAS,GAAT,EAAc,EAAd,EAAkB,EAAlB,EAAsB;AAC5D,aAAO,KAAK,GAAG,WAAH,EAAZ;AACD,KAFM,EAEJ,OAFI,CAEI,IAFJ,EAEU,EAFV,CAAP;AAGD;AACD;;AAEA;;;;;;;;;;AAUA,WAAS,MAAT,CAAgB,EAAhB,EAAoB,IAApB,EAA0B;AACxB,WAAO,YAAW;AAChB,aAAO,GAAG,KAAH,CAAS,IAAT,EAAe,SAAf,CAAP;AACD,KAFD;AAGD;;AAED;;AAEA;;;;;;;;;;AAUA,WAAS,YAAT,CAAsB,KAAtB,EAA6B,GAA7B,EAAkC,IAAlC,EAAwC;AACtC,QAAI,IAAJ;;AAEA,SAAK,IAAI,CAAT,IAAc,KAAd,EAAqB;AACnB,UAAI,MAAM,CAAN,KAAY,GAAhB,EAAqB;;AAEnB;AACA,YAAI,SAAS,KAAb,EAAoB;AAClB,iBAAO,MAAM,CAAN,CAAP;AACD;;AAED,eAAO,IAAI,MAAM,CAAN,CAAJ,CAAP;;AAEA;AACA,YAAI,GAAG,IAAH,EAAS,UAAT,CAAJ,EAA0B;AACxB;AACA,iBAAO,OAAO,IAAP,EAAa,QAAQ,GAArB,CAAP;AACD;;AAED;AACA,eAAO,IAAP;AACD;AACF;AACD,WAAO,KAAP;AACD;;AAED;;AAEA;;;;;;AAMA,MAAI,UAAU;AACZ,UAAM,cAAc,WAAd;AADM,GAAd;;AAIA;AACA,YAAU,EAAV,CAAa,IAAb,CAAkB,YAAW;AAC3B,WAAO,QAAQ,IAAf;AACD,GAFD;;AAMA,MAAI,SAAS;AACX,WAAO,QAAQ,IAAR,CAAa;AADT,GAAb;;AAIA;AACA;AACA,YAAU,EAAV,CAAa,OAAb,CAAqB,YAAW;AAC9B,WAAO,OAAO,KAAd;AACD,GAFD;;AAMA;;;;;;;;;;AAUA,WAAS,QAAT,CAAkB,IAAlB,EAAwB;AACtB,WAAO,KAAK,OAAL,CAAa,UAAb,EAAyB,UAAS,GAAT,EAAc,EAAd,EAAkB;AAChD,aAAO,MAAM,GAAG,WAAH,EAAb;AACD,KAFM,EAEJ,OAFI,CAEI,MAFJ,EAEY,MAFZ,CAAP;AAGD;AACD;;AAEA;;;;;;;;;;;AAWA;AACA;AACA,WAAS,eAAT,CAAyB,KAAzB,EAAgC,KAAhC,EAAuC;AACrC,QAAI,IAAI,MAAM,MAAd;AACA;AACA,QAAI,SAAS,MAAT,IAAmB,cAAc,OAAO,GAA5C,EAAiD;AAC/C;AACA,aAAO,GAAP,EAAY;AACV,YAAI,OAAO,GAAP,CAAW,QAAX,CAAoB,SAAS,MAAM,CAAN,CAAT,CAApB,EAAwC,KAAxC,CAAJ,EAAoD;AAClD,iBAAO,IAAP;AACD;AACF;AACD,aAAO,KAAP;AACD;AACD;AATA,SAUK,IAAI,qBAAqB,MAAzB,EAAiC;AACpC;AACA,YAAI,gBAAgB,EAApB;AACA,eAAO,GAAP,EAAY;AACV,wBAAc,IAAd,CAAmB,MAAM,SAAS,MAAM,CAAN,CAAT,CAAN,GAA2B,GAA3B,GAAiC,KAAjC,GAAyC,GAA5D;AACD;AACD,wBAAgB,cAAc,IAAd,CAAmB,MAAnB,CAAhB;AACA,eAAO,wBAAwB,gBAAgB,aAAhB,GAAgC,0CAAxD,EAAoG,UAAS,IAAT,EAAe;AACxH,iBAAO,iBAAiB,IAAjB,EAAuB,IAAvB,EAA6B,QAA7B,IAAyC,UAAhD;AACD,SAFM,CAAP;AAGD;AACD,WAAO,SAAP;AACD;AACD;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,WAAS,SAAT,CAAmB,KAAnB,EAA0B,QAA1B,EAAoC,KAApC,EAA2C,aAA3C,EAA0D;AACxD,oBAAgB,GAAG,aAAH,EAAkB,WAAlB,IAAiC,KAAjC,GAAyC,aAAzD;;AAEA;AACA,QAAI,CAAC,GAAG,KAAH,EAAU,WAAV,CAAL,EAA6B;AAC3B,UAAI,SAAS,gBAAgB,KAAhB,EAAuB,KAAvB,CAAb;AACA,UAAI,CAAC,GAAG,MAAH,EAAW,WAAX,CAAL,EAA8B;AAC5B,eAAO,MAAP;AACD;AACF;;AAED;AACA,QAAI,SAAJ,EAAe,CAAf,EAAkB,WAAlB,EAA+B,IAA/B,EAAqC,MAArC;;AAEA;AACA;;AAEA;AACA;AACA;AACA,QAAI,QAAQ,CAAC,WAAD,EAAc,OAAd,CAAZ;AACA,WAAO,CAAC,OAAO,KAAf,EAAsB;AACpB,kBAAY,IAAZ;AACA,aAAO,OAAP,GAAiB,cAAc,MAAM,KAAN,EAAd,CAAjB;AACA,aAAO,KAAP,GAAe,OAAO,OAAP,CAAe,KAA9B;AACD;;AAED;AACA,aAAS,UAAT,GAAsB;AACpB,UAAI,SAAJ,EAAe;AACb,eAAO,OAAO,KAAd;AACA,eAAO,OAAO,OAAd;AACD;AACF;;AAED,kBAAc,MAAM,MAApB;AACA,SAAK,IAAI,CAAT,EAAY,IAAI,WAAhB,EAA6B,GAA7B,EAAkC;AAChC,aAAO,MAAM,CAAN,CAAP;AACA,eAAS,OAAO,KAAP,CAAa,IAAb,CAAT;;AAEA,UAAI,SAAS,IAAT,EAAe,GAAf,CAAJ,EAAyB;AACvB,eAAO,SAAS,IAAT,CAAP;AACD;;AAED,UAAI,OAAO,KAAP,CAAa,IAAb,MAAuB,SAA3B,EAAsC;;AAEpC;AACA;AACA;AACA,YAAI,CAAC,aAAD,IAAkB,CAAC,GAAG,KAAH,EAAU,WAAV,CAAvB,EAA+C;;AAE7C;AACA;AACA,cAAI;AACF,mBAAO,KAAP,CAAa,IAAb,IAAqB,KAArB;AACD,WAFD,CAEE,OAAO,CAAP,EAAU,CAAE;;AAEd;AACA;AACA;AACA;AACA,cAAI,OAAO,KAAP,CAAa,IAAb,KAAsB,MAA1B,EAAkC;AAChC;AACA,mBAAO,YAAY,KAAZ,GAAoB,IAApB,GAA2B,IAAlC;AACD;AACF;AACD;AACA;AAlBA,aAmBK;AACH;AACA,mBAAO,YAAY,KAAZ,GAAoB,IAApB,GAA2B,IAAlC;AACD;AACF;AACF;AACD;AACA,WAAO,KAAP;AACD;;AAED;;AAEA;;;;;;;;;;;;;;AAcA,WAAS,YAAT,CAAsB,IAAtB,EAA4B,QAA5B,EAAsC,IAAtC,EAA4C,KAA5C,EAAmD,aAAnD,EAAkE;;AAEhE,QAAI,SAAS,KAAK,MAAL,CAAY,CAAZ,EAAe,WAAf,KAA+B,KAAK,KAAL,CAAW,CAAX,CAA5C;AAAA,QACA,QAAQ,CAAC,OAAO,GAAP,GAAa,cAAc,IAAd,CAAmB,SAAS,GAA5B,CAAb,GAAgD,MAAjD,EAAyD,KAAzD,CAA+D,GAA/D,CADR;;AAGA;AACA,QAAI,GAAG,QAAH,EAAa,QAAb,KAA0B,GAAG,QAAH,EAAa,WAAb,CAA9B,EAAyD;AACvD,aAAO,UAAU,KAAV,EAAiB,QAAjB,EAA2B,KAA3B,EAAkC,aAAlC,CAAP;;AAEA;AACD,KAJD,MAIO;AACL,cAAQ,CAAC,OAAO,GAAP,GAAc,WAAD,CAAc,IAAd,CAAmB,SAAS,GAA5B,CAAb,GAAgD,MAAjD,EAAyD,KAAzD,CAA+D,GAA/D,CAAR;AACA,aAAO,aAAa,KAAb,EAAoB,QAApB,EAA8B,IAA9B,CAAP;AACD;AACF;;AAED;AACA;AACA;AACA;AACA;AACA,iBAAe,YAAf,GAA8B,YAA9B;;AAIA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqCA,WAAS,YAAT,CAAsB,IAAtB,EAA4B,KAA5B,EAAmC,aAAnC,EAAkD;AAChD,WAAO,aAAa,IAAb,EAAmB,SAAnB,EAA8B,SAA9B,EAAyC,KAAzC,EAAgD,aAAhD,CAAP;AACD;AACD,iBAAe,YAAf,GAA8B,YAA9B;;AAEF;;;;;;;;;;;;;;AAcA;;;;AAIE,YAAU,OAAV,CAAkB,eAAlB,EAAmC,aAAa,eAAb,EAA8B,GAA9B,EAAmC,IAAnC,CAAnC;;AAEF;;;;;;;;;;;;AAYE,YAAU,OAAV,CAAkB,iBAAlB,EAAqC,YAAW;AAC9C,QAAI,MAAM,CAAC,CAAC,aAAa,aAAb,EAA4B,KAA5B,EAAmC,IAAnC,CAAZ;AACA,QAAI,YAAY,UAAU,OAAV,CAAkB,WAAlC;;AAEA;AACA;AACA;AACA;AACA,QAAI,QAAQ,CAAC,SAAD,IAAc,uBAAuB,WAAW,KAAxD,CAAJ,EAAoE;AAClE,UAAI,EAAJ;AACA,UAAI,eAAe,8BAAnB;AACA;AACA,UAAI,UAAU,QAAd,EAAwB;AACtB,aAAK,8BAAL;AACD,OAFD,MAEO;AACL;AACA;AACA,aAAK,uBAAL;AACA,YAAI,SAAJ,EAAe;AACb,gBAAM,yBAAN;AACD;AACF;;AAED,YAAM,iEAAN;;AAEA,iBAAW,eAAe,EAA1B,EAA8B,UAAS,IAAT,EAAe;AAC3C,cAAM,KAAK,WAAL,KAAqB,CAArB,IAA0B,KAAK,YAAL,KAAsB,EAAtD;AACD,OAFD;AAGD;;AAED,WAAO,GAAP;AACD,GA/BD;;AAkCA;AACA;;AAEA;AACA,aAAW,OAAX;;AAEA,SAAO,eAAe,OAAtB;AACA,SAAO,eAAe,YAAtB;;AAEA;AACA,OAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,UAAU,EAAV,CAAa,MAAjC,EAAyC,GAAzC,EAA8C;AAC5C,cAAU,EAAV,CAAa,CAAb;AACD;;AAED;AACA,SAAO,SAAP,GAAmB,SAAnB;;AAGF;AAEC,CAp4CA,EAo4CE,MAp4CF,EAo4CU,QAp4CV;;;;;;;;;;;;;;;;;;ACxBD;;;;;;;;IAEM,E;AAEF,kBAAc;AAAA;;AAEV,gBAAQ,GAAR;;AAIA,aAAK,IAAL,GAAY,KAAK,IAAL,CAAU,IAAV,CAAe,IAAf,CAAZ;AACA,aAAK,MAAL,GAAc,KAAK,MAAL,CAAY,IAAZ,CAAiB,IAAjB,CAAd;AACA,aAAK,SAAL,GAAiB,KAAK,SAAL,CAAe,IAAf,CAAoB,IAApB,CAAjB;AACA,aAAK,aAAL,GAAqB,KAAK,aAAL,CAAmB,IAAnB,CAAwB,IAAxB,CAArB;;AAGA,aAAK,IAAL;AAGH;;;;+BAEM;;AAGH,iBAAK,EAAL,GAAU;AACN,yBAAS,SAAS,aAAT,CAAuB,OAAvB,CADH;AAEN,4BAAY,SAAS,aAAT,CAAuB,mBAAvB,CAFN;AAGN,4BAAY,SAAS,aAAT,CAAuB,mBAAvB,CAHN;AAIN,2BAAW,SAAS,aAAT,CAAuB,kBAAvB,CAJL;AAKN,wBAAQ,SAAS,aAAT,CAAuB,eAAvB,CALF;AAMN,yBAAS,SAAS,aAAT,CAAuB,UAAvB;AANH,aAAV;;AASA;AACA,iBAAK,QAAL,GAAgB,KAAI,OAAO,YAAP,IAAuB,OAAO,kBAAlC,GAAhB;;AAEA;AACA,iBAAK,QAAL,GAAgB,KAAK,QAAL,CAAc,cAAd,EAAhB;;AAEA;AACA,gBAAI,SAAS,KAAK,QAAL,CAAc,wBAAd,CAAuC,KAAK,EAAL,CAAQ,OAA/C,CAAb;AACA,mBAAO,OAAP,CAAe,KAAK,QAApB;AACA,iBAAK,QAAL,CAAc,OAAd,CAAsB,KAAK,QAAL,CAAc,WAApC;;AAGA;AACA,iBAAK,QAAL,CAAc,OAAd,GAAwB,KAAK,EAAL,CAAQ,OAAR,CAAgB,KAAxC;AACA;AACA,iBAAK,YAAL,GAAoB,KAAK,QAAL,CAAc,iBAAlC;AACA;AACA,iBAAK,SAAL,GAAiB,IAAI,UAAJ,CAAe,KAAK,YAApB,CAAjB;;AAGA,iBAAK,MAAL,GAAc,SAAS,aAAT,CAAuB,SAAvB,CAAd;AACA,iBAAK,MAAL,CAAY,KAAZ,GAAoB,OAAO,UAA3B;AACA,iBAAK,MAAL,CAAY,MAAZ,GAAqB,GAArB;AACA,oBAAQ,GAAR,CAAY,KAAK,MAAL,CAAY,KAAxB;AACA,iBAAK,SAAL,GAAiB,KAAK,MAAL,CAAY,UAAZ,CAAuB,IAAvB,CAAjB;AACA,iBAAK,SAAL,CAAe,SAAf,CAAyB,CAAzB,EAA4B,CAA5B,EAA+B,GAA/B,EAAoC,GAApC;;AAEA,oBAAQ,GAAR,CAAY,KAAK,YAAjB;;AAEA,iBAAK,MAAL;;AAEA,iBAAK,IAAL;AAGH;;;iCAEQ;;AAEL,iBAAK,EAAL,CAAQ,OAAR,CAAgB,gBAAhB,CAAiC,QAAjC,EAA2C,KAAK,SAAhD;AACA,mBAAO,gBAAP,CAAwB,QAAxB,EAAkC,KAAK,aAAvC;AAEH;;;kCAES,C,EAAG;AACT;AACA,iBAAK,QAAL,CAAc,OAAd,GAAwB,KAAK,EAAL,CAAQ,OAAR,CAAgB,KAAxC;AACA,iBAAK,YAAL,GAAoB,KAAK,QAAL,CAAc,iBAAlC;AACA,iBAAK,SAAL,GAAiB,IAAI,UAAJ,CAAe,KAAK,YAApB,CAAjB;;AAEA,oBAAQ,GAAR,CAAY,KAAK,YAAjB,EAA+B,KAAK,SAApC;AACH;;;wCAEe;AACZ,iBAAK,MAAL,CAAY,KAAZ,GAAoB,OAAO,UAA3B;AACH;;;+BAEM;;AAGH;AACA;AACA,iBAAK,QAAL,CAAc,oBAAd,CAAmC,KAAK,SAAxC;;AAEA;AACA,iBAAK,SAAL,CAAe,SAAf,GAA2B,cAA3B;AACA,iBAAK,SAAL,CAAe,QAAf,CAAwB,CAAxB,EAA2B,CAA3B,EAA8B,KAAK,MAAL,CAAY,KAA1C,EAAiD,GAAjD;;AAEA,gBAAI,WAAY,KAAK,MAAL,CAAY,KAAZ,GAAoB,KAAK,YAAzC;AACA,gBAAI,kBAAJ;AACA,gBAAI,IAAI,CAAR;;AAEA;AACA;;AAEA,iBAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,KAAK,YAAzB,EAAuC,GAAvC,EAA4C;AACxC,4BAAY,KAAK,SAAL,CAAe,CAAf,CAAZ;;AAEA,oBAAI,MAAM,IAAI,KAAK,YAAT,GAAwB,GAAlC;AACA,qBAAK,SAAL,CAAe,SAAf,GAA2B,SAAS,GAAT,GAAe,cAA1C;AACA,qBAAK,SAAL,CAAe,QAAf,CAAwB,CAAxB,EAA2B,KAAK,MAAL,CAAY,MAAZ,GAAqB,YAAY,CAAZ,GAAc,CAA9D,EAAiE,QAAjE,EAA2E,SAA3E;;AAEA,qBAAK,WAAW,CAAhB;AACH;;AAID,kCAAsB,KAAK,IAA3B;AAEH;;;;;;kBAMU,IAAI,EAAJ,E;;;AC/Hf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"app.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\n\n// Default Babel Polyfill, be careful, be sure you need it\n// because it's ~6000 lines of code unminified\n// import 'babel-polyfill';\nimport 'modernizr';\n// import * as tools from '@84paris/84.tools';\n\n// Your imports\n// import MyComponent from './component.es6'\nconsole.log('%c 84.Boilerplate ===== Your app is ready.', 'background: #000; color: #FFF');\n\nimport Xp from './xp/xp';\n\n","/*!\n * modernizr v3.3.1\n * Build http://modernizr.com/download?-cssanimations-csscalc-cssgradients-csstransforms3d-history-webgl-setclasses-shiv-dontmin\n *\n * Copyright (c)\n *  Faruk Ates\n *  Paul Irish\n *  Alex Sexton\n *  Ryan Seddon\n *  Patrick Kettner\n *  Stu Cox\n *  Richard Herrera\n\n * MIT License\n */\n\n/*\n * Modernizr tests which native CSS3 and HTML5 features are available in the\n * current UA and makes the results available to you in two ways: as properties on\n * a global `Modernizr` object, and as classes on the `<html>` element. This\n * information allows you to progressively enhance your pages with a granular level\n * of control over the experience.\n*/\n\n;(function(window, document, undefined){\n  var classes = [];\n\n\n  var tests = [];\n\n\n  /**\n   *\n   * ModernizrProto is the constructor for Modernizr\n   *\n   * @class\n   * @access public\n   */\n\n  var ModernizrProto = {\n    // The current version, dummy\n    _version: '3.3.1',\n\n    // Any settings that don't work as separate modules\n    // can go in here as configuration.\n    _config: {\n      'classPrefix': '',\n      'enableClasses': true,\n      'enableJSClass': true,\n      'usePrefixes': true\n    },\n\n    // Queue of tests\n    _q: [],\n\n    // Stub these for people who are listening\n    on: function(test, cb) {\n      // I don't really think people should do this, but we can\n      // safe guard it a bit.\n      // -- NOTE:: this gets WAY overridden in src/addTest for actual async tests.\n      // This is in case people listen to synchronous tests. I would leave it out,\n      // but the code to *disallow* sync tests in the real version of this\n      // function is actually larger than this.\n      var self = this;\n      setTimeout(function() {\n        cb(self[test]);\n      }, 0);\n    },\n\n    addTest: function(name, fn, options) {\n      tests.push({name: name, fn: fn, options: options});\n    },\n\n    addAsyncTest: function(fn) {\n      tests.push({name: null, fn: fn});\n    }\n  };\n\n\n\n  // Fake some of Object.create so we can force non test results to be non \"own\" properties.\n  var Modernizr = function() {};\n  Modernizr.prototype = ModernizrProto;\n\n  // Leak modernizr globally when you `require` it rather than force it here.\n  // Overwrite name so constructor name is nicer :D\n  Modernizr = new Modernizr();\n\n\n/*!\n{\n  \"name\": \"History API\",\n  \"property\": \"history\",\n  \"caniuse\": \"history\",\n  \"tags\": [\"history\"],\n  \"authors\": [\"Hay Kranen\", \"Alexander Farkas\"],\n  \"notes\": [{\n    \"name\": \"W3C Spec\",\n    \"href\": \"https://www.w3.org/TR/html51/browsers.html#the-history-interface\"\n  }, {\n    \"name\": \"MDN documentation\",\n    \"href\": \"https://developer.mozilla.org/en-US/docs/Web/API/window.history\"\n  }],\n  \"polyfills\": [\"historyjs\", \"html5historyapi\"]\n}\n!*/\n/* DOC\nDetects support for the History API for manipulating the browser session history.\n*/\n\n  Modernizr.addTest('history', function() {\n    // Issue #733\n    // The stock browser on Android 2.2 & 2.3, and 4.0.x returns positive on history support\n    // Unfortunately support is really buggy and there is no clean way to detect\n    // these bugs, so we fall back to a user agent sniff :(\n    var ua = navigator.userAgent;\n\n    // We only want Android 2 and 4.0, stock browser, and not Chrome which identifies\n    // itself as 'Mobile Safari' as well, nor Windows Phone (issue #1471).\n    if ((ua.indexOf('Android 2.') !== -1 ||\n        (ua.indexOf('Android 4.0') !== -1)) &&\n        ua.indexOf('Mobile Safari') !== -1 &&\n        ua.indexOf('Chrome') === -1 &&\n        ua.indexOf('Windows Phone') === -1) {\n      return false;\n    }\n\n    // Return the regular check\n    return (window.history && 'pushState' in window.history);\n  });\n\n\n  /**\n   * is returns a boolean if the typeof an obj is exactly type.\n   *\n   * @access private\n   * @function is\n   * @param {*} obj - A thing we want to check the type of\n   * @param {string} type - A string to compare the typeof against\n   * @returns {boolean}\n   */\n\n  function is(obj, type) {\n    return typeof obj === type;\n  }\n  ;\n\n  /**\n   * Run through all tests and detect their support in the current UA.\n   *\n   * @access private\n   */\n\n  function testRunner() {\n    var featureNames;\n    var feature;\n    var aliasIdx;\n    var result;\n    var nameIdx;\n    var featureName;\n    var featureNameSplit;\n\n    for (var featureIdx in tests) {\n      if (tests.hasOwnProperty(featureIdx)) {\n        featureNames = [];\n        feature = tests[featureIdx];\n        // run the test, throw the return value into the Modernizr,\n        // then based on that boolean, define an appropriate className\n        // and push it into an array of classes we'll join later.\n        //\n        // If there is no name, it's an 'async' test that is run,\n        // but not directly added to the object. That should\n        // be done with a post-run addTest call.\n        if (feature.name) {\n          featureNames.push(feature.name.toLowerCase());\n\n          if (feature.options && feature.options.aliases && feature.options.aliases.length) {\n            // Add all the aliases into the names list\n            for (aliasIdx = 0; aliasIdx < feature.options.aliases.length; aliasIdx++) {\n              featureNames.push(feature.options.aliases[aliasIdx].toLowerCase());\n            }\n          }\n        }\n\n        // Run the test, or use the raw value if it's not a function\n        result = is(feature.fn, 'function') ? feature.fn() : feature.fn;\n\n\n        // Set each of the names on the Modernizr object\n        for (nameIdx = 0; nameIdx < featureNames.length; nameIdx++) {\n          featureName = featureNames[nameIdx];\n          // Support dot properties as sub tests. We don't do checking to make sure\n          // that the implied parent tests have been added. You must call them in\n          // order (either in the test, or make the parent test a dependency).\n          //\n          // Cap it to TWO to make the logic simple and because who needs that kind of subtesting\n          // hashtag famous last words\n          featureNameSplit = featureName.split('.');\n\n          if (featureNameSplit.length === 1) {\n            Modernizr[featureNameSplit[0]] = result;\n          } else {\n            // cast to a Boolean, if not one already\n            /* jshint -W053 */\n            if (Modernizr[featureNameSplit[0]] && !(Modernizr[featureNameSplit[0]] instanceof Boolean)) {\n              Modernizr[featureNameSplit[0]] = new Boolean(Modernizr[featureNameSplit[0]]);\n            }\n\n            Modernizr[featureNameSplit[0]][featureNameSplit[1]] = result;\n          }\n\n          classes.push((result ? '' : 'no-') + featureNameSplit.join('-'));\n        }\n      }\n    }\n  }\n  ;\n\n  /**\n   * docElement is a convenience wrapper to grab the root element of the document\n   *\n   * @access private\n   * @returns {HTMLElement|SVGElement} The root element of the document\n   */\n\n  var docElement = document.documentElement;\n\n\n  /**\n   * A convenience helper to check if the document we are running in is an SVG document\n   *\n   * @access private\n   * @returns {boolean}\n   */\n\n  var isSVG = docElement.nodeName.toLowerCase() === 'svg';\n\n\n  /**\n   * setClasses takes an array of class names and adds them to the root element\n   *\n   * @access private\n   * @function setClasses\n   * @param {string[]} classes - Array of class names\n   */\n\n  // Pass in an and array of class names, e.g.:\n  //  ['no-webp', 'borderradius', ...]\n  function setClasses(classes) {\n    var className = docElement.className;\n    var classPrefix = Modernizr._config.classPrefix || '';\n\n    if (isSVG) {\n      className = className.baseVal;\n    }\n\n    // Change `no-js` to `js` (independently of the `enableClasses` option)\n    // Handle classPrefix on this too\n    if (Modernizr._config.enableJSClass) {\n      var reJS = new RegExp('(^|\\\\s)' + classPrefix + 'no-js(\\\\s|$)');\n      className = className.replace(reJS, '$1' + classPrefix + 'js$2');\n    }\n\n    if (Modernizr._config.enableClasses) {\n      // Add the new classes\n      className += ' ' + classPrefix + classes.join(' ' + classPrefix);\n      isSVG ? docElement.className.baseVal = className : docElement.className = className;\n    }\n\n  }\n\n  ;\n\n/**\n  * @optionName html5shiv\n  * @optionProp html5shiv\n  */\n\n  // Take the html5 variable out of the html5shiv scope so we can return it.\n  var html5;\n  if (!isSVG) {\n    /**\n     * @preserve HTML5 Shiv 3.7.3 | @afarkas @jdalton @jon_neal @rem | MIT/GPL2 Licensed\n     */\n    ;(function(window, document) {\n      /*jshint evil:true */\n      /** version */\n      var version = '3.7.3';\n\n      /** Preset options */\n      var options = window.html5 || {};\n\n      /** Used to skip problem elements */\n      var reSkip = /^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i;\n\n      /** Not all elements can be cloned in IE **/\n      var saveClones = /^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i;\n\n      /** Detect whether the browser supports default html5 styles */\n      var supportsHtml5Styles;\n\n      /** Name of the expando, to work with multiple documents or to re-shiv one document */\n      var expando = '_html5shiv';\n\n      /** The id for the the documents expando */\n      var expanID = 0;\n\n      /** Cached data for each document */\n      var expandoData = {};\n\n      /** Detect whether the browser supports unknown elements */\n      var supportsUnknownElements;\n\n      (function() {\n        try {\n          var a = document.createElement('a');\n          a.innerHTML = '<xyz></xyz>';\n          //if the hidden property is implemented we can assume, that the browser supports basic HTML5 Styles\n          supportsHtml5Styles = ('hidden' in a);\n\n          supportsUnknownElements = a.childNodes.length == 1 || (function() {\n            // assign a false positive if unable to shiv\n            (document.createElement)('a');\n            var frag = document.createDocumentFragment();\n            return (\n              typeof frag.cloneNode == 'undefined' ||\n                typeof frag.createDocumentFragment == 'undefined' ||\n                typeof frag.createElement == 'undefined'\n            );\n          }());\n        } catch(e) {\n          // assign a false positive if detection fails => unable to shiv\n          supportsHtml5Styles = true;\n          supportsUnknownElements = true;\n        }\n\n      }());\n\n      /*--------------------------------------------------------------------------*/\n\n      /**\n       * Creates a style sheet with the given CSS text and adds it to the document.\n       * @private\n       * @param {Document} ownerDocument The document.\n       * @param {String} cssText The CSS text.\n       * @returns {StyleSheet} The style element.\n       */\n      function addStyleSheet(ownerDocument, cssText) {\n        var p = ownerDocument.createElement('p'),\n          parent = ownerDocument.getElementsByTagName('head')[0] || ownerDocument.documentElement;\n\n        p.innerHTML = 'x<style>' + cssText + '</style>';\n        return parent.insertBefore(p.lastChild, parent.firstChild);\n      }\n\n      /**\n       * Returns the value of `html5.elements` as an array.\n       * @private\n       * @returns {Array} An array of shived element node names.\n       */\n      function getElements() {\n        var elements = html5.elements;\n        return typeof elements == 'string' ? elements.split(' ') : elements;\n      }\n\n      /**\n       * Extends the built-in list of html5 elements\n       * @memberOf html5\n       * @param {String|Array} newElements whitespace separated list or array of new element names to shiv\n       * @param {Document} ownerDocument The context document.\n       */\n      function addElements(newElements, ownerDocument) {\n        var elements = html5.elements;\n        if(typeof elements != 'string'){\n          elements = elements.join(' ');\n        }\n        if(typeof newElements != 'string'){\n          newElements = newElements.join(' ');\n        }\n        html5.elements = elements +' '+ newElements;\n        shivDocument(ownerDocument);\n      }\n\n      /**\n       * Returns the data associated to the given document\n       * @private\n       * @param {Document} ownerDocument The document.\n       * @returns {Object} An object of data.\n       */\n      function getExpandoData(ownerDocument) {\n        var data = expandoData[ownerDocument[expando]];\n        if (!data) {\n          data = {};\n          expanID++;\n          ownerDocument[expando] = expanID;\n          expandoData[expanID] = data;\n        }\n        return data;\n      }\n\n      /**\n       * returns a shived element for the given nodeName and document\n       * @memberOf html5\n       * @param {String} nodeName name of the element\n       * @param {Document|DocumentFragment} ownerDocument The context document.\n       * @returns {Object} The shived element.\n       */\n      function createElement(nodeName, ownerDocument, data){\n        if (!ownerDocument) {\n          ownerDocument = document;\n        }\n        if(supportsUnknownElements){\n          return ownerDocument.createElement(nodeName);\n        }\n        if (!data) {\n          data = getExpandoData(ownerDocument);\n        }\n        var node;\n\n        if (data.cache[nodeName]) {\n          node = data.cache[nodeName].cloneNode();\n        } else if (saveClones.test(nodeName)) {\n          node = (data.cache[nodeName] = data.createElem(nodeName)).cloneNode();\n        } else {\n          node = data.createElem(nodeName);\n        }\n\n        // Avoid adding some elements to fragments in IE < 9 because\n        // * Attributes like `name` or `type` cannot be set/changed once an element\n        //   is inserted into a document/fragment\n        // * Link elements with `src` attributes that are inaccessible, as with\n        //   a 403 response, will cause the tab/window to crash\n        // * Script elements appended to fragments will execute when their `src`\n        //   or `text` property is set\n        return node.canHaveChildren && !reSkip.test(nodeName) && !node.tagUrn ? data.frag.appendChild(node) : node;\n      }\n\n      /**\n       * returns a shived DocumentFragment for the given document\n       * @memberOf html5\n       * @param {Document} ownerDocument The context document.\n       * @returns {Object} The shived DocumentFragment.\n       */\n      function createDocumentFragment(ownerDocument, data){\n        if (!ownerDocument) {\n          ownerDocument = document;\n        }\n        if(supportsUnknownElements){\n          return ownerDocument.createDocumentFragment();\n        }\n        data = data || getExpandoData(ownerDocument);\n        var clone = data.frag.cloneNode(),\n          i = 0,\n          elems = getElements(),\n          l = elems.length;\n        for(;i<l;i++){\n          clone.createElement(elems[i]);\n        }\n        return clone;\n      }\n\n      /**\n       * Shivs the `createElement` and `createDocumentFragment` methods of the document.\n       * @private\n       * @param {Document|DocumentFragment} ownerDocument The document.\n       * @param {Object} data of the document.\n       */\n      function shivMethods(ownerDocument, data) {\n        if (!data.cache) {\n          data.cache = {};\n          data.createElem = ownerDocument.createElement;\n          data.createFrag = ownerDocument.createDocumentFragment;\n          data.frag = data.createFrag();\n        }\n\n\n        ownerDocument.createElement = function(nodeName) {\n          //abort shiv\n          if (!html5.shivMethods) {\n            return data.createElem(nodeName);\n          }\n          return createElement(nodeName, ownerDocument, data);\n        };\n\n        ownerDocument.createDocumentFragment = Function('h,f', 'return function(){' +\n                                                        'var n=f.cloneNode(),c=n.createElement;' +\n                                                        'h.shivMethods&&(' +\n                                                        // unroll the `createElement` calls\n                                                        getElements().join().replace(/[\\w\\-:]+/g, function(nodeName) {\n          data.createElem(nodeName);\n          data.frag.createElement(nodeName);\n          return 'c(\"' + nodeName + '\")';\n        }) +\n          ');return n}'\n                                                       )(html5, data.frag);\n      }\n\n      /*--------------------------------------------------------------------------*/\n\n      /**\n       * Shivs the given document.\n       * @memberOf html5\n       * @param {Document} ownerDocument The document to shiv.\n       * @returns {Document} The shived document.\n       */\n      function shivDocument(ownerDocument) {\n        if (!ownerDocument) {\n          ownerDocument = document;\n        }\n        var data = getExpandoData(ownerDocument);\n\n        if (html5.shivCSS && !supportsHtml5Styles && !data.hasCSS) {\n          data.hasCSS = !!addStyleSheet(ownerDocument,\n                                        // corrects block display not defined in IE6/7/8/9\n                                        'article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}' +\n                                        // adds styling not present in IE6/7/8/9\n                                        'mark{background:#FF0;color:#000}' +\n                                        // hides non-rendered elements\n                                        'template{display:none}'\n                                       );\n        }\n        if (!supportsUnknownElements) {\n          shivMethods(ownerDocument, data);\n        }\n        return ownerDocument;\n      }\n\n      /*--------------------------------------------------------------------------*/\n\n      /**\n       * The `html5` object is exposed so that more elements can be shived and\n       * existing shiving can be detected on iframes.\n       * @type Object\n       * @example\n       *\n       * // options can be changed before the script is included\n       * html5 = { 'elements': 'mark section', 'shivCSS': false, 'shivMethods': false };\n       */\n      var html5 = {\n\n        /**\n         * An array or space separated string of node names of the elements to shiv.\n         * @memberOf html5\n         * @type Array|String\n         */\n        'elements': options.elements || 'abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output picture progress section summary template time video',\n\n        /**\n         * current version of html5shiv\n         */\n        'version': version,\n\n        /**\n         * A flag to indicate that the HTML5 style sheet should be inserted.\n         * @memberOf html5\n         * @type Boolean\n         */\n        'shivCSS': (options.shivCSS !== false),\n\n        /**\n         * Is equal to true if a browser supports creating unknown/HTML5 elements\n         * @memberOf html5\n         * @type boolean\n         */\n        'supportsUnknownElements': supportsUnknownElements,\n\n        /**\n         * A flag to indicate that the document's `createElement` and `createDocumentFragment`\n         * methods should be overwritten.\n         * @memberOf html5\n         * @type Boolean\n         */\n        'shivMethods': (options.shivMethods !== false),\n\n        /**\n         * A string to describe the type of `html5` object (\"default\" or \"default print\").\n         * @memberOf html5\n         * @type String\n         */\n        'type': 'default',\n\n        // shivs the document according to the specified `html5` object options\n        'shivDocument': shivDocument,\n\n        //creates a shived element\n        createElement: createElement,\n\n        //creates a shived documentFragment\n        createDocumentFragment: createDocumentFragment,\n\n        //extends list of elements\n        addElements: addElements\n      };\n\n      /*--------------------------------------------------------------------------*/\n\n      // expose html5\n      window.html5 = html5;\n\n      // shiv the document\n      shivDocument(document);\n\n      if(typeof module == 'object' && module.exports){\n        module.exports = html5;\n      }\n\n    }(typeof window !== \"undefined\" ? window : this, document));\n  }\n;\n\n  /**\n   * createElement is a convenience wrapper around document.createElement. Since we\n   * use createElement all over the place, this allows for (slightly) smaller code\n   * as well as abstracting away issues with creating elements in contexts other than\n   * HTML documents (e.g. SVG documents).\n   *\n   * @access private\n   * @function createElement\n   * @returns {HTMLElement|SVGElement} An HTML or SVG element\n   */\n\n  function createElement() {\n    if (typeof document.createElement !== 'function') {\n      // This is the case in IE7, where the type of createElement is \"object\".\n      // For this reason, we cannot call apply() as Object is not a Function.\n      return document.createElement(arguments[0]);\n    } else if (isSVG) {\n      return document.createElementNS.call(document, 'http://www.w3.org/2000/svg', arguments[0]);\n    } else {\n      return document.createElement.apply(document, arguments);\n    }\n  }\n\n  ;\n/*!\n{\n  \"name\": \"WebGL\",\n  \"property\": \"webgl\",\n  \"caniuse\": \"webgl\",\n  \"tags\": [\"webgl\", \"graphics\"],\n  \"polyfills\": [\"jebgl\", \"cwebgl\", \"iewebgl\"]\n}\n!*/\n\n  Modernizr.addTest('webgl', function() {\n    var canvas = createElement('canvas');\n    var supports = 'probablySupportsContext' in canvas ? 'probablySupportsContext' :  'supportsContext';\n    if (supports in canvas) {\n      return canvas[supports]('webgl') || canvas[supports]('experimental-webgl');\n    }\n    return 'WebGLRenderingContext' in window;\n  });\n\n\n  /**\n   * List of property values to set for css tests. See ticket #21\n   * http://git.io/vUGl4\n   *\n   * @memberof Modernizr\n   * @name Modernizr._prefixes\n   * @optionName Modernizr._prefixes\n   * @optionProp prefixes\n   * @access public\n   * @example\n   *\n   * Modernizr._prefixes is the internal list of prefixes that we test against\n   * inside of things like [prefixed](#modernizr-prefixed) and [prefixedCSS](#-code-modernizr-prefixedcss). It is simply\n   * an array of kebab-case vendor prefixes you can use within your code.\n   *\n   * Some common use cases include\n   *\n   * Generating all possible prefixed version of a CSS property\n   * ```js\n   * var rule = Modernizr._prefixes.join('transform: rotate(20deg); ');\n   *\n   * rule === 'transform: rotate(20deg); webkit-transform: rotate(20deg); moz-transform: rotate(20deg); o-transform: rotate(20deg); ms-transform: rotate(20deg);'\n   * ```\n   *\n   * Generating all possible prefixed version of a CSS value\n   * ```js\n   * rule = 'display:' +  Modernizr._prefixes.join('flex; display:') + 'flex';\n   *\n   * rule === 'display:flex; display:-webkit-flex; display:-moz-flex; display:-o-flex; display:-ms-flex; display:flex'\n   * ```\n   */\n\n  // we use ['',''] rather than an empty array in order to allow a pattern of .`join()`ing prefixes to test\n  // values in feature detects to continue to work\n  var prefixes = (ModernizrProto._config.usePrefixes ? ' -webkit- -moz- -o- -ms- '.split(' ') : ['','']);\n\n  // expose these for the plugin API. Look in the source for how to join() them against your input\n  ModernizrProto._prefixes = prefixes;\n\n\n/*!\n{\n  \"name\": \"CSS Calc\",\n  \"property\": \"csscalc\",\n  \"caniuse\": \"calc\",\n  \"tags\": [\"css\"],\n  \"builderAliases\": [\"css_calc\"],\n  \"authors\": [\"@calvein\"]\n}\n!*/\n/* DOC\nMethod of allowing calculated values for length units. For example:\n\n```css\n//lem {\n  width: calc(100% - 3em);\n}\n```\n*/\n\n  Modernizr.addTest('csscalc', function() {\n    var prop = 'width:';\n    var value = 'calc(10px);';\n    var el = createElement('a');\n\n    el.style.cssText = prop + prefixes.join(value + prop);\n\n    return !!el.style.length;\n  });\n\n/*!\n{\n  \"name\": \"CSS Gradients\",\n  \"caniuse\": \"css-gradients\",\n  \"property\": \"cssgradients\",\n  \"tags\": [\"css\"],\n  \"knownBugs\": [\"False-positives on webOS (https://github.com/Modernizr/Modernizr/issues/202)\"],\n  \"notes\": [{\n    \"name\": \"Webkit Gradient Syntax\",\n    \"href\": \"https://webkit.org/blog/175/introducing-css-gradients/\"\n  },{\n    \"name\": \"Linear Gradient Syntax\",\n    \"href\": \"https://developer.mozilla.org/en-US/docs/Web/CSS/linear-gradient\"\n  },{\n    \"name\": \"W3C Gradient Spec\",\n    \"href\": \"https://drafts.csswg.org/css-images-3/#gradients\"\n  }]\n}\n!*/\n\n\n  Modernizr.addTest('cssgradients', function() {\n\n    var str1 = 'background-image:';\n    var str2 = 'gradient(linear,left top,right bottom,from(#9f9),to(white));';\n    var css = '';\n    var angle;\n\n    for (var i = 0, len = prefixes.length - 1; i < len; i++) {\n      angle = (i === 0 ? 'to ' : '');\n      css += str1 + prefixes[i] + 'linear-gradient(' + angle + 'left top, #9f9, white);';\n    }\n\n    if (Modernizr._config.usePrefixes) {\n    // legacy webkit syntax (FIXME: remove when syntax not in use anymore)\n      css += str1 + '-webkit-' + str2;\n    }\n\n    var elem = createElement('a');\n    var style = elem.style;\n    style.cssText = css;\n\n    // IE6 returns undefined so cast to string\n    return ('' + style.backgroundImage).indexOf('gradient') > -1;\n  });\n\n/*!\n{\n  \"name\": \"CSS Supports\",\n  \"property\": \"supports\",\n  \"caniuse\": \"css-featurequeries\",\n  \"tags\": [\"css\"],\n  \"builderAliases\": [\"css_supports\"],\n  \"notes\": [{\n    \"name\": \"W3 Spec\",\n    \"href\": \"http://dev.w3.org/csswg/css3-conditional/#at-supports\"\n  },{\n    \"name\": \"Related Github Issue\",\n    \"href\": \"github.com/Modernizr/Modernizr/issues/648\"\n  },{\n    \"name\": \"W3 Info\",\n    \"href\": \"http://dev.w3.org/csswg/css3-conditional/#the-csssupportsrule-interface\"\n  }]\n}\n!*/\n\n  var newSyntax = 'CSS' in window && 'supports' in window.CSS;\n  var oldSyntax = 'supportsCSS' in window;\n  Modernizr.addTest('supports', newSyntax || oldSyntax);\n\n\n  /**\n   * getBody returns the body of a document, or an element that can stand in for\n   * the body if a real body does not exist\n   *\n   * @access private\n   * @function getBody\n   * @returns {HTMLElement|SVGElement} Returns the real body of a document, or an\n   * artificially created element that stands in for the body\n   */\n\n  function getBody() {\n    // After page load injecting a fake body doesn't work so check if body exists\n    var body = document.body;\n\n    if (!body) {\n      // Can't use the real body create a fake one.\n      body = createElement(isSVG ? 'svg' : 'body');\n      body.fake = true;\n    }\n\n    return body;\n  }\n\n  ;\n\n  /**\n   * injectElementWithStyles injects an element with style element and some CSS rules\n   *\n   * @access private\n   * @function injectElementWithStyles\n   * @param {string} rule - String representing a css rule\n   * @param {function} callback - A function that is used to test the injected element\n   * @param {number} [nodes] - An integer representing the number of additional nodes you want injected\n   * @param {string[]} [testnames] - An array of strings that are used as ids for the additional nodes\n   * @returns {boolean}\n   */\n\n  function injectElementWithStyles(rule, callback, nodes, testnames) {\n    var mod = 'modernizr';\n    var style;\n    var ret;\n    var node;\n    var docOverflow;\n    var div = createElement('div');\n    var body = getBody();\n\n    if (parseInt(nodes, 10)) {\n      // In order not to give false positives we create a node for each test\n      // This also allows the method to scale for unspecified uses\n      while (nodes--) {\n        node = createElement('div');\n        node.id = testnames ? testnames[nodes] : mod + (nodes + 1);\n        div.appendChild(node);\n      }\n    }\n\n    style = createElement('style');\n    style.type = 'text/css';\n    style.id = 's' + mod;\n\n    // IE6 will false positive on some tests due to the style element inside the test div somehow interfering offsetHeight, so insert it into body or fakebody.\n    // Opera will act all quirky when injecting elements in documentElement when page is served as xml, needs fakebody too. #270\n    (!body.fake ? div : body).appendChild(style);\n    body.appendChild(div);\n\n    if (style.styleSheet) {\n      style.styleSheet.cssText = rule;\n    } else {\n      style.appendChild(document.createTextNode(rule));\n    }\n    div.id = mod;\n\n    if (body.fake) {\n      //avoid crashing IE8, if background image is used\n      body.style.background = '';\n      //Safari 5.13/5.1.4 OSX stops loading if ::-webkit-scrollbar is used and scrollbars are visible\n      body.style.overflow = 'hidden';\n      docOverflow = docElement.style.overflow;\n      docElement.style.overflow = 'hidden';\n      docElement.appendChild(body);\n    }\n\n    ret = callback(div, rule);\n    // If this is done after page load we don't want to remove the body so check if body exists\n    if (body.fake) {\n      body.parentNode.removeChild(body);\n      docElement.style.overflow = docOverflow;\n      // Trigger layout so kinetic scrolling isn't disabled in iOS6+\n      docElement.offsetHeight;\n    } else {\n      div.parentNode.removeChild(div);\n    }\n\n    return !!ret;\n\n  }\n\n  ;\n\n  /**\n   * testStyles injects an element with style element and some CSS rules\n   *\n   * @memberof Modernizr\n   * @name Modernizr.testStyles\n   * @optionName Modernizr.testStyles()\n   * @optionProp testStyles\n   * @access public\n   * @function testStyles\n   * @param {string} rule - String representing a css rule\n   * @param {function} callback - A function that is used to test the injected element\n   * @param {number} [nodes] - An integer representing the number of additional nodes you want injected\n   * @param {string[]} [testnames] - An array of strings that are used as ids for the additional nodes\n   * @returns {boolean}\n   * @example\n   *\n   * `Modernizr.testStyles` takes a CSS rule and injects it onto the current page\n   * along with (possibly multiple) DOM elements. This lets you check for features\n   * that can not be detected by simply checking the [IDL](https://developer.mozilla.org/en-US/docs/Mozilla/Developer_guide/Interface_development_guide/IDL_interface_rules).\n   *\n   * ```js\n   * Modernizr.testStyles('#modernizr { width: 9px; color: papayawhip; }', function(elem, rule) {\n   *   // elem is the first DOM node in the page (by default #modernizr)\n   *   // rule is the first argument you supplied - the CSS rule in string form\n   *\n   *   addTest('widthworks', elem.style.width === '9px')\n   * });\n   * ```\n   *\n   * If your test requires multiple nodes, you can include a third argument\n   * indicating how many additional div elements to include on the page. The\n   * additional nodes are injected as children of the `elem` that is returned as\n   * the first argument to the callback.\n   *\n   * ```js\n   * Modernizr.testStyles('#modernizr {width: 1px}; #modernizr2 {width: 2px}', function(elem) {\n   *   document.getElementById('modernizr').style.width === '1px'; // true\n   *   document.getElementById('modernizr2').style.width === '2px'; // true\n   *   elem.firstChild === document.getElementById('modernizr2'); // true\n   * }, 1);\n   * ```\n   *\n   * By default, all of the additional elements have an ID of `modernizr[n]`, where\n   * `n` is its index (e.g. the first additional, second overall is `#modernizr2`,\n   * the second additional is `#modernizr3`, etc.).\n   * If you want to have more meaningful IDs for your function, you can provide\n   * them as the fourth argument, as an array of strings\n   *\n   * ```js\n   * Modernizr.testStyles('#foo {width: 10px}; #bar {height: 20px}', function(elem) {\n   *   elem.firstChild === document.getElementById('foo'); // true\n   *   elem.lastChild === document.getElementById('bar'); // true\n   * }, 2, ['foo', 'bar']);\n   * ```\n   *\n   */\n\n  var testStyles = ModernizrProto.testStyles = injectElementWithStyles;\n\n\n  /**\n   * If the browsers follow the spec, then they would expose vendor-specific style as:\n   *   elem.style.WebkitBorderRadius\n   * instead of something like the following, which would be technically incorrect:\n   *   elem.style.webkitBorderRadius\n\n   * Webkit ghosts their properties in lowercase but Opera & Moz do not.\n   * Microsoft uses a lowercase `ms` instead of the correct `Ms` in IE8+\n   *   erik.eae.net/archives/2008/03/10/21.48.10/\n\n   * More here: github.com/Modernizr/Modernizr/issues/issue/21\n   *\n   * @access private\n   * @returns {string} The string representing the vendor-specific style properties\n   */\n\n  var omPrefixes = 'Moz O ms Webkit';\n\n\n  var cssomPrefixes = (ModernizrProto._config.usePrefixes ? omPrefixes.split(' ') : []);\n  ModernizrProto._cssomPrefixes = cssomPrefixes;\n\n\n  /**\n   * List of JavaScript DOM values used for tests\n   *\n   * @memberof Modernizr\n   * @name Modernizr._domPrefixes\n   * @optionName Modernizr._domPrefixes\n   * @optionProp domPrefixes\n   * @access public\n   * @example\n   *\n   * Modernizr._domPrefixes is exactly the same as [_prefixes](#modernizr-_prefixes), but rather\n   * than kebab-case properties, all properties are their Capitalized variant\n   *\n   * ```js\n   * Modernizr._domPrefixes === [ \"Moz\", \"O\", \"ms\", \"Webkit\" ];\n   * ```\n   */\n\n  var domPrefixes = (ModernizrProto._config.usePrefixes ? omPrefixes.toLowerCase().split(' ') : []);\n  ModernizrProto._domPrefixes = domPrefixes;\n\n\n\n  /**\n   * contains checks to see if a string contains another string\n   *\n   * @access private\n   * @function contains\n   * @param {string} str - The string we want to check for substrings\n   * @param {string} substr - The substring we want to search the first string for\n   * @returns {boolean}\n   */\n\n  function contains(str, substr) {\n    return !!~('' + str).indexOf(substr);\n  }\n\n  ;\n\n  /**\n   * cssToDOM takes a kebab-case string and converts it to camelCase\n   * e.g. box-sizing -> boxSizing\n   *\n   * @access private\n   * @function cssToDOM\n   * @param {string} name - String name of kebab-case prop we want to convert\n   * @returns {string} The camelCase version of the supplied name\n   */\n\n  function cssToDOM(name) {\n    return name.replace(/([a-z])-([a-z])/g, function(str, m1, m2) {\n      return m1 + m2.toUpperCase();\n    }).replace(/^-/, '');\n  }\n  ;\n\n  /**\n   * fnBind is a super small [bind](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind) polyfill.\n   *\n   * @access private\n   * @function fnBind\n   * @param {function} fn - a function you want to change `this` reference to\n   * @param {object} that - the `this` you want to call the function with\n   * @returns {function} The wrapped version of the supplied function\n   */\n\n  function fnBind(fn, that) {\n    return function() {\n      return fn.apply(that, arguments);\n    };\n  }\n\n  ;\n\n  /**\n   * testDOMProps is a generic DOM property test; if a browser supports\n   *   a certain property, it won't return undefined for it.\n   *\n   * @access private\n   * @function testDOMProps\n   * @param {array.<string>} props - An array of properties to test for\n   * @param {object} obj - An object or Element you want to use to test the parameters again\n   * @param {boolean|object} elem - An Element to bind the property lookup again. Use `false` to prevent the check\n   */\n  function testDOMProps(props, obj, elem) {\n    var item;\n\n    for (var i in props) {\n      if (props[i] in obj) {\n\n        // return the property name as a string\n        if (elem === false) {\n          return props[i];\n        }\n\n        item = obj[props[i]];\n\n        // let's bind a function\n        if (is(item, 'function')) {\n          // bind to obj unless overriden\n          return fnBind(item, elem || obj);\n        }\n\n        // return the unbound function or obj or value\n        return item;\n      }\n    }\n    return false;\n  }\n\n  ;\n\n  /**\n   * Create our \"modernizr\" element that we do most feature tests on.\n   *\n   * @access private\n   */\n\n  var modElem = {\n    elem: createElement('modernizr')\n  };\n\n  // Clean up this element\n  Modernizr._q.push(function() {\n    delete modElem.elem;\n  });\n\n\n\n  var mStyle = {\n    style: modElem.elem.style\n  };\n\n  // kill ref for gc, must happen before mod.elem is removed, so we unshift on to\n  // the front of the queue.\n  Modernizr._q.unshift(function() {\n    delete mStyle.style;\n  });\n\n\n\n  /**\n   * domToCSS takes a camelCase string and converts it to kebab-case\n   * e.g. boxSizing -> box-sizing\n   *\n   * @access private\n   * @function domToCSS\n   * @param {string} name - String name of camelCase prop we want to convert\n   * @returns {string} The kebab-case version of the supplied name\n   */\n\n  function domToCSS(name) {\n    return name.replace(/([A-Z])/g, function(str, m1) {\n      return '-' + m1.toLowerCase();\n    }).replace(/^ms-/, '-ms-');\n  }\n  ;\n\n  /**\n   * nativeTestProps allows for us to use native feature detection functionality if available.\n   * some prefixed form, or false, in the case of an unsupported rule\n   *\n   * @access private\n   * @function nativeTestProps\n   * @param {array} props - An array of property names\n   * @param {string} value - A string representing the value we want to check via @supports\n   * @returns {boolean|undefined} A boolean when @supports exists, undefined otherwise\n   */\n\n  // Accepts a list of property names and a single value\n  // Returns `undefined` if native detection not available\n  function nativeTestProps(props, value) {\n    var i = props.length;\n    // Start with the JS API: http://www.w3.org/TR/css3-conditional/#the-css-interface\n    if ('CSS' in window && 'supports' in window.CSS) {\n      // Try every prefixed variant of the property\n      while (i--) {\n        if (window.CSS.supports(domToCSS(props[i]), value)) {\n          return true;\n        }\n      }\n      return false;\n    }\n    // Otherwise fall back to at-rule (for Opera 12.x)\n    else if ('CSSSupportsRule' in window) {\n      // Build a condition string for every prefixed variant\n      var conditionText = [];\n      while (i--) {\n        conditionText.push('(' + domToCSS(props[i]) + ':' + value + ')');\n      }\n      conditionText = conditionText.join(' or ');\n      return injectElementWithStyles('@supports (' + conditionText + ') { #modernizr { position: absolute; } }', function(node) {\n        return getComputedStyle(node, null).position == 'absolute';\n      });\n    }\n    return undefined;\n  }\n  ;\n\n  // testProps is a generic CSS / DOM property test.\n\n  // In testing support for a given CSS property, it's legit to test:\n  //    `elem.style[styleName] !== undefined`\n  // If the property is supported it will return an empty string,\n  // if unsupported it will return undefined.\n\n  // We'll take advantage of this quick test and skip setting a style\n  // on our modernizr element, but instead just testing undefined vs\n  // empty string.\n\n  // Property names can be provided in either camelCase or kebab-case.\n\n  function testProps(props, prefixed, value, skipValueTest) {\n    skipValueTest = is(skipValueTest, 'undefined') ? false : skipValueTest;\n\n    // Try native detect first\n    if (!is(value, 'undefined')) {\n      var result = nativeTestProps(props, value);\n      if (!is(result, 'undefined')) {\n        return result;\n      }\n    }\n\n    // Otherwise do it properly\n    var afterInit, i, propsLength, prop, before;\n\n    // If we don't have a style element, that means we're running async or after\n    // the core tests, so we'll need to create our own elements to use\n\n    // inside of an SVG element, in certain browsers, the `style` element is only\n    // defined for valid tags. Therefore, if `modernizr` does not have one, we\n    // fall back to a less used element and hope for the best.\n    var elems = ['modernizr', 'tspan'];\n    while (!mStyle.style) {\n      afterInit = true;\n      mStyle.modElem = createElement(elems.shift());\n      mStyle.style = mStyle.modElem.style;\n    }\n\n    // Delete the objects if we created them.\n    function cleanElems() {\n      if (afterInit) {\n        delete mStyle.style;\n        delete mStyle.modElem;\n      }\n    }\n\n    propsLength = props.length;\n    for (i = 0; i < propsLength; i++) {\n      prop = props[i];\n      before = mStyle.style[prop];\n\n      if (contains(prop, '-')) {\n        prop = cssToDOM(prop);\n      }\n\n      if (mStyle.style[prop] !== undefined) {\n\n        // If value to test has been passed in, do a set-and-check test.\n        // 0 (integer) is a valid property value, so check that `value` isn't\n        // undefined, rather than just checking it's truthy.\n        if (!skipValueTest && !is(value, 'undefined')) {\n\n          // Needs a try catch block because of old IE. This is slow, but will\n          // be avoided in most cases because `skipValueTest` will be used.\n          try {\n            mStyle.style[prop] = value;\n          } catch (e) {}\n\n          // If the property value has changed, we assume the value used is\n          // supported. If `value` is empty string, it'll fail here (because\n          // it hasn't changed), which matches how browsers have implemented\n          // CSS.supports()\n          if (mStyle.style[prop] != before) {\n            cleanElems();\n            return prefixed == 'pfx' ? prop : true;\n          }\n        }\n        // Otherwise just return true, or the property name if this is a\n        // `prefixed()` call\n        else {\n          cleanElems();\n          return prefixed == 'pfx' ? prop : true;\n        }\n      }\n    }\n    cleanElems();\n    return false;\n  }\n\n  ;\n\n  /**\n   * testPropsAll tests a list of DOM properties we want to check against.\n   * We specify literally ALL possible (known and/or likely) properties on\n   * the element including the non-vendor prefixed one, for forward-\n   * compatibility.\n   *\n   * @access private\n   * @function testPropsAll\n   * @param {string} prop - A string of the property to test for\n   * @param {string|object} [prefixed] - An object to check the prefixed properties on. Use a string to skip\n   * @param {HTMLElement|SVGElement} [elem] - An element used to test the property and value against\n   * @param {string} [value] - A string of a css value\n   * @param {boolean} [skipValueTest] - An boolean representing if you want to test if value sticks when set\n   */\n  function testPropsAll(prop, prefixed, elem, value, skipValueTest) {\n\n    var ucProp = prop.charAt(0).toUpperCase() + prop.slice(1),\n    props = (prop + ' ' + cssomPrefixes.join(ucProp + ' ') + ucProp).split(' ');\n\n    // did they call .prefixed('boxSizing') or are we just testing a prop?\n    if (is(prefixed, 'string') || is(prefixed, 'undefined')) {\n      return testProps(props, prefixed, value, skipValueTest);\n\n      // otherwise, they called .prefixed('requestAnimationFrame', window[, elem])\n    } else {\n      props = (prop + ' ' + (domPrefixes).join(ucProp + ' ') + ucProp).split(' ');\n      return testDOMProps(props, prefixed, elem);\n    }\n  }\n\n  // Modernizr.testAllProps() investigates whether a given style property,\n  // or any of its vendor-prefixed variants, is recognized\n  //\n  // Note that the property names must be provided in the camelCase variant.\n  // Modernizr.testAllProps('boxSizing')\n  ModernizrProto.testAllProps = testPropsAll;\n\n\n\n  /**\n   * testAllProps determines whether a given CSS property is supported in the browser\n   *\n   * @memberof Modernizr\n   * @name Modernizr.testAllProps\n   * @optionName Modernizr.testAllProps()\n   * @optionProp testAllProps\n   * @access public\n   * @function testAllProps\n   * @param {string} prop - String naming the property to test (either camelCase or kebab-case)\n   * @param {string} [value] - String of the value to test\n   * @param {boolean} [skipValueTest=false] - Whether to skip testing that the value is supported when using non-native detection\n   * @example\n   *\n   * testAllProps determines whether a given CSS property, in some prefixed form,\n   * is supported by the browser.\n   *\n   * ```js\n   * testAllProps('boxSizing')  // true\n   * ```\n   *\n   * It can optionally be given a CSS value in string form to test if a property\n   * value is valid\n   *\n   * ```js\n   * testAllProps('display', 'block') // true\n   * testAllProps('display', 'penguin') // false\n   * ```\n   *\n   * A boolean can be passed as a third parameter to skip the value check when\n   * native detection (@supports) isn't available.\n   *\n   * ```js\n   * testAllProps('shapeOutside', 'content-box', true);\n   * ```\n   */\n\n  function testAllProps(prop, value, skipValueTest) {\n    return testPropsAll(prop, undefined, undefined, value, skipValueTest);\n  }\n  ModernizrProto.testAllProps = testAllProps;\n\n/*!\n{\n  \"name\": \"CSS Animations\",\n  \"property\": \"cssanimations\",\n  \"caniuse\": \"css-animation\",\n  \"polyfills\": [\"transformie\", \"csssandpaper\"],\n  \"tags\": [\"css\"],\n  \"warnings\": [\"Android < 4 will pass this test, but can only animate a single property at a time\"],\n  \"notes\": [{\n    \"name\" : \"Article: 'Dispelling the Android CSS animation myths'\",\n    \"href\": \"https://goo.gl/OGw5Gm\"\n  }]\n}\n!*/\n/* DOC\nDetects whether or not elements can be animated using CSS\n*/\n\n  Modernizr.addTest('cssanimations', testAllProps('animationName', 'a', true));\n\n/*!\n{\n  \"name\": \"CSS Transforms 3D\",\n  \"property\": \"csstransforms3d\",\n  \"caniuse\": \"transforms3d\",\n  \"tags\": [\"css\"],\n  \"warnings\": [\n    \"Chrome may occassionally fail this test on some systems; more info: https://code.google.com/p/chromium/issues/detail?id=129004\"\n  ]\n}\n!*/\n\n  Modernizr.addTest('csstransforms3d', function() {\n    var ret = !!testAllProps('perspective', '1px', true);\n    var usePrefix = Modernizr._config.usePrefixes;\n\n    // Webkit's 3D transforms are passed off to the browser's own graphics renderer.\n    //   It works fine in Safari on Leopard and Snow Leopard, but not in Chrome in\n    //   some conditions. As a result, Webkit typically recognizes the syntax but\n    //   will sometimes throw a false positive, thus we must do a more thorough check:\n    if (ret && (!usePrefix || 'webkitPerspective' in docElement.style)) {\n      var mq;\n      var defaultStyle = '#modernizr{width:0;height:0}';\n      // Use CSS Conditional Rules if available\n      if (Modernizr.supports) {\n        mq = '@supports (perspective: 1px)';\n      } else {\n        // Otherwise, Webkit allows this media query to succeed only if the feature is enabled.\n        // `@media (transform-3d),(-webkit-transform-3d){ ... }`\n        mq = '@media (transform-3d)';\n        if (usePrefix) {\n          mq += ',(-webkit-transform-3d)';\n        }\n      }\n\n      mq += '{#modernizr{width:7px;height:18px;margin:0;padding:0;border:0}}';\n\n      testStyles(defaultStyle + mq, function(elem) {\n        ret = elem.offsetWidth === 7 && elem.offsetHeight === 18;\n      });\n    }\n\n    return ret;\n  });\n\n\n  // Run each test\n  testRunner();\n\n  // Remove the \"no-js\" class if it exists\n  setClasses(classes);\n\n  delete ModernizrProto.addTest;\n  delete ModernizrProto.addAsyncTest;\n\n  // Run the things that are supposed to run after the tests\n  for (var i = 0; i < Modernizr._q.length; i++) {\n    Modernizr._q[i]();\n  }\n\n  // Leak Modernizr namespace\n  window.Modernizr = Modernizr;\n\n\n;\n\n})(window, document);\n","import sono from 'sono';\n\nclass Xp {\n\n    constructor() {\n\n        console.log(sono);\n\n\n\n        this.draw = this.draw.bind(this);\n        this.events = this.events.bind(this);\n        this.changeFtt = this.changeFtt.bind(this);\n        this.resizeHandler = this.resizeHandler.bind(this);\n\n\n        this.init();\n\n\n    }\n\n    init() {\n\n\n        this.ui = {\n            myAudio: document.querySelector('audio'),\n            frequencyB: document.querySelector('.frequency .block'),\n            amplitudeB: document.querySelector('.amplitude .block'),\n            waveFormB: document.querySelector('.waveForm .block'),\n            ptichB: document.querySelector('.pitch .block'),\n            formFtt: document.querySelector('.fttSize')\n        }\n\n        // New WebAudio API\n        this.audioCtx = new(window.AudioContext || window.webkitAudioContext)();\n\n        //  Create Analyser node\n        this.analyser = this.audioCtx.createAnalyser();\n\n        // Connect nodes together\n        var source = this.audioCtx.createMediaElementSource(this.ui.myAudio);\n        source.connect(this.analyser);\n        this.analyser.connect(this.audioCtx.destination);\n\n\n        // Set Fourier value\n        this.analyser.fftSize = this.ui.formFtt.value;\n        // Get frequency length ( fftSize / 2)\n        this.bufferLength = this.analyser.frequencyBinCount;\n        // Prepare array of frequencies\n        this.dataArray = new Uint8Array(this.bufferLength);\n\n\n        this.canvas = document.querySelector('.canvas');\n        this.canvas.width = window.innerWidth;\n        this.canvas.height = 300;\n        console.log(this.canvas.width);\n        this.canvasCtx = this.canvas.getContext('2d');\n        this.canvasCtx.clearRect(0, 0, 500, 500);\n\n        console.log(this.bufferLength);\n\n        this.events();\n\n        this.draw();\n\n\n    }\n\n    events() {\n\n        this.ui.formFtt.addEventListener('change', this.changeFtt);\n        window.addEventListener('resize', this.resizeHandler);\n\n    }\n\n    changeFtt(e) {\n        // Reset frequencies \n        this.analyser.fftSize = this.ui.formFtt.value;\n        this.bufferLength = this.analyser.frequencyBinCount;\n        this.dataArray = new Uint8Array(this.bufferLength);\n\n        console.log(this.bufferLength, this.dataArray);\n    }\n\n    resizeHandler() {\n        this.canvas.width = window.innerWidth;\n    }\n\n    draw() {\n\n\n        // .getByteFrequencyData() --> For bar graph visualisation (abscisse = Fréquence / ordonnée = intensité)\n        // .getByteTimeDomainData() --> For oscilloscope visualisation \n        this.analyser.getByteFrequencyData(this.dataArray);\n\n        // create background\n        this.canvasCtx.fillStyle = 'rgb(0, 0, 0)';\n        this.canvasCtx.fillRect(0, 0, this.canvas.width, 500);\n\n        let barWidth = (this.canvas.width / this.bufferLength);\n        let barHeight;\n        let x = 0;\n\n        // Value of first Bar\n        // console.log(this.dataArray[0]);\n\n        for (let i = 0; i < this.bufferLength; i++) {\n            barHeight = this.dataArray[i];\n\n            let hue = i / this.bufferLength * 360;\n            this.canvasCtx.fillStyle = 'hsl(' + hue + ', 100%, 50%)';\n            this.canvasCtx.fillRect(x, this.canvas.height - barHeight * 3/4, barWidth, barHeight);\n\n            x += barWidth + 1;\n        }\n\n\n\n        requestAnimationFrame(this.draw);\n\n    }\n\n\n}\n\n\nexport default new Xp();\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.sono = factory());\n}(this, (function () { 'use strict';\n\nvar browser = {};\n\nbrowser.handlePageVisibility = function (onHidden, onShown) {\n    var hidden = void 0,\n        visibilityChange = void 0;\n\n    if (typeof document.hidden !== 'undefined') {\n        hidden = 'hidden';\n        visibilityChange = 'visibilitychange';\n    } else if (typeof document.mozHidden !== 'undefined') {\n        hidden = 'mozHidden';\n        visibilityChange = 'mozvisibilitychange';\n    } else if (typeof document.msHidden !== 'undefined') {\n        hidden = 'msHidden';\n        visibilityChange = 'msvisibilitychange';\n    } else if (typeof document.webkitHidden !== 'undefined') {\n        hidden = 'webkitHidden';\n        visibilityChange = 'webkitvisibilitychange';\n    }\n\n    function onChange() {\n        if (document[hidden]) {\n            onHidden();\n        } else {\n            onShown();\n        }\n    }\n\n    if (typeof visibilityChange !== 'undefined') {\n        document.addEventListener(visibilityChange, onChange, false);\n    }\n};\n\nbrowser.handleTouchLock = function (context, onUnlock) {\n    var ua = navigator.userAgent,\n        locked = !!ua.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Windows Phone|SymbianOS/i);\n\n    function unlock() {\n        if (context && context.state === 'suspended') {\n            context.resume().then(function () {\n                var buffer = context.createBuffer(1, 1, 44100);\n                var source = context.createBufferSource();\n                source.buffer = buffer;\n                source.connect(context.destination);\n                source.start(0);\n                source.stop(0);\n                source.disconnect();\n\n                document.body.removeEventListener('touchend', unlock);\n                onUnlock();\n            });\n        } else {\n            document.body.removeEventListener('touchend', unlock);\n            onUnlock();\n        }\n    }\n\n    if (locked) {\n        document.body.addEventListener('touchend', unlock, false);\n    }\n\n    return locked;\n};\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj;\n};\n\n\n\n\n\nvar classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\n\n\n\n\n\n\n\n\nvar get$1 = function get$1(object, property, receiver) {\n  if (object === null) object = Function.prototype;\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent === null) {\n      return undefined;\n    } else {\n      return get$1(parent, property, receiver);\n    }\n  } else if (\"value\" in desc) {\n    return desc.value;\n  } else {\n    var getter = desc.get;\n\n    if (getter === undefined) {\n      return undefined;\n    }\n\n    return getter.call(receiver);\n  }\n};\n\nvar inherits = function (subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n};\n\n\n\n\n\n\n\n\n\n\n\nvar possibleConstructorReturn = function (self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n};\n\n\n\nvar set$1 = function set$1(object, property, value, receiver) {\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent !== null) {\n      set$1(parent, property, value, receiver);\n    }\n  } else if (\"value\" in desc && desc.writable) {\n    desc.value = value;\n  } else {\n    var setter = desc.set;\n\n    if (setter !== undefined) {\n      setter.call(receiver, value);\n    }\n  }\n\n  return value;\n};\n\nvar extensions = [];\nvar canPlay = {};\n\n/*\n * Initial tests\n */\n\nvar tests = [{\n    ext: 'ogg',\n    type: 'audio/ogg; codecs=\"vorbis\"'\n}, {\n    ext: 'mp3',\n    type: 'audio/mpeg;'\n}, {\n    ext: 'opus',\n    type: 'audio/ogg; codecs=\"opus\"'\n}, {\n    ext: 'wav',\n    type: 'audio/wav; codecs=\"1\"'\n}, {\n    ext: 'm4a',\n    type: 'audio/x-m4a;'\n}, {\n    ext: 'm4a',\n    type: 'audio/aac;'\n}];\n\nvar el = document.createElement('audio');\nif (el) {\n    tests.forEach(function (test) {\n        var canPlayType = !!el.canPlayType(test.type);\n        if (canPlayType && extensions.indexOf(test.ext) === -1) {\n            extensions.push(test.ext);\n        }\n        canPlay[test.ext] = canPlayType;\n    });\n    el = null;\n}\n\n/*\n * find a supported file\n */\n\nfunction getFileExtension(url) {\n    if (typeof url !== 'string') {\n        return '';\n    }\n    // from DataURL\n    if (url.slice(0, 5) === 'data:') {\n        var match = url.match(/data:audio\\/(ogg|mp3|opus|wav|m4a)/i);\n        if (match && match.length > 1) {\n            return match[1].toLowerCase();\n        }\n    }\n    // from Standard URL\n    url = url.split('?')[0];\n    url = url.slice(url.lastIndexOf('/') + 1);\n\n    var a = url.split('.');\n    if (a.length === 1 || a[0] === '' && a.length === 2) {\n        return '';\n    }\n    return a.pop().toLowerCase();\n}\n\nfunction getSupportedFile(fileNames) {\n    var name = void 0;\n\n    if (Array.isArray(fileNames)) {\n        // if array get the first one that works\n        for (var i = 0; i < fileNames.length; i++) {\n            name = fileNames[i];\n            var ext = getFileExtension(name);\n            if (extensions.indexOf(ext) > -1) {\n                break;\n            }\n        }\n    } else if ((typeof fileNames === 'undefined' ? 'undefined' : _typeof(fileNames)) === 'object') {\n        // if not array and is object\n        Object.keys(fileNames).some(function (key) {\n            name = fileNames[key];\n            var ext = getFileExtension(name);\n            return extensions.indexOf(ext) > -1;\n        });\n    }\n    // if string just return\n    return name || fileNames;\n}\n\n/*\n * infer file types\n */\n\nfunction isAudioBuffer(data) {\n    return !!(data && window.AudioBuffer && data instanceof window.AudioBuffer);\n}\n\nfunction isArrayBuffer(data) {\n    return !!(data && window.ArrayBuffer && data instanceof window.ArrayBuffer);\n}\n\nfunction isMediaElement(data) {\n    return !!(data && window.HTMLMediaElement && data instanceof window.HTMLMediaElement);\n}\n\nfunction isMediaStream(data) {\n    return !!(data && typeof data.getAudioTracks === 'function' && data.getAudioTracks().length && window.MediaStreamTrack && data.getAudioTracks()[0] instanceof window.MediaStreamTrack);\n}\n\nfunction isOscillatorType(data) {\n    return !!(data && typeof data === 'string' && (data === 'sine' || data === 'square' || data === 'sawtooth' || data === 'triangle'));\n}\n\nfunction isScriptConfig(data) {\n    return !!(data && (typeof data === 'undefined' ? 'undefined' : _typeof(data)) === 'object' && data.bufferSize && data.channels && data.callback);\n}\n\nfunction isURL(data) {\n    return !!(data && typeof data === 'string' && (data.indexOf('.') > -1 || data.slice(0, 5) === 'data:'));\n}\n\nfunction containsURL(config) {\n    if (!config || isMediaElement(config)) {\n        return false;\n    }\n    // string, array or object with src/url/data property that is string, array or arraybuffer\n    var src = config.src || config.url || config.data || config;\n    return isURL(src) || isArrayBuffer(src) || Array.isArray(src) && isURL(src[0]);\n}\n\nvar file = {\n    canPlay: canPlay,\n    containsURL: containsURL,\n    extensions: extensions,\n    getFileExtension: getFileExtension,\n    getSupportedFile: getSupportedFile,\n    isAudioBuffer: isAudioBuffer,\n    isMediaElement: isMediaElement,\n    isMediaStream: isMediaStream,\n    isOscillatorType: isOscillatorType,\n    isScriptConfig: isScriptConfig,\n    isURL: isURL\n};\n\nfunction Analyser(context, config) {\n    config = config || {};\n\n    var node = context.createAnalyser();\n\n    var fftSize = config.fftSize || 512,\n        freqFloat = !!config.float,\n        waveFloat = !!config.float,\n        waveform = void 0,\n        frequencies = void 0;\n\n    node.fftSize = fftSize; // frequencyBinCount will be half this value\n    node.smoothingTimeConstant = config.smoothing || config.smoothingTimeConstant || node.smoothingTimeConstant;\n    node.minDecibels = config.minDecibels || node.minDecibels;\n    node.maxDecibels = config.maxDecibels || node.maxDecibels;\n\n    //the worker returns a normalized value\n    //first a sum of all magnitudes devided by the byteLength, then devide  by half the fft (1channel)\n    var amplitudeBlob = new Blob(['onmessage=function(e){var data=e.data;var f=new Float32Array(data.b);for(var i=0;i<f.length;i++){data.sum+=f[i]}data.sum/=f.length;postMessage(Math.max(1.0-(data.sum/data.numSamples*-1.0),0))};']);\n    var pitchBlob = new Blob(['onmessage=function(e){var data=e.data;var sampleRate=data.sampleRate;var buf=new Float32Array(data.b);var SIZE=buf.length;var MAX_SAMPLES=Math.floor(SIZE/2);var best_offset=-1;var best_correlation=0;var rms=0;var foundGoodCorrelation=false;var correlations=new Array(MAX_SAMPLES);for(var i=0;i<SIZE;i++){var val=buf[i];rms+=val*val}rms=Math.sqrt(rms/SIZE);if (rms<0.01){postMessage(-1)}else{var lastCorrelation=1;for(var offset=0;offset<MAX_SAMPLES;offset++){var correlation=0;for(var i=0;i<MAX_SAMPLES;i++){correlation+=Math.abs((buf[i])-(buf[i+offset]))}correlation=1-(correlation/MAX_SAMPLES);correlations[offset]=correlation;if ((correlation>0.9)&&(correlation>lastCorrelation)){foundGoodCorrelation=true;if (correlation>best_correlation){best_correlation=correlation;best_offset=offset}}else if (foundGoodCorrelation){var shift=(correlations[best_offset+1]-correlations[best_offset-1])/correlations[best_offset];postMessage(sampleRate/(best_offset+(8*shift)))}lastCorrelation=correlation}if (best_correlation>0.01){postMessage(sampleRate/best_offset)}else{postMessage(-1)}}};']);\n    var amplitudeBlobURL = URL.createObjectURL(amplitudeBlob);\n    var amplitudeWorker = new Worker(amplitudeBlobURL);\n    var pitchBlobURL = URL.createObjectURL(pitchBlob);\n    var pitchWorker = new Worker(pitchBlobURL);\n\n    var amplitudeCallback = null;\n    var noteStrings = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n    var pitchCallback = null;\n    var pitchCallbackObject = {\n        hertz: null, //number\n        note: null, //string\n        noteIndex: null, //int\n        detuneCents: null, //number\n        detune: null //string\n    };\n\n    function noteFromPitch(frequency) {\n        var noteNum = 12 * (Math.log(frequency / 440) / Math.log(2));\n        return Math.round(noteNum) + 69;\n    }\n\n    function frequencyFromNoteNumber(note) {\n        return 440 * Math.pow(2, (note - 69) / 12);\n    }\n\n    function centsOffFromPitch(frequency, note) {\n        return Math.floor(1200 * Math.log(frequency / frequencyFromNoteNumber(note)) / Math.log(2));\n    }\n\n    amplitudeWorker.onmessage = function (e) {\n        if (amplitudeCallback) {\n            amplitudeCallback(e.data);\n        }\n    };\n\n    pitchWorker.onmessage = function (e) {\n        if (pitchCallback) {\n            var Hz = e.data;\n            if (Hz !== -1) {\n                var note = noteFromPitch(Hz);\n                var detune = centsOffFromPitch(Hz, note);\n                pitchCallbackObject.hertz = Hz;\n                pitchCallbackObject.noteIndex = note % 12;\n                pitchCallbackObject.note = noteStrings[note % 12];\n                pitchCallbackObject.detuneCents = detune;\n                if (detune === 0) {\n                    pitchCallbackObject.detune = '';\n                } else if (detune < 0) {\n                    pitchCallbackObject.detune = 'flat';\n                } else {\n                    pitchCallbackObject.detune = 'sharp';\n                }\n            }\n            pitchCallback(pitchCallbackObject);\n        }\n    };\n\n    function needsUpdate(arr, float) {\n        if (!arr) {\n            return true;\n        }\n        if (node.fftSize !== fftSize) {\n            return true;\n        }\n        if (float && arr instanceof Uint8Array) {\n            return true;\n        }\n        return !float && arr instanceof Float32Array;\n    }\n\n    function createArray(float, length) {\n        return float ? new Float32Array(length) : new Uint8Array(length);\n    }\n\n    node.getWaveform = function (float) {\n        if (!arguments.length) {\n            float = waveFloat;\n        }\n\n        if (needsUpdate(waveform, float)) {\n            fftSize = node.fftSize;\n            waveFloat = float;\n            waveform = createArray(float, fftSize);\n        }\n        if (float && this.getFloatTimeDomainData) {\n            this.getFloatTimeDomainData(waveform);\n        } else {\n            this.getByteTimeDomainData(waveform);\n        }\n\n        return waveform;\n    };\n\n    node.getPitch = function (callback) {\n        pitchCallback = pitchCallback || callback;\n        var f = new Float32Array(node.fftSize);\n        f.set(node.getWaveform(true));\n        pitchWorker.postMessage({\n            sampleRate: context.sampleRate,\n            b: f.buffer\n        }, [f.buffer]);\n    };\n\n    node.getFrequencies = function (float) {\n        if (!arguments.length) {\n            float = freqFloat;\n        }\n\n        if (needsUpdate(frequencies, float)) {\n            fftSize = node.fftSize;\n            freqFloat = float;\n            frequencies = createArray(float, node.frequencyBinCount);\n        }\n\n        if (float) {\n            this.getFloatFrequencyData(frequencies);\n        } else {\n            this.getByteFrequencyData(frequencies);\n        }\n\n        return frequencies;\n    };\n\n    node.getAmplitude = function (callback) {\n        amplitudeCallback = amplitudeCallback || callback;\n        var f = new Float32Array(node.fftSize);\n        f.set(node.getFrequencies(true));\n        amplitudeWorker.postMessage({\n            sum: 0,\n            length: f.byteLength,\n            numSamples: node.fftSize / 2,\n            b: f.buffer\n        }, [f.buffer]);\n    };\n\n    node.update = function () {\n        node.getWaveform();\n        node.getFrequencies();\n    };\n\n    Object.defineProperties(node, {\n        smoothing: {\n            get: function get() {\n                return node.smoothingTimeConstant;\n            },\n            set: function set(value) {\n                node.smoothingTimeConstant = value;\n            }\n        }\n    });\n\n    return node;\n}\n\nfunction number(value, defaultValue) {\n    if (arguments.length < 2) {\n        defaultValue = 0;\n    }\n    if (typeof value !== 'number' || isNaN(value)) {\n        return defaultValue;\n    }\n    return value;\n}\n\nvar n = 22050;\n\nfunction Distortion(context, amount) {\n\n    amount = number(amount, 1);\n\n    var node = context.createWaveShaper();\n    var curve = new Float32Array(n);\n\n    // create waveShaper distortion curve from 0 to 1\n    node.update = function (value) {\n        amount = value;\n        if (amount <= 0) {\n            amount = 0;\n            this.curve = null;\n            return;\n        }\n        var k = value * 100;\n        var deg = Math.PI / 180;\n        var x = void 0;\n\n        for (var i = 0; i < n; i++) {\n            x = i * 2 / n - 1;\n            curve[i] = (3 + k) * x * 20 * deg / (Math.PI + k * Math.abs(x));\n        }\n\n        this.curve = curve;\n    };\n\n    Object.defineProperties(node, {\n        amount: {\n            get: function get() {\n                return amount;\n            },\n            set: function set(value) {\n                this.update(value);\n            }\n        }\n    });\n\n    if (typeof amount !== 'undefined') {\n        node.update(amount);\n    }\n\n    return node;\n}\n\nfunction Echo(context, config) {\n    config = config || {};\n\n    var input = context.createGain();\n    var delay = context.createDelay();\n    var gain = context.createGain();\n    var output = context.createGain();\n\n    delay.delayTime.value = number(config.delayTime, 0.5);\n    gain.gain.value = number(config.feedback, 0.5);\n\n    input.connect(delay);\n    input.connect(output);\n    delay.connect(gain);\n    gain.connect(delay);\n    gain.connect(output);\n\n    var node = input;\n    node.name = 'Echo';\n    node._output = output;\n\n    Object.defineProperties(node, {\n        delay: {\n            get: function get() {\n                return delay.delayTime.value;\n            },\n            set: function set(value) {\n                delay.delayTime.value = value;\n            }\n        },\n        feedback: {\n            get: function get() {\n                return gain.gain.value;\n            },\n            set: function set(value) {\n                gain.gain.value = value;\n            }\n        }\n    });\n\n    return node;\n}\n\nfunction FakeContext() {\n\n    var startTime = Date.now();\n\n    function fn() {}\n\n    function param() {\n        return {\n            value: 1,\n            defaultValue: 1,\n            linearRampToValueAtTime: fn,\n            setValueAtTime: fn,\n            exponentialRampToValueAtTime: fn,\n            setTargetAtTime: fn,\n            setValueCurveAtTime: fn,\n            cancelScheduledValues: fn\n        };\n    }\n\n    function fakeNode() {\n        return {\n            connect: fn,\n            disconnect: fn,\n            // analyser\n            frequencyBinCount: 0,\n            smoothingTimeConstant: 0,\n            fftSize: 0,\n            minDecibels: 0,\n            maxDecibels: 0,\n            getByteTimeDomainData: fn,\n            getByteFrequencyData: fn,\n            getFloatTimeDomainData: fn,\n            getFloatFrequencyData: fn,\n            // gain\n            gain: param(),\n            // panner\n            panningModel: 0,\n            setPosition: fn,\n            setOrientation: fn,\n            setVelocity: fn,\n            distanceModel: 0,\n            refDistance: 0,\n            maxDistance: 0,\n            rolloffFactor: 0,\n            coneInnerAngle: 360,\n            coneOuterAngle: 360,\n            coneOuterGain: 0,\n            // filter:\n            type: 0,\n            frequency: param(),\n            Q: param(),\n            detune: param(),\n            // delay\n            delayTime: param(),\n            // convolver\n            buffer: 0,\n            // compressor\n            threshold: param(),\n            knee: param(),\n            ratio: param(),\n            attack: param(),\n            release: param(),\n            reduction: param(),\n            // distortion\n            oversample: 0,\n            curve: 0,\n            // buffer\n            sampleRate: 1,\n            length: 0,\n            duration: 0,\n            numberOfChannels: 0,\n            getChannelData: function getChannelData() {\n                return [];\n            },\n            copyFromChannel: fn,\n            copyToChannel: fn,\n            // listener\n            dopplerFactor: 0,\n            speedOfSound: 0,\n            // osc\n            start: fn\n        };\n    }\n\n    // ie9\n    if (!window.Uint8Array) {\n        window.Uint8Array = window.Float32Array = Array;\n    }\n\n    return {\n        createAnalyser: fakeNode,\n        createBuffer: fakeNode,\n        createBiquadFilter: fakeNode,\n        createChannelMerger: fakeNode,\n        createChannelSplitter: fakeNode,\n        createDynamicsCompressor: fakeNode,\n        createConvolver: fakeNode,\n        createDelay: fakeNode,\n        createGain: fakeNode,\n        createOscillator: fakeNode,\n        createPanner: fakeNode,\n        createScriptProcessor: fakeNode,\n        createWaveShaper: fakeNode,\n        listener: fakeNode(),\n        get currentTime() {\n            return (Date.now() - startTime) / 1000;\n        }\n    };\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/API/BiquadFilterNode\n// For lowpass and highpass Q indicates how peaked the frequency is around the cutoff.\n// The greater the value is, the greater is the peak\n\nfunction Filter(context) {\n    var config = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n    // Frequency between 40Hz and half of the sampling rate\n    var minFrequency = 40;\n    var maxFrequency = context.sampleRate / 2;\n\n    var node = context.createBiquadFilter();\n    node.type = config.type;\n\n    function getFrequency(value) {\n        // Logarithm (base 2) to compute how many octaves fall in the range.\n        var numberOfOctaves = Math.log(maxFrequency / minFrequency) / Math.LN2;\n        // Compute a multiplier from 0 to 1 based on an exponential scale.\n        var multiplier = Math.pow(2, numberOfOctaves * (value - 1.0));\n        // Get back to the frequency value between min and max.\n        return maxFrequency * multiplier;\n    }\n\n    node.set = function (frequency, q, gain) {\n        if (typeof frequency !== 'undefined' && typeof frequency === 'number') {\n            node.frequency.value = frequency;\n        }\n        if (typeof q !== 'undefined' && typeof q === 'number') {\n            node.Q.value = q;\n        }\n        if (typeof gain !== 'undefined' && typeof gain === 'number') {\n            node.gain.value = gain;\n        }\n        return node;\n    };\n\n    // set filter frequency based on value from 0 to 1\n    node.setByPercent = function (percent, q, gain) {\n        return node.set(getFrequency(percent), q, gain);\n    };\n\n    return node.set(config.frequency, config.q, config.gain);\n}\n\nfunction MonoFlanger(context, config) {\n    var input = context.createGain();\n    var delay = context.createDelay();\n    var feedback = context.createGain();\n    var lfo = context.createOscillator();\n    var gain = context.createGain();\n    var output = context.createGain();\n\n    delay.delayTime.value = number(config.delay, 0.005); // 5-25ms delay (0.005 > 0.025)\n    feedback.gain.value = number(config.feedback, 0.5); // 0 > 1\n\n    lfo.type = 'sine';\n    lfo.frequency.value = number(config.frequency, 0.002); // 0.05 > 5\n    gain.gain.value = number(config.gain, 0.25); // 0.0005 > 0.005\n\n    input.connect(output);\n    input.connect(delay);\n    delay.connect(output);\n    delay.connect(feedback);\n    feedback.connect(input);\n\n    lfo.connect(gain);\n    gain.connect(delay.delayTime);\n    lfo.start(0);\n\n    var node = input;\n    node.name = 'Flanger';\n    node._output = output;\n\n    Object.defineProperties(node, {\n        delay: {\n            get: function get() {\n                return delay.delayTime.value;\n            },\n            set: function set(value) {\n                delay.delayTime.value = value;\n            }\n        },\n        lfoFrequency: {\n            get: function get() {\n                return lfo.frequency.value;\n            },\n            set: function set(value) {\n                lfo.frequency.value = value;\n            }\n        },\n        lfoGain: {\n            get: function get() {\n                return gain.gain.value;\n            },\n            set: function set(value) {\n                gain.gain.value = value;\n            }\n        },\n        feedback: {\n            get: function get() {\n                return feedback.gain.value;\n            },\n            set: function set(value) {\n                feedback.gain.value = value;\n            }\n        }\n    });\n\n    return node;\n}\n\nfunction StereoFlanger(context, config) {\n    var input = context.createGain();\n    var splitter = context.createChannelSplitter(2);\n    var merger = context.createChannelMerger(2);\n    var feedbackL = context.createGain();\n    var feedbackR = context.createGain();\n    var lfo = context.createOscillator();\n    var lfoGainL = context.createGain();\n    var lfoGainR = context.createGain();\n    var delayL = context.createDelay();\n    var delayR = context.createDelay();\n    var output = context.createGain();\n\n    feedbackL.gain.value = feedbackR.gain.value = number(config.feedback, 0.5);\n    delayL.delayTime.value = delayR.delayTime.value = number(config.delay, 0.003);\n\n    lfo.type = 'sine';\n    lfo.frequency.value = number(config.frequency, 0.5);\n    lfoGainL.gain.value = number(config.gain, 0.005);\n    lfoGainR.gain.value = 0 - lfoGainL.gain.value;\n\n    input.connect(splitter);\n\n    splitter.connect(delayL, 0);\n    splitter.connect(delayR, 1);\n\n    delayL.connect(feedbackL);\n    delayR.connect(feedbackR);\n\n    feedbackL.connect(delayR);\n    feedbackR.connect(delayL);\n\n    delayL.connect(merger, 0, 0);\n    delayR.connect(merger, 0, 1);\n\n    merger.connect(output);\n    input.connect(output);\n\n    lfo.connect(lfoGainL);\n    lfo.connect(lfoGainR);\n    lfoGainL.connect(delayL.delayTime);\n    lfoGainR.connect(delayR.delayTime);\n    lfo.start(0);\n\n    var node = input;\n    node.name = 'StereoFlanger';\n    node._output = output;\n\n    Object.defineProperties(node, {\n        delay: {\n            get: function get() {\n                return delayL.delayTime.value;\n            },\n            set: function set(value) {\n                delayL.delayTime.value = delayR.delayTime.value = value;\n            }\n        },\n        lfoFrequency: {\n            get: function get() {\n                return lfo.frequency.value;\n            },\n            set: function set(value) {\n                lfo.frequency.value = value;\n            }\n        },\n        lfoGain: {\n            get: function get() {\n                return lfoGainL.gain.value;\n            },\n            set: function set(value) {\n                lfoGainL.gain.value = lfoGainR.gain.value = value;\n            }\n        },\n        feedback: {\n            get: function get() {\n                return feedbackL.gain.value;\n            },\n            set: function set(value) {\n                feedbackL.gain.value = feedbackR.gain.value = value;\n            }\n        }\n    });\n\n    return node;\n}\n\nfunction Flanger(context, config) {\n    config = config || {};\n    return config.stereo ? new StereoFlanger(context, config) : new MonoFlanger(context, config);\n}\n\nfunction Panner(context) {\n    var node = context.createPanner();\n\n    // Default for stereo is 'HRTF' can also be 'equalpower'\n    node.panningModel = Panner.defaults.panningModel;\n\n    // Distance model and attributes\n    // Can be 'linear' 'inverse' 'exponential'\n    node.distanceModel = Panner.defaults.distanceModel;\n    node.refDistance = Panner.defaults.refDistance;\n    node.maxDistance = Panner.defaults.maxDistance;\n    node.rolloffFactor = Panner.defaults.rolloffFactor;\n    node.coneInnerAngle = Panner.defaults.coneInnerAngle;\n    node.coneOuterAngle = Panner.defaults.coneOuterAngle;\n    node.coneOuterGain = Panner.defaults.coneOuterGain;\n    // set to defaults (needed in Firefox)\n    node.setPosition(0, 0, 1);\n    node.setOrientation(0, 0, 0);\n\n    // simple vec3 object pool\n    var vecPool = {\n        pool: [],\n        get: function get(x, y, z) {\n            var v = this.pool.length ? this.pool.pop() : {\n                x: 0,\n                y: 0,\n                z: 0\n            };\n            // check if a vector has been passed in\n            if (typeof x !== 'undefined' && isNaN(x) && 'x' in x && 'y' in x && 'z' in x) {\n                v.x = number(x.x);\n                v.y = number(x.y);\n                v.z = number(x.z);\n            } else {\n                v.x = number(x);\n                v.y = number(y);\n                v.z = number(z);\n            }\n            return v;\n        },\n        dispose: function dispose(instance) {\n            this.pool.push(instance);\n        }\n    };\n\n    var globalUp = vecPool.get(0, 1, 0),\n        angle45 = Math.PI / 4,\n        angle90 = Math.PI / 2;\n\n    // cross product of 2 vectors\n    function cross(a, b) {\n        var ax = a.x,\n            ay = a.y,\n            az = a.z;\n        var bx = b.x,\n            by = b.y,\n            bz = b.z;\n        a.x = ay * bz - az * by;\n        a.y = az * bx - ax * bz;\n        a.z = ax * by - ay * bx;\n    }\n\n    // normalise to unit vector\n    function normalize(vec3) {\n        if (vec3.x === 0 && vec3.y === 0 && vec3.z === 0) {\n            return vec3;\n        }\n        var length = Math.sqrt(vec3.x * vec3.x + vec3.y * vec3.y + vec3.z * vec3.z);\n        var invScalar = 1 / length;\n        vec3.x *= invScalar;\n        vec3.y *= invScalar;\n        vec3.z *= invScalar;\n        return vec3;\n    }\n\n    // set the orientation of the source (where the audio is coming from)\n    function setOrientation(pannerNode, fw) {\n        // calculate up vec ( up = (forward cross (0, 1, 0)) cross forward )\n        var up = vecPool.get(fw.x, fw.y, fw.z);\n        cross(up, globalUp);\n        cross(up, fw);\n        normalize(up);\n        normalize(fw);\n        // set the audio context's listener position to match the camera position\n        pannerNode.setOrientation(fw.x, fw.y, fw.z, up.x, up.y, up.z);\n        // return the vecs to the pool\n        vecPool.dispose(fw);\n        vecPool.dispose(up);\n    }\n\n    function setPosition(nodeOrListener, vec) {\n        nodeOrListener.setPosition(vec.x, vec.y, vec.z);\n        vecPool.dispose(vec);\n    }\n\n    node.set = function (x, y, z) {\n        var v = vecPool.get(x, y, z);\n\n        if (arguments.length === 1 && v.x) {\n            // pan left to right with value from -1 to 1\n            x = v.x;\n\n            if (x > 1) {\n                x = 1;\n            }\n            if (x < -1) {\n                x = -1;\n            }\n\n            // creates a nice curve with z\n            x = x * angle45;\n            z = x + angle90;\n\n            if (z > angle90) {\n                z = Math.PI - z;\n            }\n\n            v.x = Math.sin(x);\n            v.z = Math.sin(z);\n        }\n        setPosition(node, v);\n    };\n\n    // set the position the audio is coming from)\n    node.setSourcePosition = function (x, y, z) {\n        setPosition(node, vecPool.get(x, y, z));\n    };\n\n    // set the direction the audio is coming from)\n    node.setSourceOrientation = function (x, y, z) {\n        setOrientation(node, vecPool.get(x, y, z));\n    };\n\n    // set the position of who or what is hearing the audio (could be camera or some character)\n    node.setListenerPosition = function (x, y, z) {\n        setPosition(context.listener, vecPool.get(x, y, z));\n    };\n\n    // set the position of who or what is hearing the audio (could be camera or some character)\n    node.setListenerOrientation = function (x, y, z) {\n        setOrientation(context.listener, vecPool.get(x, y, z));\n    };\n\n    node.getDefaults = function () {\n        return Panner.defaults;\n    };\n\n    node.setDefaults = function (defaults) {\n        Object.keys(defaults).forEach(function (key) {\n            Panner.defaults[key] = defaults[key];\n        });\n    };\n\n    return node;\n}\n\nPanner.defaults = {\n    panningModel: 'HRTF',\n    distanceModel: 'linear',\n    refDistance: 1,\n    maxDistance: 1000,\n    rolloffFactor: 1,\n    coneInnerAngle: 360,\n    coneOuterAngle: 0,\n    coneOuterGain: 0\n};\n\nfunction Phaser(context) {\n    var config = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n    var stages = number(config.stages, 8);\n    var filters = [];\n    var filter = void 0;\n\n    var input = context.createGain();\n    var feedback = context.createGain();\n    var lfo = context.createOscillator();\n    var lfoGain = context.createGain();\n    var output = context.createGain();\n\n    feedback.gain.value = number(config.feedback, 0.5);\n\n    lfo.type = 'sine';\n    lfo.frequency.value = number(config.frequency, 0.5);\n    lfoGain.gain.value = number(config.gain, 300);\n\n    for (var i = 0; i < stages; i++) {\n        filter = context.createBiquadFilter();\n        filter.type = 'allpass';\n        filter.frequency.value = 1000 * i;\n        //filter.Q.value = 10;\n        if (i > 0) {\n            filters[i - 1].connect(filter);\n        }\n        lfoGain.connect(filter.frequency);\n\n        filters.push(filter);\n    }\n\n    var first = filters[0];\n    var last = filters[filters.length - 1];\n\n    input.connect(first);\n    input.connect(output);\n    last.connect(output);\n    last.connect(feedback);\n    feedback.connect(first);\n    lfo.connect(lfoGain);\n    lfo.start(0);\n\n    var node = input;\n    node.name = 'Phaser';\n    node._output = output;\n\n    Object.defineProperties(node, {\n        lfoFrequency: {\n            get: function get() {\n                return lfo.frequency.value;\n            },\n            set: function set(value) {\n                lfo.frequency.value = value;\n            }\n        },\n        lfoGain: {\n            get: function get() {\n                return lfoGain.gain.value;\n            },\n            set: function set(value) {\n                lfoGain.gain.value = value;\n            }\n        },\n        feedback: {\n            get: function get() {\n                return feedback.gain.value;\n            },\n            set: function set(value) {\n                feedback.gain.value = value;\n            }\n        }\n    });\n\n    return node;\n}\n\nfunction Recorder(context, passThrough) {\n    var bufferLength = 4096,\n        buffersL = [],\n        buffersR = [];\n    var startedAt = 0,\n        stoppedAt = 0;\n\n    var input = context.createGain();\n    var output = context.createGain();\n    var script = void 0;\n\n    var node = input;\n    node.name = 'Recorder';\n    node._output = output;\n\n    node.isRecording = false;\n\n    function mergeBuffers(buffers, length) {\n        var buffer = new Float32Array(length);\n        var offset = 0;\n        for (var i = 0; i < buffers.length; i++) {\n            buffer.set(buffers[i], offset);\n            offset += buffers[i].length;\n        }\n        return buffer;\n    }\n\n    function getBuffer() {\n        if (!buffersL.length) {\n            return context.createBuffer(2, bufferLength, context.sampleRate);\n        }\n        var recordingLength = buffersL.length * bufferLength;\n        var buffer = context.createBuffer(2, recordingLength, context.sampleRate);\n        buffer.getChannelData(0).set(mergeBuffers(buffersL, recordingLength));\n        buffer.getChannelData(1).set(mergeBuffers(buffersR, recordingLength));\n        return buffer;\n    }\n\n    function destroyScriptProcessor() {\n        if (script) {\n            script.onaudioprocess = null;\n            input.disconnect();\n            script.disconnect();\n        }\n    }\n\n    function createScriptProcessor() {\n        destroyScriptProcessor();\n\n        script = context.createScriptProcessor(bufferLength, 2, 2);\n        input.connect(script);\n        script.connect(context.destination);\n        script.connect(output);\n\n        script.onaudioprocess = function (event) {\n            var inputL = event.inputBuffer.getChannelData(0);\n            var inputR = event.inputBuffer.getChannelData(1);\n\n            if (passThrough) {\n                var outputL = event.outputBuffer.getChannelData(0);\n                var outputR = event.outputBuffer.getChannelData(1);\n                outputL.set(inputL);\n                outputR.set(inputR);\n            }\n\n            if (node.isRecording) {\n                buffersL.push(new Float32Array(inputL));\n                buffersR.push(new Float32Array(inputR));\n            }\n        };\n    }\n\n    node.start = function () {\n        createScriptProcessor();\n        buffersL.length = 0;\n        buffersR.length = 0;\n        startedAt = context.currentTime;\n        stoppedAt = 0;\n        this.isRecording = true;\n    };\n\n    node.stop = function () {\n        stoppedAt = context.currentTime;\n        this.isRecording = false;\n        destroyScriptProcessor();\n        return getBuffer();\n    };\n\n    node.getDuration = function () {\n        if (!this.isRecording) {\n            return stoppedAt - startedAt;\n        }\n        return context.currentTime - startedAt;\n    };\n\n    return node;\n}\n\nfunction Reverb(context) {\n    var config = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n    var rate = context.sampleRate;\n\n    var time = number(config.time, 1);\n    var decay = number(config.decay, 5);\n    var reverse = !!config.reverse;\n    var length = void 0;\n    var impulseResponse = void 0;\n\n    var input = context.createGain();\n    var reverb = context.createConvolver();\n    var output = context.createGain();\n\n    input.connect(reverb);\n    input.connect(output);\n    reverb.connect(output);\n\n    var node = input;\n    node.name = 'Reverb';\n    node._output = output;\n\n    node.update = function (opt) {\n        if (typeof opt.time !== 'undefined') {\n            time = opt.time;\n            length = Math.floor(rate * time);\n            impulseResponse = length ? context.createBuffer(2, length, rate) : null;\n        }\n        if (typeof opt.decay !== 'undefined') {\n            decay = opt.decay;\n        }\n        if (typeof opt.reverse !== 'undefined') {\n            reverse = opt.reverse;\n        }\n\n        if (!impulseResponse) {\n            reverb.buffer = null;\n            return;\n        }\n\n        var left = impulseResponse.getChannelData(0);\n        var right = impulseResponse.getChannelData(1);\n        var n = void 0,\n            e = void 0;\n\n        for (var i = 0; i < length; i++) {\n            n = reverse ? length - i : i;\n            e = Math.pow(1 - n / length, decay);\n            left[i] = (Math.random() * 2 - 1) * e;\n            right[i] = (Math.random() * 2 - 1) * e;\n        }\n\n        reverb.buffer = impulseResponse;\n    };\n\n    node.update({\n        time: time,\n        decay: decay,\n        reverse: reverse\n    });\n\n    Object.defineProperties(node, {\n        time: {\n            get: function get() {\n                return time;\n            },\n            set: function set(value) {\n                if (value === time) {\n                    return;\n                }\n                this.update({\n                    time: value\n                });\n            }\n        },\n        decay: {\n            get: function get() {\n                return decay;\n            },\n            set: function set(value) {\n                if (value === decay) {\n                    return;\n                }\n                this.update({\n                    decay: value\n                });\n            }\n        },\n        reverse: {\n            get: function get() {\n                return reverse;\n            },\n            set: function set(value) {\n                if (value === reverse) {\n                    return;\n                }\n                this.update({\n                    reverse: !!value\n                });\n            }\n        }\n    });\n\n    return node;\n}\n\nfunction Effect(context) {\n    context = context || new FakeContext();\n    var panning = new Panner(context);\n\n    var api = null,\n        destination = void 0,\n        nodeList = [],\n        sourceNode = void 0;\n\n    function connect(a, b) {\n        //console.log('> connect', (a.name || a.constructor.name), 'to', (b.name || b.constructor.name));\n\n        var output = a._output || a;\n        //console.log('> disconnect output: ', (a.name || a.constructor.name));\n        output.disconnect();\n        //console.log('> connect output: ',(a.name || a.constructor.name), 'to input:', (b.name || b.constructor.name));\n        output.connect(b);\n    }\n\n    function connectToDestination(node) {\n        var l = nodeList.length;\n        var lastNode = l ? nodeList[l - 1] : sourceNode;\n\n        if (lastNode) {\n            connect(lastNode, node);\n        }\n\n        destination = node;\n    }\n\n    function updateConnections() {\n        if (!sourceNode) {\n            return;\n        }\n\n        //console.log('updateConnections:', nodeList.length);\n\n        var node = void 0,\n            prev = void 0;\n\n        for (var i = 0; i < nodeList.length; i++) {\n            node = nodeList[i];\n            //console.log(i, node);\n            prev = i === 0 ? sourceNode : nodeList[i - 1];\n            connect(prev, node);\n        }\n\n        if (destination) {\n            connectToDestination(destination);\n        }\n    }\n\n    function has(node) {\n        if (!node) {\n            return false;\n        }\n        return nodeList.indexOf(node) > -1;\n    }\n\n    function add(node) {\n        if (!node) {\n            return null;\n        }\n        if (has(node)) {\n            return node;\n        }\n        nodeList.push(node);\n        updateConnections();\n        return node;\n    }\n\n    function remove(node) {\n        if (!node) {\n            return null;\n        }\n        if (!has(node)) {\n            return node;\n        }\n        var l = nodeList.length;\n        for (var i = 0; i < l; i++) {\n            if (node === nodeList[i]) {\n                nodeList.splice(i, 1);\n                break;\n            }\n        }\n        var output = node._output || node;\n        output.disconnect();\n        updateConnections();\n        return node;\n    }\n\n    function toggle(node, force) {\n        force = !!force;\n        var hasNode = has(node);\n        if (arguments.length > 1 && hasNode === force) {\n            return api;\n        }\n        if (hasNode) {\n            remove(node);\n        } else {\n            add(node);\n        }\n        return api;\n    }\n\n    function removeAll() {\n        while (nodeList.length) {\n            nodeList.pop().disconnect();\n        }\n        updateConnections();\n        return api;\n    }\n\n    function destroy() {\n        removeAll();\n        context = null;\n        destination = null;\n        nodeList = [];\n        if (sourceNode) {\n            sourceNode.disconnect();\n        }\n        sourceNode = null;\n    }\n\n    /*\n     * Effects\n     */\n\n    function analyser(config) {\n        return add(new Analyser(context, config));\n    }\n\n    // lowers the volume of the loudest parts of the signal and raises the volume of the softest parts\n    function compressor(options) {\n        var node = context.createDynamicsCompressor();\n\n        node.update = function (config) {\n            // min decibels to start compressing at from -100 to 0\n            node.threshold.value = typeof config.threshold !== 'undefined' ? config.threshold : -24;\n            // decibel value to start curve to compressed value from 0 to 40\n            node.knee.value = typeof config.knee !== 'undefined' ? config.knee : 30;\n            // amount of change per decibel from 1 to 20\n            node.ratio.value = typeof config.ratio !== 'undefined' ? config.ratio : 12;\n            // gain reduction currently applied by compressor from -20 to 0\n            // node.reduction.value = typeof config.reduction !== 'undefined' ? config.reduction : -10;)\n            // seconds to reduce gain by 10db from 0 to 1 - how quickly signal adapted when volume increased\n            node.attack.value = typeof config.attack !== 'undefined' ? config.attack : 0.0003;\n            // seconds to increase gain by 10db from 0 to 1 - how quickly signal adapted when volume redcuced\n            node.release.value = typeof config.release !== 'undefined' ? config.release : 0.25;\n        };\n\n        node.update(options || {});\n\n        return add(node);\n    }\n\n    function convolver(impulseResponse) {\n        // impulseResponse is an audio file buffer\n        var node = context.createConvolver();\n        node.buffer = impulseResponse;\n        return add(node);\n    }\n\n    function delay(time) {\n        var node = context.createDelay();\n        if (typeof time !== 'undefined') {\n            node.delayTime.value = time;\n        }\n        return add(node);\n    }\n\n    function echo(config) {\n        return add(new Echo(context, config));\n    }\n\n    function distortion(amount) {\n        // Float32Array defining curve (values are interpolated)\n        //node.curve\n        // up-sample before applying curve for better resolution result 'none', '2x' or '4x'\n        //node.oversample = '2x';\n        return add(new Distortion(context, amount));\n    }\n\n    function filter(type, frequency, q, gain) {\n        return add(new Filter(context, { type: type, frequency: frequency, q: q, gain: gain }));\n    }\n\n    function lowpass(frequency, peak) {\n        return filter('lowpass', { frequency: frequency, q: peak });\n    }\n\n    function highpass(frequency, peak) {\n        return filter('highpass', { frequency: frequency, q: peak });\n    }\n\n    function bandpass(frequency, width) {\n        return filter('bandpass', { frequency: frequency, q: width });\n    }\n\n    function lowshelf(frequency, gain) {\n        return filter('lowshelf', { frequency: frequency, q: 0, gain: gain });\n    }\n\n    function highshelf(frequency, gain) {\n        return filter('highshelf', { frequency: frequency, q: 0, gain: gain });\n    }\n\n    function peaking(frequency, width, gain) {\n        return filter('peaking', { frequency: frequency, q: width, gain: gain });\n    }\n\n    function notch(frequency, width, gain) {\n        return filter('notch', { frequency: frequency, q: width, gain: gain });\n    }\n\n    function allpass(frequency, sharpness) {\n        return filter('allpass', { frequency: frequency, q: sharpness });\n    }\n\n    function flanger(config) {\n        return add(new Flanger(context, config));\n    }\n\n    function gainNode(value) {\n        var node = context.createGain();\n        if (typeof value !== 'undefined') {\n            node.gain.value = value;\n        }\n        return node;\n    }\n\n    function panner() {\n        return add(new Panner(context));\n    }\n\n    function phaser(config) {\n        return add(new Phaser(context, config));\n    }\n\n    function recorder(passThrough) {\n        return add(new Recorder(context, passThrough));\n    }\n\n    function reverb(seconds, decay, reverse) {\n        return add(new Reverb(context, seconds, decay, reverse));\n    }\n\n    function script() {\n        var config = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n        // bufferSize 256 - 16384 (pow 2)\n        var bufferSize = config.bufferSize || 1024;\n        var inputChannels = typeof config.inputChannels === 'undefined' ? 0 : config.inputChannels;\n        var outputChannels = typeof config.outputChannels === 'undefined' ? 1 : config.outputChannels;\n\n        var node = context.createScriptProcessor(bufferSize, inputChannels, outputChannels);\n\n        var thisArg = config.thisArg || config.context || node;\n        var callback = config.callback || function () {};\n\n        // available props:\n        /*\n        event.inputBuffer\n        event.outputBuffer\n        event.playbackTime\n        */\n        // Example: generate noise\n        /*\n        const output = event.outputBuffer.getChannelData(0);\n        const l = output.length;\n        for (let i = 0; i < l; i++) {\n            output[i] = Math.random();\n        }\n        */\n        node.onaudioprocess = callback.bind(thisArg);\n\n        return add(node);\n    }\n\n    function setSource(node) {\n        sourceNode = node;\n        updateConnections();\n        return node;\n    }\n\n    function setDestination(node) {\n        connectToDestination(node);\n        return node;\n    }\n\n    //\n\n    api = {\n        context: context,\n        nodeList: nodeList,\n        panning: panning,\n\n        has: has,\n        add: add,\n        remove: remove,\n        toggle: toggle,\n        removeAll: removeAll,\n        destroy: destroy,\n        setSource: setSource,\n        setDestination: setDestination,\n\n        analyser: analyser,\n        compressor: compressor,\n        convolver: convolver,\n        delay: delay,\n        echo: echo,\n        distortion: distortion,\n        filter: filter,\n        lowpass: lowpass,\n        highpass: highpass,\n        bandpass: bandpass,\n        lowshelf: lowshelf,\n        highshelf: highshelf,\n        peaking: peaking,\n        notch: notch,\n        allpass: allpass,\n        flanger: flanger,\n        gain: gainNode,\n        panner: panner,\n        phaser: phaser,\n        recorder: recorder,\n        reverb: reverb,\n        script: script\n    };\n\n    return Object.freeze(api);\n}\n\nfunction Group(context, destination) {\n    var sounds = [];\n    var effect = new Effect(context);\n    var gain = effect.gain();\n    var preMuteVolume = 1;\n    var group = null;\n\n    if (context) {\n        effect.setSource(gain);\n        effect.setDestination(destination || context.destination);\n    }\n\n    /*\n     * Add / remove\n     */\n\n    function find(soundOrId, callback) {\n        var found = void 0;\n\n        if (!soundOrId && soundOrId !== 0) {\n            return found;\n        }\n\n        sounds.some(function (sound) {\n            if (sound === soundOrId || sound.id === soundOrId) {\n                found = sound;\n                return true;\n            }\n            return false;\n        });\n\n        if (found && callback) {\n            return callback(found);\n        }\n\n        return found;\n    }\n\n    function remove(soundOrId) {\n        find(soundOrId, function (sound) {\n            return sounds.splice(sounds.indexOf(sound), 1);\n        });\n        return group;\n    }\n\n    function add(sound) {\n        sound.gain.disconnect();\n        sound.gain.connect(gain);\n\n        sounds.push(sound);\n\n        sound.once('destroy', remove);\n\n        return group;\n    }\n\n    /*\n     * Controls\n     */\n\n    function play(delay, offset) {\n        sounds.forEach(function (sound) {\n            return sound.play(delay, offset);\n        });\n        return group;\n    }\n\n    function pause() {\n        sounds.forEach(function (sound) {\n            if (sound.playing) {\n                sound.pause();\n            }\n        });\n        return group;\n    }\n\n    function resume() {\n        sounds.forEach(function (sound) {\n            if (sound.paused) {\n                sound.play();\n            }\n        });\n        return group;\n    }\n\n    function stop() {\n        sounds.forEach(function (sound) {\n            return sound.stop();\n        });\n        return group;\n    }\n\n    function seek(percent) {\n        sounds.forEach(function (sound) {\n            return sound.seek(percent);\n        });\n        return group;\n    }\n\n    function mute() {\n        preMuteVolume = group.volume;\n        group.volume = 0;\n        return group;\n    }\n\n    function unMute() {\n        group.volume = preMuteVolume || 1;\n        return group;\n    }\n\n    function setVolume(value) {\n        group.volume = value;\n        return group;\n    }\n\n    function fade(volume, duration) {\n        if (context) {\n            var param = gain.gain;\n            var time = context.currentTime;\n\n            param.cancelScheduledValues(time);\n            param.setValueAtTime(param.value, time);\n            // param.setValueAtTime(volume, time + duration);\n            param.linearRampToValueAtTime(volume, time + duration);\n            // param.setTargetAtTime(volume, time, duration);\n            // param.exponentialRampToValueAtTime(Math.max(volume, 0.0001), time + duration);\n        } else {\n            sounds.forEach(function (sound) {\n                return sound.fade(volume, duration);\n            });\n        }\n\n        return group;\n    }\n\n    /*\n     * Load\n     */\n\n    function load() {\n        sounds.forEach(function (sound) {\n            return sound.load(null, true);\n        });\n    }\n\n    /*\n     * Unload\n     */\n\n    function unload() {\n        sounds.forEach(function (sound) {\n            return sound.unload();\n        });\n    }\n\n    /*\n     * Destroy\n     */\n\n    function destroy() {\n        while (sounds.length) {\n            sounds.pop().destroy();\n        }\n    }\n\n    /*\n     * Api\n     */\n\n    group = {\n        add: add,\n        find: find,\n        remove: remove,\n        play: play,\n        pause: pause,\n        resume: resume,\n        stop: stop,\n        seek: seek,\n        setVolume: setVolume,\n        mute: mute,\n        unMute: unMute,\n        fade: fade,\n        load: load,\n        unload: unload,\n        destroy: destroy\n    };\n\n    /*\n     * Getters & Setters\n     */\n\n    Object.defineProperties(group, {\n        effect: {\n            value: effect\n        },\n        gain: {\n            value: gain\n        },\n        sounds: {\n            value: sounds\n        },\n        volume: {\n            get: function get() {\n                return gain.gain.value;\n            },\n            set: function set(value) {\n                if (isNaN(value)) {\n                    return;\n                }\n\n                value = Math.min(Math.max(value, 0), 1);\n\n                if (context) {\n                    gain.gain.cancelScheduledValues(context.currentTime);\n                    gain.gain.value = value;\n                    gain.gain.setValueAtTime(value, context.currentTime);\n                } else {\n                    gain.gain.value = value;\n                }\n                sounds.forEach(function (sound) {\n                    if (!sound.context) {\n                        sound.groupVolume = value;\n                    }\n                });\n            }\n        }\n    });\n\n    return group;\n}\n\nGroup.Effect = Effect;\n\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter$1() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nvar events = EventEmitter$1;\n\n// Backwards-compat with node 0.10.x\nEventEmitter$1.EventEmitter = EventEmitter$1;\n\nEventEmitter$1.prototype._events = undefined;\nEventEmitter$1.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter$1.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter$1.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter$1.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter$1.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter$1.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter$1.prototype.on = EventEmitter$1.prototype.addListener;\n\nEventEmitter$1.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter$1.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter$1.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter$1.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter$1.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter$1.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\nvar EventEmitter = events.EventEmitter;\n\nvar Emitter = function (_EventEmitter) {\n    inherits(Emitter, _EventEmitter);\n\n    function Emitter() {\n        classCallCheck(this, Emitter);\n        return possibleConstructorReturn(this, _EventEmitter.call(this));\n    }\n\n    Emitter.prototype.off = function off(type, listener) {\n        if (listener) {\n            return this.removeListener(type, listener);\n        }\n        if (type) {\n            return this.removeAllListeners(type);\n        }\n        return this.removeAllListeners();\n    };\n\n    return Emitter;\n}(EventEmitter);\n\nfunction Loader(url, deferLoad) {\n    var ERROR_STATE = ['', 'ABORTED', 'NETWORK', 'DECODE', 'SRC_NOT_SUPPORTED'];\n    var emitter = new Emitter();\n    var progress = 0,\n        audioContext = void 0,\n        isTouchLocked = void 0,\n        request = void 0,\n        timeout = void 0,\n        data = void 0;\n\n    // clean up\n\n    function removeListeners() {\n        emitter.off('error');\n        emitter.off('progress');\n        emitter.off('complete');\n        emitter.off('loaded');\n\n        if (data && typeof data.removeEventListener === 'function') {\n            data.removeEventListener('canplaythrough', readyHandler);\n            data.removeEventListener('error', errorHandler);\n        }\n\n        if (request) {\n            request.removeEventListener('progress', progressHandler);\n            request.removeEventListener('load', loadHandler);\n            request.removeEventListener('error', errorHandler);\n        }\n    }\n\n    function dispatchComplete(buffer) {\n        emitter.emit('progress', 1);\n        emitter.emit('loaded', buffer);\n        emitter.emit('complete', buffer);\n\n        removeListeners();\n    }\n\n    function progressHandler(event) {\n        if (event.lengthComputable) {\n            progress = event.loaded / event.total;\n            emitter.emit('progress', progress);\n        }\n    }\n\n    // error\n\n    function errorHandler(event) {\n        window.clearTimeout(timeout);\n\n        var message = event;\n\n        if (data && data.error) {\n            message = 'Media Error: ' + ERROR_STATE[data.error.code] + ' ' + url;\n        }\n\n        if (request) {\n            message = 'XHR Error: ' + request.status + ' ' + request.statusText + ' ' + url;\n        }\n\n        emitter.emit('error', message);\n\n        removeListeners();\n    }\n\n    function decodeArrayBuffer(arraybuffer) {\n        audioContext.decodeAudioData(arraybuffer, function (buffer) {\n            data = buffer;\n            request = null;\n            progress = 1;\n            dispatchComplete(buffer);\n        }, errorHandler);\n    }\n\n    function loadHandler() {\n        decodeArrayBuffer(request.response);\n    }\n\n    function readyHandler() {\n        window.clearTimeout(timeout);\n        if (!data) {\n            return;\n        }\n        progress = 1;\n        dispatchComplete(data);\n    }\n\n    function cancel() {\n        removeListeners();\n\n        if (request && request.readyState !== 4) {\n            request.abort();\n        }\n        request = null;\n\n        window.clearTimeout(timeout);\n    }\n\n    function destroy() {\n        cancel();\n        request = null;\n        data = null;\n        audioContext = null;\n    }\n\n    // audio buffer\n\n    function loadArrayBuffer() {\n        if (url instanceof window.ArrayBuffer) {\n            decodeArrayBuffer(url);\n            return;\n        }\n        request = new XMLHttpRequest();\n        request.open('GET', url, true);\n        request.responseType = 'arraybuffer';\n        request.addEventListener('progress', progressHandler);\n        request.addEventListener('load', loadHandler);\n        request.addEventListener('error', errorHandler);\n        request.send();\n    }\n\n    // audio element\n\n    function loadAudioElement() {\n        if (!data || !data.tagName) {\n            data = document.createElement('audio');\n        }\n\n        if (!isTouchLocked) {\n            // timeout because sometimes canplaythrough doesn't fire\n            window.clearTimeout(timeout);\n            timeout = window.setTimeout(readyHandler, 2000);\n            data.addEventListener('canplaythrough', readyHandler, false);\n        }\n\n        data.addEventListener('error', errorHandler, false);\n        data.preload = 'auto';\n        data.src = url;\n        data.load();\n\n        if (isTouchLocked) {\n            dispatchComplete(data);\n        }\n    }\n\n    function start() {\n        var force = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];\n\n        if (deferLoad && !force) {\n            return;\n        }\n        if (audioContext) {\n            loadArrayBuffer();\n        } else {\n            loadAudioElement();\n        }\n    }\n\n    // reload\n\n    function load(newUrl) {\n        url = newUrl;\n        start();\n    }\n\n    var api = {\n        on: emitter.on.bind(emitter),\n        once: emitter.once.bind(emitter),\n        off: emitter.off.bind(emitter),\n        load: load,\n        start: start,\n        cancel: cancel,\n        destroy: destroy\n    };\n\n    Object.defineProperties(api, {\n        data: {\n            get: function get() {\n                return data;\n            }\n        },\n        progress: {\n            get: function get() {\n                return progress;\n            }\n        },\n        audioContext: {\n            set: function set(value) {\n                audioContext = value;\n            }\n        },\n        isTouchLocked: {\n            set: function set(value) {\n                isTouchLocked = value;\n            }\n        }\n    });\n\n    return Object.freeze(api);\n}\n\nLoader.Group = function () {\n    var emitter = new Emitter();\n    var queue = [];\n    var numLoaded = 0,\n        numTotal = 0,\n        currentLoader = void 0;\n\n    function progressHandler(progress) {\n        var loaded = numLoaded + progress;\n        emitter.emit('progress', loaded / numTotal);\n    }\n\n    function completeHandler() {\n        numLoaded++;\n        removeListeners();\n        emitter.emit('progress', numLoaded / numTotal);\n        next();\n    }\n\n    function errorHandler(e) {\n        console.error(e);\n        removeListeners();\n        emitter.emit('error', e);\n        next();\n    }\n\n    function next() {\n        if (queue.length === 0) {\n            currentLoader = null;\n            emitter.emit('complete');\n            return;\n        }\n\n        currentLoader = queue.pop();\n        currentLoader.on('progress', progressHandler);\n        currentLoader.once('loaded', completeHandler);\n        currentLoader.once('error', errorHandler);\n        currentLoader.start();\n    }\n\n    function removeListeners() {\n        currentLoader.off('progress', progressHandler);\n        currentLoader.off('loaded', completeHandler);\n        currentLoader.off('error', errorHandler);\n    }\n\n    function add(loader) {\n        queue.push(loader);\n        numTotal++;\n        return loader;\n    }\n\n    function start() {\n        numTotal = queue.length;\n        next();\n    }\n\n    return Object.freeze({\n        on: emitter.on.bind(emitter),\n        once: emitter.once.bind(emitter),\n        off: emitter.off.bind(emitter),\n        add: add,\n        start: start\n    });\n};\n\nfunction BufferSource(buffer, context, onEnded) {\n    var api = {};\n    var ended = false,\n        endedCallback = onEnded,\n        loop = false,\n        paused = false,\n        pausedAt = 0,\n        playbackRate = 1,\n        playing = false,\n        sourceNode = null,\n        startedAt = 0;\n\n    function createSourceNode() {\n        if (!sourceNode && context) {\n            sourceNode = context.createBufferSource();\n            sourceNode.buffer = buffer;\n        }\n        return sourceNode;\n    }\n\n    /*\n     * Controls\n     */\n\n    function stop() {\n        if (sourceNode) {\n            sourceNode.onended = null;\n            try {\n                sourceNode.disconnect();\n                sourceNode.stop(0);\n            } catch (e) {}\n            sourceNode = null;\n        }\n\n        paused = false;\n        pausedAt = 0;\n        playing = false;\n        startedAt = 0;\n    }\n\n    function pause() {\n        var elapsed = context.currentTime - startedAt;\n        stop();\n        pausedAt = elapsed;\n        playing = false;\n        paused = true;\n    }\n\n    function endedHandler() {\n        stop();\n        ended = true;\n        if (typeof endedCallback === 'function') {\n            endedCallback(api);\n        }\n    }\n\n    function play(delay) {\n        var offset = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];\n\n        if (playing) {\n            return;\n        }\n\n        delay = delay ? context.currentTime + delay : 0;\n        if (offset) {\n            pausedAt = 0;\n        }\n        if (pausedAt) {\n            offset = pausedAt;\n        }\n        while (offset > api.duration) {\n            offset = offset % api.duration;\n        }\n\n        createSourceNode();\n        sourceNode.onended = endedHandler;\n        sourceNode.start(delay, offset);\n\n        sourceNode.loop = loop;\n        sourceNode.playbackRate.value = playbackRate;\n\n        startedAt = context.currentTime - offset;\n        ended = false;\n        paused = false;\n        pausedAt = 0;\n        playing = true;\n    }\n\n    /*\n     * Destroy\n     */\n\n    function destroy() {\n        stop();\n        buffer = null;\n        context = null;\n        endedCallback = null;\n        sourceNode = null;\n    }\n\n    /*\n     * Getters & Setters\n     */\n\n    Object.defineProperties(api, {\n        play: {\n            value: play\n        },\n        pause: {\n            value: pause\n        },\n        stop: {\n            value: stop\n        },\n        destroy: {\n            value: destroy\n        },\n        currentTime: {\n            get: function get() {\n                if (pausedAt) {\n                    return pausedAt;\n                }\n                if (startedAt) {\n                    var time = context.currentTime - startedAt;\n                    if (time > api.duration) {\n                        time = time % api.duration;\n                    }\n                    return time;\n                }\n                return 0;\n            }\n        },\n        duration: {\n            get: function get() {\n                return buffer ? buffer.duration : 0;\n            }\n        },\n        ended: {\n            get: function get() {\n                return ended;\n            }\n        },\n        loop: {\n            get: function get() {\n                return loop;\n            },\n            set: function set(value) {\n                loop = !!value;\n                if (sourceNode) {\n                    sourceNode.loop = loop;\n                }\n            }\n        },\n        paused: {\n            get: function get() {\n                return paused;\n            }\n        },\n        playbackRate: {\n            get: function get() {\n                return playbackRate;\n            },\n            set: function set(value) {\n                playbackRate = value;\n                if (sourceNode) {\n                    sourceNode.playbackRate.value = playbackRate;\n                }\n            }\n        },\n        playing: {\n            get: function get() {\n                return playing;\n            }\n        },\n        progress: {\n            get: function get() {\n                return api.duration ? api.currentTime / api.duration : 0;\n            }\n        },\n        sourceNode: {\n            get: function get() {\n                return createSourceNode();\n            }\n        }\n    });\n\n    return Object.freeze(api);\n}\n\nfunction MediaSource(el, context, onEnded) {\n    var api = {};\n    var ended = false,\n        endedCallback = onEnded,\n        delayTimeout = void 0,\n        fadeTimeout = void 0,\n        loop = false,\n        paused = false,\n        playbackRate = 1,\n        playing = false,\n        sourceNode = null,\n        groupVolume = 1,\n        volume = 1;\n\n    function createSourceNode() {\n        if (!sourceNode && context) {\n            sourceNode = context.createMediaElementSource(el);\n        }\n        return sourceNode;\n    }\n\n    /*\n     * Load\n     */\n\n    function load(url) {\n        el.src = url;\n        el.load();\n        ended = false;\n        paused = false;\n        playing = false;\n    }\n\n    /*\n     * Controls\n     */\n\n    function readyHandler() {\n        el.removeEventListener('canplaythrough', readyHandler);\n        if (playing) {\n            el.play();\n        }\n    }\n\n    /*\n     * Ended handler\n     */\n\n    function endedHandler() {\n\n        if (loop) {\n            el.currentTime = 0;\n            // fixes bug where server doesn't support seek:\n            if (el.currentTime > 0) {\n                el.load();\n            }\n            el.play();\n\n            return;\n        }\n\n        ended = true;\n        paused = false;\n        playing = false;\n\n        if (typeof endedCallback === 'function') {\n            endedCallback(api);\n        }\n    }\n\n    function play(delay, offset) {\n        clearTimeout(delayTimeout);\n\n        el.volume = volume * groupVolume;\n        el.playbackRate = playbackRate;\n\n        if (offset) {\n            el.currentTime = offset;\n        }\n\n        if (delay) {\n            delayTimeout = setTimeout(play, delay);\n        } else {\n            // el.load();\n            el.play();\n        }\n\n        ended = false;\n        paused = false;\n        playing = true;\n\n        el.removeEventListener('ended', endedHandler);\n        el.addEventListener('ended', endedHandler, false);\n\n        if (el.readyState < 1) {\n            el.removeEventListener('canplaythrough', readyHandler);\n            el.addEventListener('canplaythrough', readyHandler, false);\n            el.load();\n            el.play();\n        }\n    }\n\n    function pause() {\n        clearTimeout(delayTimeout);\n\n        if (!el) {\n            return;\n        }\n\n        el.pause();\n        playing = false;\n        paused = true;\n    }\n\n    function stop() {\n        clearTimeout(delayTimeout);\n\n        if (!el) {\n            return;\n        }\n\n        el.pause();\n\n        try {\n            el.currentTime = 0;\n            // fixes bug where server doesn't support seek:\n            if (el.currentTime > 0) {\n                el.load();\n            }\n        } catch (e) {}\n\n        playing = false;\n        paused = false;\n    }\n\n    /*\n     * Fade for no webaudio\n     */\n\n    function fade(toVolume, duration) {\n        if (context) {\n            return api;\n        }\n\n        function ramp(value, step) {\n            fadeTimeout = window.setTimeout(function () {\n                api.volume = api.volume + (value - api.volume) * 0.2;\n                if (Math.abs(api.volume - value) > 0.05) {\n                    ramp(value, step);\n                    return;\n                }\n                api.volume = value;\n            }, step * 1000);\n        }\n\n        window.clearTimeout(fadeTimeout);\n        ramp(toVolume, duration / 10);\n\n        return api;\n    }\n\n    /*\n     * Destroy\n     */\n\n    function destroy() {\n        el.removeEventListener('ended', endedHandler);\n        el.removeEventListener('canplaythrough', readyHandler);\n        stop();\n        el = null;\n        context = null;\n        endedCallback = null;\n        sourceNode = null;\n    }\n\n    /*\n     * Getters & Setters\n     */\n\n    Object.defineProperties(api, {\n        play: {\n            value: play\n        },\n        pause: {\n            value: pause\n        },\n        stop: {\n            value: stop\n        },\n        load: {\n            value: load\n        },\n        fade: {\n            value: fade\n        },\n        destroy: {\n            value: destroy\n        },\n        currentTime: {\n            get: function get() {\n                return el ? el.currentTime : 0;\n            }\n        },\n        duration: {\n            get: function get() {\n                return el ? el.duration : 0;\n            }\n        },\n        ended: {\n            get: function get() {\n                return ended;\n            }\n        },\n        loop: {\n            get: function get() {\n                return loop;\n            },\n            set: function set(value) {\n                loop = !!value;\n            }\n        },\n        paused: {\n            get: function get() {\n                return paused;\n            }\n        },\n        playbackRate: {\n            get: function get() {\n                return playbackRate;\n            },\n            set: function set(value) {\n                playbackRate = value;\n                if (el) {\n                    el.playbackRate = playbackRate;\n                }\n            }\n        },\n        playing: {\n            get: function get() {\n                return playing;\n            }\n        },\n        progress: {\n            get: function get() {\n                return el && el.duration ? el.currentTime / el.duration : 0;\n            }\n        },\n        sourceNode: {\n            get: function get() {\n                return createSourceNode();\n            }\n        },\n        volume: {\n            get: function get() {\n                return volume;\n            },\n            set: function set(value) {\n                window.clearTimeout(fadeTimeout);\n                volume = value;\n                if (el) {\n                    el.volume = volume * groupVolume;\n                }\n            }\n        },\n        groupVolume: {\n            get: function get() {\n                return groupVolume;\n            },\n            set: function set(value) {\n                groupVolume = value;\n                if (el) {\n                    el.volume = volume * groupVolume;\n                }\n            }\n        }\n    });\n\n    return Object.freeze(api);\n}\n\nfunction MicrophoneSource(stream, context) {\n    var ended = false,\n        paused = false,\n        pausedAt = 0,\n        playing = false,\n        sourceNode = null,\n        // MicrophoneSourceNode\n    startedAt = 0;\n\n    function createSourceNode() {\n        if (!sourceNode && context) {\n            sourceNode = context.createMediaStreamSource(stream);\n            // HACK: stops moz garbage collection killing the stream\n            // see https://support.mozilla.org/en-US/questions/984179\n            if (navigator.mozGetUserMedia) {\n                window.mozHack = sourceNode;\n            }\n        }\n        return sourceNode;\n    }\n\n    /*\n     * Controls\n     */\n\n    function play(delay) {\n        delay = delay ? context.currentTime + delay : 0;\n\n        createSourceNode();\n        sourceNode.start(delay);\n\n        startedAt = context.currentTime - pausedAt;\n        ended = false;\n        playing = true;\n        paused = false;\n        pausedAt = 0;\n    }\n\n    function stop() {\n        if (sourceNode) {\n            try {\n                sourceNode.stop(0);\n            } catch (e) {}\n            sourceNode = null;\n        }\n        ended = true;\n        paused = false;\n        pausedAt = 0;\n        playing = false;\n        startedAt = 0;\n    }\n\n    function pause() {\n        var elapsed = context.currentTime - startedAt;\n        stop();\n        pausedAt = elapsed;\n        playing = false;\n        paused = true;\n    }\n\n    /*\n     * Destroy\n     */\n\n    function destroy() {\n        stop();\n        context = null;\n        sourceNode = null;\n        stream = null;\n        window.mozHack = null;\n    }\n\n    /*\n     * Api\n     */\n\n    var api = {\n        play: play,\n        pause: pause,\n        stop: stop,\n        destroy: destroy,\n\n        duration: 0,\n        progress: 0\n    };\n\n    /*\n     * Getters & Setters\n     */\n\n    Object.defineProperties(api, {\n        currentTime: {\n            get: function get() {\n                if (pausedAt) {\n                    return pausedAt;\n                }\n                if (startedAt) {\n                    return context.currentTime - startedAt;\n                }\n                return 0;\n            }\n        },\n        ended: {\n            get: function get() {\n                return ended;\n            }\n        },\n        paused: {\n            get: function get() {\n                return paused;\n            }\n        },\n        playing: {\n            get: function get() {\n                return playing;\n            }\n        },\n        sourceNode: {\n            get: function get() {\n                return createSourceNode();\n            }\n        }\n    });\n\n    return Object.freeze(api);\n}\n\nfunction OscillatorSource(type, context) {\n    var ended = false,\n        paused = false,\n        pausedAt = 0,\n        playing = false,\n        sourceNode = null,\n        // OscillatorSourceNode\n    startedAt = 0,\n        frequency = 200,\n        api = null;\n\n    function createSourceNode() {\n        if (!sourceNode && context) {\n            sourceNode = context.createOscillator();\n            sourceNode.type = type;\n            sourceNode.frequency.value = frequency;\n        }\n        return sourceNode;\n    }\n\n    /*\n     * Controls\n     */\n\n    function play(delay) {\n        delay = delay || 0;\n        if (delay) {\n            delay = context.currentTime + delay;\n        }\n\n        createSourceNode();\n        sourceNode.start(delay);\n\n        if (pausedAt) {\n            startedAt = context.currentTime - pausedAt;\n        } else {\n            startedAt = context.currentTime;\n        }\n\n        ended = false;\n        playing = true;\n        paused = false;\n        pausedAt = 0;\n    }\n\n    function stop() {\n        if (sourceNode) {\n            try {\n                sourceNode.stop(0);\n            } catch (e) {}\n            sourceNode = null;\n        }\n        ended = true;\n        paused = false;\n        pausedAt = 0;\n        playing = false;\n        startedAt = 0;\n    }\n\n    function pause() {\n        var elapsed = context.currentTime - startedAt;\n        stop();\n        pausedAt = elapsed;\n        playing = false;\n        paused = true;\n    }\n\n    /*\n     * Destroy\n     */\n\n    function destroy() {\n        stop();\n        context = null;\n        sourceNode = null;\n    }\n\n    /*\n     * Api\n     */\n\n    api = {\n        play: play,\n        pause: pause,\n        stop: stop,\n        destroy: destroy\n    };\n\n    /*\n     * Getters & Setters\n     */\n\n    Object.defineProperties(api, {\n        currentTime: {\n            get: function get() {\n                if (pausedAt) {\n                    return pausedAt;\n                }\n                if (startedAt) {\n                    return context.currentTime - startedAt;\n                }\n                return 0;\n            }\n        },\n        duration: {\n            value: 0\n        },\n        ended: {\n            get: function get() {\n                return ended;\n            }\n        },\n        frequency: {\n            get: function get() {\n                return frequency;\n            },\n            set: function set(value) {\n                frequency = value;\n                if (sourceNode) {\n                    sourceNode.frequency.value = value;\n                }\n            }\n        },\n        paused: {\n            get: function get() {\n                return paused;\n            }\n        },\n        playing: {\n            get: function get() {\n                return playing;\n            }\n        },\n        progress: {\n            value: 0\n        },\n        sourceNode: {\n            get: function get() {\n                return createSourceNode();\n            }\n        }\n    });\n\n    return Object.freeze(api);\n}\n\nfunction ScriptSource(data, context) {\n    var bufferSize = data.bufferSize || 1024;\n    var channels = data.channels || 1;\n    var ended = false,\n        onProcess = data.callback.bind(data.thisArg || this),\n        paused = false,\n        pausedAt = 0,\n        playing = false,\n        sourceNode = null,\n        // ScriptSourceNode\n    startedAt = 0,\n        api = null;\n\n    function createSourceNode() {\n        if (!sourceNode && context) {\n            sourceNode = context.createScriptProcessor(bufferSize, 0, channels);\n        }\n        return sourceNode;\n    }\n\n    /*\n     * Controls\n     */\n\n    function play() {\n        createSourceNode();\n        sourceNode.onaudioprocess = onProcess;\n\n        startedAt = context.currentTime - pausedAt;\n        ended = false;\n        paused = false;\n        pausedAt = 0;\n        playing = true;\n    }\n\n    function onPaused(event) {\n        var buffer = event.outputBuffer;\n        for (var i = 0; i < buffer.numberOfChannels; i++) {\n            var channel = buffer.getChannelData(i);\n            for (var j = 0; j < channel.length; j++) {\n                channel[j] = 0;\n            }\n        }\n    }\n\n    function stop() {\n        if (sourceNode) {\n            sourceNode.onaudioprocess = onPaused;\n        }\n        ended = true;\n        paused = false;\n        pausedAt = 0;\n        playing = false;\n        startedAt = 0;\n    }\n\n    function pause() {\n        var elapsed = context.currentTime - startedAt;\n        stop();\n        pausedAt = elapsed;\n        playing = false;\n        paused = true;\n    }\n\n    /*\n     * Destroy\n     */\n\n    function destroy() {\n        stop();\n        context = null;\n        onProcess = null;\n        sourceNode = null;\n    }\n\n    /*\n     * Api\n     */\n\n    api = {\n        play: play,\n        pause: pause,\n        stop: stop,\n        destroy: destroy,\n\n        duration: 0,\n        progress: 0\n    };\n\n    /*\n     * Getters & Setters\n     */\n\n    Object.defineProperties(api, {\n        currentTime: {\n            get: function get() {\n                if (pausedAt) {\n                    return pausedAt;\n                }\n                if (startedAt) {\n                    return context.currentTime - startedAt;\n                }\n                return 0;\n            }\n        },\n        ended: {\n            get: function get() {\n                return ended;\n            }\n        },\n        paused: {\n            get: function get() {\n                return paused;\n            }\n        },\n        playing: {\n            get: function get() {\n                return playing;\n            }\n        },\n        sourceNode: {\n            get: function get() {\n                return createSourceNode();\n            }\n        }\n    });\n\n    return Object.freeze(api);\n}\n\nfunction waveform() {\n    var buffer = void 0,\n        wave = void 0;\n\n    return function (audioBuffer, length) {\n        if (!window.Float32Array || !window.AudioBuffer) {\n            return [];\n        }\n\n        var sameBuffer = buffer === audioBuffer;\n        var sameLength = wave && wave.length === length;\n        if (sameBuffer && sameLength) {\n            return wave;\n        }\n\n        //console.time('waveData');\n        if (!wave || wave.length !== length) {\n            wave = new Float32Array(length);\n        }\n\n        if (!audioBuffer) {\n            return wave;\n        }\n\n        // cache for repeated calls\n        buffer = audioBuffer;\n\n        var chunk = Math.floor(buffer.length / length),\n            resolution = 5,\n            // 10\n        incr = Math.max(Math.floor(chunk / resolution), 1);\n        var greatest = 0;\n\n        for (var i = 0; i < buffer.numberOfChannels; i++) {\n            // check each channel\n            var channel = buffer.getChannelData(i);\n            for (var j = 0; j < length; j++) {\n                // get highest value within the chunk\n                for (var k = j * chunk, l = k + chunk; k < l; k += incr) {\n                    // select highest value from channels\n                    var a = channel[k];\n                    if (a < 0) {\n                        a = -a;\n                    }\n                    if (a > wave[j]) {\n                        wave[j] = a;\n                    }\n                    // update highest overall for scaling\n                    if (a > greatest) {\n                        greatest = a;\n                    }\n                }\n            }\n        }\n        // scale up\n        var scale = 1 / greatest;\n        for (var _i = 0; _i < wave.length; _i++) {\n            wave[_i] *= scale;\n        }\n        //console.timeEnd('waveData');\n\n        return wave;\n    };\n}\n\nfunction Sound(config) {\n    var context = config.context;\n    var destination = config.destination;\n    var effect = new Effect(context);\n    var gain = effect.gain();\n    var wave = waveform();\n\n    var id = null;\n    var data = null;\n    var isTouchLocked = false;\n    var loader = null;\n    var loop = false;\n    var playbackRate = 1;\n    var playWhenReady = null;\n    var source = null;\n    var sound = null;\n\n    if (context) {\n        effect.setDestination(gain);\n        gain.connect(destination || context.destination);\n    }\n\n    /*\n     * Create source\n     */\n\n    function createSource(value) {\n        data = value;\n\n        if (file.isAudioBuffer(data)) {\n            source = new BufferSource(data, context, function () {\n                return sound.emit('ended', sound);\n            });\n        } else if (file.isMediaElement(data)) {\n            source = new MediaSource(data, context, function () {\n                return sound.emit('ended', sound);\n            });\n        } else if (file.isMediaStream(data)) {\n            source = new MicrophoneSource(data, context);\n        } else if (file.isOscillatorType(data && data.type || data)) {\n            source = new OscillatorSource(data.type || data, context);\n        } else if (file.isScriptConfig(data)) {\n            source = new ScriptSource(data, context);\n        } else {\n            throw new Error('Cannot detect data type: ' + data);\n        }\n\n        effect.setSource(source.sourceNode);\n\n        sound.emit('ready', sound);\n\n        if (playWhenReady) {\n            playWhenReady();\n        }\n    }\n\n    /*\n     * Load\n     */\n\n    function onLoad(fileData) {\n        createSource(fileData);\n        sound.emit('loaded', sound);\n    }\n\n    function onLoadError(err) {\n        sound.emit('error', sound, err);\n    }\n\n    function load() {\n        var newConfig = arguments.length <= 0 || arguments[0] === undefined ? null : arguments[0];\n        var force = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];\n\n        var skipLoad = !force && !source && !!config.deferLoad;\n\n        if (newConfig) {\n            var src = file.getSupportedFile(config.src || config.url || config.data || config) || config.src;\n            config = Object.assign(config, newConfig, { src: src });\n        }\n\n        if (source && data && data.tagName) {\n            source.load(config.src);\n        } else {\n            loader = loader || new Loader(config.src, skipLoad);\n            loader.audioContext = !!config.asMediaElement ? null : context;\n            loader.isTouchLocked = isTouchLocked;\n            loader.off('loaded', onLoad);\n            loader.once('loaded', onLoad);\n            loader.off('error', onLoadError);\n            loader.on('error', onLoadError);\n        }\n        return sound;\n    }\n\n    /*\n     * Controls\n     */\n\n    function play(delay, offset) {\n        if (!source || isTouchLocked) {\n            playWhenReady = function playWhenReady() {\n                if (source) {\n                    play(delay, offset);\n                }\n            };\n            if (!!config.deferLoad) {\n                if (!loader) {\n                    load(null, true);\n                }\n                loader.start(true);\n            }\n            return sound;\n        }\n        playWhenReady = null;\n        effect.setSource(source.sourceNode);\n\n        // update volume needed for no webaudio\n        if (!context) {\n            sound.volume = gain.gain.value;\n        }\n\n        source.play(delay, offset);\n\n        if (source.hasOwnProperty('loop')) {\n            source.loop = loop;\n        }\n\n        sound.emit('play', sound);\n\n        return sound;\n    }\n\n    function pause() {\n        source && source.pause();\n        sound.emit('pause', sound);\n        return sound;\n    }\n\n    function stop(delay) {\n        source && source.stop(delay || 0);\n        sound.emit('stop', sound);\n        return sound;\n    }\n\n    function seek(percent) {\n        if (source) {\n            source.stop();\n            play(0, source.duration * percent);\n        }\n        return sound;\n    }\n\n    function fade(volume, duration) {\n        if (!source) {\n            return sound;\n        }\n\n        var param = gain.gain;\n\n        if (context) {\n            var time = context.currentTime;\n            param.cancelScheduledValues(time);\n            param.setValueAtTime(param.value, time);\n            param.linearRampToValueAtTime(volume, time + duration);\n        } else if (typeof source.fade === 'function') {\n            source.fade(volume, duration);\n            param.value = volume;\n        }\n\n        sound.emit('fade', sound, volume);\n\n        return sound;\n    }\n\n    function unload() {\n        source && source.destroy();\n        loader && loader.destroy();\n        data = null;\n        playWhenReady = null;\n        source = null;\n        loader = null;\n        config.deferLoad = true;\n        sound.emit('unload', sound);\n    }\n\n    function reload() {\n        load(null, true);\n    }\n\n    /*\n     * Destroy\n     */\n\n    function destroy() {\n        source && source.destroy();\n        effect && effect.destroy();\n        gain && gain.disconnect();\n        loader && loader.off('loaded');\n        loader && loader.off('error');\n        loader && loader.destroy();\n        sound.off('loaded');\n        sound.off('ended');\n        sound.off('error');\n        gain = null;\n        context = null;\n        destination = null;\n        data = null;\n        playWhenReady = null;\n        source = null;\n        effect = null;\n        loader = null;\n        wave = null;\n        config = null;\n        sound.emit('destroy', sound);\n        sound.off('destroy');\n    }\n\n    sound = Object.create(Emitter.prototype, {\n        _events: {\n            value: {}\n        },\n        constructor: {\n            value: Sound\n        },\n        play: {\n            value: play\n        },\n        pause: {\n            value: pause\n        },\n        load: {\n            value: load\n        },\n        seek: {\n            value: seek\n        },\n        stop: {\n            value: stop\n        },\n        fade: {\n            value: fade\n        },\n        unload: {\n            value: unload\n        },\n        reload: {\n            value: reload\n        },\n        destroy: {\n            value: destroy\n        },\n        context: {\n            value: context\n        },\n        currentTime: {\n            get: function get() {\n                return source ? source.currentTime : 0;\n            },\n            set: function set(value) {\n                // const silent = sound.playing;\n                source && source.stop();\n                // play(0, value, silent);\n                play(0, value);\n            }\n        },\n        data: {\n            get: function get() {\n                return data;\n            },\n            set: function set(value) {\n                if (!value) {\n                    return;\n                }\n                createSource(value);\n            }\n        },\n        duration: {\n            get: function get() {\n                return source ? source.duration : 0;\n            }\n        },\n        effect: {\n            value: effect\n        },\n        ended: {\n            get: function get() {\n                return !!source && source.ended;\n            }\n        },\n        frequency: {\n            get: function get() {\n                return source ? source.frequency : 0;\n            },\n            set: function set(value) {\n                if (source && source.hasOwnProperty('frequency')) {\n                    source.frequency = value;\n                }\n            }\n        },\n        gain: {\n            value: gain\n        },\n        id: {\n            get: function get() {\n                return id;\n            },\n            set: function set(value) {\n                id = value;\n            }\n        },\n        isTouchLocked: {\n            set: function set(value) {\n                isTouchLocked = value;\n                if (loader) {\n                    loader.isTouchLocked = value;\n                }\n                if (!value && playWhenReady) {\n                    playWhenReady();\n                }\n            }\n        },\n        loader: {\n            get: function get() {\n                return loader;\n            }\n        },\n        loop: {\n            get: function get() {\n                return loop;\n            },\n            set: function set(value) {\n                loop = !!value;\n\n                if (source && source.hasOwnProperty('loop') && source.loop !== loop) {\n                    source.loop = loop;\n                }\n            }\n        },\n        config: {\n            get: function get() {\n                return config;\n            }\n        },\n        paused: {\n            get: function get() {\n                return !!source && source.paused;\n            }\n        },\n        playing: {\n            get: function get() {\n                return !!source && source.playing;\n            }\n        },\n        playbackRate: {\n            get: function get() {\n                return playbackRate;\n            },\n            set: function set(value) {\n                playbackRate = value;\n                if (source) {\n                    source.playbackRate = playbackRate;\n                }\n            }\n        },\n        progress: {\n            get: function get() {\n                return source ? source.progress : 0;\n            }\n        },\n        sourceNode: {\n            get: function get() {\n                return source ? source.sourceNode : null;\n            }\n        },\n        volume: {\n            get: function get() {\n                if (context) {\n                    return gain.gain.value;\n                }\n                if (source && source.hasOwnProperty('volume')) {\n                    return source.volume;\n                }\n                return 1;\n            },\n            set: function set(value) {\n                if (isNaN(value)) {\n                    return;\n                }\n\n                value = Math.min(Math.max(value, 0), 1);\n\n                var param = gain.gain;\n\n                if (context) {\n                    var time = context.currentTime;\n                    param.cancelScheduledValues(time);\n                    param.value = value;\n                    param.setValueAtTime(value, time);\n                } else {\n                    param.value = value;\n\n                    if (source && source.hasOwnProperty('volume')) {\n                        source.volume = value;\n                    }\n                }\n            }\n        },\n        // for media element source\n        groupVolume: {\n            get: function get() {\n                return source.groupVolume;\n            },\n            set: function set(value) {\n                if (source && source.hasOwnProperty('groupVolume')) {\n                    source.groupVolume = value;\n                }\n            }\n        },\n        waveform: {\n            value: function value(length) {\n                if (!data) {\n                    sound.once('ready', function () {\n                        return wave(data, length);\n                    });\n                }\n                return wave(data, length);\n            }\n        },\n        userData: {\n            value: {}\n        }\n    });\n\n    return sound;\n}\n\n// expose for unit tests\nSound.__source = {\n    BufferSource: BufferSource,\n    MediaSource: MediaSource,\n    MicrophoneSource: MicrophoneSource,\n    OscillatorSource: OscillatorSource,\n    ScriptSource: ScriptSource\n};\n\nfunction SoundGroup(context, destination) {\n    var group = new Group(context, destination);\n    var sounds = group.sounds;\n    var playbackRate = 1,\n        loop = false,\n        src = void 0;\n\n    function getSource() {\n        if (!sounds.length) {\n            return;\n        }\n\n        src = sounds.slice(0).sort(function (a, b) {\n            return b.duration - a.duration;\n        })[0];\n    }\n\n    var add = group.add;\n    group.add = function (sound) {\n        add(sound);\n        getSource();\n        return group;\n    };\n\n    var remove = group.rmeove;\n    group.remove = function (soundOrId) {\n        remove(soundOrId);\n        getSource();\n        return group;\n    };\n\n    Object.defineProperties(group, {\n        currentTime: {\n            get: function get() {\n                return src ? src.currentTime : 0;\n            },\n            set: function set(value) {\n                this.stop();\n                this.play(0, value);\n            }\n        },\n        duration: {\n            get: function get() {\n                return src ? src.duration : 0;\n            }\n        },\n        // ended: {\n        //     get: function() {\n        //         return src ? src.ended : false;\n        //     }\n        // },\n        loop: {\n            get: function get() {\n                return loop;\n            },\n            set: function set(value) {\n                loop = !!value;\n                sounds.forEach(function (sound) {\n                    sound.loop = loop;\n                });\n            }\n        },\n        paused: {\n            get: function get() {\n                // return src ? src.paused : false;\n                return !!src && src.paused;\n            }\n        },\n        progress: {\n            get: function get() {\n                return src ? src.progress : 0;\n            }\n        },\n        playbackRate: {\n            get: function get() {\n                return playbackRate;\n            },\n            set: function set(value) {\n                playbackRate = value;\n                sounds.forEach(function (sound) {\n                    sound.playbackRate = playbackRate;\n                });\n            }\n        },\n        playing: {\n            get: function get() {\n                // return src ? src.playing : false;\n                return !!src && src.playing;\n            }\n        }\n    });\n\n    return group;\n}\n\nfunction Microphone(connected, denied, error) {\n    navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;\n    error = error || function () {};\n\n    var isSupported = !!navigator.getUserMedia;\n    var api = {};\n    var stream = null;\n\n    function connect() {\n        if (!isSupported) {\n            return api;\n        }\n\n        navigator.getUserMedia({\n            audio: true\n        }, function (micStream) {\n            stream = micStream;\n            connected(stream);\n        }, function (e) {\n            if (denied && e.name === 'PermissionDeniedError' || e === 'PERMISSION_DENIED') {\n                // console.log('Permission denied. Reset by clicking the camera icon with the red cross.');\n                denied();\n            } else {\n                error(e.message || e);\n            }\n        });\n        return api;\n    }\n\n    function disconnect() {\n        if (stream) {\n            stream.stop();\n            stream = null;\n        }\n        return api;\n    }\n\n    Object.defineProperties(api, {\n        connect: {\n            value: connect\n        },\n        disconnect: {\n            value: disconnect\n        },\n        isSupported: {\n            value: isSupported\n        },\n        stream: {\n            get: function get() {\n                return stream;\n            }\n        }\n    });\n\n    return Object.freeze(api);\n}\n\nvar halfPI = Math.PI / 2;\nvar twoPI = Math.PI * 2;\n\nfunction waveformer(config) {\n\n    var style = config.style || 'fill',\n        // 'fill' or 'line'\n    shape = config.shape || 'linear',\n        // 'circular' or 'linear'\n    color = config.color || 0,\n        bgColor = config.bgColor,\n        lineWidth = config.lineWidth || 1,\n        percent = config.percent || 1,\n        originX = config.x || 0,\n        originY = config.y || 0,\n        transform = config.transform;\n\n    var canvas = config.canvas,\n        width = config.width || canvas && canvas.width,\n        height = config.height || canvas && canvas.height;\n\n    var ctx = null,\n        currentColor = void 0,\n        i = void 0,\n        x = void 0,\n        y = void 0,\n        radius = void 0,\n        innerRadius = void 0,\n        centerX = void 0,\n        centerY = void 0;\n\n    if (!canvas && !config.context) {\n        canvas = document.createElement('canvas');\n        width = width || canvas.width;\n        height = height || canvas.height;\n        canvas.width = height;\n        canvas.height = height;\n    }\n\n    if (shape === 'circular') {\n        radius = config.radius || Math.min(height / 2, width / 2);\n        innerRadius = config.innerRadius || radius / 2;\n        centerX = originX + width / 2;\n        centerY = originY + height / 2;\n    }\n\n    ctx = config.context || canvas.getContext('2d');\n\n    function clear() {\n        if (bgColor) {\n            ctx.fillStyle = bgColor;\n            ctx.fillRect(originX, originY, width, height);\n        } else {\n            ctx.clearRect(originX, originY, width, height);\n        }\n\n        ctx.lineWidth = lineWidth;\n\n        currentColor = null;\n\n        if (typeof color !== 'function') {\n            ctx.strokeStyle = color;\n            ctx.beginPath();\n        }\n    }\n\n    function updateColor(position, length, value) {\n        if (typeof color === 'function') {\n            var newColor = color(position, length, value);\n            if (newColor !== currentColor) {\n                currentColor = newColor;\n                ctx.stroke();\n                ctx.strokeStyle = currentColor;\n                ctx.beginPath();\n            }\n        }\n    }\n\n    function getValue(value, position, length) {\n        if (typeof transform === 'function') {\n            return transform(value, position, length);\n        }\n        return value;\n    }\n\n    function getWaveform(value, length) {\n        if (value && typeof value.waveform === 'function') {\n            return value.waveform(length);\n        }\n        if (value) {\n            return value;\n        }\n        if (config.waveform) {\n            return config.waveform;\n        }\n        if (config.sound) {\n            return config.sound.waveform(length);\n        }\n        return null;\n    }\n\n    function update(wave) {\n\n        clear();\n\n        if (shape === 'circular') {\n            var waveform = getWaveform(wave, 360);\n            var length = Math.floor(waveform.length * percent);\n\n            var step = twoPI / length;\n            var angle = void 0,\n                magnitude = void 0,\n                sine = void 0,\n                cosine = void 0;\n\n            for (i = 0; i < length; i++) {\n                var value = getValue(waveform[i], i, length);\n                updateColor(i, length, value);\n\n                angle = i * step - halfPI;\n                cosine = Math.cos(angle);\n                sine = Math.sin(angle);\n\n                if (style === 'fill') {\n                    x = centerX + innerRadius * cosine;\n                    y = centerY + innerRadius * sine;\n                    ctx.moveTo(x, y);\n                }\n\n                magnitude = innerRadius + (radius - innerRadius) * value;\n                x = centerX + magnitude * cosine;\n                y = centerY + magnitude * sine;\n\n                if (style === 'line' && i === 0) {\n                    ctx.moveTo(x, y);\n                }\n\n                ctx.lineTo(x, y);\n            }\n\n            if (style === 'line') {\n                ctx.closePath();\n            }\n        } else {\n\n            var _waveform = getWaveform(wave, width);\n            var _length = Math.min(_waveform.length, width - lineWidth / 2);\n            _length = Math.floor(_length * percent);\n\n            for (i = 0; i < _length; i++) {\n                var _value = getValue(_waveform[i], i, _length);\n                updateColor(i, _length, _value);\n\n                if (style === 'line' && i > 0) {\n                    ctx.lineTo(x, y);\n                }\n\n                x = originX + i;\n                y = originY + height - Math.round(height * _value);\n                y = Math.floor(Math.min(y, originY + height - lineWidth / 2));\n\n                if (style === 'fill') {\n                    ctx.moveTo(x, y);\n                    ctx.lineTo(x, originY + height);\n                } else {\n                    ctx.lineTo(x, y);\n                }\n            }\n        }\n        ctx.stroke();\n    }\n\n    update.canvas = canvas;\n\n    if (config.waveform || config.sound) {\n        update();\n    }\n\n    return update;\n}\n\n/*\n * audio ctx\n */\nvar ctx = void 0;\nvar offlineCtx = void 0;\n\nfunction getContext() {\n\tif (ctx) {\n\t\treturn ctx;\n\t}\n\n\tvar desiredSampleRate = 44100;\n\n\tvar Ctx = window.AudioContext || window.webkitAudioContext;\n\n\tctx = Ctx ? new Ctx() : null;\n\n\t// Check if hack is necessary. Only occurs in iOS6+ devices\n\t// and only when you first boot the iPhone, or play a audio/video\n\t// with a different sample rate\n\t// https://github.com/Jam3/ios-safe-audio-context/blob/master/index.js\n\tif (/(iPhone|iPad)/i.test(navigator.userAgent) && ctx.sampleRate !== desiredSampleRate) {\n\t\tvar buffer = ctx.createBuffer(1, 1, desiredSampleRate);\n\t\tvar dummy = ctx.createBufferSource();\n\t\tdummy.buffer = buffer;\n\t\tdummy.connect(ctx.destination);\n\t\tdummy.start(0);\n\t\tdummy.disconnect();\n\n\t\tctx.close(); // dispose old context\n\t\tctx = Ctx ? new Ctx() : null;\n\t}\n\n\t// Handles bug in Safari 9 OSX where AudioContext instance starts in 'suspended' state\n\n\tvar isSuspended = ctx && ctx.state === 'suspended';\n\n\tif (isSuspended && typeof ctx.resume === 'function') {\n\t\twindow.setTimeout(function () {\n\t\t\tctx.resume();\n\t\t}, 1000);\n\t}\n\n\treturn ctx;\n}\n\n/*\nIn contrast with a standard AudioContext, an OfflineAudioContext doesn't render\nthe audio to the device hardware;\ninstead, it generates it, as fast as it can, and outputs the result to an AudioBuffer.\n*/\nfunction getOfflineContext(numOfChannels, length, sampleRate) {\n\tif (offlineCtx) {\n\t\treturn offlineCtx;\n\t}\n\tnumOfChannels = numOfChannels || 2;\n\tsampleRate = sampleRate || 44100;\n\tlength = sampleRate || numOfChannels;\n\n\tvar OfflineCtx = window.OfflineAudioContext || window.webkitOfflineAudioContext;\n\n\tofflineCtx = OfflineCtx ? new OfflineCtx(numOfChannels, length, sampleRate) : null;\n\n\treturn offlineCtx;\n}\n\n/*\n * clone audio buffer\n */\n\nfunction cloneBuffer(buffer) {\n\tif (!ctx) {\n\t\treturn buffer;\n\t}\n\n\tvar numChannels = buffer.numberOfChannels,\n\t    cloned = ctx.createBuffer(numChannels, buffer.length, buffer.sampleRate);\n\tfor (var i = 0; i < numChannels; i++) {\n\t\tcloned.getChannelData(i).set(buffer.getChannelData(i));\n\t}\n\treturn cloned;\n}\n\n/*\n * reverse audio buffer\n */\n\nfunction reverseBuffer(buffer) {\n\tvar numChannels = buffer.numberOfChannels;\n\tfor (var i = 0; i < numChannels; i++) {\n\t\tArray.prototype.reverse.call(buffer.getChannelData(i));\n\t}\n\treturn buffer;\n}\n\n/*\n * ramp audio param\n */\n\nfunction ramp(param, fromValue, toValue, duration, linear) {\n\tif (!ctx) {\n\t\treturn;\n\t}\n\n\tparam.setValueAtTime(fromValue, ctx.currentTime);\n\n\tif (linear) {\n\t\tparam.linearRampToValueAtTime(toValue, ctx.currentTime + duration);\n\t} else {\n\t\tparam.exponentialRampToValueAtTime(toValue, ctx.currentTime + duration);\n\t}\n}\n\n/*\n * get frequency from min to max by passing 0 to 1\n */\n\nfunction getFrequency(value) {\n\tif (!ctx) {\n\t\treturn 0;\n\t}\n\t// get frequency by passing number from 0 to 1\n\t// Clamp the frequency between the minimum value (40 Hz) and half of the\n\t// sampling rate.\n\tvar minValue = 40;\n\tvar maxValue = ctx.sampleRate / 2;\n\t// Logarithm (base 2) to compute how many octaves fall in the range.\n\tvar numberOfOctaves = Math.log(maxValue / minValue) / Math.LN2;\n\t// Compute a multiplier from 0 to 1 based on an exponential scale.\n\tvar multiplier = Math.pow(2, numberOfOctaves * (value - 1.0));\n\t// Get back to the frequency value between min and max.\n\treturn maxValue * multiplier;\n}\n\n/*\n * microphone util\n */\n\nfunction microphone(connected, denied, error) {\n\treturn new Microphone(connected, denied, error);\n}\n\n/*\n * Format seconds as timecode string\n */\n\nfunction timeCode(seconds) {\n\tvar delim = arguments.length <= 1 || arguments[1] === undefined ? ':' : arguments[1];\n\n\t// const h = Math.floor(seconds / 3600);\n\t// const m = Math.floor((seconds % 3600) / 60);\n\tvar m = Math.floor(seconds / 60);\n\tvar s = Math.floor(seconds % 3600 % 60);\n\t// const hr = (h < 10 ? '0' + h + delim : h + delim);\n\tvar mn = (m < 10 ? '0' + m : m) + delim;\n\tvar sc = s < 10 ? '0' + s : s;\n\t// return hr + mn + sc;\n\treturn mn + sc;\n}\n\nvar utils = Object.freeze({\n\tgetContext: getContext,\n\tgetOfflineContext: getOfflineContext,\n\tcloneBuffer: cloneBuffer,\n\treverseBuffer: reverseBuffer,\n\tramp: ramp,\n\tgetFrequency: getFrequency,\n\tmicrophone: microphone,\n\ttimeCode: timeCode,\n\twaveformer: waveformer\n});\n\nfunction Sono() {\n    var VERSION = '0.1.85';\n    var context = utils.getContext();\n    var destination = context ? context.destination : null;\n    var group = new Group(context, destination);\n\n    var api = null;\n    var isTouchLocked = false;\n\n    /*\n     * Get Sound by id\n     */\n\n    function getSound(id) {\n        return group.find(id);\n    }\n\n    /*\n     * Create group\n     */\n\n    function createGroup(sounds) {\n        var soundGroup = new SoundGroup(context, group.gain);\n        if (sounds) {\n            sounds.forEach(function (sound) {\n                return soundGroup.add(sound);\n            });\n        }\n        return soundGroup;\n    }\n\n    /*\n     * Loading\n     */\n\n    function add(config) {\n        var soundContext = config && config.webAudio === false ? null : context;\n        // const sound = new Sound(soundContext, group.gain);\n        var src = file.getSupportedFile(config.src || config.url || config.data || config);\n        var sound = new Sound(Object.assign({}, config || {}, {\n            src: src,\n            context: soundContext,\n            destination: group.gain\n        }));\n        sound.isTouchLocked = isTouchLocked;\n        if (config) {\n            sound.id = config.id || config.name || '';\n            sound.loop = !!config.loop;\n            sound.volume = config.volume;\n        }\n        group.add(sound);\n        return sound;\n    }\n\n    function queue(config, loaderGroup) {\n        var sound = add(config).load();\n\n        if (loaderGroup) {\n            loaderGroup.add(sound.loader);\n        }\n        return sound;\n    }\n\n    function load(config) {\n        var src = config.src || config.url || config.data || config;\n        var sound = void 0,\n            loader = void 0;\n\n        if (file.containsURL(src)) {\n            sound = queue(config);\n            loader = sound.loader;\n        } else if (Array.isArray(src) && file.containsURL(src[0].src || src[0].url)) {\n            sound = [];\n            loader = new Loader.Group();\n            src.forEach(function (url) {\n                return sound.push(queue(url, loader));\n            });\n        } else {\n            var errorMessage = 'sono.load: No audio file URLs found in config.';\n            if (config.onError) {\n                config.onError('[ERROR] ' + errorMessage);\n            } else {\n                throw new Error(errorMessage);\n            }\n            return null;\n        }\n        if (config.onProgress) {\n            loader.on('progress', function (progress) {\n                return config.onProgress(progress);\n            });\n        }\n        if (config.onComplete) {\n            loader.once('complete', function () {\n                loader.off('progress');\n                config.onComplete(sound);\n            });\n        }\n        loader.once('error', function (err) {\n            loader.off('error');\n            if (config.onError) {\n                config.onError(err);\n            } else {\n                console.error('[ERROR] sono.load: ' + err);\n            }\n        });\n        loader.start();\n\n        return sound;\n    }\n\n    /*\n     * Create Sound\n     *\n     * Accepted values for param config:\n     * Object config e.g. { id:'foo', url:['foo.ogg', 'foo.mp3'] }\n     * Array (of files e.g. ['foo.ogg', 'foo.mp3'])\n     * ArrayBuffer\n     * HTMLMediaElement\n     * Filename string (e.g. 'foo.ogg')\n     * Oscillator type string (i.e. 'sine', 'square', 'sawtooth', 'triangle')\n     * ScriptProcessor config object (e.g. { bufferSize: 1024, channels: 1, callback: fn })\n     */\n\n    function createSound(config) {\n        // try to load if config contains URLs\n        if (file.containsURL(config)) {\n            return load(config);\n        }\n\n        var sound = add(config);\n        sound.data = config.data || config;\n\n        return sound;\n    }\n\n    /*\n     * Destroy\n     */\n\n    function destroySound(soundOrId) {\n        group.find(soundOrId, function (sound) {\n            return sound.destroy();\n        });\n        return api;\n    }\n\n    function destroyAll() {\n        group.destroy();\n        return api;\n    }\n\n    /*\n     * Controls\n     */\n\n    function mute() {\n        group.mute();\n        return api;\n    }\n\n    function unMute() {\n        group.unMute();\n        return api;\n    }\n\n    function fade(volume, duration) {\n        group.fade(volume, duration);\n        return api;\n    }\n\n    function pauseAll() {\n        group.pause();\n        return api;\n    }\n\n    function resumeAll() {\n        group.resume();\n        return api;\n    }\n\n    function stopAll() {\n        group.stop();\n        return api;\n    }\n\n    function play(id, delay, offset) {\n        group.find(id, function (sound) {\n            return sound.play(delay, offset);\n        });\n        return api;\n    }\n\n    function pause(id) {\n        group.find(id, function (sound) {\n            return sound.pause();\n        });\n        return api;\n    }\n\n    function stop(id) {\n        group.find(id, function (sound) {\n            return sound.stop();\n        });\n        return api;\n    }\n\n    /*\n     * Mobile touch lock\n     */\n\n    isTouchLocked = browser.handleTouchLock(context, function () {\n        isTouchLocked = false;\n        group.sounds.forEach(function (sound) {\n            return sound.isTouchLocked = false;\n        });\n    });\n\n    /*\n     * Page visibility events\n     */\n\n    (function () {\n        var pageHiddenPaused = [];\n\n        // pause currently playing sounds and store refs\n        function onHidden() {\n            group.sounds.forEach(function (sound) {\n                if (sound.playing) {\n                    sound.pause();\n                    pageHiddenPaused.push(sound);\n                }\n            });\n        }\n\n        // play sounds that got paused when page was hidden\n        function onShown() {\n            while (pageHiddenPaused.length) {\n                pageHiddenPaused.pop().play();\n            }\n        }\n\n        browser.handlePageVisibility(onHidden, onShown);\n    })();\n\n    /*\n     * Log version & device support info\n     */\n\n    function log() {\n        var title = 'sono ' + VERSION,\n            info = 'Supported:' + api.isSupported + ' WebAudioAPI:' + api.hasWebAudio + ' TouchLocked:' + isTouchLocked + ' State:' + (context && context.state) + ' Extensions:' + file.extensions;\n\n        if (navigator.userAgent.indexOf('Chrome') > -1) {\n            var args = ['%c ♫ ' + title + ' ♫ %c ' + info + ' ', 'color: #FFFFFF; background: #379F7A', 'color: #1F1C0D; background: #E0FBAC'];\n            console.log.apply(console, args);\n        } else if (window.console && window.console.log.call) {\n            console.log.call(console, title + ' ' + info);\n        }\n    }\n\n    api = {\n        createSound: createSound,\n        create: createSound,\n        destroySound: destroySound,\n        destroyAll: destroyAll,\n        getSound: getSound,\n        createGroup: createGroup,\n        file: file,\n        load: load,\n        mute: mute,\n        unMute: unMute,\n        fade: fade,\n        pauseAll: pauseAll,\n        resumeAll: resumeAll,\n        stopAll: stopAll,\n        play: play,\n        pause: pause,\n        stop: stop,\n        log: log,\n\n        canPlay: file.canPlay,\n        context: context,\n        getOfflineContext: utils.getOfflineContext,\n        effect: group.effect,\n        extensions: file.extensions,\n        hasWebAudio: !!context,\n        isSupported: file.extensions.length > 0,\n        gain: group.gain,\n        utils: utils,\n        VERSION: VERSION,\n\n        Sound: Sound,\n        Group: Group\n    };\n\n    /*\n     * Getters & Setters\n     */\n\n    Object.defineProperties(api, {\n        isTouchLocked: {\n            get: function get() {\n                return isTouchLocked;\n            }\n        },\n        sounds: {\n            get: function get() {\n                return group.sounds.slice(0);\n            }\n        },\n        volume: {\n            get: function get() {\n                return group.volume;\n            },\n            set: function set(value) {\n                group.volume = value;\n            }\n        }\n    });\n\n    return Object.freeze(api);\n}\n\nvar sono = new Sono();\n\nreturn sono;\n\n})));\n//# sourceMappingURL=sono.js.map\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJkZXYvamF2YXNjcmlwdHMvYXBwLmpzIiwiZGV2L2phdmFzY3JpcHRzL3ZlbmRvcnMvbW9kZXJuaXpyLmpzIiwiZGV2L2phdmFzY3JpcHRzL3hwL3hwLmpzIiwibm9kZV9tb2R1bGVzL3Nvbm8vZGlzdC9zb25vLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7O0FBRUE7QUFDQTtBQUNBOztBQUNBOztBQU9BOzs7Ozs7QUFOQTs7QUFFQTtBQUNBO0FBQ0EsUUFBUSxHQUFSLENBQVksNENBQVosRUFBMEQsK0JBQTFEOzs7Ozs7OztBQ1ZBOzs7Ozs7Ozs7Ozs7Ozs7O0FBZ0JBOzs7Ozs7OztBQVFBLENBQUMsQ0FBQyxVQUFTLE1BQVQsRUFBaUIsUUFBakIsRUFBMkIsU0FBM0IsRUFBcUM7QUFDckMsTUFBSSxVQUFVLEVBQWQ7O0FBR0EsTUFBSSxRQUFRLEVBQVo7O0FBR0E7Ozs7Ozs7O0FBUUEsTUFBSSxpQkFBaUI7QUFDbkI7QUFDQSxjQUFVLE9BRlM7O0FBSW5CO0FBQ0E7QUFDQSxhQUFTO0FBQ1AscUJBQWUsRUFEUjtBQUVQLHVCQUFpQixJQUZWO0FBR1AsdUJBQWlCLElBSFY7QUFJUCxxQkFBZTtBQUpSLEtBTlU7O0FBYW5CO0FBQ0EsUUFBSSxFQWRlOztBQWdCbkI7QUFDQSxRQUFJLFlBQVMsSUFBVCxFQUFlLEVBQWYsRUFBbUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBSSxPQUFPLElBQVg7QUFDQSxpQkFBVyxZQUFXO0FBQ3BCLFdBQUcsS0FBSyxJQUFMLENBQUg7QUFDRCxPQUZELEVBRUcsQ0FGSDtBQUdELEtBNUJrQjs7QUE4Qm5CLGFBQVMsaUJBQVMsSUFBVCxFQUFlLEVBQWYsRUFBbUIsT0FBbkIsRUFBNEI7QUFDbkMsWUFBTSxJQUFOLENBQVcsRUFBQyxNQUFNLElBQVAsRUFBYSxJQUFJLEVBQWpCLEVBQXFCLFNBQVMsT0FB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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIid1c2Ugc3RyaWN0JztcblxuLy8gRGVmYXVsdCBCYWJlbCBQb2x5ZmlsbCwgYmUgY2FyZWZ1bCwgYmUgc3VyZSB5b3UgbmVlZCBpdFxuLy8gYmVjYXVzZSBpdCdzIH42MDAwIGxpbmVzIG9mIGNvZGUgdW5taW5pZmllZFxuLy8gaW1wb3J0ICdiYWJlbC1wb2x5ZmlsbCc7XG5pbXBvcnQgJ21vZGVybml6cic7XG4vLyBpbXBvcnQgKiBhcyB0b29scyBmcm9tICdAODRwYXJpcy84NC50b29scyc7XG5cbi8vIFlvdXIgaW1wb3J0c1xuLy8gaW1wb3J0IE15Q29tcG9uZW50IGZyb20gJy4vY29tcG9uZW50LmVzNidcbmNvbnNvbGUubG9nKCclYyA4NC5Cb2lsZXJwbGF0ZSA9PT09PSBZb3VyIGFwcCBpcyByZWFkeS4nLCAnYmFja2dyb3VuZDogIzAwMDsgY29sb3I6ICNGRkYnKTtcblxuaW1wb3J0IFhwIGZyb20gJy4veHAveHAnO1xuXG4iLCIvKiFcbiAqIG1vZGVybml6ciB2My4zLjFcbiAqIEJ1aWxkIGh0dHA6Ly9tb2Rlcm5penIuY29tL2Rvd25sb2FkPy1jc3NhbmltYXRpb25zLWNzc2NhbGMtY3NzZ3JhZGllbnRzLWNzc3RyYW5zZm9ybXMzZC1oaXN0b3J5LXdlYmdsLXNldGNsYXNzZXMtc2hpdi1kb250bWluXG4gKlxuICogQ29weXJpZ2h0IChjKVxuICogIEZhcnVrIEF0ZXNcbiAqICBQYXVsIElyaXNoXG4gKiAgQWxleCBTZXh0b25cbiAqICBSeWFuIFNlZGRvblxuICogIFBhdHJpY2sgS2V0dG5lclxuICogIFN0dSBDb3hcbiAqICBSaWNoYXJkIEhlcnJlcmFcblxuICogTUlUIExpY2Vuc2VcbiAqL1xuXG4vKlxuICogTW9kZXJuaXpyIHRlc3RzIHdoaWNoIG5hdGl2ZSBDU1MzIGFuZCBIVE1MNSBmZWF0dXJlcyBhcmUgYXZhaWxhYmxlIGluIHRoZVxuICogY3VycmVudCBVQSBhbmQgbWFrZXMgdGhlIHJlc3VsdHMgYXZhaWxhYmxlIHRvIHlvdSBpbiB0d28gd2F5czogYXMgcHJvcGVydGllcyBvblxuICogYSBnbG9iYWwgYE1vZGVybml6cmAgb2JqZWN0LCBhbmQgYXMgY2xhc3NlcyBvbiB0aGUgYDxodG1sPmAgZWxlbWVudC4gVGhpc1xuICogaW5mb3JtYXRpb24gYWxsb3dzIHlvdSB0byBwcm9ncmVzc2l2ZWx5IGVuaGFuY2UgeW91ciBwYWdlcyB3aXRoIGEgZ3JhbnVsYXIgbGV2ZWxcbiAqIG9mIGNvbnRyb2wgb3ZlciB0aGUgZXhwZXJpZW5jZS5cbiovXG5cbjsoZnVuY3Rpb24od2luZG93LCBkb2N1bWVudCwgdW5kZWZpbmVkKXtcbiAgdmFyIGNsYXNzZXMgPSBbXTtcblxuXG4gIHZhciB0ZXN0cyA9IFtdO1xuXG5cbiAgLyoqXG4gICAqXG4gICAqIE1vZGVybml6clByb3RvIGlzIHRoZSBjb25zdHJ1Y3RvciBmb3IgTW9kZXJuaXpyXG4gICAqXG4gICAqIEBjbGFzc1xuICAgKiBAYWNjZXNzIHB1YmxpY1xuICAgKi9cblxuICB2YXIgTW9kZXJuaXpyUHJvdG8gPSB7XG4gICAgLy8gVGhlIGN1cnJlbnQgdmVyc2lvbiwgZHVtbXlcbiAgICBfdmVyc2lvbjogJzMuMy4xJyxcblxuICAgIC8vIEFueSBzZXR0aW5ncyB0aGF0IGRvbid0IHdvcmsgYXMgc2VwYXJhdGUgbW9kdWxlc1xuICAgIC8vIGNhbiBnbyBpbiBoZXJlIGFzIGNvbmZpZ3VyYXRpb24uXG4gICAgX2NvbmZpZzoge1xuICAgICAgJ2NsYXNzUHJlZml4JzogJycsXG4gICAgICAnZW5hYmxlQ2xhc3Nlcyc6IHRydWUsXG4gICAgICAnZW5hYmxlSlNDbGFzcyc6IHRydWUsXG4gICAgICAndXNlUHJlZml4ZXMnOiB0cnVlXG4gICAgfSxcblxuICAgIC8vIFF1ZXVlIG9mIHRlc3RzXG4gICAgX3E6IFtdLFxuXG4gICAgLy8gU3R1YiB0aGVzZSBmb3IgcGVvcGxlIHdobyBhcmUgbGlzdGVuaW5nXG4gICAgb246IGZ1bmN0aW9uKHRlc3QsIGNiKSB7XG4gICAgICAvLyBJIGRvbid0IHJlYWxseSB0aGluayBwZW9wbGUgc2hvdWxkIGRvIHRoaXMsIGJ1dCB3ZSBjYW5cbiAgICAgIC8vIHNhZmUgZ3VhcmQgaXQgYSBiaXQuXG4gICAgICAvLyAtLSBOT1RFOjogdGhpcyBnZXRzIFdBWSBvdmVycmlkZGVuIGluIHNyYy9hZGRUZXN0IGZvciBhY3R1YWwgYXN5bmMgdGVzdHMuXG4gICAgICAvLyBUaGlzIGlzIGluIGNhc2UgcGVvcGxlIGxpc3RlbiB0byBzeW5jaHJvbm91cyB0ZXN0cy4gSSB3b3VsZCBsZWF2ZSBpdCBvdXQsXG4gICAgICAvLyBidXQgdGhlIGNvZGUgdG8gKmRpc2FsbG93KiBzeW5jIHRlc3RzIGluIHRoZSByZWFsIHZlcnNpb24gb2YgdGhpc1xuICAgICAgLy8gZnVuY3Rpb24gaXMgYWN0dWFsbHkgbGFyZ2VyIHRoYW4gdGhpcy5cbiAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIGNiKHNlbGZbdGVzdF0pO1xuICAgICAgfSwgMCk7XG4gICAgfSxcblxuICAgIGFkZFRlc3Q6IGZ1bmN0aW9uKG5hbWUsIGZuLCBvcHRpb25zKSB7XG4gICAgICB0ZXN0cy5wdXNoKHtuYW1lOiBuYW1lLCBmbjogZm4sIG9wdGlvbnM6IG9wdGlvbnN9KTtcbiAgICB9LFxuXG4gICAgYWRkQXN5bmNUZXN0OiBmdW5jdGlvbihmbikge1xuICAgICAgdGVzdHMucHVzaCh7bmFtZTogbnVsbCwgZm46IGZufSk7XG4gICAgfVxuICB9O1xuXG5cblxuICAvLyBGYWtlIHNvbWUgb2YgT2JqZWN0LmNyZWF0ZSBzbyB3ZSBjYW4gZm9yY2Ugbm9uIHRlc3QgcmVzdWx0cyB0byBiZSBub24gXCJvd25cIiBwcm9wZXJ0aWVzLlxuICB2YXIgTW9kZXJuaXpyID0gZnVuY3Rpb24oKSB7fTtcbiAgTW9kZXJuaXpyLnByb3RvdHlwZSA9IE1vZGVybml6clByb3RvO1xuXG4gIC8vIExlYWsgbW9kZXJuaXpyIGdsb2JhbGx5IHdoZW4geW91IGByZXF1aXJlYCBpdCByYXRoZXIgdGhhbiBmb3JjZSBpdCBoZXJlLlxuICAvLyBPdmVyd3JpdGUgbmFtZSBzbyBjb25zdHJ1Y3RvciBuYW1lIGlzIG5pY2VyIDpEXG4gIE1vZGVybml6ciA9IG5ldyBNb2Rlcm5penIoKTtcblxuXG4vKiFcbntcbiAgXCJuYW1lXCI6IFwiSGlzdG9yeSBBUElcIixcbiAgXCJwcm9wZXJ0eVwiOiBcImhpc3RvcnlcIixcbiAgXCJjYW5pdXNlXCI6IFwiaGlzdG9yeVwiLFxuICBcInRhZ3NcIjogW1wiaGlzdG9yeVwiXSxcbiAgXCJhdXRob3JzXCI6IFtcIkhheSBLcmFuZW5cIiwgXCJBbGV4YW5kZXIgRmFya2FzXCJdLFxuICBcIm5vdGVzXCI6IFt7XG4gICAgXCJuYW1lXCI6IFwiVzNDIFNwZWNcIixcbiAgICBcImhyZWZcIjogXCJodHRwczovL3d3dy53My5vcmcvVFIvaHRtbDUxL2Jyb3dzZXJzLmh0bWwjdGhlLWhpc3RvcnktaW50ZXJmYWNlXCJcbiAgfSwge1xuICAgIFwibmFtZVwiOiBcIk1ETiBkb2N1bWVudGF0aW9uXCIsXG4gICAgXCJocmVmXCI6IFwiaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL3dpbmRvdy5oaXN0b3J5XCJcbiAgfV0sXG4gIFwicG9seWZpbGxzXCI6IFtcImhpc3Rvcnlqc1wiLCBcImh0bWw1aGlzdG9yeWFwaVwiXVxufVxuISovXG4vKiBET0NcbkRldGVjdHMgc3VwcG9ydCBmb3IgdGhlIEhpc3RvcnkgQVBJIGZvciBtYW5pcHVsYXRpbmcgdGhlIGJyb3dzZXIgc2Vzc2lvbiBoaXN0b3J5LlxuKi9cblxuICBNb2Rlcm5penIuYWRkVGVzdCgnaGlzdG9yeScsIGZ1bmN0aW9uKCkge1xuICAgIC8vIElzc3VlICM3MzNcbiAgICAvLyBUaGUgc3RvY2sgYnJvd3NlciBvbiBBbmRyb2lkIDIuMiAmIDIuMywgYW5kIDQuMC54IHJldHVybnMgcG9zaXRpdmUgb24gaGlzdG9yeSBzdXBwb3J0XG4gICAgLy8gVW5mb3J0dW5hdGVseSBzdXBwb3J0IGlzIHJlYWxseSBidWdneSBhbmQgdGhlcmUgaXMgbm8gY2xlYW4gd2F5IHRvIGRldGVjdFxuICAgIC8vIHRoZXNlIGJ1Z3MsIHNvIHdlIGZhbGwgYmFjayB0byBhIHVzZXIgYWdlbnQgc25pZmYgOihcbiAgICB2YXIgdWEgPSBuYXZpZ2F0b3IudXNlckFnZW50O1xuXG4gICAgLy8gV2Ugb25seSB3YW50IEFuZHJvaWQgMiBhbmQgNC4wLCBzdG9jayBicm93c2VyLCBhbmQgbm90IENocm9tZSB3aGljaCBpZGVudGlmaWVzXG4gICAgLy8gaXRzZWxmIGFzICdNb2JpbGUgU2FmYXJpJyBhcyB3ZWxsLCBub3IgV2luZG93cyBQaG9uZSAoaXNzdWUgIzE0NzEpLlxuICAgIGlmICgodWEuaW5kZXhPZignQW5kcm9pZCAyLicpICE9PSAtMSB8fFxuICAgICAgICAodWEuaW5kZXhPZignQW5kcm9pZCA0LjAnKSAhPT0gLTEpKSAmJlxuICAgICAgICB1YS5pbmRleE9mKCdNb2JpbGUgU2FmYXJpJykgIT09IC0xICYmXG4gICAgICAgIHVhLmluZGV4T2YoJ0Nocm9tZScpID09PSAtMSAmJlxuICAgICAgICB1YS5pbmRleE9mKCdXaW5kb3dzIFBob25lJykgPT09IC0xKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gUmV0dXJuIHRoZSByZWd1bGFyIGNoZWNrXG4gICAgcmV0dXJuICh3aW5kb3cuaGlzdG9yeSAmJiAncHVzaFN0YXRlJyBpbiB3aW5kb3cuaGlzdG9yeSk7XG4gIH0pO1xuXG5cbiAgLyoqXG4gICAqIGlzIHJldHVybnMgYSBib29sZWFuIGlmIHRoZSB0eXBlb2YgYW4gb2JqIGlzIGV4YWN0bHkgdHlwZS5cbiAgICpcbiAgICogQGFjY2VzcyBwcml2YXRlXG4gICAqIEBmdW5jdGlvbiBpc1xuICAgKiBAcGFyYW0geyp9IG9iaiAtIEEgdGhpbmcgd2Ugd2FudCB0byBjaGVjayB0aGUgdHlwZSBvZlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSAtIEEgc3RyaW5nIHRvIGNvbXBhcmUgdGhlIHR5cGVvZiBhZ2FpbnN0XG4gICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgKi9cblxuICBmdW5jdGlvbiBpcyhvYmosIHR5cGUpIHtcbiAgICByZXR1cm4gdHlwZW9mIG9iaiA9PT0gdHlwZTtcbiAgfVxuICA7XG5cbiAgLyoqXG4gICAqIFJ1biB0aHJvdWdoIGFsbCB0ZXN0cyBhbmQgZGV0ZWN0IHRoZWlyIHN1cHBvcnQgaW4gdGhlIGN1cnJlbnQgVUEuXG4gICAqXG4gICAqIEBhY2Nlc3MgcHJpdmF0ZVxuICAgKi9cblxuICBmdW5jdGlvbiB0ZXN0UnVubmVyKCkge1xuICAgIHZhciBmZWF0dXJlTmFtZXM7XG4gICAgdmFyIGZlYXR1cmU7XG4gICAgdmFyIGFsaWFzSWR4O1xuICAgIHZhciByZXN1bHQ7XG4gICAgdmFyIG5hbWVJZHg7XG4gICAgdmFyIGZlYXR1cmVOYW1lO1xuICAgIHZhciBmZWF0dXJlTmFtZVNwbGl0O1xuXG4gICAgZm9yICh2YXIgZmVhdHVyZUlkeCBpbiB0ZXN0cykge1xuICAgICAgaWYgKHRlc3RzLmhhc093blByb3BlcnR5KGZlYXR1cmVJZHgpKSB7XG4gICAgICAgIGZlYXR1cmVOYW1lcyA9IFtdO1xuICAgICAgICBmZWF0dXJlID0gdGVzdHNbZmVhdHVyZUlkeF07XG4gICAgICAgIC8vIHJ1biB0aGUgdGVzdCwgdGhyb3cgdGhlIHJldHVybiB2YWx1ZSBpbnRvIHRoZSBNb2Rlcm5penIsXG4gICAgICAgIC8vIHRoZW4gYmFzZWQgb24gdGhhdCBib29sZWFuLCBkZWZpbmUgYW4gYXBwcm9wcmlhdGUgY2xhc3NOYW1lXG4gICAgICAgIC8vIGFuZCBwdXNoIGl0IGludG8gYW4gYXJyYXkgb2YgY2xhc3NlcyB3ZSdsbCBqb2luIGxhdGVyLlxuICAgICAgICAvL1xuICAgICAgICAvLyBJZiB0aGVyZSBpcyBubyBuYW1lLCBpdCdzIGFuICdhc3luYycgdGVzdCB0aGF0IGlzIHJ1bixcbiAgICAgICAgLy8gYnV0IG5vdCBkaXJlY3RseSBhZGRlZCB0byB0aGUgb2JqZWN0LiBUaGF0IHNob3VsZFxuICAgICAgICAvLyBiZSBkb25lIHdpdGggYSBwb3N0LXJ1biBhZGRUZXN0IGNhbGwuXG4gICAgICAgIGlmIChmZWF0dXJlLm5hbWUpIHtcbiAgICAgICAgICBmZWF0dXJlTmFtZXMucHVzaChmZWF0dXJlLm5hbWUudG9Mb3dlckNhc2UoKSk7XG5cbiAgICAgICAgICBpZiAoZmVhdHVyZS5vcHRpb25zICYmIGZlYXR1cmUub3B0aW9ucy5hbGlhc2VzICYmIGZlYXR1cmUub3B0aW9ucy5hbGlhc2VzLmxlbmd0aCkge1xuICAgICAgICAgICAgLy8gQWRkIGFsbCB0aGUgYWxpYXNlcyBpbnRvIHRoZSBuYW1lcyBsaXN0XG4gICAgICAgICAgICBmb3IgKGFsaWFzSWR4ID0gMDsgYWxpYXNJZHggPCBmZWF0dXJlLm9wdGlvbnMuYWxpYXNlcy5sZW5ndGg7IGFsaWFzSWR4KyspIHtcbiAgICAgICAgICAgICAgZmVhdHVyZU5hbWVzLnB1c2goZmVhdHVyZS5vcHRpb25zLmFsaWFzZXNbYWxpYXNJZHhdLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJ1biB0aGUgdGVzdCwgb3IgdXNlIHRoZSByYXcgdmFsdWUgaWYgaXQncyBub3QgYSBmdW5jdGlvblxuICAgICAgICByZXN1bHQgPSBpcyhmZWF0dXJlLmZuLCAnZnVuY3Rpb24nKSA/IGZlYXR1cmUuZm4oKSA6IGZlYXR1cmUuZm47XG5cblxuICAgICAgICAvLyBTZXQgZWFjaCBvZiB0aGUgbmFtZXMgb24gdGhlIE1vZGVybml6ciBvYmplY3RcbiAgICAgICAgZm9yIChuYW1lSWR4ID0gMDsgbmFtZUlkeCA8IGZlYXR1cmVOYW1lcy5sZW5ndGg7IG5hbWVJZHgrKykge1xuICAgICAgICAgIGZlYXR1cmVOYW1lID0gZmVhdHVyZU5hbWVzW25hbWVJZHhdO1xuICAgICAgICAgIC8vIFN1cHBvcnQgZG90IHByb3BlcnRpZXMgYXMgc3ViIHRlc3RzLiBXZSBkb24ndCBkbyBjaGVja2luZyB0byBtYWtlIHN1cmVcbiAgICAgICAgICAvLyB0aGF0IHRoZSBpbXBsaWVkIHBhcmVudCB0ZXN0cyBoYXZlIGJlZW4gYWRkZWQuIFlvdSBtdXN0IGNhbGwgdGhlbSBpblxuICAgICAgICAgIC8vIG9yZGVyIChlaXRoZXIgaW4gdGhlIHRlc3QsIG9yIG1ha2UgdGhlIHBhcmVudCB0ZXN0IGEgZGVwZW5kZW5jeSkuXG4gICAgICAgICAgLy9cbiAgICAgICAgICAvLyBDYXAgaXQgdG8gVFdPIHRvIG1ha2UgdGhlIGxvZ2ljIHNpbXBsZSBhbmQgYmVjYXVzZSB3aG8gbmVlZHMgdGhhdCBraW5kIG9mIHN1YnRlc3RpbmdcbiAgICAgICAgICAvLyBoYXNodGFnIGZhbW91cyBsYXN0IHdvcmRzXG4gICAgICAgICAgZmVhdHVyZU5hbWVTcGxpdCA9IGZlYXR1cmVOYW1lLnNwbGl0KCcuJyk7XG5cbiAgICAgICAgICBpZiAoZmVhdHVyZU5hbWVTcGxpdC5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIE1vZGVybml6cltmZWF0dXJlTmFtZVNwbGl0WzBdXSA9IHJlc3VsdDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gY2FzdCB0byBhIEJvb2xlYW4sIGlmIG5vdCBvbmUgYWxyZWFkeVxuICAgICAgICAgICAgLyoganNoaW50IC1XMDUzICovXG4gICAgICAgICAgICBpZiAoTW9kZXJuaXpyW2ZlYXR1cmVOYW1lU3BsaXRbMF1dICYmICEoTW9kZXJuaXpyW2ZlYXR1cmVOYW1lU3BsaXRbMF1dIGluc3RhbmNlb2YgQm9vbGVhbikpIHtcbiAgICAgICAgICAgICAgTW9kZXJuaXpyW2ZlYXR1cmVOYW1lU3BsaXRbMF1dID0gbmV3IEJvb2xlYW4oTW9kZXJuaXpyW2ZlYXR1cmVOYW1lU3BsaXRbMF1dKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgTW9kZXJuaXpyW2ZlYXR1cmVOYW1lU3BsaXRbMF1dW2ZlYXR1cmVOYW1lU3BsaXRbMV1dID0gcmVzdWx0O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNsYXNzZXMucHVzaCgocmVzdWx0ID8gJycgOiAnbm8tJykgKyBmZWF0dXJlTmFtZVNwbGl0LmpvaW4oJy0nKSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgO1xuXG4gIC8qKlxuICAgKiBkb2NFbGVtZW50IGlzIGEgY29udmVuaWVuY2Ugd3JhcHBlciB0byBncmFiIHRoZSByb290IGVsZW1lbnQgb2YgdGhlIGRvY3VtZW50XG4gICAqXG4gICAqIEBhY2Nlc3MgcHJpdmF0ZVxuICAgKiBAcmV0dXJucyB7SFRNTEVsZW1lbnR8U1ZHRWxlbWVudH0gVGhlIHJvb3QgZWxlbWVudCBvZiB0aGUgZG9jdW1lbnRcbiAgICovXG5cbiAgdmFyIGRvY0VsZW1lbnQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG5cblxuICAvKipcbiAgICogQSBjb252ZW5pZW5jZSBoZWxwZXIgdG8gY2hlY2sgaWYgdGhlIGRvY3VtZW50IHdlIGFyZSBydW5uaW5nIGluIGlzIGFuIFNWRyBkb2N1bWVudFxuICAgKlxuICAgKiBAYWNjZXNzIHByaXZhdGVcbiAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAqL1xuXG4gIHZhciBpc1NWRyA9IGRvY0VsZW1lbnQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ3N2Zyc7XG5cblxuICAvKipcbiAgICogc2V0Q2xhc3NlcyB0YWtlcyBhbiBhcnJheSBvZiBjbGFzcyBuYW1lcyBhbmQgYWRkcyB0aGVtIHRvIHRoZSByb290IGVsZW1lbnRcbiAgICpcbiAgICogQGFjY2VzcyBwcml2YXRlXG4gICAqIEBmdW5jdGlvbiBzZXRDbGFzc2VzXG4gICAqIEBwYXJhbSB7c3RyaW5nW119IGNsYXNzZXMgLSBBcnJheSBvZiBjbGFzcyBuYW1lc1xuICAgKi9cblxuICAvLyBQYXNzIGluIGFuIGFuZCBhcnJheSBvZiBjbGFzcyBuYW1lcywgZS5nLjpcbiAgLy8gIFsnbm8td2VicCcsICdib3JkZXJyYWRpdXMnLCAuLi5dXG4gIGZ1bmN0aW9uIHNldENsYXNzZXMoY2xhc3Nlcykge1xuICAgIHZhciBjbGFzc05hbWUgPSBkb2NFbGVtZW50LmNsYXNzTmFtZTtcbiAgICB2YXIgY2xhc3NQcmVmaXggPSBNb2Rlcm5penIuX2NvbmZpZy5jbGFzc1ByZWZpeCB8fCAnJztcblxuICAgIGlmIChpc1NWRykge1xuICAgICAgY2xhc3NOYW1lID0gY2xhc3NOYW1lLmJhc2VWYWw7XG4gICAgfVxuXG4gICAgLy8gQ2hhbmdlIGBuby1qc2AgdG8gYGpzYCAoaW5kZXBlbmRlbnRseSBvZiB0aGUgYGVuYWJsZUNsYXNzZXNgIG9wdGlvbilcbiAgICAvLyBIYW5kbGUgY2xhc3NQcmVmaXggb24gdGhpcyB0b29cbiAgICBpZiAoTW9kZXJuaXpyLl9jb25maWcuZW5hYmxlSlNDbGFzcykge1xuICAgICAgdmFyIHJlSlMgPSBuZXcgUmVnRXhwKCcoXnxcXFxccyknICsgY2xhc3NQcmVmaXggKyAnbm8tanMoXFxcXHN8JCknKTtcbiAgICAgIGNsYXNzTmFtZSA9IGNsYXNzTmFtZS5yZXBsYWNlKHJlSlMsICckMScgKyBjbGFzc1ByZWZpeCArICdqcyQyJyk7XG4gICAgfVxuXG4gICAgaWYgKE1vZGVybml6ci5fY29uZmlnLmVuYWJsZUNsYXNzZXMpIHtcbiAgICAgIC8vIEFkZCB0aGUgbmV3IGNsYXNzZXNcbiAgICAgIGNsYXNzTmFtZSArPSAnICcgKyBjbGFzc1ByZWZpeCArIGNsYXNzZXMuam9pbignICcgKyBjbGFzc1ByZWZpeCk7XG4gICAgICBpc1NWRyA/IGRvY0VsZW1lbnQuY2xhc3NOYW1lLmJhc2VWYWwgPSBjbGFzc05hbWUgOiBkb2NFbGVtZW50LmNsYXNzTmFtZSA9IGNsYXNzTmFtZTtcbiAgICB9XG5cbiAgfVxuXG4gIDtcblxuLyoqXG4gICogQG9wdGlvbk5hbWUgaHRtbDVzaGl2XG4gICogQG9wdGlvblByb3AgaHRtbDVzaGl2XG4gICovXG5cbiAgLy8gVGFrZSB0aGUgaHRtbDUgdmFyaWFibGUgb3V0IG9mIHRoZSBodG1sNXNoaXYgc2NvcGUgc28gd2UgY2FuIHJldHVybiBpdC5cbiAgdmFyIGh0bWw1O1xuICBpZiAoIWlzU1ZHKSB7XG4gICAgLyoqXG4gICAgICogQHByZXNlcnZlIEhUTUw1IFNoaXYgMy43LjMgfCBAYWZhcmthcyBAamRhbHRvbiBAam9uX25lYWwgQHJlbSB8IE1JVC9HUEwyIExpY2Vuc2VkXG4gICAgICovXG4gICAgOyhmdW5jdGlvbih3aW5kb3csIGRvY3VtZW50KSB7XG4gICAgICAvKmpzaGludCBldmlsOnRydWUgKi9cbiAgICAgIC8qKiB2ZXJzaW9uICovXG4gICAgICB2YXIgdmVyc2lvbiA9ICczLjcuMyc7XG5cbiAgICAgIC8qKiBQcmVzZXQgb3B0aW9ucyAqL1xuICAgICAgdmFyIG9wdGlvbnMgPSB3aW5kb3cuaHRtbDUgfHwge307XG5cbiAgICAgIC8qKiBVc2VkIHRvIHNraXAgcHJvYmxlbSBlbGVtZW50cyAqL1xuICAgICAgdmFyIHJlU2tpcCA9IC9ePHxeKD86YnV0dG9ufG1hcHxzZWxlY3R8dGV4dGFyZWF8b2JqZWN0fGlmcmFtZXxvcHRpb258b3B0Z3JvdXApJC9pO1xuXG4gICAgICAvKiogTm90IGFsbCBlbGVtZW50cyBjYW4gYmUgY2xvbmVkIGluIElFICoqL1xuICAgICAgdmFyIHNhdmVDbG9uZXMgPSAvXig/OmF8Ynxjb2RlfGRpdnxmaWVsZHNldHxoMXxoMnxoM3xoNHxoNXxoNnxpfGxhYmVsfGxpfG9sfHB8cXxzcGFufHN0cm9uZ3xzdHlsZXx0YWJsZXx0Ym9keXx0ZHx0aHx0cnx1bCkkL2k7XG5cbiAgICAgIC8qKiBEZXRlY3Qgd2hldGhlciB0aGUgYnJvd3NlciBzdXBwb3J0cyBkZWZhdWx0IGh0bWw1IHN0eWxlcyAqL1xuICAgICAgdmFyIHN1cHBvcnRzSHRtbDVTdHlsZXM7XG5cbiAgICAgIC8qKiBOYW1lIG9mIHRoZSBleHBhbmRvLCB0byB3b3JrIHdpdGggbXVsdGlwbGUgZG9jdW1lbnRzIG9yIHRvIHJlLXNoaXYgb25lIGRvY3VtZW50ICovXG4gICAgICB2YXIgZXhwYW5kbyA9ICdfaHRtbDVzaGl2JztcblxuICAgICAgLyoqIFRoZSBpZCBmb3IgdGhlIHRoZSBkb2N1bWVudHMgZXhwYW5kbyAqL1xuICAgICAgdmFyIGV4cGFuSUQgPSAwO1xuXG4gICAgICAvKiogQ2FjaGVkIGRhdGEgZm9yIGVhY2ggZG9jdW1lbnQgKi9cbiAgICAgIHZhciBleHBhbmRvRGF0YSA9IHt9O1xuXG4gICAgICAvKiogRGV0ZWN0IHdoZXRoZXIgdGhlIGJyb3dzZXIgc3VwcG9ydHMgdW5rbm93biBlbGVtZW50cyAqL1xuICAgICAgdmFyIHN1cHBvcnRzVW5rbm93bkVsZW1lbnRzO1xuXG4gICAgICAoZnVuY3Rpb24oKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgdmFyIGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICAgICAgYS5pbm5lckhUTUwgPSAnPHh5ej48L3h5ej4nO1xuICAgICAgICAgIC8vaWYgdGhlIGhpZGRlbiBwcm9wZXJ0eSBpcyBpbXBsZW1lbnRlZCB3ZSBjYW4gYXNzdW1lLCB0aGF0IHRoZSBicm93c2VyIHN1cHBvcnRzIGJhc2ljIEhUTUw1IFN0eWxlc1xuICAgICAgICAgIHN1cHBvcnRzSHRtbDVTdHlsZXMgPSAoJ2hpZGRlbicgaW4gYSk7XG5cbiAgICAgICAgICBzdXBwb3J0c1Vua25vd25FbGVtZW50cyA9IGEuY2hpbGROb2Rlcy5sZW5ndGggPT0gMSB8fCAoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvLyBhc3NpZ24gYSBmYWxzZSBwb3NpdGl2ZSBpZiB1bmFibGUgdG8gc2hpdlxuICAgICAgICAgICAgKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQpKCdhJyk7XG4gICAgICAgICAgICB2YXIgZnJhZyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgIHR5cGVvZiBmcmFnLmNsb25lTm9kZSA9PSAndW5kZWZpbmVkJyB8fFxuICAgICAgICAgICAgICAgIHR5cGVvZiBmcmFnLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQgPT0gJ3VuZGVmaW5lZCcgfHxcbiAgICAgICAgICAgICAgICB0eXBlb2YgZnJhZy5jcmVhdGVFbGVtZW50ID09ICd1bmRlZmluZWQnXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH0oKSk7XG4gICAgICAgIH0gY2F0Y2goZSkge1xuICAgICAgICAgIC8vIGFzc2lnbiBhIGZhbHNlIHBvc2l0aXZlIGlmIGRldGVjdGlvbiBmYWlscyA9PiB1bmFibGUgdG8gc2hpdlxuICAgICAgICAgIHN1cHBvcnRzSHRtbDVTdHlsZXMgPSB0cnVlO1xuICAgICAgICAgIHN1cHBvcnRzVW5rbm93bkVsZW1lbnRzID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICB9KCkpO1xuXG4gICAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAgICAgLyoqXG4gICAgICAgKiBDcmVhdGVzIGEgc3R5bGUgc2hlZXQgd2l0aCB0aGUgZ2l2ZW4gQ1NTIHRleHQgYW5kIGFkZHMgaXQgdG8gdGhlIGRvY3VtZW50LlxuICAgICAgICogQHByaXZhdGVcbiAgICAgICAqIEBwYXJhbSB7RG9jdW1lbnR9IG93bmVyRG9jdW1lbnQgVGhlIGRvY3VtZW50LlxuICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGNzc1RleHQgVGhlIENTUyB0ZXh0LlxuICAgICAgICogQHJldHVybnMge1N0eWxlU2hlZXR9IFRoZSBzdHlsZSBlbGVtZW50LlxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiBhZGRTdHlsZVNoZWV0KG93bmVyRG9jdW1lbnQsIGNzc1RleHQpIHtcbiAgICAgICAgdmFyIHAgPSBvd25lckRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKSxcbiAgICAgICAgICBwYXJlbnQgPSBvd25lckRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0gfHwgb3duZXJEb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG5cbiAgICAgICAgcC5pbm5lckhUTUwgPSAneDxzdHlsZT4nICsgY3NzVGV4dCArICc8L3N0eWxlPic7XG4gICAgICAgIHJldHVybiBwYXJlbnQuaW5zZXJ0QmVmb3JlKHAubGFzdENoaWxkLCBwYXJlbnQuZmlyc3RDaGlsZCk7XG4gICAgICB9XG5cbiAgICAgIC8qKlxuICAgICAgICogUmV0dXJucyB0aGUgdmFsdWUgb2YgYGh0bWw1LmVsZW1lbnRzYCBhcyBhbiBhcnJheS5cbiAgICAgICAqIEBwcml2YXRlXG4gICAgICAgKiBAcmV0dXJucyB7QXJyYXl9IEFuIGFycmF5IG9mIHNoaXZlZCBlbGVtZW50IG5vZGUgbmFtZXMuXG4gICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIGdldEVsZW1lbnRzKCkge1xuICAgICAgICB2YXIgZWxlbWVudHMgPSBodG1sNS5lbGVtZW50cztcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBlbGVtZW50cyA9PSAnc3RyaW5nJyA/IGVsZW1lbnRzLnNwbGl0KCcgJykgOiBlbGVtZW50cztcbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiBFeHRlbmRzIHRoZSBidWlsdC1pbiBsaXN0IG9mIGh0bWw1IGVsZW1lbnRzXG4gICAgICAgKiBAbWVtYmVyT2YgaHRtbDVcbiAgICAgICAqIEBwYXJhbSB7U3RyaW5nfEFycmF5fSBuZXdFbGVtZW50cyB3aGl0ZXNwYWNlIHNlcGFyYXRlZCBsaXN0IG9yIGFycmF5IG9mIG5ldyBlbGVtZW50IG5hbWVzIHRvIHNoaXZcbiAgICAgICAqIEBwYXJhbSB7RG9jdW1lbnR9IG93bmVyRG9jdW1lbnQgVGhlIGNvbnRleHQgZG9jdW1lbnQuXG4gICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIGFkZEVsZW1lbnRzKG5ld0VsZW1lbnRzLCBvd25lckRvY3VtZW50KSB7XG4gICAgICAgIHZhciBlbGVtZW50cyA9IGh0bWw1LmVsZW1lbnRzO1xuICAgICAgICBpZih0eXBlb2YgZWxlbWVudHMgIT0gJ3N0cmluZycpe1xuICAgICAgICAgIGVsZW1lbnRzID0gZWxlbWVudHMuam9pbignICcpO1xuICAgICAgICB9XG4gICAgICAgIGlmKHR5cGVvZiBuZXdFbGVtZW50cyAhPSAnc3RyaW5nJyl7XG4gICAgICAgICAgbmV3RWxlbWVudHMgPSBuZXdFbGVtZW50cy5qb2luKCcgJyk7XG4gICAgICAgIH1cbiAgICAgICAgaHRtbDUuZWxlbWVudHMgPSBlbGVtZW50cyArJyAnKyBuZXdFbGVtZW50cztcbiAgICAgICAgc2hpdkRvY3VtZW50KG93bmVyRG9jdW1lbnQpO1xuICAgICAgfVxuXG4gICAgICAvKipcbiAgICAgICAqIFJldHVybnMgdGhlIGRhdGEgYXNzb2NpYXRlZCB0byB0aGUgZ2l2ZW4gZG9jdW1lbnRcbiAgICAgICAqIEBwcml2YXRlXG4gICAgICAgKiBAcGFyYW0ge0RvY3VtZW50fSBvd25lckRvY3VtZW50IFRoZSBkb2N1bWVudC5cbiAgICAgICAqIEByZXR1cm5zIHtPYmplY3R9IEFuIG9iamVjdCBvZiBkYXRhLlxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiBnZXRFeHBhbmRvRGF0YShvd25lckRvY3VtZW50KSB7XG4gICAgICAgIHZhciBkYXRhID0gZXhwYW5kb0RhdGFbb3duZXJEb2N1bWVudFtleHBhbmRvXV07XG4gICAgICAgIGlmICghZGF0YSkge1xuICAgICAgICAgIGRhdGEgPSB7fTtcbiAgICAgICAgICBleHBhbklEKys7XG4gICAgICAgICAgb3duZXJEb2N1bWVudFtleHBhbmRvXSA9IGV4cGFuSUQ7XG4gICAgICAgICAgZXhwYW5kb0RhdGFbZXhwYW5JRF0gPSBkYXRhO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgfVxuXG4gICAgICAvKipcbiAgICAgICAqIHJldHVybnMgYSBzaGl2ZWQgZWxlbWVudCBmb3IgdGhlIGdpdmVuIG5vZGVOYW1lIGFuZCBkb2N1bWVudFxuICAgICAgICogQG1lbWJlck9mIGh0bWw1XG4gICAgICAgKiBAcGFyYW0ge1N0cmluZ30gbm9kZU5hbWUgbmFtZSBvZiB0aGUgZWxlbWVudFxuICAgICAgICogQHBhcmFtIHtEb2N1bWVudHxEb2N1bWVudEZyYWdtZW50fSBvd25lckRvY3VtZW50IFRoZSBjb250ZXh0IGRvY3VtZW50LlxuICAgICAgICogQHJldHVybnMge09iamVjdH0gVGhlIHNoaXZlZCBlbGVtZW50LlxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiBjcmVhdGVFbGVtZW50KG5vZGVOYW1lLCBvd25lckRvY3VtZW50LCBkYXRhKXtcbiAgICAgICAgaWYgKCFvd25lckRvY3VtZW50KSB7XG4gICAgICAgICAgb3duZXJEb2N1bWVudCA9IGRvY3VtZW50O1xuICAgICAgICB9XG4gICAgICAgIGlmKHN1cHBvcnRzVW5rbm93bkVsZW1lbnRzKXtcbiAgICAgICAgICByZXR1cm4gb3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KG5vZGVOYW1lKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWRhdGEpIHtcbiAgICAgICAgICBkYXRhID0gZ2V0RXhwYW5kb0RhdGEob3duZXJEb2N1bWVudCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5vZGU7XG5cbiAgICAgICAgaWYgKGRhdGEuY2FjaGVbbm9kZU5hbWVdKSB7XG4gICAgICAgICAgbm9kZSA9IGRhdGEuY2FjaGVbbm9kZU5hbWVdLmNsb25lTm9kZSgpO1xuICAgICAgICB9IGVsc2UgaWYgKHNhdmVDbG9uZXMudGVzdChub2RlTmFtZSkpIHtcbiAgICAgICAgICBub2RlID0gKGRhdGEuY2FjaGVbbm9kZU5hbWVdID0gZGF0YS5jcmVhdGVFbGVtKG5vZGVOYW1lKSkuY2xvbmVOb2RlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbm9kZSA9IGRhdGEuY3JlYXRlRWxlbShub2RlTmFtZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBdm9pZCBhZGRpbmcgc29tZSBlbGVtZW50cyB0byBmcmFnbWVudHMgaW4gSUUgPCA5IGJlY2F1c2VcbiAgICAgICAgLy8gKiBBdHRyaWJ1dGVzIGxpa2UgYG5hbWVgIG9yIGB0eXBlYCBjYW5ub3QgYmUgc2V0L2NoYW5nZWQgb25jZSBhbiBlbGVtZW50XG4gICAgICAgIC8vICAgaXMgaW5zZXJ0ZWQgaW50byBhIGRvY3VtZW50L2ZyYWdtZW50XG4gICAgICAgIC8vICogTGluayBlbGVtZW50cyB3aXRoIGBzcmNgIGF0dHJpYnV0ZXMgdGhhdCBhcmUgaW5hY2Nlc3NpYmxlLCBhcyB3aXRoXG4gICAgICAgIC8vICAgYSA0MDMgcmVzcG9uc2UsIHdpbGwgY2F1c2UgdGhlIHRhYi93aW5kb3cgdG8gY3Jhc2hcbiAgICAgICAgLy8gKiBTY3JpcHQgZWxlbWVudHMgYXBwZW5kZWQgdG8gZnJhZ21lbnRzIHdpbGwgZXhlY3V0ZSB3aGVuIHRoZWlyIGBzcmNgXG4gICAgICAgIC8vICAgb3IgYHRleHRgIHByb3BlcnR5IGlzIHNldFxuICAgICAgICByZXR1cm4gbm9kZS5jYW5IYXZlQ2hpbGRyZW4gJiYgIXJlU2tpcC50ZXN0KG5vZGVOYW1lKSAmJiAhbm9kZS50YWdVcm4gPyBkYXRhLmZyYWcuYXBwZW5kQ2hpbGQobm9kZSkgOiBub2RlO1xuICAgICAgfVxuXG4gICAgICAvKipcbiAgICAgICAqIHJldHVybnMgYSBzaGl2ZWQgRG9jdW1lbnRGcmFnbWVudCBmb3IgdGhlIGdpdmVuIGRvY3VtZW50XG4gICAgICAgKiBAbWVtYmVyT2YgaHRtbDVcbiAgICAgICAqIEBwYXJhbSB7RG9jdW1lbnR9IG93bmVyRG9jdW1lbnQgVGhlIGNvbnRleHQgZG9jdW1lbnQuXG4gICAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBUaGUgc2hpdmVkIERvY3VtZW50RnJhZ21lbnQuXG4gICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIGNyZWF0ZURvY3VtZW50RnJhZ21lbnQob3duZXJEb2N1bWVudCwgZGF0YSl7XG4gICAgICAgIGlmICghb3duZXJEb2N1bWVudCkge1xuICAgICAgICAgIG93bmVyRG9jdW1lbnQgPSBkb2N1bWVudDtcbiAgICAgICAgfVxuICAgICAgICBpZihzdXBwb3J0c1Vua25vd25FbGVtZW50cyl7XG4gICAgICAgICAgcmV0dXJuIG93bmVyRG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgICAgICB9XG4gICAgICAgIGRhdGEgPSBkYXRhIHx8IGdldEV4cGFuZG9EYXRhKG93bmVyRG9jdW1lbnQpO1xuICAgICAgICB2YXIgY2xvbmUgPSBkYXRhLmZyYWcuY2xvbmVOb2RlKCksXG4gICAgICAgICAgaSA9IDAsXG4gICAgICAgICAgZWxlbXMgPSBnZXRFbGVtZW50cygpLFxuICAgICAgICAgIGwgPSBlbGVtcy5sZW5ndGg7XG4gICAgICAgIGZvcig7aTxsO2krKyl7XG4gICAgICAgICAgY2xvbmUuY3JlYXRlRWxlbWVudChlbGVtc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgICAgfVxuXG4gICAgICAvKipcbiAgICAgICAqIFNoaXZzIHRoZSBgY3JlYXRlRWxlbWVudGAgYW5kIGBjcmVhdGVEb2N1bWVudEZyYWdtZW50YCBtZXRob2RzIG9mIHRoZSBkb2N1bWVudC5cbiAgICAgICAqIEBwcml2YXRlXG4gICAgICAgKiBAcGFyYW0ge0RvY3VtZW50fERvY3VtZW50RnJhZ21lbnR9IG93bmVyRG9jdW1lbnQgVGhlIGRvY3VtZW50LlxuICAgICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGEgb2YgdGhlIGRvY3VtZW50LlxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiBzaGl2TWV0aG9kcyhvd25lckRvY3VtZW50LCBkYXRhKSB7XG4gICAgICAgIGlmICghZGF0YS5jYWNoZSkge1xuICAgICAgICAgIGRhdGEuY2FjaGUgPSB7fTtcbiAgICAgICAgICBkYXRhLmNyZWF0ZUVsZW0gPSBvd25lckRvY3VtZW50LmNyZWF0ZUVsZW1lbnQ7XG4gICAgICAgICAgZGF0YS5jcmVhdGVGcmFnID0gb3duZXJEb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50O1xuICAgICAgICAgIGRhdGEuZnJhZyA9IGRhdGEuY3JlYXRlRnJhZygpO1xuICAgICAgICB9XG5cblxuICAgICAgICBvd25lckRvY3VtZW50LmNyZWF0ZUVsZW1lbnQgPSBmdW5jdGlvbihub2RlTmFtZSkge1xuICAgICAgICAgIC8vYWJvcnQgc2hpdlxuICAgICAgICAgIGlmICghaHRtbDUuc2hpdk1ldGhvZHMpIHtcbiAgICAgICAgICAgIHJldHVybiBkYXRhLmNyZWF0ZUVsZW0obm9kZU5hbWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gY3JlYXRlRWxlbWVudChub2RlTmFtZSwgb3duZXJEb2N1bWVudCwgZGF0YSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgb3duZXJEb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50ID0gRnVuY3Rpb24oJ2gsZicsICdyZXR1cm4gZnVuY3Rpb24oKXsnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3ZhciBuPWYuY2xvbmVOb2RlKCksYz1uLmNyZWF0ZUVsZW1lbnQ7JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdoLnNoaXZNZXRob2RzJiYoJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVucm9sbCB0aGUgYGNyZWF0ZUVsZW1lbnRgIGNhbGxzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldEVsZW1lbnRzKCkuam9pbigpLnJlcGxhY2UoL1tcXHdcXC06XSsvZywgZnVuY3Rpb24obm9kZU5hbWUpIHtcbiAgICAgICAgICBkYXRhLmNyZWF0ZUVsZW0obm9kZU5hbWUpO1xuICAgICAgICAgIGRhdGEuZnJhZy5jcmVhdGVFbGVtZW50KG5vZGVOYW1lKTtcbiAgICAgICAgICByZXR1cm4gJ2MoXCInICsgbm9kZU5hbWUgKyAnXCIpJztcbiAgICAgICAgfSkgK1xuICAgICAgICAgICcpO3JldHVybiBufSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApKGh0bWw1LCBkYXRhLmZyYWcpO1xuICAgICAgfVxuXG4gICAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAgICAgLyoqXG4gICAgICAgKiBTaGl2cyB0aGUgZ2l2ZW4gZG9jdW1lbnQuXG4gICAgICAgKiBAbWVtYmVyT2YgaHRtbDVcbiAgICAgICAqIEBwYXJhbSB7RG9jdW1lbnR9IG93bmVyRG9jdW1lbnQgVGhlIGRvY3VtZW50IHRvIHNoaXYuXG4gICAgICAgKiBAcmV0dXJucyB7RG9jdW1lbnR9IFRoZSBzaGl2ZWQgZG9jdW1lbnQuXG4gICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIHNoaXZEb2N1bWVudChvd25lckRvY3VtZW50KSB7XG4gICAgICAgIGlmICghb3duZXJEb2N1bWVudCkge1xuICAgICAgICAgIG93bmVyRG9jdW1lbnQgPSBkb2N1bWVudDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZGF0YSA9IGdldEV4cGFuZG9EYXRhKG93bmVyRG9jdW1lbnQpO1xuXG4gICAgICAgIGlmIChodG1sNS5zaGl2Q1NTICYmICFzdXBwb3J0c0h0bWw1U3R5bGVzICYmICFkYXRhLmhhc0NTUykge1xuICAgICAgICAgIGRhdGEuaGFzQ1NTID0gISFhZGRTdHlsZVNoZWV0KG93bmVyRG9jdW1lbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29ycmVjdHMgYmxvY2sgZGlzcGxheSBub3QgZGVmaW5lZCBpbiBJRTYvNy84LzlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYXJ0aWNsZSxhc2lkZSxkaWFsb2csZmlnY2FwdGlvbixmaWd1cmUsZm9vdGVyLGhlYWRlcixoZ3JvdXAsbWFpbixuYXYsc2VjdGlvbntkaXNwbGF5OmJsb2NrfScgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZHMgc3R5bGluZyBub3QgcHJlc2VudCBpbiBJRTYvNy84LzlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbWFya3tiYWNrZ3JvdW5kOiNGRjA7Y29sb3I6IzAwMH0nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBoaWRlcyBub24tcmVuZGVyZWQgZWxlbWVudHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndGVtcGxhdGV7ZGlzcGxheTpub25lfSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzdXBwb3J0c1Vua25vd25FbGVtZW50cykge1xuICAgICAgICAgIHNoaXZNZXRob2RzKG93bmVyRG9jdW1lbnQsIGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvd25lckRvY3VtZW50O1xuICAgICAgfVxuXG4gICAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAgICAgLyoqXG4gICAgICAgKiBUaGUgYGh0bWw1YCBvYmplY3QgaXMgZXhwb3NlZCBzbyB0aGF0IG1vcmUgZWxlbWVudHMgY2FuIGJlIHNoaXZlZCBhbmRcbiAgICAgICAqIGV4aXN0aW5nIHNoaXZpbmcgY2FuIGJlIGRldGVjdGVkIG9uIGlmcmFtZXMuXG4gICAgICAgKiBAdHlwZSBPYmplY3RcbiAgICAgICAqIEBleGFtcGxlXG4gICAgICAgKlxuICAgICAgICogLy8gb3B0aW9ucyBjYW4gYmUgY2hhbmdlZCBiZWZvcmUgdGhlIHNjcmlwdCBpcyBpbmNsdWRlZFxuICAgICAgICogaHRtbDUgPSB7ICdlbGVtZW50cyc6ICdtYXJrIHNlY3Rpb24nLCAnc2hpdkNTUyc6IGZhbHNlLCAnc2hpdk1ldGhvZHMnOiBmYWxzZSB9O1xuICAgICAgICovXG4gICAgICB2YXIgaHRtbDUgPSB7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFuIGFycmF5IG9yIHNwYWNlIHNlcGFyYXRlZCBzdHJpbmcgb2Ygbm9kZSBuYW1lcyBvZiB0aGUgZWxlbWVudHMgdG8gc2hpdi5cbiAgICAgICAgICogQG1lbWJlck9mIGh0bWw1XG4gICAgICAgICAqIEB0eXBlIEFycmF5fFN0cmluZ1xuICAgICAgICAgKi9cbiAgICAgICAgJ2VsZW1lbnRzJzogb3B0aW9ucy5lbGVtZW50cyB8fCAnYWJiciBhcnRpY2xlIGFzaWRlIGF1ZGlvIGJkaSBjYW52YXMgZGF0YSBkYXRhbGlzdCBkZXRhaWxzIGRpYWxvZyBmaWdjYXB0aW9uIGZpZ3VyZSBmb290ZXIgaGVhZGVyIGhncm91cCBtYWluIG1hcmsgbWV0ZXIgbmF2IG91dHB1dCBwaWN0dXJlIHByb2dyZXNzIHNlY3Rpb24gc3VtbWFyeSB0ZW1wbGF0ZSB0aW1lIHZpZGVvJyxcblxuICAgICAgICAvKipcbiAgICAgICAgICogY3VycmVudCB2ZXJzaW9uIG9mIGh0bWw1c2hpdlxuICAgICAgICAgKi9cbiAgICAgICAgJ3ZlcnNpb24nOiB2ZXJzaW9uLFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGZsYWcgdG8gaW5kaWNhdGUgdGhhdCB0aGUgSFRNTDUgc3R5bGUgc2hlZXQgc2hvdWxkIGJlIGluc2VydGVkLlxuICAgICAgICAgKiBAbWVtYmVyT2YgaHRtbDVcbiAgICAgICAgICogQHR5cGUgQm9vbGVhblxuICAgICAgICAgKi9cbiAgICAgICAgJ3NoaXZDU1MnOiAob3B0aW9ucy5zaGl2Q1NTICE9PSBmYWxzZSksXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIElzIGVxdWFsIHRvIHRydWUgaWYgYSBicm93c2VyIHN1cHBvcnRzIGNyZWF0aW5nIHVua25vd24vSFRNTDUgZWxlbWVudHNcbiAgICAgICAgICogQG1lbWJlck9mIGh0bWw1XG4gICAgICAgICAqIEB0eXBlIGJvb2xlYW5cbiAgICAgICAgICovXG4gICAgICAgICdzdXBwb3J0c1Vua25vd25FbGVtZW50cyc6IHN1cHBvcnRzVW5rbm93bkVsZW1lbnRzLFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGZsYWcgdG8gaW5kaWNhdGUgdGhhdCB0aGUgZG9jdW1lbnQncyBgY3JlYXRlRWxlbWVudGAgYW5kIGBjcmVhdGVEb2N1bWVudEZyYWdtZW50YFxuICAgICAgICAgKiBtZXRob2RzIHNob3VsZCBiZSBvdmVyd3JpdHRlbi5cbiAgICAgICAgICogQG1lbWJlck9mIGh0bWw1XG4gICAgICAgICAqIEB0eXBlIEJvb2xlYW5cbiAgICAgICAgICovXG4gICAgICAgICdzaGl2TWV0aG9kcyc6IChvcHRpb25zLnNoaXZNZXRob2RzICE9PSBmYWxzZSksXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgc3RyaW5nIHRvIGRlc2NyaWJlIHRoZSB0eXBlIG9mIGBodG1sNWAgb2JqZWN0IChcImRlZmF1bHRcIiBvciBcImRlZmF1bHQgcHJpbnRcIikuXG4gICAgICAgICAqIEBtZW1iZXJPZiBodG1sNVxuICAgICAgICAgKiBAdHlwZSBTdHJpbmdcbiAgICAgICAgICovXG4gICAgICAgICd0eXBlJzogJ2RlZmF1bHQnLFxuXG4gICAgICAgIC8vIHNoaXZzIHRoZSBkb2N1bWVudCBhY2NvcmRpbmcgdG8gdGhlIHNwZWNpZmllZCBgaHRtbDVgIG9iamVjdCBvcHRpb25zXG4gICAgICAgICdzaGl2RG9jdW1lbnQnOiBzaGl2RG9jdW1lbnQsXG5cbiAgICAgICAgLy9jcmVhdGVzIGEgc2hpdmVkIGVsZW1lbnRcbiAgICAgICAgY3JlYXRlRWxlbWVudDogY3JlYXRlRWxlbWVudCxcblxuICAgICAgICAvL2NyZWF0ZXMgYSBzaGl2ZWQgZG9jdW1lbnRGcmFnbWVudFxuICAgICAgICBjcmVhdGVEb2N1bWVudEZyYWdtZW50OiBjcmVhdGVEb2N1bWVudEZyYWdtZW50LFxuXG4gICAgICAgIC8vZXh0ZW5kcyBsaXN0IG9mIGVsZW1lbnRzXG4gICAgICAgIGFkZEVsZW1lbnRzOiBhZGRFbGVtZW50c1xuICAgICAgfTtcblxuICAgICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgICAgIC8vIGV4cG9zZSBodG1sNVxuICAgICAgd2luZG93Lmh0bWw1ID0gaHRtbDU7XG5cbiAgICAgIC8vIHNoaXYgdGhlIGRvY3VtZW50XG4gICAgICBzaGl2RG9jdW1lbnQoZG9jdW1lbnQpO1xuXG4gICAgICBpZih0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzKXtcbiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBodG1sNTtcbiAgICAgIH1cblxuICAgIH0odHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHRoaXMsIGRvY3VtZW50KSk7XG4gIH1cbjtcblxuICAvKipcbiAgICogY3JlYXRlRWxlbWVudCBpcyBhIGNvbnZlbmllbmNlIHdyYXBwZXIgYXJvdW5kIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQuIFNpbmNlIHdlXG4gICAqIHVzZSBjcmVhdGVFbGVtZW50IGFsbCBvdmVyIHRoZSBwbGFjZSwgdGhpcyBhbGxvd3MgZm9yIChzbGlnaHRseSkgc21hbGxlciBjb2RlXG4gICAqIGFzIHdlbGwgYXMgYWJzdHJhY3RpbmcgYXdheSBpc3N1ZXMgd2l0aCBjcmVhdGluZyBlbGVtZW50cyBpbiBjb250ZXh0cyBvdGhlciB0aGFuXG4gICAqIEhUTUwgZG9jdW1lbnRzIChlLmcuIFNWRyBkb2N1bWVudHMpLlxuICAgKlxuICAgKiBAYWNjZXNzIHByaXZhdGVcbiAgICogQGZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnRcbiAgICogQHJldHVybnMge0hUTUxFbGVtZW50fFNWR0VsZW1lbnR9IEFuIEhUTUwgb3IgU1ZHIGVsZW1lbnRcbiAgICovXG5cbiAgZnVuY3Rpb24gY3JlYXRlRWxlbWVudCgpIHtcbiAgICBpZiAodHlwZW9mIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIC8vIFRoaXMgaXMgdGhlIGNhc2UgaW4gSUU3LCB3aGVyZSB0aGUgdHlwZSBvZiBjcmVhdGVFbGVtZW50IGlzIFwib2JqZWN0XCIuXG4gICAgICAvLyBGb3IgdGhpcyByZWFzb24sIHdlIGNhbm5vdCBjYWxsIGFwcGx5KCkgYXMgT2JqZWN0IGlzIG5vdCBhIEZ1bmN0aW9uLlxuICAgICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoYXJndW1lbnRzWzBdKTtcbiAgICB9IGVsc2UgaWYgKGlzU1ZHKSB7XG4gICAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TLmNhbGwoZG9jdW1lbnQsICdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsIGFyZ3VtZW50c1swXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50LmFwcGx5KGRvY3VtZW50LCBhcmd1bWVudHMpO1xuICAgIH1cbiAgfVxuXG4gIDtcbi8qIVxue1xuICBcIm5hbWVcIjogXCJXZWJHTFwiLFxuICBcInByb3BlcnR5XCI6IFwid2ViZ2xcIixcbiAgXCJjYW5pdXNlXCI6IFwid2ViZ2xcIixcbiAgXCJ0YWdzXCI6IFtcIndlYmdsXCIsIFwiZ3JhcGhpY3NcIl0sXG4gIFwicG9seWZpbGxzXCI6IFtcImplYmdsXCIsIFwiY3dlYmdsXCIsIFwiaWV3ZWJnbFwiXVxufVxuISovXG5cbiAgTW9kZXJuaXpyLmFkZFRlc3QoJ3dlYmdsJywgZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNhbnZhcyA9IGNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICAgIHZhciBzdXBwb3J0cyA9ICdwcm9iYWJseVN1cHBvcnRzQ29udGV4dCcgaW4gY2FudmFzID8gJ3Byb2JhYmx5U3VwcG9ydHNDb250ZXh0JyA6ICAnc3VwcG9ydHNDb250ZXh0JztcbiAgICBpZiAoc3VwcG9ydHMgaW4gY2FudmFzKSB7XG4gICAgICByZXR1cm4gY2FudmFzW3N1cHBvcnRzXSgnd2ViZ2wnKSB8fCBjYW52YXNbc3VwcG9ydHNdKCdleHBlcmltZW50YWwtd2ViZ2wnKTtcbiAgICB9XG4gICAgcmV0dXJuICdXZWJHTFJlbmRlcmluZ0NvbnRleHQnIGluIHdpbmRvdztcbiAgfSk7XG5cblxuICAvKipcbiAgICogTGlzdCBvZiBwcm9wZXJ0eSB2YWx1ZXMgdG8gc2V0IGZvciBjc3MgdGVzdHMuIFNlZSB0aWNrZXQgIzIxXG4gICAqIGh0dHA6Ly9naXQuaW8vdlVHbDRcbiAgICpcbiAgICogQG1lbWJlcm9mIE1vZGVybml6clxuICAgKiBAbmFtZSBNb2Rlcm5penIuX3ByZWZpeGVzXG4gICAqIEBvcHRpb25OYW1lIE1vZGVybml6ci5fcHJlZml4ZXNcbiAgICogQG9wdGlvblByb3AgcHJlZml4ZXNcbiAgICogQGFjY2VzcyBwdWJsaWNcbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogTW9kZXJuaXpyLl9wcmVmaXhlcyBpcyB0aGUgaW50ZXJuYWwgbGlzdCBvZiBwcmVmaXhlcyB0aGF0IHdlIHRlc3QgYWdhaW5zdFxuICAgKiBpbnNpZGUgb2YgdGhpbmdzIGxpa2UgW3ByZWZpeGVkXSgjbW9kZXJuaXpyLXByZWZpeGVkKSBhbmQgW3ByZWZpeGVkQ1NTXSgjLWNvZGUtbW9kZXJuaXpyLXByZWZpeGVkY3NzKS4gSXQgaXMgc2ltcGx5XG4gICAqIGFuIGFycmF5IG9mIGtlYmFiLWNhc2UgdmVuZG9yIHByZWZpeGVzIHlvdSBjYW4gdXNlIHdpdGhpbiB5b3VyIGNvZGUuXG4gICAqXG4gICAqIFNvbWUgY29tbW9uIHVzZSBjYXNlcyBpbmNsdWRlXG4gICAqXG4gICAqIEdlbmVyYXRpbmcgYWxsIHBvc3NpYmxlIHByZWZpeGVkIHZlcnNpb24gb2YgYSBDU1MgcHJvcGVydHlcbiAgICogYGBganNcbiAgICogdmFyIHJ1bGUgPSBNb2Rlcm5penIuX3ByZWZpeGVzLmpvaW4oJ3RyYW5zZm9ybTogcm90YXRlKDIwZGVnKTsgJyk7XG4gICAqXG4gICAqIHJ1bGUgPT09ICd0cmFuc2Zvcm06IHJvdGF0ZSgyMGRlZyk7IHdlYmtpdC10cmFuc2Zvcm06IHJvdGF0ZSgyMGRlZyk7IG1vei10cmFuc2Zvcm06IHJvdGF0ZSgyMGRlZyk7IG8tdHJhbnNmb3JtOiByb3RhdGUoMjBkZWcpOyBtcy10cmFuc2Zvcm06IHJvdGF0ZSgyMGRlZyk7J1xuICAgKiBgYGBcbiAgICpcbiAgICogR2VuZXJhdGluZyBhbGwgcG9zc2libGUgcHJlZml4ZWQgdmVyc2lvbiBvZiBhIENTUyB2YWx1ZVxuICAgKiBgYGBqc1xuICAgKiBydWxlID0gJ2Rpc3BsYXk6JyArICBNb2Rlcm5penIuX3ByZWZpeGVzLmpvaW4oJ2ZsZXg7IGRpc3BsYXk6JykgKyAnZmxleCc7XG4gICAqXG4gICAqIHJ1bGUgPT09ICdkaXNwbGF5OmZsZXg7IGRpc3BsYXk6LXdlYmtpdC1mbGV4OyBkaXNwbGF5Oi1tb3otZmxleDsgZGlzcGxheTotby1mbGV4OyBkaXNwbGF5Oi1tcy1mbGV4OyBkaXNwbGF5OmZsZXgnXG4gICAqIGBgYFxuICAgKi9cblxuICAvLyB3ZSB1c2UgWycnLCcnXSByYXRoZXIgdGhhbiBhbiBlbXB0eSBhcnJheSBpbiBvcmRlciB0byBhbGxvdyBhIHBhdHRlcm4gb2YgLmBqb2luKClgaW5nIHByZWZpeGVzIHRvIHRlc3RcbiAgLy8gdmFsdWVzIGluIGZlYXR1cmUgZGV0ZWN0cyB0byBjb250aW51ZSB0byB3b3JrXG4gIHZhciBwcmVmaXhlcyA9IChNb2Rlcm5penJQcm90by5fY29uZmlnLnVzZVByZWZpeGVzID8gJyAtd2Via2l0LSAtbW96LSAtby0gLW1zLSAnLnNwbGl0KCcgJykgOiBbJycsJyddKTtcblxuICAvLyBleHBvc2UgdGhlc2UgZm9yIHRoZSBwbHVnaW4gQVBJLiBMb29rIGluIHRoZSBzb3VyY2UgZm9yIGhvdyB0byBqb2luKCkgdGhlbSBhZ2FpbnN0IHlvdXIgaW5wdXRcbiAgTW9kZXJuaXpyUHJvdG8uX3ByZWZpeGVzID0gcHJlZml4ZXM7XG5cblxuLyohXG57XG4gIFwibmFtZVwiOiBcIkNTUyBDYWxjXCIsXG4gIFwicHJvcGVydHlcIjogXCJjc3NjYWxjXCIsXG4gIFwiY2FuaXVzZVwiOiBcImNhbGNcIixcbiAgXCJ0YWdzXCI6IFtcImNzc1wiXSxcbiAgXCJidWlsZGVyQWxpYXNlc1wiOiBbXCJjc3NfY2FsY1wiXSxcbiAgXCJhdXRob3JzXCI6IFtcIkBjYWx2ZWluXCJdXG59XG4hKi9cbi8qIERPQ1xuTWV0aG9kIG9mIGFsbG93aW5nIGNhbGN1bGF0ZWQgdmFsdWVzIGZvciBsZW5ndGggdW5pdHMuIEZvciBleGFtcGxlOlxuXG5gYGBjc3Ncbi8vbGVtIHtcbiAgd2lkdGg6IGNhbGMoMTAwJSAtIDNlbSk7XG59XG5gYGBcbiovXG5cbiAgTW9kZXJuaXpyLmFkZFRlc3QoJ2Nzc2NhbGMnLCBmdW5jdGlvbigpIHtcbiAgICB2YXIgcHJvcCA9ICd3aWR0aDonO1xuICAgIHZhciB2YWx1ZSA9ICdjYWxjKDEwcHgpOyc7XG4gICAgdmFyIGVsID0gY3JlYXRlRWxlbWVudCgnYScpO1xuXG4gICAgZWwuc3R5bGUuY3NzVGV4dCA9IHByb3AgKyBwcmVmaXhlcy5qb2luKHZhbHVlICsgcHJvcCk7XG5cbiAgICByZXR1cm4gISFlbC5zdHlsZS5sZW5ndGg7XG4gIH0pO1xuXG4vKiFcbntcbiAgXCJuYW1lXCI6IFwiQ1NTIEdyYWRpZW50c1wiLFxuICBcImNhbml1c2VcIjogXCJjc3MtZ3JhZGllbnRzXCIsXG4gIFwicHJvcGVydHlcIjogXCJjc3NncmFkaWVudHNcIixcbiAgXCJ0YWdzXCI6IFtcImNzc1wiXSxcbiAgXCJrbm93bkJ1Z3NcIjogW1wiRmFsc2UtcG9zaXRpdmVzIG9uIHdlYk9TIChodHRwczovL2dpdGh1Yi5jb20vTW9kZXJuaXpyL01vZGVybml6ci9pc3N1ZXMvMjAyKVwiXSxcbiAgXCJub3Rlc1wiOiBbe1xuICAgIFwibmFtZVwiOiBcIldlYmtpdCBHcmFkaWVudCBTeW50YXhcIixcbiAgICBcImhyZWZcIjogXCJodHRwczovL3dlYmtpdC5vcmcvYmxvZy8xNzUvaW50cm9kdWNpbmctY3NzLWdyYWRpZW50cy9cIlxuICB9LHtcbiAgICBcIm5hbWVcIjogXCJMaW5lYXIgR3JhZGllbnQgU3ludGF4XCIsXG4gICAgXCJocmVmXCI6IFwiaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQ1NTL2xpbmVhci1ncmFkaWVudFwiXG4gIH0se1xuICAgIFwibmFtZVwiOiBcIlczQyBHcmFkaWVudCBTcGVjXCIsXG4gICAgXCJocmVmXCI6IFwiaHR0cHM6Ly9kcmFmdHMuY3Nzd2cub3JnL2Nzcy1pbWFnZXMtMy8jZ3JhZGllbnRzXCJcbiAgfV1cbn1cbiEqL1xuXG5cbiAgTW9kZXJuaXpyLmFkZFRlc3QoJ2Nzc2dyYWRpZW50cycsIGZ1bmN0aW9uKCkge1xuXG4gICAgdmFyIHN0cjEgPSAnYmFja2dyb3VuZC1pbWFnZTonO1xuICAgIHZhciBzdHIyID0gJ2dyYWRpZW50KGxpbmVhcixsZWZ0IHRvcCxyaWdodCBib3R0b20sZnJvbSgjOWY5KSx0byh3aGl0ZSkpOyc7XG4gICAgdmFyIGNzcyA9ICcnO1xuICAgIHZhciBhbmdsZTtcblxuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBwcmVmaXhlcy5sZW5ndGggLSAxOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIGFuZ2xlID0gKGkgPT09IDAgPyAndG8gJyA6ICcnKTtcbiAgICAgIGNzcyArPSBzdHIxICsgcHJlZml4ZXNbaV0gKyAnbGluZWFyLWdyYWRpZW50KCcgKyBhbmdsZSArICdsZWZ0IHRvcCwgIzlmOSwgd2hpdGUpOyc7XG4gICAgfVxuXG4gICAgaWYgKE1vZGVybml6ci5fY29uZmlnLnVzZVByZWZpeGVzKSB7XG4gICAgLy8gbGVnYWN5IHdlYmtpdCBzeW50YXggKEZJWE1FOiByZW1vdmUgd2hlbiBzeW50YXggbm90IGluIHVzZSBhbnltb3JlKVxuICAgICAgY3NzICs9IHN0cjEgKyAnLXdlYmtpdC0nICsgc3RyMjtcbiAgICB9XG5cbiAgICB2YXIgZWxlbSA9IGNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICB2YXIgc3R5bGUgPSBlbGVtLnN0eWxlO1xuICAgIHN0eWxlLmNzc1RleHQgPSBjc3M7XG5cbiAgICAvLyBJRTYgcmV0dXJucyB1bmRlZmluZWQgc28gY2FzdCB0byBzdHJpbmdcbiAgICByZXR1cm4gKCcnICsgc3R5bGUuYmFja2dyb3VuZEltYWdlKS5pbmRleE9mKCdncmFkaWVudCcpID4gLTE7XG4gIH0pO1xuXG4vKiFcbntcbiAgXCJuYW1lXCI6IFwiQ1NTIFN1cHBvcnRzXCIsXG4gIFwicHJvcGVydHlcIjogXCJzdXBwb3J0c1wiLFxuICBcImNhbml1c2VcIjogXCJjc3MtZmVhdHVyZXF1ZXJpZXNcIixcbiAgXCJ0YWdzXCI6IFtcImNzc1wiXSxcbiAgXCJidWlsZGVyQWxpYXNlc1wiOiBbXCJjc3Nfc3VwcG9ydHNcIl0sXG4gIFwibm90ZXNcIjogW3tcbiAgICBcIm5hbWVcIjogXCJXMyBTcGVjXCIsXG4gICAgXCJocmVmXCI6IFwiaHR0cDovL2Rldi53My5vcmcvY3Nzd2cvY3NzMy1jb25kaXRpb25hbC8jYXQtc3VwcG9ydHNcIlxuICB9LHtcbiAgICBcIm5hbWVcIjogXCJSZWxhdGVkIEdpdGh1YiBJc3N1ZVwiLFxuICAgIFwiaHJlZlwiOiBcImdpdGh1Yi5jb20vTW9kZXJuaXpyL01vZGVybml6ci9pc3N1ZXMvNjQ4XCJcbiAgfSx7XG4gICAgXCJuYW1lXCI6IFwiVzMgSW5mb1wiLFxuICAgIFwiaHJlZlwiOiBcImh0dHA6Ly9kZXYudzMub3JnL2Nzc3dnL2NzczMtY29uZGl0aW9uYWwvI3RoZS1jc3NzdXBwb3J0c3J1bGUtaW50ZXJmYWNlXCJcbiAgfV1cbn1cbiEqL1xuXG4gIHZhciBuZXdTeW50YXggPSAnQ1NTJyBpbiB3aW5kb3cgJiYgJ3N1cHBvcnRzJyBpbiB3aW5kb3cuQ1NTO1xuICB2YXIgb2xkU3ludGF4ID0gJ3N1cHBvcnRzQ1NTJyBpbiB3aW5kb3c7XG4gIE1vZGVybml6ci5hZGRUZXN0KCdzdXBwb3J0cycsIG5ld1N5bnRheCB8fCBvbGRTeW50YXgpO1xuXG5cbiAgLyoqXG4gICAqIGdldEJvZHkgcmV0dXJucyB0aGUgYm9keSBvZiBhIGRvY3VtZW50LCBvciBhbiBlbGVtZW50IHRoYXQgY2FuIHN0YW5kIGluIGZvclxuICAgKiB0aGUgYm9keSBpZiBhIHJlYWwgYm9keSBkb2VzIG5vdCBleGlzdFxuICAgKlxuICAgKiBAYWNjZXNzIHByaXZhdGVcbiAgICogQGZ1bmN0aW9uIGdldEJvZHlcbiAgICogQHJldHVybnMge0hUTUxFbGVtZW50fFNWR0VsZW1lbnR9IFJldHVybnMgdGhlIHJlYWwgYm9keSBvZiBhIGRvY3VtZW50LCBvciBhblxuICAgKiBhcnRpZmljaWFsbHkgY3JlYXRlZCBlbGVtZW50IHRoYXQgc3RhbmRzIGluIGZvciB0aGUgYm9keVxuICAgKi9cblxuICBmdW5jdGlvbiBnZXRCb2R5KCkge1xuICAgIC8vIEFmdGVyIHBhZ2UgbG9hZCBpbmplY3RpbmcgYSBmYWtlIGJvZHkgZG9lc24ndCB3b3JrIHNvIGNoZWNrIGlmIGJvZHkgZXhpc3RzXG4gICAgdmFyIGJvZHkgPSBkb2N1bWVudC5ib2R5O1xuXG4gICAgaWYgKCFib2R5KSB7XG4gICAgICAvLyBDYW4ndCB1c2UgdGhlIHJlYWwgYm9keSBjcmVhdGUgYSBmYWtlIG9uZS5cbiAgICAgIGJvZHkgPSBjcmVhdGVFbGVtZW50KGlzU1ZHID8gJ3N2ZycgOiAnYm9keScpO1xuICAgICAgYm9keS5mYWtlID0gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gYm9keTtcbiAgfVxuXG4gIDtcblxuICAvKipcbiAgICogaW5qZWN0RWxlbWVudFdpdGhTdHlsZXMgaW5qZWN0cyBhbiBlbGVtZW50IHdpdGggc3R5bGUgZWxlbWVudCBhbmQgc29tZSBDU1MgcnVsZXNcbiAgICpcbiAgICogQGFjY2VzcyBwcml2YXRlXG4gICAqIEBmdW5jdGlvbiBpbmplY3RFbGVtZW50V2l0aFN0eWxlc1xuICAgKiBAcGFyYW0ge3N0cmluZ30gcnVsZSAtIFN0cmluZyByZXByZXNlbnRpbmcgYSBjc3MgcnVsZVxuICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjayAtIEEgZnVuY3Rpb24gdGhhdCBpcyB1c2VkIHRvIHRlc3QgdGhlIGluamVjdGVkIGVsZW1lbnRcbiAgICogQHBhcmFtIHtudW1iZXJ9IFtub2Rlc10gLSBBbiBpbnRlZ2VyIHJlcHJlc2VudGluZyB0aGUgbnVtYmVyIG9mIGFkZGl0aW9uYWwgbm9kZXMgeW91IHdhbnQgaW5qZWN0ZWRcbiAgICogQHBhcmFtIHtzdHJpbmdbXX0gW3Rlc3RuYW1lc10gLSBBbiBhcnJheSBvZiBzdHJpbmdzIHRoYXQgYXJlIHVzZWQgYXMgaWRzIGZvciB0aGUgYWRkaXRpb25hbCBub2Rlc1xuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICovXG5cbiAgZnVuY3Rpb24gaW5qZWN0RWxlbWVudFdpdGhTdHlsZXMocnVsZSwgY2FsbGJhY2ssIG5vZGVzLCB0ZXN0bmFtZXMpIHtcbiAgICB2YXIgbW9kID0gJ21vZGVybml6cic7XG4gICAgdmFyIHN0eWxlO1xuICAgIHZhciByZXQ7XG4gICAgdmFyIG5vZGU7XG4gICAgdmFyIGRvY092ZXJmbG93O1xuICAgIHZhciBkaXYgPSBjcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB2YXIgYm9keSA9IGdldEJvZHkoKTtcblxuICAgIGlmIChwYXJzZUludChub2RlcywgMTApKSB7XG4gICAgICAvLyBJbiBvcmRlciBub3QgdG8gZ2l2ZSBmYWxzZSBwb3NpdGl2ZXMgd2UgY3JlYXRlIGEgbm9kZSBmb3IgZWFjaCB0ZXN0XG4gICAgICAvLyBUaGlzIGFsc28gYWxsb3dzIHRoZSBtZXRob2QgdG8gc2NhbGUgZm9yIHVuc3BlY2lmaWVkIHVzZXNcbiAgICAgIHdoaWxlIChub2Rlcy0tKSB7XG4gICAgICAgIG5vZGUgPSBjcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgbm9kZS5pZCA9IHRlc3RuYW1lcyA/IHRlc3RuYW1lc1tub2Rlc10gOiBtb2QgKyAobm9kZXMgKyAxKTtcbiAgICAgICAgZGl2LmFwcGVuZENoaWxkKG5vZGUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHN0eWxlID0gY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcbiAgICBzdHlsZS50eXBlID0gJ3RleHQvY3NzJztcbiAgICBzdHlsZS5pZCA9ICdzJyArIG1vZDtcblxuICAgIC8vIElFNiB3aWxsIGZhbHNlIHBvc2l0aXZlIG9uIHNvbWUgdGVzdHMgZHVlIHRvIHRoZSBzdHlsZSBlbGVtZW50IGluc2lkZSB0aGUgdGVzdCBkaXYgc29tZWhvdyBpbnRlcmZlcmluZyBvZmZzZXRIZWlnaHQsIHNvIGluc2VydCBpdCBpbnRvIGJvZHkgb3IgZmFrZWJvZHkuXG4gICAgLy8gT3BlcmEgd2lsbCBhY3QgYWxsIHF1aXJreSB3aGVuIGluamVjdGluZyBlbGVtZW50cyBpbiBkb2N1bWVudEVsZW1lbnQgd2hlbiBwYWdlIGlzIHNlcnZlZCBhcyB4bWwsIG5lZWRzIGZha2Vib2R5IHRvby4gIzI3MFxuICAgICghYm9keS5mYWtlID8gZGl2IDogYm9keSkuYXBwZW5kQ2hpbGQoc3R5bGUpO1xuICAgIGJvZHkuYXBwZW5kQ2hpbGQoZGl2KTtcblxuICAgIGlmIChzdHlsZS5zdHlsZVNoZWV0KSB7XG4gICAgICBzdHlsZS5zdHlsZVNoZWV0LmNzc1RleHQgPSBydWxlO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdHlsZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShydWxlKSk7XG4gICAgfVxuICAgIGRpdi5pZCA9IG1vZDtcblxuICAgIGlmIChib2R5LmZha2UpIHtcbiAgICAgIC8vYXZvaWQgY3Jhc2hpbmcgSUU4LCBpZiBiYWNrZ3JvdW5kIGltYWdlIGlzIHVzZWRcbiAgICAgIGJvZHkuc3R5bGUuYmFja2dyb3VuZCA9ICcnO1xuICAgICAgLy9TYWZhcmkgNS4xMy81LjEuNCBPU1ggc3RvcHMgbG9hZGluZyBpZiA6Oi13ZWJraXQtc2Nyb2xsYmFyIGlzIHVzZWQgYW5kIHNjcm9sbGJhcnMgYXJlIHZpc2libGVcbiAgICAgIGJvZHkuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcbiAgICAgIGRvY092ZXJmbG93ID0gZG9jRWxlbWVudC5zdHlsZS5vdmVyZmxvdztcbiAgICAgIGRvY0VsZW1lbnQuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcbiAgICAgIGRvY0VsZW1lbnQuYXBwZW5kQ2hpbGQoYm9keSk7XG4gICAgfVxuXG4gICAgcmV0ID0gY2FsbGJhY2soZGl2LCBydWxlKTtcbiAgICAvLyBJZiB0aGlzIGlzIGRvbmUgYWZ0ZXIgcGFnZSBsb2FkIHdlIGRvbid0IHdhbnQgdG8gcmVtb3ZlIHRoZSBib2R5IHNvIGNoZWNrIGlmIGJvZHkgZXhpc3RzXG4gICAgaWYgKGJvZHkuZmFrZSkge1xuICAgICAgYm9keS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGJvZHkpO1xuICAgICAgZG9jRWxlbWVudC5zdHlsZS5vdmVyZmxvdyA9IGRvY092ZXJmbG93O1xuICAgICAgLy8gVHJpZ2dlciBsYXlvdXQgc28ga2luZXRpYyBzY3JvbGxpbmcgaXNuJ3QgZGlzYWJsZWQgaW4gaU9TNitcbiAgICAgIGRvY0VsZW1lbnQub2Zmc2V0SGVpZ2h0O1xuICAgIH0gZWxzZSB7XG4gICAgICBkaXYucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChkaXYpO1xuICAgIH1cblxuICAgIHJldHVybiAhIXJldDtcblxuICB9XG5cbiAgO1xuXG4gIC8qKlxuICAgKiB0ZXN0U3R5bGVzIGluamVjdHMgYW4gZWxlbWVudCB3aXRoIHN0eWxlIGVsZW1lbnQgYW5kIHNvbWUgQ1NTIHJ1bGVzXG4gICAqXG4gICAqIEBtZW1iZXJvZiBNb2Rlcm5penJcbiAgICogQG5hbWUgTW9kZXJuaXpyLnRlc3RTdHlsZXNcbiAgICogQG9wdGlvbk5hbWUgTW9kZXJuaXpyLnRlc3RTdHlsZXMoKVxuICAgKiBAb3B0aW9uUHJvcCB0ZXN0U3R5bGVzXG4gICAqIEBhY2Nlc3MgcHVibGljXG4gICAqIEBmdW5jdGlvbiB0ZXN0U3R5bGVzXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBydWxlIC0gU3RyaW5nIHJlcHJlc2VudGluZyBhIGNzcyBydWxlXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIC0gQSBmdW5jdGlvbiB0aGF0IGlzIHVzZWQgdG8gdGVzdCB0aGUgaW5qZWN0ZWQgZWxlbWVudFxuICAgKiBAcGFyYW0ge251bWJlcn0gW25vZGVzXSAtIEFuIGludGVnZXIgcmVwcmVzZW50aW5nIHRoZSBudW1iZXIgb2YgYWRkaXRpb25hbCBub2RlcyB5b3Ugd2FudCBpbmplY3RlZFxuICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBbdGVzdG5hbWVzXSAtIEFuIGFycmF5IG9mIHN0cmluZ3MgdGhhdCBhcmUgdXNlZCBhcyBpZHMgZm9yIHRoZSBhZGRpdGlvbmFsIG5vZGVzXG4gICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiBgTW9kZXJuaXpyLnRlc3RTdHlsZXNgIHRha2VzIGEgQ1NTIHJ1bGUgYW5kIGluamVjdHMgaXQgb250byB0aGUgY3VycmVudCBwYWdlXG4gICAqIGFsb25nIHdpdGggKHBvc3NpYmx5IG11bHRpcGxlKSBET00gZWxlbWVudHMuIFRoaXMgbGV0cyB5b3UgY2hlY2sgZm9yIGZlYXR1cmVzXG4gICAqIHRoYXQgY2FuIG5vdCBiZSBkZXRlY3RlZCBieSBzaW1wbHkgY2hlY2tpbmcgdGhlIFtJRExdKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvTW96aWxsYS9EZXZlbG9wZXJfZ3VpZGUvSW50ZXJmYWNlX2RldmVsb3BtZW50X2d1aWRlL0lETF9pbnRlcmZhY2VfcnVsZXMpLlxuICAgKlxuICAgKiBgYGBqc1xuICAgKiBNb2Rlcm5penIudGVzdFN0eWxlcygnI21vZGVybml6ciB7IHdpZHRoOiA5cHg7IGNvbG9yOiBwYXBheWF3aGlwOyB9JywgZnVuY3Rpb24oZWxlbSwgcnVsZSkge1xuICAgKiAgIC8vIGVsZW0gaXMgdGhlIGZpcnN0IERPTSBub2RlIGluIHRoZSBwYWdlIChieSBkZWZhdWx0ICNtb2Rlcm5penIpXG4gICAqICAgLy8gcnVsZSBpcyB0aGUgZmlyc3QgYXJndW1lbnQgeW91IHN1cHBsaWVkIC0gdGhlIENTUyBydWxlIGluIHN0cmluZyBmb3JtXG4gICAqXG4gICAqICAgYWRkVGVzdCgnd2lkdGh3b3JrcycsIGVsZW0uc3R5bGUud2lkdGggPT09ICc5cHgnKVxuICAgKiB9KTtcbiAgICogYGBgXG4gICAqXG4gICAqIElmIHlvdXIgdGVzdCByZXF1aXJlcyBtdWx0aXBsZSBub2RlcywgeW91IGNhbiBpbmNsdWRlIGEgdGhpcmQgYXJndW1lbnRcbiAgICogaW5kaWNhdGluZyBob3cgbWFueSBhZGRpdGlvbmFsIGRpdiBlbGVtZW50cyB0byBpbmNsdWRlIG9uIHRoZSBwYWdlLiBUaGVcbiAgICogYWRkaXRpb25hbCBub2RlcyBhcmUgaW5qZWN0ZWQgYXMgY2hpbGRyZW4gb2YgdGhlIGBlbGVtYCB0aGF0IGlzIHJldHVybmVkIGFzXG4gICAqIHRoZSBmaXJzdCBhcmd1bWVudCB0byB0aGUgY2FsbGJhY2suXG4gICAqXG4gICAqIGBgYGpzXG4gICAqIE1vZGVybml6ci50ZXN0U3R5bGVzKCcjbW9kZXJuaXpyIHt3aWR0aDogMXB4fTsgI21vZGVybml6cjIge3dpZHRoOiAycHh9JywgZnVuY3Rpb24oZWxlbSkge1xuICAgKiAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2Rlcm5penInKS5zdHlsZS53aWR0aCA9PT0gJzFweCc7IC8vIHRydWVcbiAgICogICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kZXJuaXpyMicpLnN0eWxlLndpZHRoID09PSAnMnB4JzsgLy8gdHJ1ZVxuICAgKiAgIGVsZW0uZmlyc3RDaGlsZCA9PT0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGVybml6cjInKTsgLy8gdHJ1ZVxuICAgKiB9LCAxKTtcbiAgICogYGBgXG4gICAqXG4gICAqIEJ5IGRlZmF1bHQsIGFsbCBvZiB0aGUgYWRkaXRpb25hbCBlbGVtZW50cyBoYXZlIGFuIElEIG9mIGBtb2Rlcm5penJbbl1gLCB3aGVyZVxuICAgKiBgbmAgaXMgaXRzIGluZGV4IChlLmcuIHRoZSBmaXJzdCBhZGRpdGlvbmFsLCBzZWNvbmQgb3ZlcmFsbCBpcyBgI21vZGVybml6cjJgLFxuICAgKiB0aGUgc2Vjb25kIGFkZGl0aW9uYWwgaXMgYCNtb2Rlcm5penIzYCwgZXRjLikuXG4gICAqIElmIHlvdSB3YW50IHRvIGhhdmUgbW9yZSBtZWFuaW5nZnVsIElEcyBmb3IgeW91ciBmdW5jdGlvbiwgeW91IGNhbiBwcm92aWRlXG4gICAqIHRoZW0gYXMgdGhlIGZvdXJ0aCBhcmd1bWVudCwgYXMgYW4gYXJyYXkgb2Ygc3RyaW5nc1xuICAgKlxuICAgKiBgYGBqc1xuICAgKiBNb2Rlcm5penIudGVzdFN0eWxlcygnI2ZvbyB7d2lkdGg6IDEwcHh9OyAjYmFyIHtoZWlnaHQ6IDIwcHh9JywgZnVuY3Rpb24oZWxlbSkge1xuICAgKiAgIGVsZW0uZmlyc3RDaGlsZCA9PT0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZvbycpOyAvLyB0cnVlXG4gICAqICAgZWxlbS5sYXN0Q2hpbGQgPT09IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiYXInKTsgLy8gdHJ1ZVxuICAgKiB9LCAyLCBbJ2ZvbycsICdiYXInXSk7XG4gICAqIGBgYFxuICAgKlxuICAgKi9cblxuICB2YXIgdGVzdFN0eWxlcyA9IE1vZGVybml6clByb3RvLnRlc3RTdHlsZXMgPSBpbmplY3RFbGVtZW50V2l0aFN0eWxlcztcblxuXG4gIC8qKlxuICAgKiBJZiB0aGUgYnJvd3NlcnMgZm9sbG93IHRoZSBzcGVjLCB0aGVuIHRoZXkgd291bGQgZXhwb3NlIHZlbmRvci1zcGVjaWZpYyBzdHlsZSBhczpcbiAgICogICBlbGVtLnN0eWxlLldlYmtpdEJvcmRlclJhZGl1c1xuICAgKiBpbnN0ZWFkIG9mIHNvbWV0aGluZyBsaWtlIHRoZSBmb2xsb3dpbmcsIHdoaWNoIHdvdWxkIGJlIHRlY2huaWNhbGx5IGluY29ycmVjdDpcbiAgICogICBlbGVtLnN0eWxlLndlYmtpdEJvcmRlclJhZGl1c1xuXG4gICAqIFdlYmtpdCBnaG9zdHMgdGhlaXIgcHJvcGVydGllcyBpbiBsb3dlcmNhc2UgYnV0IE9wZXJhICYgTW96IGRvIG5vdC5cbiAgICogTWljcm9zb2Z0IHVzZXMgYSBsb3dlcmNhc2UgYG1zYCBpbnN0ZWFkIG9mIHRoZSBjb3JyZWN0IGBNc2AgaW4gSUU4K1xuICAgKiAgIGVyaWsuZWFlLm5ldC9hcmNoaXZlcy8yMDA4LzAzLzEwLzIxLjQ4LjEwL1xuXG4gICAqIE1vcmUgaGVyZTogZ2l0aHViLmNvbS9Nb2Rlcm5penIvTW9kZXJuaXpyL2lzc3Vlcy9pc3N1ZS8yMVxuICAgKlxuICAgKiBAYWNjZXNzIHByaXZhdGVcbiAgICogQHJldHVybnMge3N0cmluZ30gVGhlIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIHZlbmRvci1zcGVjaWZpYyBzdHlsZSBwcm9wZXJ0aWVzXG4gICAqL1xuXG4gIHZhciBvbVByZWZpeGVzID0gJ01veiBPIG1zIFdlYmtpdCc7XG5cblxuICB2YXIgY3Nzb21QcmVmaXhlcyA9IChNb2Rlcm5penJQcm90by5fY29uZmlnLnVzZVByZWZpeGVzID8gb21QcmVmaXhlcy5zcGxpdCgnICcpIDogW10pO1xuICBNb2Rlcm5penJQcm90by5fY3Nzb21QcmVmaXhlcyA9IGNzc29tUHJlZml4ZXM7XG5cblxuICAvKipcbiAgICogTGlzdCBvZiBKYXZhU2NyaXB0IERPTSB2YWx1ZXMgdXNlZCBmb3IgdGVzdHNcbiAgICpcbiAgICogQG1lbWJlcm9mIE1vZGVybml6clxuICAgKiBAbmFtZSBNb2Rlcm5penIuX2RvbVByZWZpeGVzXG4gICAqIEBvcHRpb25OYW1lIE1vZGVybml6ci5fZG9tUHJlZml4ZXNcbiAgICogQG9wdGlvblByb3AgZG9tUHJlZml4ZXNcbiAgICogQGFjY2VzcyBwdWJsaWNcbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogTW9kZXJuaXpyLl9kb21QcmVmaXhlcyBpcyBleGFjdGx5IHRoZSBzYW1lIGFzIFtfcHJlZml4ZXNdKCNtb2Rlcm5penItX3ByZWZpeGVzKSwgYnV0IHJhdGhlclxuICAgKiB0aGFuIGtlYmFiLWNhc2UgcHJvcGVydGllcywgYWxsIHByb3BlcnRpZXMgYXJlIHRoZWlyIENhcGl0YWxpemVkIHZhcmlhbnRcbiAgICpcbiAgICogYGBganNcbiAgICogTW9kZXJuaXpyLl9kb21QcmVmaXhlcyA9PT0gWyBcIk1velwiLCBcIk9cIiwgXCJtc1wiLCBcIldlYmtpdFwiIF07XG4gICAqIGBgYFxuICAgKi9cblxuICB2YXIgZG9tUHJlZml4ZXMgPSAoTW9kZXJuaXpyUHJvdG8uX2NvbmZpZy51c2VQcmVmaXhlcyA/IG9tUHJlZml4ZXMudG9Mb3dlckNhc2UoKS5zcGxpdCgnICcpIDogW10pO1xuICBNb2Rlcm5penJQcm90by5fZG9tUHJlZml4ZXMgPSBkb21QcmVmaXhlcztcblxuXG5cbiAgLyoqXG4gICAqIGNvbnRhaW5zIGNoZWNrcyB0byBzZWUgaWYgYSBzdHJpbmcgY29udGFpbnMgYW5vdGhlciBzdHJpbmdcbiAgICpcbiAgICogQGFjY2VzcyBwcml2YXRlXG4gICAqIEBmdW5jdGlvbiBjb250YWluc1xuICAgKiBAcGFyYW0ge3N0cmluZ30gc3RyIC0gVGhlIHN0cmluZyB3ZSB3YW50IHRvIGNoZWNrIGZvciBzdWJzdHJpbmdzXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzdWJzdHIgLSBUaGUgc3Vic3RyaW5nIHdlIHdhbnQgdG8gc2VhcmNoIHRoZSBmaXJzdCBzdHJpbmcgZm9yXG4gICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgKi9cblxuICBmdW5jdGlvbiBjb250YWlucyhzdHIsIHN1YnN0cikge1xuICAgIHJldHVybiAhIX4oJycgKyBzdHIpLmluZGV4T2Yoc3Vic3RyKTtcbiAgfVxuXG4gIDtcblxuICAvKipcbiAgICogY3NzVG9ET00gdGFrZXMgYSBrZWJhYi1jYXNlIHN0cmluZyBhbmQgY29udmVydHMgaXQgdG8gY2FtZWxDYXNlXG4gICAqIGUuZy4gYm94LXNpemluZyAtPiBib3hTaXppbmdcbiAgICpcbiAgICogQGFjY2VzcyBwcml2YXRlXG4gICAqIEBmdW5jdGlvbiBjc3NUb0RPTVxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSAtIFN0cmluZyBuYW1lIG9mIGtlYmFiLWNhc2UgcHJvcCB3ZSB3YW50IHRvIGNvbnZlcnRcbiAgICogQHJldHVybnMge3N0cmluZ30gVGhlIGNhbWVsQ2FzZSB2ZXJzaW9uIG9mIHRoZSBzdXBwbGllZCBuYW1lXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGNzc1RvRE9NKG5hbWUpIHtcbiAgICByZXR1cm4gbmFtZS5yZXBsYWNlKC8oW2Etel0pLShbYS16XSkvZywgZnVuY3Rpb24oc3RyLCBtMSwgbTIpIHtcbiAgICAgIHJldHVybiBtMSArIG0yLnRvVXBwZXJDYXNlKCk7XG4gICAgfSkucmVwbGFjZSgvXi0vLCAnJyk7XG4gIH1cbiAgO1xuXG4gIC8qKlxuICAgKiBmbkJpbmQgaXMgYSBzdXBlciBzbWFsbCBbYmluZF0oaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvRnVuY3Rpb24vYmluZCkgcG9seWZpbGwuXG4gICAqXG4gICAqIEBhY2Nlc3MgcHJpdmF0ZVxuICAgKiBAZnVuY3Rpb24gZm5CaW5kXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb259IGZuIC0gYSBmdW5jdGlvbiB5b3Ugd2FudCB0byBjaGFuZ2UgYHRoaXNgIHJlZmVyZW5jZSB0b1xuICAgKiBAcGFyYW0ge29iamVjdH0gdGhhdCAtIHRoZSBgdGhpc2AgeW91IHdhbnQgdG8gY2FsbCB0aGUgZnVuY3Rpb24gd2l0aFxuICAgKiBAcmV0dXJucyB7ZnVuY3Rpb259IFRoZSB3cmFwcGVkIHZlcnNpb24gb2YgdGhlIHN1cHBsaWVkIGZ1bmN0aW9uXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGZuQmluZChmbiwgdGhhdCkge1xuICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBmbi5hcHBseSh0aGF0LCBhcmd1bWVudHMpO1xuICAgIH07XG4gIH1cblxuICA7XG5cbiAgLyoqXG4gICAqIHRlc3RET01Qcm9wcyBpcyBhIGdlbmVyaWMgRE9NIHByb3BlcnR5IHRlc3Q7IGlmIGEgYnJvd3NlciBzdXBwb3J0c1xuICAgKiAgIGEgY2VydGFpbiBwcm9wZXJ0eSwgaXQgd29uJ3QgcmV0dXJuIHVuZGVmaW5lZCBmb3IgaXQuXG4gICAqXG4gICAqIEBhY2Nlc3MgcHJpdmF0ZVxuICAgKiBAZnVuY3Rpb24gdGVzdERPTVByb3BzXG4gICAqIEBwYXJhbSB7YXJyYXkuPHN0cmluZz59IHByb3BzIC0gQW4gYXJyYXkgb2YgcHJvcGVydGllcyB0byB0ZXN0IGZvclxuICAgKiBAcGFyYW0ge29iamVjdH0gb2JqIC0gQW4gb2JqZWN0IG9yIEVsZW1lbnQgeW91IHdhbnQgdG8gdXNlIHRvIHRlc3QgdGhlIHBhcmFtZXRlcnMgYWdhaW5cbiAgICogQHBhcmFtIHtib29sZWFufG9iamVjdH0gZWxlbSAtIEFuIEVsZW1lbnQgdG8gYmluZCB0aGUgcHJvcGVydHkgbG9va3VwIGFnYWluLiBVc2UgYGZhbHNlYCB0byBwcmV2ZW50IHRoZSBjaGVja1xuICAgKi9cbiAgZnVuY3Rpb24gdGVzdERPTVByb3BzKHByb3BzLCBvYmosIGVsZW0pIHtcbiAgICB2YXIgaXRlbTtcblxuICAgIGZvciAodmFyIGkgaW4gcHJvcHMpIHtcbiAgICAgIGlmIChwcm9wc1tpXSBpbiBvYmopIHtcblxuICAgICAgICAvLyByZXR1cm4gdGhlIHByb3BlcnR5IG5hbWUgYXMgYSBzdHJpbmdcbiAgICAgICAgaWYgKGVsZW0gPT09IGZhbHNlKSB7XG4gICAgICAgICAgcmV0dXJuIHByb3BzW2ldO1xuICAgICAgICB9XG5cbiAgICAgICAgaXRlbSA9IG9ialtwcm9wc1tpXV07XG5cbiAgICAgICAgLy8gbGV0J3MgYmluZCBhIGZ1bmN0aW9uXG4gICAgICAgIGlmIChpcyhpdGVtLCAnZnVuY3Rpb24nKSkge1xuICAgICAgICAgIC8vIGJpbmQgdG8gb2JqIHVubGVzcyBvdmVycmlkZW5cbiAgICAgICAgICByZXR1cm4gZm5CaW5kKGl0ZW0sIGVsZW0gfHwgb2JqKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHJldHVybiB0aGUgdW5ib3VuZCBmdW5jdGlvbiBvciBvYmogb3IgdmFsdWVcbiAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIDtcblxuICAvKipcbiAgICogQ3JlYXRlIG91ciBcIm1vZGVybml6clwiIGVsZW1lbnQgdGhhdCB3ZSBkbyBtb3N0IGZlYXR1cmUgdGVzdHMgb24uXG4gICAqXG4gICAqIEBhY2Nlc3MgcHJpdmF0ZVxuICAgKi9cblxuICB2YXIgbW9kRWxlbSA9IHtcbiAgICBlbGVtOiBjcmVhdGVFbGVtZW50KCdtb2Rlcm5penInKVxuICB9O1xuXG4gIC8vIENsZWFuIHVwIHRoaXMgZWxlbWVudFxuICBNb2Rlcm5penIuX3EucHVzaChmdW5jdGlvbigpIHtcbiAgICBkZWxldGUgbW9kRWxlbS5lbGVtO1xuICB9KTtcblxuXG5cbiAgdmFyIG1TdHlsZSA9IHtcbiAgICBzdHlsZTogbW9kRWxlbS5lbGVtLnN0eWxlXG4gIH07XG5cbiAgLy8ga2lsbCByZWYgZm9yIGdjLCBtdXN0IGhhcHBlbiBiZWZvcmUgbW9kLmVsZW0gaXMgcmVtb3ZlZCwgc28gd2UgdW5zaGlmdCBvbiB0b1xuICAvLyB0aGUgZnJvbnQgb2YgdGhlIHF1ZXVlLlxuICBNb2Rlcm5penIuX3EudW5zaGlmdChmdW5jdGlvbigpIHtcbiAgICBkZWxldGUgbVN0eWxlLnN0eWxlO1xuICB9KTtcblxuXG5cbiAgLyoqXG4gICAqIGRvbVRvQ1NTIHRha2VzIGEgY2FtZWxDYXNlIHN0cmluZyBhbmQgY29udmVydHMgaXQgdG8ga2ViYWItY2FzZVxuICAgKiBlLmcuIGJveFNpemluZyAtPiBib3gtc2l6aW5nXG4gICAqXG4gICAqIEBhY2Nlc3MgcHJpdmF0ZVxuICAgKiBAZnVuY3Rpb24gZG9tVG9DU1NcbiAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgLSBTdHJpbmcgbmFtZSBvZiBjYW1lbENhc2UgcHJvcCB3ZSB3YW50IHRvIGNvbnZlcnRcbiAgICogQHJldHVybnMge3N0cmluZ30gVGhlIGtlYmFiLWNhc2UgdmVyc2lvbiBvZiB0aGUgc3VwcGxpZWQgbmFtZVxuICAgKi9cblxuICBmdW5jdGlvbiBkb21Ub0NTUyhuYW1lKSB7XG4gICAgcmV0dXJuIG5hbWUucmVwbGFjZSgvKFtBLVpdKS9nLCBmdW5jdGlvbihzdHIsIG0xKSB7XG4gICAgICByZXR1cm4gJy0nICsgbTEudG9Mb3dlckNhc2UoKTtcbiAgICB9KS5yZXBsYWNlKC9ebXMtLywgJy1tcy0nKTtcbiAgfVxuICA7XG5cbiAgLyoqXG4gICAqIG5hdGl2ZVRlc3RQcm9wcyBhbGxvd3MgZm9yIHVzIHRvIHVzZSBuYXRpdmUgZmVhdHVyZSBkZXRlY3Rpb24gZnVuY3Rpb25hbGl0eSBpZiBhdmFpbGFibGUuXG4gICAqIHNvbWUgcHJlZml4ZWQgZm9ybSwgb3IgZmFsc2UsIGluIHRoZSBjYXNlIG9mIGFuIHVuc3VwcG9ydGVkIHJ1bGVcbiAgICpcbiAgICogQGFjY2VzcyBwcml2YXRlXG4gICAqIEBmdW5jdGlvbiBuYXRpdmVUZXN0UHJvcHNcbiAgICogQHBhcmFtIHthcnJheX0gcHJvcHMgLSBBbiBhcnJheSBvZiBwcm9wZXJ0eSBuYW1lc1xuICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUgLSBBIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIHZhbHVlIHdlIHdhbnQgdG8gY2hlY2sgdmlhIEBzdXBwb3J0c1xuICAgKiBAcmV0dXJucyB7Ym9vbGVhbnx1bmRlZmluZWR9IEEgYm9vbGVhbiB3aGVuIEBzdXBwb3J0cyBleGlzdHMsIHVuZGVmaW5lZCBvdGhlcndpc2VcbiAgICovXG5cbiAgLy8gQWNjZXB0cyBhIGxpc3Qgb2YgcHJvcGVydHkgbmFtZXMgYW5kIGEgc2luZ2xlIHZhbHVlXG4gIC8vIFJldHVybnMgYHVuZGVmaW5lZGAgaWYgbmF0aXZlIGRldGVjdGlvbiBub3QgYXZhaWxhYmxlXG4gIGZ1bmN0aW9uIG5hdGl2ZVRlc3RQcm9wcyhwcm9wcywgdmFsdWUpIHtcbiAgICB2YXIgaSA9IHByb3BzLmxlbmd0aDtcbiAgICAvLyBTdGFydCB3aXRoIHRoZSBKUyBBUEk6IGh0dHA6Ly93d3cudzMub3JnL1RSL2NzczMtY29uZGl0aW9uYWwvI3RoZS1jc3MtaW50ZXJmYWNlXG4gICAgaWYgKCdDU1MnIGluIHdpbmRvdyAmJiAnc3VwcG9ydHMnIGluIHdpbmRvdy5DU1MpIHtcbiAgICAgIC8vIFRyeSBldmVyeSBwcmVmaXhlZCB2YXJpYW50IG9mIHRoZSBwcm9wZXJ0eVxuICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICBpZiAod2luZG93LkNTUy5zdXBwb3J0cyhkb21Ub0NTUyhwcm9wc1tpXSksIHZhbHVlKSkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8vIE90aGVyd2lzZSBmYWxsIGJhY2sgdG8gYXQtcnVsZSAoZm9yIE9wZXJhIDEyLngpXG4gICAgZWxzZSBpZiAoJ0NTU1N1cHBvcnRzUnVsZScgaW4gd2luZG93KSB7XG4gICAgICAvLyBCdWlsZCBhIGNvbmRpdGlvbiBzdHJpbmcgZm9yIGV2ZXJ5IHByZWZpeGVkIHZhcmlhbnRcbiAgICAgIHZhciBjb25kaXRpb25UZXh0ID0gW107XG4gICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGNvbmRpdGlvblRleHQucHVzaCgnKCcgKyBkb21Ub0NTUyhwcm9wc1tpXSkgKyAnOicgKyB2YWx1ZSArICcpJyk7XG4gICAgICB9XG4gICAgICBjb25kaXRpb25UZXh0ID0gY29uZGl0aW9uVGV4dC5qb2luKCcgb3IgJyk7XG4gICAgICByZXR1cm4gaW5qZWN0RWxlbWVudFdpdGhTdHlsZXMoJ0BzdXBwb3J0cyAoJyArIGNvbmRpdGlvblRleHQgKyAnKSB7ICNtb2Rlcm5penIgeyBwb3NpdGlvbjogYWJzb2x1dGU7IH0gfScsIGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgcmV0dXJuIGdldENvbXB1dGVkU3R5bGUobm9kZSwgbnVsbCkucG9zaXRpb24gPT0gJ2Fic29sdXRlJztcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG4gIDtcblxuICAvLyB0ZXN0UHJvcHMgaXMgYSBnZW5lcmljIENTUyAvIERPTSBwcm9wZXJ0eSB0ZXN0LlxuXG4gIC8vIEluIHRlc3Rpbmcgc3VwcG9ydCBmb3IgYSBnaXZlbiBDU1MgcHJvcGVydHksIGl0J3MgbGVnaXQgdG8gdGVzdDpcbiAgLy8gICAgYGVsZW0uc3R5bGVbc3R5bGVOYW1lXSAhPT0gdW5kZWZpbmVkYFxuICAvLyBJZiB0aGUgcHJvcGVydHkgaXMgc3VwcG9ydGVkIGl0IHdpbGwgcmV0dXJuIGFuIGVtcHR5IHN0cmluZyxcbiAgLy8gaWYgdW5zdXBwb3J0ZWQgaXQgd2lsbCByZXR1cm4gdW5kZWZpbmVkLlxuXG4gIC8vIFdlJ2xsIHRha2UgYWR2YW50YWdlIG9mIHRoaXMgcXVpY2sgdGVzdCBhbmQgc2tpcCBzZXR0aW5nIGEgc3R5bGVcbiAgLy8gb24gb3VyIG1vZGVybml6ciBlbGVtZW50LCBidXQgaW5zdGVhZCBqdXN0IHRlc3RpbmcgdW5kZWZpbmVkIHZzXG4gIC8vIGVtcHR5IHN0cmluZy5cblxuICAvLyBQcm9wZXJ0eSBuYW1lcyBjYW4gYmUgcHJvdmlkZWQgaW4gZWl0aGVyIGNhbWVsQ2FzZSBvciBrZWJhYi1jYXNlLlxuXG4gIGZ1bmN0aW9uIHRlc3RQcm9wcyhwcm9wcywgcHJlZml4ZWQsIHZhbHVlLCBza2lwVmFsdWVUZXN0KSB7XG4gICAgc2tpcFZhbHVlVGVzdCA9IGlzKHNraXBWYWx1ZVRlc3QsICd1bmRlZmluZWQnKSA/IGZhbHNlIDogc2tpcFZhbHVlVGVzdDtcblxuICAgIC8vIFRyeSBuYXRpdmUgZGV0ZWN0IGZpcnN0XG4gICAgaWYgKCFpcyh2YWx1ZSwgJ3VuZGVmaW5lZCcpKSB7XG4gICAgICB2YXIgcmVzdWx0ID0gbmF0aXZlVGVzdFByb3BzKHByb3BzLCB2YWx1ZSk7XG4gICAgICBpZiAoIWlzKHJlc3VsdCwgJ3VuZGVmaW5lZCcpKSB7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gT3RoZXJ3aXNlIGRvIGl0IHByb3Blcmx5XG4gICAgdmFyIGFmdGVySW5pdCwgaSwgcHJvcHNMZW5ndGgsIHByb3AsIGJlZm9yZTtcblxuICAgIC8vIElmIHdlIGRvbid0IGhhdmUgYSBzdHlsZSBlbGVtZW50LCB0aGF0IG1lYW5zIHdlJ3JlIHJ1bm5pbmcgYXN5bmMgb3IgYWZ0ZXJcbiAgICAvLyB0aGUgY29yZSB0ZXN0cywgc28gd2UnbGwgbmVlZCB0byBjcmVhdGUgb3VyIG93biBlbGVtZW50cyB0byB1c2VcblxuICAgIC8vIGluc2lkZSBvZiBhbiBTVkcgZWxlbWVudCwgaW4gY2VydGFpbiBicm93c2VycywgdGhlIGBzdHlsZWAgZWxlbWVudCBpcyBvbmx5XG4gICAgLy8gZGVmaW5lZCBmb3IgdmFsaWQgdGFncy4gVGhlcmVmb3JlLCBpZiBgbW9kZXJuaXpyYCBkb2VzIG5vdCBoYXZlIG9uZSwgd2VcbiAgICAvLyBmYWxsIGJhY2sgdG8gYSBsZXNzIHVzZWQgZWxlbWVudCBhbmQgaG9wZSBmb3IgdGhlIGJlc3QuXG4gICAgdmFyIGVsZW1zID0gWydtb2Rlcm5penInLCAndHNwYW4nXTtcbiAgICB3aGlsZSAoIW1TdHlsZS5zdHlsZSkge1xuICAgICAgYWZ0ZXJJbml0ID0gdHJ1ZTtcbiAgICAgIG1TdHlsZS5tb2RFbGVtID0gY3JlYXRlRWxlbWVudChlbGVtcy5zaGlmdCgpKTtcbiAgICAgIG1TdHlsZS5zdHlsZSA9IG1TdHlsZS5tb2RFbGVtLnN0eWxlO1xuICAgIH1cblxuICAgIC8vIERlbGV0ZSB0aGUgb2JqZWN0cyBpZiB3ZSBjcmVhdGVkIHRoZW0uXG4gICAgZnVuY3Rpb24gY2xlYW5FbGVtcygpIHtcbiAgICAgIGlmIChhZnRlckluaXQpIHtcbiAgICAgICAgZGVsZXRlIG1TdHlsZS5zdHlsZTtcbiAgICAgICAgZGVsZXRlIG1TdHlsZS5tb2RFbGVtO1xuICAgICAgfVxuICAgIH1cblxuICAgIHByb3BzTGVuZ3RoID0gcHJvcHMubGVuZ3RoO1xuICAgIGZvciAoaSA9IDA7IGkgPCBwcm9wc0xlbmd0aDsgaSsrKSB7XG4gICAgICBwcm9wID0gcHJvcHNbaV07XG4gICAgICBiZWZvcmUgPSBtU3R5bGUuc3R5bGVbcHJvcF07XG5cbiAgICAgIGlmIChjb250YWlucyhwcm9wLCAnLScpKSB7XG4gICAgICAgIHByb3AgPSBjc3NUb0RPTShwcm9wKTtcbiAgICAgIH1cblxuICAgICAgaWYgKG1TdHlsZS5zdHlsZVtwcm9wXSAhPT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgLy8gSWYgdmFsdWUgdG8gdGVzdCBoYXMgYmVlbiBwYXNzZWQgaW4sIGRvIGEgc2V0LWFuZC1jaGVjayB0ZXN0LlxuICAgICAgICAvLyAwIChpbnRlZ2VyKSBpcyBhIHZhbGlkIHByb3BlcnR5IHZhbHVlLCBzbyBjaGVjayB0aGF0IGB2YWx1ZWAgaXNuJ3RcbiAgICAgICAgLy8gdW5kZWZpbmVkLCByYXRoZXIgdGhhbiBqdXN0IGNoZWNraW5nIGl0J3MgdHJ1dGh5LlxuICAgICAgICBpZiAoIXNraXBWYWx1ZVRlc3QgJiYgIWlzKHZhbHVlLCAndW5kZWZpbmVkJykpIHtcblxuICAgICAgICAgIC8vIE5lZWRzIGEgdHJ5IGNhdGNoIGJsb2NrIGJlY2F1c2Ugb2Ygb2xkIElFLiBUaGlzIGlzIHNsb3csIGJ1dCB3aWxsXG4gICAgICAgICAgLy8gYmUgYXZvaWRlZCBpbiBtb3N0IGNhc2VzIGJlY2F1c2UgYHNraXBWYWx1ZVRlc3RgIHdpbGwgYmUgdXNlZC5cbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgbVN0eWxlLnN0eWxlW3Byb3BdID0gdmFsdWU7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge31cblxuICAgICAgICAgIC8vIElmIHRoZSBwcm9wZXJ0eSB2YWx1ZSBoYXMgY2hhbmdlZCwgd2UgYXNzdW1lIHRoZSB2YWx1ZSB1c2VkIGlzXG4gICAgICAgICAgLy8gc3VwcG9ydGVkLiBJZiBgdmFsdWVgIGlzIGVtcHR5IHN0cmluZywgaXQnbGwgZmFpbCBoZXJlIChiZWNhdXNlXG4gICAgICAgICAgLy8gaXQgaGFzbid0IGNoYW5nZWQpLCB3aGljaCBtYXRjaGVzIGhvdyBicm93c2VycyBoYXZlIGltcGxlbWVudGVkXG4gICAgICAgICAgLy8gQ1NTLnN1cHBvcnRzKClcbiAgICAgICAgICBpZiAobVN0eWxlLnN0eWxlW3Byb3BdICE9IGJlZm9yZSkge1xuICAgICAgICAgICAgY2xlYW5FbGVtcygpO1xuICAgICAgICAgICAgcmV0dXJuIHByZWZpeGVkID09ICdwZngnID8gcHJvcCA6IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIE90aGVyd2lzZSBqdXN0IHJldHVybiB0cnVlLCBvciB0aGUgcHJvcGVydHkgbmFtZSBpZiB0aGlzIGlzIGFcbiAgICAgICAgLy8gYHByZWZpeGVkKClgIGNhbGxcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgY2xlYW5FbGVtcygpO1xuICAgICAgICAgIHJldHVybiBwcmVmaXhlZCA9PSAncGZ4JyA/IHByb3AgOiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGNsZWFuRWxlbXMoKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICA7XG5cbiAgLyoqXG4gICAqIHRlc3RQcm9wc0FsbCB0ZXN0cyBhIGxpc3Qgb2YgRE9NIHByb3BlcnRpZXMgd2Ugd2FudCB0byBjaGVjayBhZ2FpbnN0LlxuICAgKiBXZSBzcGVjaWZ5IGxpdGVyYWxseSBBTEwgcG9zc2libGUgKGtub3duIGFuZC9vciBsaWtlbHkpIHByb3BlcnRpZXMgb25cbiAgICogdGhlIGVsZW1lbnQgaW5jbHVkaW5nIHRoZSBub24tdmVuZG9yIHByZWZpeGVkIG9uZSwgZm9yIGZvcndhcmQtXG4gICAqIGNvbXBhdGliaWxpdHkuXG4gICAqXG4gICAqIEBhY2Nlc3MgcHJpdmF0ZVxuICAgKiBAZnVuY3Rpb24gdGVzdFByb3BzQWxsXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBwcm9wIC0gQSBzdHJpbmcgb2YgdGhlIHByb3BlcnR5IHRvIHRlc3QgZm9yXG4gICAqIEBwYXJhbSB7c3RyaW5nfG9iamVjdH0gW3ByZWZpeGVkXSAtIEFuIG9iamVjdCB0byBjaGVjayB0aGUgcHJlZml4ZWQgcHJvcGVydGllcyBvbi4gVXNlIGEgc3RyaW5nIHRvIHNraXBcbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudHxTVkdFbGVtZW50fSBbZWxlbV0gLSBBbiBlbGVtZW50IHVzZWQgdG8gdGVzdCB0aGUgcHJvcGVydHkgYW5kIHZhbHVlIGFnYWluc3RcbiAgICogQHBhcmFtIHtzdHJpbmd9IFt2YWx1ZV0gLSBBIHN0cmluZyBvZiBhIGNzcyB2YWx1ZVxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtza2lwVmFsdWVUZXN0XSAtIEFuIGJvb2xlYW4gcmVwcmVzZW50aW5nIGlmIHlvdSB3YW50IHRvIHRlc3QgaWYgdmFsdWUgc3RpY2tzIHdoZW4gc2V0XG4gICAqL1xuICBmdW5jdGlvbiB0ZXN0UHJvcHNBbGwocHJvcCwgcHJlZml4ZWQsIGVsZW0sIHZhbHVlLCBza2lwVmFsdWVUZXN0KSB7XG5cbiAgICB2YXIgdWNQcm9wID0gcHJvcC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHByb3Auc2xpY2UoMSksXG4gICAgcHJvcHMgPSAocHJvcCArICcgJyArIGNzc29tUHJlZml4ZXMuam9pbih1Y1Byb3AgKyAnICcpICsgdWNQcm9wKS5zcGxpdCgnICcpO1xuXG4gICAgLy8gZGlkIHRoZXkgY2FsbCAucHJlZml4ZWQoJ2JveFNpemluZycpIG9yIGFyZSB3ZSBqdXN0IHRlc3RpbmcgYSBwcm9wP1xuICAgIGlmIChpcyhwcmVmaXhlZCwgJ3N0cmluZycpIHx8IGlzKHByZWZpeGVkLCAndW5kZWZpbmVkJykpIHtcbiAgICAgIHJldHVybiB0ZXN0UHJvcHMocHJvcHMsIHByZWZpeGVkLCB2YWx1ZSwgc2tpcFZhbHVlVGVzdCk7XG5cbiAgICAgIC8vIG90aGVyd2lzZSwgdGhleSBjYWxsZWQgLnByZWZpeGVkKCdyZXF1ZXN0QW5pbWF0aW9uRnJhbWUnLCB3aW5kb3dbLCBlbGVtXSlcbiAgICB9IGVsc2Uge1xuICAgICAgcHJvcHMgPSAocHJvcCArICcgJyArIChkb21QcmVmaXhlcykuam9pbih1Y1Byb3AgKyAnICcpICsgdWNQcm9wKS5zcGxpdCgnICcpO1xuICAgICAgcmV0dXJuIHRlc3RET01Qcm9wcyhwcm9wcywgcHJlZml4ZWQsIGVsZW0pO1xuICAgIH1cbiAgfVxuXG4gIC8vIE1vZGVybml6ci50ZXN0QWxsUHJvcHMoKSBpbnZlc3RpZ2F0ZXMgd2hldGhlciBhIGdpdmVuIHN0eWxlIHByb3BlcnR5LFxuICAvLyBvciBhbnkgb2YgaXRzIHZlbmRvci1wcmVmaXhlZCB2YXJpYW50cywgaXMgcmVjb2duaXplZFxuICAvL1xuICAvLyBOb3RlIHRoYXQgdGhlIHByb3BlcnR5IG5hbWVzIG11c3QgYmUgcHJvdmlkZWQgaW4gdGhlIGNhbWVsQ2FzZSB2YXJpYW50LlxuICAvLyBNb2Rlcm5penIudGVzdEFsbFByb3BzKCdib3hTaXppbmcnKVxuICBNb2Rlcm5penJQcm90by50ZXN0QWxsUHJvcHMgPSB0ZXN0UHJvcHNBbGw7XG5cblxuXG4gIC8qKlxuICAgKiB0ZXN0QWxsUHJvcHMgZGV0ZXJtaW5lcyB3aGV0aGVyIGEgZ2l2ZW4gQ1NTIHByb3BlcnR5IGlzIHN1cHBvcnRlZCBpbiB0aGUgYnJvd3NlclxuICAgKlxuICAgKiBAbWVtYmVyb2YgTW9kZXJuaXpyXG4gICAqIEBuYW1lIE1vZGVybml6ci50ZXN0QWxsUHJvcHNcbiAgICogQG9wdGlvbk5hbWUgTW9kZXJuaXpyLnRlc3RBbGxQcm9wcygpXG4gICAqIEBvcHRpb25Qcm9wIHRlc3RBbGxQcm9wc1xuICAgKiBAYWNjZXNzIHB1YmxpY1xuICAgKiBAZnVuY3Rpb24gdGVzdEFsbFByb3BzXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBwcm9wIC0gU3RyaW5nIG5hbWluZyB0aGUgcHJvcGVydHkgdG8gdGVzdCAoZWl0aGVyIGNhbWVsQ2FzZSBvciBrZWJhYi1jYXNlKVxuICAgKiBAcGFyYW0ge3N0cmluZ30gW3ZhbHVlXSAtIFN0cmluZyBvZiB0aGUgdmFsdWUgdG8gdGVzdFxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtza2lwVmFsdWVUZXN0PWZhbHNlXSAtIFdoZXRoZXIgdG8gc2tpcCB0ZXN0aW5nIHRoYXQgdGhlIHZhbHVlIGlzIHN1cHBvcnRlZCB3aGVuIHVzaW5nIG5vbi1uYXRpdmUgZGV0ZWN0aW9uXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIHRlc3RBbGxQcm9wcyBkZXRlcm1pbmVzIHdoZXRoZXIgYSBnaXZlbiBDU1MgcHJvcGVydHksIGluIHNvbWUgcHJlZml4ZWQgZm9ybSxcbiAgICogaXMgc3VwcG9ydGVkIGJ5IHRoZSBicm93c2VyLlxuICAgKlxuICAgKiBgYGBqc1xuICAgKiB0ZXN0QWxsUHJvcHMoJ2JveFNpemluZycpICAvLyB0cnVlXG4gICAqIGBgYFxuICAgKlxuICAgKiBJdCBjYW4gb3B0aW9uYWxseSBiZSBnaXZlbiBhIENTUyB2YWx1ZSBpbiBzdHJpbmcgZm9ybSB0byB0ZXN0IGlmIGEgcHJvcGVydHlcbiAgICogdmFsdWUgaXMgdmFsaWRcbiAgICpcbiAgICogYGBganNcbiAgICogdGVzdEFsbFByb3BzKCdkaXNwbGF5JywgJ2Jsb2NrJykgLy8gdHJ1ZVxuICAgKiB0ZXN0QWxsUHJvcHMoJ2Rpc3BsYXknLCAncGVuZ3VpbicpIC8vIGZhbHNlXG4gICAqIGBgYFxuICAgKlxuICAgKiBBIGJvb2xlYW4gY2FuIGJlIHBhc3NlZCBhcyBhIHRoaXJkIHBhcmFtZXRlciB0byBza2lwIHRoZSB2YWx1ZSBjaGVjayB3aGVuXG4gICAqIG5hdGl2ZSBkZXRlY3Rpb24gKEBzdXBwb3J0cykgaXNuJ3QgYXZhaWxhYmxlLlxuICAgKlxuICAgKiBgYGBqc1xuICAgKiB0ZXN0QWxsUHJvcHMoJ3NoYXBlT3V0c2lkZScsICdjb250ZW50LWJveCcsIHRydWUpO1xuICAgKiBgYGBcbiAgICovXG5cbiAgZnVuY3Rpb24gdGVzdEFsbFByb3BzKHByb3AsIHZhbHVlLCBza2lwVmFsdWVUZXN0KSB7XG4gICAgcmV0dXJuIHRlc3RQcm9wc0FsbChwcm9wLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdmFsdWUsIHNraXBWYWx1ZVRlc3QpO1xuICB9XG4gIE1vZGVybml6clByb3RvLnRlc3RBbGxQcm9wcyA9IHRlc3RBbGxQcm9wcztcblxuLyohXG57XG4gIFwibmFtZVwiOiBcIkNTUyBBbmltYXRpb25zXCIsXG4gIFwicHJvcGVydHlcIjogXCJjc3NhbmltYXRpb25zXCIsXG4gIFwiY2FuaXVzZVwiOiBcImNzcy1hbmltYXRpb25cIixcbiAgXCJwb2x5ZmlsbHNcIjogW1widHJhbnNmb3JtaWVcIiwgXCJjc3NzYW5kcGFwZXJcIl0sXG4gIFwidGFnc1wiOiBbXCJjc3NcIl0sXG4gIFwid2FybmluZ3NcIjogW1wiQW5kcm9pZCA8IDQgd2lsbCBwYXNzIHRoaXMgdGVzdCwgYnV0IGNhbiBvbmx5IGFuaW1hdGUgYSBzaW5nbGUgcHJvcGVydHkgYXQgYSB0aW1lXCJdLFxuICBcIm5vdGVzXCI6IFt7XG4gICAgXCJuYW1lXCIgOiBcIkFydGljbGU6ICdEaXNwZWxsaW5nIHRoZSBBbmRyb2lkIENTUyBhbmltYXRpb24gbXl0aHMnXCIsXG4gICAgXCJocmVmXCI6IFwiaHR0cHM6Ly9nb28uZ2wvT0d3NUdtXCJcbiAgfV1cbn1cbiEqL1xuLyogRE9DXG5EZXRlY3RzIHdoZXRoZXIgb3Igbm90IGVsZW1lbnRzIGNhbiBiZSBhbmltYXRlZCB1c2luZyBDU1NcbiovXG5cbiAgTW9kZXJuaXpyLmFkZFRlc3QoJ2Nzc2FuaW1hdGlvbnMnLCB0ZXN0QWxsUHJvcHMoJ2FuaW1hdGlvbk5hbWUnLCAnYScsIHRydWUpKTtcblxuLyohXG57XG4gIFwibmFtZVwiOiBcIkNTUyBUcmFuc2Zvcm1zIDNEXCIsXG4gIFwicHJvcGVydHlcIjogXCJjc3N0cmFuc2Zvcm1zM2RcIixcbiAgXCJjYW5pdXNlXCI6IFwidHJhbnNmb3JtczNkXCIsXG4gIFwidGFnc1wiOiBbXCJjc3NcIl0sXG4gIFwid2FybmluZ3NcIjogW1xuICAgIFwiQ2hyb21lIG1heSBvY2Nhc3Npb25hbGx5IGZhaWwgdGhpcyB0ZXN0IG9uIHNvbWUgc3lzdGVtczsgbW9yZSBpbmZvOiBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9MTI5MDA0XCJcbiAgXVxufVxuISovXG5cbiAgTW9kZXJuaXpyLmFkZFRlc3QoJ2Nzc3RyYW5zZm9ybXMzZCcsIGZ1bmN0aW9uKCkge1xuICAgIHZhciByZXQgPSAhIXRlc3RBbGxQcm9wcygncGVyc3BlY3RpdmUnLCAnMXB4JywgdHJ1ZSk7XG4gICAgdmFyIHVzZVByZWZpeCA9IE1vZGVybml6ci5fY29uZmlnLnVzZVByZWZpeGVzO1xuXG4gICAgLy8gV2Via2l0J3MgM0QgdHJhbnNmb3JtcyBhcmUgcGFzc2VkIG9mZiB0byB0aGUgYnJvd3NlcidzIG93biBncmFwaGljcyByZW5kZXJlci5cbiAgICAvLyAgIEl0IHdvcmtzIGZpbmUgaW4gU2FmYXJpIG9uIExlb3BhcmQgYW5kIFNub3cgTGVvcGFyZCwgYnV0IG5vdCBpbiBDaHJvbWUgaW5cbiAgICAvLyAgIHNvbWUgY29uZGl0aW9ucy4gQXMgYSByZXN1bHQsIFdlYmtpdCB0eXBpY2FsbHkgcmVjb2duaXplcyB0aGUgc3ludGF4IGJ1dFxuICAgIC8vICAgd2lsbCBzb21ldGltZXMgdGhyb3cgYSBmYWxzZSBwb3NpdGl2ZSwgdGh1cyB3ZSBtdXN0IGRvIGEgbW9yZSB0aG9yb3VnaCBjaGVjazpcbiAgICBpZiAocmV0ICYmICghdXNlUHJlZml4IHx8ICd3ZWJraXRQZXJzcGVjdGl2ZScgaW4gZG9jRWxlbWVudC5zdHlsZSkpIHtcbiAgICAgIHZhciBtcTtcbiAgICAgIHZhciBkZWZhdWx0U3R5bGUgPSAnI21vZGVybml6cnt3aWR0aDowO2hlaWdodDowfSc7XG4gICAgICAvLyBVc2UgQ1NTIENvbmRpdGlvbmFsIFJ1bGVzIGlmIGF2YWlsYWJsZVxuICAgICAgaWYgKE1vZGVybml6ci5zdXBwb3J0cykge1xuICAgICAgICBtcSA9ICdAc3VwcG9ydHMgKHBlcnNwZWN0aXZlOiAxcHgpJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIE90aGVyd2lzZSwgV2Via2l0IGFsbG93cyB0aGlzIG1lZGlhIHF1ZXJ5IHRvIHN1Y2NlZWQgb25seSBpZiB0aGUgZmVhdHVyZSBpcyBlbmFibGVkLlxuICAgICAgICAvLyBgQG1lZGlhICh0cmFuc2Zvcm0tM2QpLCgtd2Via2l0LXRyYW5zZm9ybS0zZCl7IC4uLiB9YFxuICAgICAgICBtcSA9ICdAbWVkaWEgKHRyYW5zZm9ybS0zZCknO1xuICAgICAgICBpZiAodXNlUHJlZml4KSB7XG4gICAgICAgICAgbXEgKz0gJywoLXdlYmtpdC10cmFuc2Zvcm0tM2QpJztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBtcSArPSAneyNtb2Rlcm5penJ7d2lkdGg6N3B4O2hlaWdodDoxOHB4O21hcmdpbjowO3BhZGRpbmc6MDtib3JkZXI6MH19JztcblxuICAgICAgdGVzdFN0eWxlcyhkZWZhdWx0U3R5bGUgKyBtcSwgZnVuY3Rpb24oZWxlbSkge1xuICAgICAgICByZXQgPSBlbGVtLm9mZnNldFdpZHRoID09PSA3ICYmIGVsZW0ub2Zmc2V0SGVpZ2h0ID09PSAxODtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiByZXQ7XG4gIH0pO1xuXG5cbiAgLy8gUnVuIGVhY2ggdGVzdFxuICB0ZXN0UnVubmVyKCk7XG5cbiAgLy8gUmVtb3ZlIHRoZSBcIm5vLWpzXCIgY2xhc3MgaWYgaXQgZXhpc3RzXG4gIHNldENsYXNzZXMoY2xhc3Nlcyk7XG5cbiAgZGVsZXRlIE1vZGVybml6clByb3RvLmFkZFRlc3Q7XG4gIGRlbGV0ZSBNb2Rlcm5penJQcm90by5hZGRBc3luY1Rlc3Q7XG5cbiAgLy8gUnVuIHRoZSB0aGluZ3MgdGhhdCBhcmUgc3VwcG9zZWQgdG8gcnVuIGFmdGVyIHRoZSB0ZXN0c1xuICBmb3IgKHZhciBpID0gMDsgaSA8IE1vZGVybml6ci5fcS5sZW5ndGg7IGkrKykge1xuICAgIE1vZGVybml6ci5fcVtpXSgpO1xuICB9XG5cbiAgLy8gTGVhayBNb2Rlcm5penIgbmFtZXNwYWNlXG4gIHdpbmRvdy5Nb2Rlcm5penIgPSBNb2Rlcm5penI7XG5cblxuO1xuXG59KSh3aW5kb3csIGRvY3VtZW50KTtcbiIsImltcG9ydCBzb25vIGZyb20gJ3Nvbm8nO1xuXG5jbGFzcyBYcCB7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcblxuICAgICAgICBjb25zb2xlLmxvZyhzb25vKTtcblxuXG5cbiAgICAgICAgdGhpcy5kcmF3ID0gdGhpcy5kcmF3LmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuZXZlbnRzID0gdGhpcy5ldmVudHMuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5jaGFuZ2VGdHQgPSB0aGlzLmNoYW5nZUZ0dC5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLnJlc2l6ZUhhbmRsZXIgPSB0aGlzLnJlc2l6ZUhhbmRsZXIuYmluZCh0aGlzKTtcblxuXG4gICAgICAgIHRoaXMuaW5pdCgpO1xuXG5cbiAgICB9XG5cbiAgICBpbml0KCkge1xuXG5cbiAgICAgICAgdGhpcy51aSA9IHtcbiAgICAgICAgICAgIG15QXVkaW86IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2F1ZGlvJyksXG4gICAgICAgICAgICBmcmVxdWVuY3lCOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZnJlcXVlbmN5IC5ibG9jaycpLFxuICAgICAgICAgICAgYW1wbGl0dWRlQjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFtcGxpdHVkZSAuYmxvY2snKSxcbiAgICAgICAgICAgIHdhdmVGb3JtQjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndhdmVGb3JtIC5ibG9jaycpLFxuICAgICAgICAgICAgcHRpY2hCOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGl0Y2ggLmJsb2NrJyksXG4gICAgICAgICAgICBmb3JtRnR0OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZnR0U2l6ZScpXG4gICAgICAgIH1cblxuICAgICAgICAvLyBOZXcgV2ViQXVkaW8gQVBJXG4gICAgICAgIHRoaXMuYXVkaW9DdHggPSBuZXcod2luZG93LkF1ZGlvQ29udGV4dCB8fCB3aW5kb3cud2Via2l0QXVkaW9Db250ZXh0KSgpO1xuXG4gICAgICAgIC8vICBDcmVhdGUgQW5hbHlzZXIgbm9kZVxuICAgICAgICB0aGlzLmFuYWx5c2VyID0gdGhpcy5hdWRpb0N0eC5jcmVhdGVBbmFseXNlcigpO1xuXG4gICAgICAgIC8vIENvbm5lY3Qgbm9kZXMgdG9nZXRoZXJcbiAgICAgICAgdmFyIHNvdXJjZSA9IHRoaXMuYXVkaW9DdHguY3JlYXRlTWVkaWFFbGVtZW50U291cmNlKHRoaXMudWkubXlBdWRpbyk7XG4gICAgICAgIHNvdXJjZS5jb25uZWN0KHRoaXMuYW5hbHlzZXIpO1xuICAgICAgICB0aGlzLmFuYWx5c2VyLmNvbm5lY3QodGhpcy5hdWRpb0N0eC5kZXN0aW5hdGlvbik7XG5cblxuICAgICAgICAvLyBTZXQgRm91cmllciB2YWx1ZVxuICAgICAgICB0aGlzLmFuYWx5c2VyLmZmdFNpemUgPSB0aGlzLnVpLmZvcm1GdHQudmFsdWU7XG4gICAgICAgIC8vIEdldCBmcmVxdWVuY3kgbGVuZ3RoICggZmZ0U2l6ZSAvIDIpXG4gICAgICAgIHRoaXMuYnVmZmVyTGVuZ3RoID0gdGhpcy5hbmFseXNlci5mcmVxdWVuY3lCaW5Db3VudDtcbiAgICAgICAgLy8gUHJlcGFyZSBhcnJheSBvZiBmcmVxdWVuY2llc1xuICAgICAgICB0aGlzLmRhdGFBcnJheSA9IG5ldyBVaW50OEFycmF5KHRoaXMuYnVmZmVyTGVuZ3RoKTtcblxuXG4gICAgICAgIHRoaXMuY2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhbnZhcycpO1xuICAgICAgICB0aGlzLmNhbnZhcy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xuICAgICAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSAzMDA7XG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuY2FudmFzLndpZHRoKTtcbiAgICAgICAgdGhpcy5jYW52YXNDdHggPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgICAgICB0aGlzLmNhbnZhc0N0eC5jbGVhclJlY3QoMCwgMCwgNTAwLCA1MDApO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuYnVmZmVyTGVuZ3RoKTtcblxuICAgICAgICB0aGlzLmV2ZW50cygpO1xuXG4gICAgICAgIHRoaXMuZHJhdygpO1xuXG5cbiAgICB9XG5cbiAgICBldmVudHMoKSB7XG5cbiAgICAgICAgdGhpcy51aS5mb3JtRnR0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHRoaXMuY2hhbmdlRnR0KTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMucmVzaXplSGFuZGxlcik7XG5cbiAgICB9XG5cbiAgICBjaGFuZ2VGdHQoZSkge1xuICAgICAgICAvLyBSZXNldCBmcmVxdWVuY2llcyBcbiAgICAgICAgdGhpcy5hbmFseXNlci5mZnRTaXplID0gdGhpcy51aS5mb3JtRnR0LnZhbHVlO1xuICAgICAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IHRoaXMuYW5hbHlzZXIuZnJlcXVlbmN5QmluQ291bnQ7XG4gICAgICAgIHRoaXMuZGF0YUFycmF5ID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5idWZmZXJMZW5ndGgpO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuYnVmZmVyTGVuZ3RoLCB0aGlzLmRhdGFBcnJheSk7XG4gICAgfVxuXG4gICAgcmVzaXplSGFuZGxlcigpIHtcbiAgICAgICAgdGhpcy5jYW52YXMud2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcbiAgICB9XG5cbiAgICBkcmF3KCkge1xuXG5cbiAgICAgICAgLy8gLmdldEJ5dGVGcmVxdWVuY3lEYXRhKCkgLS0+IEZvciBiYXIgZ3JhcGggdmlzdWFsaXNhdGlvbiAoYWJzY2lzc2UgPSBGcsOpcXVlbmNlIC8gb3Jkb25uw6llID0gaW50ZW5zaXTDqSlcbiAgICAgICAgLy8gLmdldEJ5dGVUaW1lRG9tYWluRGF0YSgpIC0tPiBGb3Igb3NjaWxsb3Njb3BlIHZpc3VhbGlzYXRpb24gXG4gICAgICAgIHRoaXMuYW5hbHlzZXIuZ2V0Qnl0ZUZyZXF1ZW5jeURhdGEodGhpcy5kYXRhQXJyYXkpO1xuXG4gICAgICAgIC8vIGNyZWF0ZSBiYWNrZ3JvdW5kXG4gICAgICAgIHRoaXMuY2FudmFzQ3R4LmZpbGxTdHlsZSA9ICdyZ2IoMCwgMCwgMCknO1xuICAgICAgICB0aGlzLmNhbnZhc0N0eC5maWxsUmVjdCgwLCAwLCB0aGlzLmNhbnZhcy53aWR0aCwgNTAwKTtcblxuICAgICAgICBsZXQgYmFyV2lkdGggPSAodGhpcy5jYW52YXMud2lkdGggLyB0aGlzLmJ1ZmZlckxlbmd0aCk7XG4gICAgICAgIGxldCBiYXJIZWlnaHQ7XG4gICAgICAgIGxldCB4ID0gMDtcblxuICAgICAgICAvLyBWYWx1ZSBvZiBmaXJzdCBCYXJcbiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5kYXRhQXJyYXlbMF0pO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5idWZmZXJMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYmFySGVpZ2h0ID0gdGhpcy5kYXRhQXJyYXlbaV07XG5cbiAgICAgICAgICAgIGxldCBodWUgPSBpIC8gdGhpcy5idWZmZXJMZW5ndGggKiAzNjA7XG4gICAgICAgICAgICB0aGlzLmNhbnZhc0N0eC5maWxsU3R5bGUgPSAnaHNsKCcgKyBodWUgKyAnLCAxMDAlLCA1MCUpJztcbiAgICAgICAgICAgIHRoaXMuY2FudmFzQ3R4LmZpbGxSZWN0KHgsIHRoaXMuY2FudmFzLmhlaWdodCAtIGJhckhlaWdodCAqIDMvNCwgYmFyV2lkdGgsIGJhckhlaWdodCk7XG5cbiAgICAgICAgICAgIHggKz0gYmFyV2lkdGggKyAxO1xuICAgICAgICB9XG5cblxuXG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLmRyYXcpO1xuXG4gICAgfVxuXG5cbn1cblxuXG5leHBvcnQgZGVmYXVsdCBuZXcgWHAoKTtcbiIsIihmdW5jdGlvbiAoZ2xvYmFsLCBmYWN0b3J5KSB7XG5cdHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyA/IG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpIDpcblx0dHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kID8gZGVmaW5lKGZhY3RvcnkpIDpcblx0KGdsb2JhbC5zb25vID0gZmFjdG9yeSgpKTtcbn0odGhpcywgKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xuXG52YXIgYnJvd3NlciA9IHt9O1xuXG5icm93c2VyLmhhbmRsZVBhZ2VWaXNpYmlsaXR5ID0gZnVuY3Rpb24gKG9uSGlkZGVuLCBvblNob3duKSB7XG4gICAgdmFyIGhpZGRlbiA9IHZvaWQgMCxcbiAgICAgICAgdmlzaWJpbGl0eUNoYW5nZSA9IHZvaWQgMDtcblxuICAgIGlmICh0eXBlb2YgZG9jdW1lbnQuaGlkZGVuICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBoaWRkZW4gPSAnaGlkZGVuJztcbiAgICAgICAgdmlzaWJpbGl0eUNoYW5nZSA9ICd2aXNpYmlsaXR5Y2hhbmdlJztcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBkb2N1bWVudC5tb3pIaWRkZW4gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIGhpZGRlbiA9ICdtb3pIaWRkZW4nO1xuICAgICAgICB2aXNpYmlsaXR5Q2hhbmdlID0gJ21venZpc2liaWxpdHljaGFuZ2UnO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGRvY3VtZW50Lm1zSGlkZGVuICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBoaWRkZW4gPSAnbXNIaWRkZW4nO1xuICAgICAgICB2aXNpYmlsaXR5Q2hhbmdlID0gJ21zdmlzaWJpbGl0eWNoYW5nZSc7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZG9jdW1lbnQud2Via2l0SGlkZGVuICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBoaWRkZW4gPSAnd2Via2l0SGlkZGVuJztcbiAgICAgICAgdmlzaWJpbGl0eUNoYW5nZSA9ICd3ZWJraXR2aXNpYmlsaXR5Y2hhbmdlJztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvbkNoYW5nZSgpIHtcbiAgICAgICAgaWYgKGRvY3VtZW50W2hpZGRlbl0pIHtcbiAgICAgICAgICAgIG9uSGlkZGVuKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBvblNob3duKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIHZpc2liaWxpdHlDaGFuZ2UgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIodmlzaWJpbGl0eUNoYW5nZSwgb25DaGFuZ2UsIGZhbHNlKTtcbiAgICB9XG59O1xuXG5icm93c2VyLmhhbmRsZVRvdWNoTG9jayA9IGZ1bmN0aW9uIChjb250ZXh0LCBvblVubG9jaykge1xuICAgIHZhciB1YSA9IG5hdmlnYXRvci51c2VyQWdlbnQsXG4gICAgICAgIGxvY2tlZCA9ICEhdWEubWF0Y2goL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxCbGFja0JlcnJ5fElFTW9iaWxlfE9wZXJhIE1pbml8V2luZG93cyBQaG9uZXxTeW1iaWFuT1MvaSk7XG5cbiAgICBmdW5jdGlvbiB1bmxvY2soKSB7XG4gICAgICAgIGlmIChjb250ZXh0ICYmIGNvbnRleHQuc3RhdGUgPT09ICdzdXNwZW5kZWQnKSB7XG4gICAgICAgICAgICBjb250ZXh0LnJlc3VtZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBidWZmZXIgPSBjb250ZXh0LmNyZWF0ZUJ1ZmZlcigxLCAxLCA0NDEwMCk7XG4gICAgICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGNvbnRleHQuY3JlYXRlQnVmZmVyU291cmNlKCk7XG4gICAgICAgICAgICAgICAgc291cmNlLmJ1ZmZlciA9IGJ1ZmZlcjtcbiAgICAgICAgICAgICAgICBzb3VyY2UuY29ubmVjdChjb250ZXh0LmRlc3RpbmF0aW9uKTtcbiAgICAgICAgICAgICAgICBzb3VyY2Uuc3RhcnQoMCk7XG4gICAgICAgICAgICAgICAgc291cmNlLnN0b3AoMCk7XG4gICAgICAgICAgICAgICAgc291cmNlLmRpc2Nvbm5lY3QoKTtcblxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB1bmxvY2spO1xuICAgICAgICAgICAgICAgIG9uVW5sb2NrKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB1bmxvY2spO1xuICAgICAgICAgICAgb25VbmxvY2soKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmIChsb2NrZWQpIHtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIHVubG9jaywgZmFsc2UpO1xuICAgIH1cblxuICAgIHJldHVybiBsb2NrZWQ7XG59O1xuXG52YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikge1xuICByZXR1cm4gdHlwZW9mIG9iajtcbn0gOiBmdW5jdGlvbiAob2JqKSB7XG4gIHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7XG59O1xuXG5cblxuXG5cbnZhciBjbGFzc0NhbGxDaGVjayA9IGZ1bmN0aW9uIChpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHtcbiAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpO1xuICB9XG59O1xuXG5cblxuXG5cblxuXG5cblxudmFyIGdldCQxID0gZnVuY3Rpb24gZ2V0JDEob2JqZWN0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHtcbiAgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlO1xuICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7XG5cbiAgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkge1xuICAgIHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTtcblxuICAgIGlmIChwYXJlbnQgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBnZXQkMShwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7XG4gICAgfVxuICB9IGVsc2UgaWYgKFwidmFsdWVcIiBpbiBkZXNjKSB7XG4gICAgcmV0dXJuIGRlc2MudmFsdWU7XG4gIH0gZWxzZSB7XG4gICAgdmFyIGdldHRlciA9IGRlc2MuZ2V0O1xuXG4gICAgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7XG4gIH1cbn07XG5cbnZhciBpbmhlcml0cyA9IGZ1bmN0aW9uIChzdWJDbGFzcywgc3VwZXJDbGFzcykge1xuICBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7XG4gIH1cblxuICBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHtcbiAgICBjb25zdHJ1Y3Rvcjoge1xuICAgICAgdmFsdWU6IHN1YkNsYXNzLFxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH1cbiAgfSk7XG4gIGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzcztcbn07XG5cblxuXG5cblxuXG5cblxuXG5cblxudmFyIHBvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4gPSBmdW5jdGlvbiAoc2VsZiwgY2FsbCkge1xuICBpZiAoIXNlbGYpIHtcbiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7XG4gIH1cblxuICByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjtcbn07XG5cblxuXG52YXIgc2V0JDEgPSBmdW5jdGlvbiBzZXQkMShvYmplY3QsIHByb3BlcnR5LCB2YWx1ZSwgcmVjZWl2ZXIpIHtcbiAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpO1xuXG4gIGlmIChkZXNjID09PSB1bmRlZmluZWQpIHtcbiAgICB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7XG5cbiAgICBpZiAocGFyZW50ICE9PSBudWxsKSB7XG4gICAgICBzZXQkMShwYXJlbnQsIHByb3BlcnR5LCB2YWx1ZSwgcmVjZWl2ZXIpO1xuICAgIH1cbiAgfSBlbHNlIGlmIChcInZhbHVlXCIgaW4gZGVzYyAmJiBkZXNjLndyaXRhYmxlKSB7XG4gICAgZGVzYy52YWx1ZSA9IHZhbHVlO1xuICB9IGVsc2Uge1xuICAgIHZhciBzZXR0ZXIgPSBkZXNjLnNldDtcblxuICAgIGlmIChzZXR0ZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgc2V0dGVyLmNhbGwocmVjZWl2ZXIsIHZhbHVlKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdmFsdWU7XG59O1xuXG52YXIgZXh0ZW5zaW9ucyA9IFtdO1xudmFyIGNhblBsYXkgPSB7fTtcblxuLypcbiAqIEluaXRpYWwgdGVzdHNcbiAqL1xuXG52YXIgdGVzdHMgPSBbe1xuICAgIGV4dDogJ29nZycsXG4gICAgdHlwZTogJ2F1ZGlvL29nZzsgY29kZWNzPVwidm9yYmlzXCInXG59LCB7XG4gICAgZXh0OiAnbXAzJyxcbiAgICB0eXBlOiAnYXVkaW8vbXBlZzsnXG59LCB7XG4gICAgZXh0OiAnb3B1cycsXG4gICAgdHlwZTogJ2F1ZGlvL29nZzsgY29kZWNzPVwib3B1c1wiJ1xufSwge1xuICAgIGV4dDogJ3dhdicsXG4gICAgdHlwZTogJ2F1ZGlvL3dhdjsgY29kZWNzPVwiMVwiJ1xufSwge1xuICAgIGV4dDogJ200YScsXG4gICAgdHlwZTogJ2F1ZGlvL3gtbTRhOydcbn0sIHtcbiAgICBleHQ6ICdtNGEnLFxuICAgIHR5cGU6ICdhdWRpby9hYWM7J1xufV07XG5cbnZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2F1ZGlvJyk7XG5pZiAoZWwpIHtcbiAgICB0ZXN0cy5mb3JFYWNoKGZ1bmN0aW9uICh0ZXN0KSB7XG4gICAgICAgIHZhciBjYW5QbGF5VHlwZSA9ICEhZWwuY2FuUGxheVR5cGUodGVzdC50eXBlKTtcbiAgICAgICAgaWYgKGNhblBsYXlUeXBlICYmIGV4dGVuc2lvbnMuaW5kZXhPZih0ZXN0LmV4dCkgPT09IC0xKSB7XG4gICAgICAgICAgICBleHRlbnNpb25zLnB1c2godGVzdC5leHQpO1xuICAgICAgICB9XG4gICAgICAgIGNhblBsYXlbdGVzdC5leHRdID0gY2FuUGxheVR5cGU7XG4gICAgfSk7XG4gICAgZWwgPSBudWxsO1xufVxuXG4vKlxuICogZmluZCBhIHN1cHBvcnRlZCBmaWxlXG4gKi9cblxuZnVuY3Rpb24gZ2V0RmlsZUV4dGVuc2lvbih1cmwpIHtcbiAgICBpZiAodHlwZW9mIHVybCAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgICAvLyBmcm9tIERhdGFVUkxcbiAgICBpZiAodXJsLnNsaWNlKDAsIDUpID09PSAnZGF0YTonKSB7XG4gICAgICAgIHZhciBtYXRjaCA9IHVybC5tYXRjaCgvZGF0YTphdWRpb1xcLyhvZ2d8bXAzfG9wdXN8d2F2fG00YSkvaSk7XG4gICAgICAgIGlmIChtYXRjaCAmJiBtYXRjaC5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICByZXR1cm4gbWF0Y2hbMV0udG9Mb3dlckNhc2UoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBmcm9tIFN0YW5kYXJkIFVSTFxuICAgIHVybCA9IHVybC5zcGxpdCgnPycpWzBdO1xuICAgIHVybCA9IHVybC5zbGljZSh1cmwubGFzdEluZGV4T2YoJy8nKSArIDEpO1xuXG4gICAgdmFyIGEgPSB1cmwuc3BsaXQoJy4nKTtcbiAgICBpZiAoYS5sZW5ndGggPT09IDEgfHwgYVswXSA9PT0gJycgJiYgYS5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgICByZXR1cm4gYS5wb3AoKS50b0xvd2VyQ2FzZSgpO1xufVxuXG5mdW5jdGlvbiBnZXRTdXBwb3J0ZWRGaWxlKGZpbGVOYW1lcykge1xuICAgIHZhciBuYW1lID0gdm9pZCAwO1xuXG4gICAgaWYgKEFycmF5LmlzQXJyYXkoZmlsZU5hbWVzKSkge1xuICAgICAgICAvLyBpZiBhcnJheSBnZXQgdGhlIGZpcnN0IG9uZSB0aGF0IHdvcmtzXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmlsZU5hbWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBuYW1lID0gZmlsZU5hbWVzW2ldO1xuICAgICAgICAgICAgdmFyIGV4dCA9IGdldEZpbGVFeHRlbnNpb24obmFtZSk7XG4gICAgICAgICAgICBpZiAoZXh0ZW5zaW9ucy5pbmRleE9mKGV4dCkgPiAtMSkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSBlbHNlIGlmICgodHlwZW9mIGZpbGVOYW1lcyA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YoZmlsZU5hbWVzKSkgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIC8vIGlmIG5vdCBhcnJheSBhbmQgaXMgb2JqZWN0XG4gICAgICAgIE9iamVjdC5rZXlzKGZpbGVOYW1lcykuc29tZShmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICBuYW1lID0gZmlsZU5hbWVzW2tleV07XG4gICAgICAgICAgICB2YXIgZXh0ID0gZ2V0RmlsZUV4dGVuc2lvbihuYW1lKTtcbiAgICAgICAgICAgIHJldHVybiBleHRlbnNpb25zLmluZGV4T2YoZXh0KSA+IC0xO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLy8gaWYgc3RyaW5nIGp1c3QgcmV0dXJuXG4gICAgcmV0dXJuIG5hbWUgfHwgZmlsZU5hbWVzO1xufVxuXG4vKlxuICogaW5mZXIgZmlsZSB0eXBlc1xuICovXG5cbmZ1bmN0aW9uIGlzQXVkaW9CdWZmZXIoZGF0YSkge1xuICAgIHJldHVybiAhIShkYXRhICYmIHdpbmRvdy5BdWRpb0J1ZmZlciAmJiBkYXRhIGluc3RhbmNlb2Ygd2luZG93LkF1ZGlvQnVmZmVyKTtcbn1cblxuZnVuY3Rpb24gaXNBcnJheUJ1ZmZlcihkYXRhKSB7XG4gICAgcmV0dXJuICEhKGRhdGEgJiYgd2luZG93LkFycmF5QnVmZmVyICYmIGRhdGEgaW5zdGFuY2VvZiB3aW5kb3cuQXJyYXlCdWZmZXIpO1xufVxuXG5mdW5jdGlvbiBpc01lZGlhRWxlbWVudChkYXRhKSB7XG4gICAgcmV0dXJuICEhKGRhdGEgJiYgd2luZG93LkhUTUxNZWRpYUVsZW1lbnQgJiYgZGF0YSBpbnN0YW5jZW9mIHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50KTtcbn1cblxuZnVuY3Rpb24gaXNNZWRpYVN0cmVhbShkYXRhKSB7XG4gICAgcmV0dXJuICEhKGRhdGEgJiYgdHlwZW9mIGRhdGEuZ2V0QXVkaW9UcmFja3MgPT09ICdmdW5jdGlvbicgJiYgZGF0YS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aCAmJiB3aW5kb3cuTWVkaWFTdHJlYW1UcmFjayAmJiBkYXRhLmdldEF1ZGlvVHJhY2tzKClbMF0gaW5zdGFuY2VvZiB3aW5kb3cuTWVkaWFTdHJlYW1UcmFjayk7XG59XG5cbmZ1bmN0aW9uIGlzT3NjaWxsYXRvclR5cGUoZGF0YSkge1xuICAgIHJldHVybiAhIShkYXRhICYmIHR5cGVvZiBkYXRhID09PSAnc3RyaW5nJyAmJiAoZGF0YSA9PT0gJ3NpbmUnIHx8IGRhdGEgPT09ICdzcXVhcmUnIHx8IGRhdGEgPT09ICdzYXd0b290aCcgfHwgZGF0YSA9PT0gJ3RyaWFuZ2xlJykpO1xufVxuXG5mdW5jdGlvbiBpc1NjcmlwdENvbmZpZyhkYXRhKSB7XG4gICAgcmV0dXJuICEhKGRhdGEgJiYgKHR5cGVvZiBkYXRhID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihkYXRhKSkgPT09ICdvYmplY3QnICYmIGRhdGEuYnVmZmVyU2l6ZSAmJiBkYXRhLmNoYW5uZWxzICYmIGRhdGEuY2FsbGJhY2spO1xufVxuXG5mdW5jdGlvbiBpc1VSTChkYXRhKSB7XG4gICAgcmV0dXJuICEhKGRhdGEgJiYgdHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnICYmIChkYXRhLmluZGV4T2YoJy4nKSA+IC0xIHx8IGRhdGEuc2xpY2UoMCwgNSkgPT09ICdkYXRhOicpKTtcbn1cblxuZnVuY3Rpb24gY29udGFpbnNVUkwoY29uZmlnKSB7XG4gICAgaWYgKCFjb25maWcgfHwgaXNNZWRpYUVsZW1lbnQoY29uZmlnKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8vIHN0cmluZywgYXJyYXkgb3Igb2JqZWN0IHdpdGggc3JjL3VybC9kYXRhIHByb3BlcnR5IHRoYXQgaXMgc3RyaW5nLCBhcnJheSBvciBhcnJheWJ1ZmZlclxuICAgIHZhciBzcmMgPSBjb25maWcuc3JjIHx8IGNvbmZpZy51cmwgfHwgY29uZmlnLmRhdGEgfHwgY29uZmlnO1xuICAgIHJldHVybiBpc1VSTChzcmMpIHx8IGlzQXJyYXlCdWZmZXIoc3JjKSB8fCBBcnJheS5pc0FycmF5KHNyYykgJiYgaXNVUkwoc3JjWzBdKTtcbn1cblxudmFyIGZpbGUgPSB7XG4gICAgY2FuUGxheTogY2FuUGxheSxcbiAgICBjb250YWluc1VSTDogY29udGFpbnNVUkwsXG4gICAgZXh0ZW5zaW9uczogZXh0ZW5zaW9ucyxcbiAgICBnZXRGaWxlRXh0ZW5zaW9uOiBnZXRGaWxlRXh0ZW5zaW9uLFxuICAgIGdldFN1cHBvcnRlZEZpbGU6IGdldFN1cHBvcnRlZEZpbGUsXG4gICAgaXNBdWRpb0J1ZmZlcjogaXNBdWRpb0J1ZmZlcixcbiAgICBpc01lZGlhRWxlbWVudDogaXNNZWRpYUVsZW1lbnQsXG4gICAgaXNNZWRpYVN0cmVhbTogaXNNZWRpYVN0cmVhbSxcbiAgICBpc09zY2lsbGF0b3JUeXBlOiBpc09zY2lsbGF0b3JUeXBlLFxuICAgIGlzU2NyaXB0Q29uZmlnOiBpc1NjcmlwdENvbmZpZyxcbiAgICBpc1VSTDogaXNVUkxcbn07XG5cbmZ1bmN0aW9uIEFuYWx5c2VyKGNvbnRleHQsIGNvbmZpZykge1xuICAgIGNvbmZpZyA9IGNvbmZpZyB8fCB7fTtcblxuICAgIHZhciBub2RlID0gY29udGV4dC5jcmVhdGVBbmFseXNlcigpO1xuXG4gICAgdmFyIGZmdFNpemUgPSBjb25maWcuZmZ0U2l6ZSB8fCA1MTIsXG4gICAgICAgIGZyZXFGbG9hdCA9ICEhY29uZmlnLmZsb2F0LFxuICAgICAgICB3YXZlRmxvYXQgPSAhIWNvbmZpZy5mbG9hdCxcbiAgICAgICAgd2F2ZWZvcm0gPSB2b2lkIDAsXG4gICAgICAgIGZyZXF1ZW5jaWVzID0gdm9pZCAwO1xuXG4gICAgbm9kZS5mZnRTaXplID0gZmZ0U2l6ZTsgLy8gZnJlcXVlbmN5QmluQ291bnQgd2lsbCBiZSBoYWxmIHRoaXMgdmFsdWVcbiAgICBub2RlLnNtb290aGluZ1RpbWVDb25zdGFudCA9IGNvbmZpZy5zbW9vdGhpbmcgfHwgY29uZmlnLnNtb290aGluZ1RpbWVDb25zdGFudCB8fCBub2RlLnNtb290aGluZ1RpbWVDb25zdGFudDtcbiAgICBub2RlLm1pbkRlY2liZWxzID0gY29uZmlnLm1pbkRlY2liZWxzIHx8IG5vZGUubWluRGVjaWJlbHM7XG4gICAgbm9kZS5tYXhEZWNpYmVscyA9IGNvbmZpZy5tYXhEZWNpYmVscyB8fCBub2RlLm1heERlY2liZWxzO1xuXG4gICAgLy90aGUgd29ya2VyIHJldHVybnMgYSBub3JtYWxpemVkIHZhbHVlXG4gICAgLy9maXJzdCBhIHN1bSBvZiBhbGwgbWFnbml0dWRlcyBkZXZpZGVkIGJ5IHRoZSBieXRlTGVuZ3RoLCB0aGVuIGRldmlkZSAgYnkgaGFsZiB0aGUgZmZ0ICgxY2hhbm5lbClcbiAgICB2YXIgYW1wbGl0dWRlQmxvYiA9IG5ldyBCbG9iKFsnb25tZXNzYWdlPWZ1bmN0aW9uKGUpe3ZhciBkYXRhPWUuZGF0YTt2YXIgZj1uZXcgRmxvYXQzMkFycmF5KGRhdGEuYik7Zm9yKHZhciBpPTA7aTxmLmxlbmd0aDtpKyspe2RhdGEuc3VtKz1mW2ldfWRhdGEuc3VtLz1mLmxlbmd0aDtwb3N0TWVzc2FnZShNYXRoLm1heCgxLjAtKGRhdGEuc3VtL2RhdGEubnVtU2FtcGxlcyotMS4wKSwwKSl9OyddKTtcbiAgICB2YXIgcGl0Y2hCbG9iID0gbmV3IEJsb2IoWydvbm1lc3NhZ2U9ZnVuY3Rpb24oZSl7dmFyIGRhdGE9ZS5kYXRhO3ZhciBzYW1wbGVSYXRlPWRhdGEuc2FtcGxlUmF0ZTt2YXIgYnVmPW5ldyBGbG9hdDMyQXJyYXkoZGF0YS5iKTt2YXIgU0laRT1idWYubGVuZ3RoO3ZhciBNQVhfU0FNUExFUz1NYXRoLmZsb29yKFNJWkUvMik7dmFyIGJlc3Rfb2Zmc2V0PS0xO3ZhciBiZXN0X2NvcnJlbGF0aW9uPTA7dmFyIHJtcz0wO3ZhciBmb3VuZEdvb2RDb3JyZWxhdGlvbj1mYWxzZTt2YXIgY29ycmVsYXRpb25zPW5ldyBBcnJheShNQVhfU0FNUExFUyk7Zm9yKHZhciBpPTA7aTxTSVpFO2krKyl7dmFyIHZhbD1idWZbaV07cm1zKz12YWwqdmFsfXJtcz1NYXRoLnNxcnQocm1zL1NJWkUpO2lmIChybXM8MC4wMSl7cG9zdE1lc3NhZ2UoLTEpfWVsc2V7dmFyIGxhc3RDb3JyZWxhdGlvbj0xO2Zvcih2YXIgb2Zmc2V0PTA7b2Zmc2V0PE1BWF9TQU1QTEVTO29mZnNldCsrKXt2YXIgY29ycmVsYXRpb249MDtmb3IodmFyIGk9MDtpPE1BWF9TQU1QTEVTO2krKyl7Y29ycmVsYXRpb24rPU1hdGguYWJzKChidWZbaV0pLShidWZbaStvZmZzZXRdKSl9Y29ycmVsYXRpb249MS0oY29ycmVsYXRpb24vTUFYX1NBTVBMRVMpO2NvcnJlbGF0aW9uc1tvZmZzZXRdPWNvcnJlbGF0aW9uO2lmICgoY29ycmVsYXRpb24+MC45KSYmKGNvcnJlbGF0aW9uPmxhc3RDb3JyZWxhdGlvbikpe2ZvdW5kR29vZENvcnJlbGF0aW9uPXRydWU7aWYgKGNvcnJlbGF0aW9uPmJlc3RfY29ycmVsYXRpb24pe2Jlc3RfY29ycmVsYXRpb249Y29ycmVsYXRpb247YmVzdF9vZmZzZXQ9b2Zmc2V0fX1lbHNlIGlmIChmb3VuZEdvb2RDb3JyZWxhdGlvbil7dmFyIHNoaWZ0PShjb3JyZWxhdGlvbnNbYmVzdF9vZmZzZXQrMV0tY29ycmVsYXRpb25zW2Jlc3Rfb2Zmc2V0LTFdKS9jb3JyZWxhdGlvbnNbYmVzdF9vZmZzZXRdO3Bvc3RNZXNzYWdlKHNhbXBsZVJhdGUvKGJlc3Rfb2Zmc2V0Kyg4KnNoaWZ0KSkpfWxhc3RDb3JyZWxhdGlvbj1jb3JyZWxhdGlvbn1pZiAoYmVzdF9jb3JyZWxhdGlvbj4wLjAxKXtwb3N0TWVzc2FnZShzYW1wbGVSYXRlL2Jlc3Rfb2Zmc2V0KX1lbHNle3Bvc3RNZXNzYWdlKC0xKX19fTsnXSk7XG4gICAgdmFyIGFtcGxpdHVkZUJsb2JVUkwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGFtcGxpdHVkZUJsb2IpO1xuICAgIHZhciBhbXBsaXR1ZGVXb3JrZXIgPSBuZXcgV29ya2VyKGFtcGxpdHVkZUJsb2JVUkwpO1xuICAgIHZhciBwaXRjaEJsb2JVUkwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKHBpdGNoQmxvYik7XG4gICAgdmFyIHBpdGNoV29ya2VyID0gbmV3IFdvcmtlcihwaXRjaEJsb2JVUkwpO1xuXG4gICAgdmFyIGFtcGxpdHVkZUNhbGxiYWNrID0gbnVsbDtcbiAgICB2YXIgbm90ZVN0cmluZ3MgPSBbJ0MnLCAnQyMnLCAnRCcsICdEIycsICdFJywgJ0YnLCAnRiMnLCAnRycsICdHIycsICdBJywgJ0EjJywgJ0InXTtcbiAgICB2YXIgcGl0Y2hDYWxsYmFjayA9IG51bGw7XG4gICAgdmFyIHBpdGNoQ2FsbGJhY2tPYmplY3QgPSB7XG4gICAgICAgIGhlcnR6OiBudWxsLCAvL251bWJlclxuICAgICAgICBub3RlOiBudWxsLCAvL3N0cmluZ1xuICAgICAgICBub3RlSW5kZXg6IG51bGwsIC8vaW50XG4gICAgICAgIGRldHVuZUNlbnRzOiBudWxsLCAvL251bWJlclxuICAgICAgICBkZXR1bmU6IG51bGwgLy9zdHJpbmdcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gbm90ZUZyb21QaXRjaChmcmVxdWVuY3kpIHtcbiAgICAgICAgdmFyIG5vdGVOdW0gPSAxMiAqIChNYXRoLmxvZyhmcmVxdWVuY3kgLyA0NDApIC8gTWF0aC5sb2coMikpO1xuICAgICAgICByZXR1cm4gTWF0aC5yb3VuZChub3RlTnVtKSArIDY5O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZyZXF1ZW5jeUZyb21Ob3RlTnVtYmVyKG5vdGUpIHtcbiAgICAgICAgcmV0dXJuIDQ0MCAqIE1hdGgucG93KDIsIChub3RlIC0gNjkpIC8gMTIpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNlbnRzT2ZmRnJvbVBpdGNoKGZyZXF1ZW5jeSwgbm90ZSkge1xuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcigxMjAwICogTWF0aC5sb2coZnJlcXVlbmN5IC8gZnJlcXVlbmN5RnJvbU5vdGVOdW1iZXIobm90ZSkpIC8gTWF0aC5sb2coMikpO1xuICAgIH1cblxuICAgIGFtcGxpdHVkZVdvcmtlci5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoYW1wbGl0dWRlQ2FsbGJhY2spIHtcbiAgICAgICAgICAgIGFtcGxpdHVkZUNhbGxiYWNrKGUuZGF0YSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcGl0Y2hXb3JrZXIub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKHBpdGNoQ2FsbGJhY2spIHtcbiAgICAgICAgICAgIHZhciBIeiA9IGUuZGF0YTtcbiAgICAgICAgICAgIGlmIChIeiAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICB2YXIgbm90ZSA9IG5vdGVGcm9tUGl0Y2goSHopO1xuICAgICAgICAgICAgICAgIHZhciBkZXR1bmUgPSBjZW50c09mZkZyb21QaXRjaChIeiwgbm90ZSk7XG4gICAgICAgICAgICAgICAgcGl0Y2hDYWxsYmFja09iamVjdC5oZXJ0eiA9IEh6O1xuICAgICAgICAgICAgICAgIHBpdGNoQ2FsbGJhY2tPYmplY3Qubm90ZUluZGV4ID0gbm90ZSAlIDEyO1xuICAgICAgICAgICAgICAgIHBpdGNoQ2FsbGJhY2tPYmplY3Qubm90ZSA9IG5vdGVTdHJpbmdzW25vdGUgJSAxMl07XG4gICAgICAgICAgICAgICAgcGl0Y2hDYWxsYmFja09iamVjdC5kZXR1bmVDZW50cyA9IGRldHVuZTtcbiAgICAgICAgICAgICAgICBpZiAoZGV0dW5lID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHBpdGNoQ2FsbGJhY2tPYmplY3QuZGV0dW5lID0gJyc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkZXR1bmUgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHBpdGNoQ2FsbGJhY2tPYmplY3QuZGV0dW5lID0gJ2ZsYXQnO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHBpdGNoQ2FsbGJhY2tPYmplY3QuZGV0dW5lID0gJ3NoYXJwJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwaXRjaENhbGxiYWNrKHBpdGNoQ2FsbGJhY2tPYmplY3QpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIG5lZWRzVXBkYXRlKGFyciwgZmxvYXQpIHtcbiAgICAgICAgaWYgKCFhcnIpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChub2RlLmZmdFNpemUgIT09IGZmdFNpemUpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChmbG9hdCAmJiBhcnIgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gIWZsb2F0ICYmIGFyciBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVBcnJheShmbG9hdCwgbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmbG9hdCA/IG5ldyBGbG9hdDMyQXJyYXkobGVuZ3RoKSA6IG5ldyBVaW50OEFycmF5KGxlbmd0aCk7XG4gICAgfVxuXG4gICAgbm9kZS5nZXRXYXZlZm9ybSA9IGZ1bmN0aW9uIChmbG9hdCkge1xuICAgICAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGZsb2F0ID0gd2F2ZUZsb2F0O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG5lZWRzVXBkYXRlKHdhdmVmb3JtLCBmbG9hdCkpIHtcbiAgICAgICAgICAgIGZmdFNpemUgPSBub2RlLmZmdFNpemU7XG4gICAgICAgICAgICB3YXZlRmxvYXQgPSBmbG9hdDtcbiAgICAgICAgICAgIHdhdmVmb3JtID0gY3JlYXRlQXJyYXkoZmxvYXQsIGZmdFNpemUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChmbG9hdCAmJiB0aGlzLmdldEZsb2F0VGltZURvbWFpbkRhdGEpIHtcbiAgICAgICAgICAgIHRoaXMuZ2V0RmxvYXRUaW1lRG9tYWluRGF0YSh3YXZlZm9ybSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmdldEJ5dGVUaW1lRG9tYWluRGF0YSh3YXZlZm9ybSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gd2F2ZWZvcm07XG4gICAgfTtcblxuICAgIG5vZGUuZ2V0UGl0Y2ggPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgcGl0Y2hDYWxsYmFjayA9IHBpdGNoQ2FsbGJhY2sgfHwgY2FsbGJhY2s7XG4gICAgICAgIHZhciBmID0gbmV3IEZsb2F0MzJBcnJheShub2RlLmZmdFNpemUpO1xuICAgICAgICBmLnNldChub2RlLmdldFdhdmVmb3JtKHRydWUpKTtcbiAgICAgICAgcGl0Y2hXb3JrZXIucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgICAgc2FtcGxlUmF0ZTogY29udGV4dC5zYW1wbGVSYXRlLFxuICAgICAgICAgICAgYjogZi5idWZmZXJcbiAgICAgICAgfSwgW2YuYnVmZmVyXSk7XG4gICAgfTtcblxuICAgIG5vZGUuZ2V0RnJlcXVlbmNpZXMgPSBmdW5jdGlvbiAoZmxvYXQpIHtcbiAgICAgICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICBmbG9hdCA9IGZyZXFGbG9hdDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChuZWVkc1VwZGF0ZShmcmVxdWVuY2llcywgZmxvYXQpKSB7XG4gICAgICAgICAgICBmZnRTaXplID0gbm9kZS5mZnRTaXplO1xuICAgICAgICAgICAgZnJlcUZsb2F0ID0gZmxvYXQ7XG4gICAgICAgICAgICBmcmVxdWVuY2llcyA9IGNyZWF0ZUFycmF5KGZsb2F0LCBub2RlLmZyZXF1ZW5jeUJpbkNvdW50KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChmbG9hdCkge1xuICAgICAgICAgICAgdGhpcy5nZXRGbG9hdEZyZXF1ZW5jeURhdGEoZnJlcXVlbmNpZXMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5nZXRCeXRlRnJlcXVlbmN5RGF0YShmcmVxdWVuY2llcyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZnJlcXVlbmNpZXM7XG4gICAgfTtcblxuICAgIG5vZGUuZ2V0QW1wbGl0dWRlID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIGFtcGxpdHVkZUNhbGxiYWNrID0gYW1wbGl0dWRlQ2FsbGJhY2sgfHwgY2FsbGJhY2s7XG4gICAgICAgIHZhciBmID0gbmV3IEZsb2F0MzJBcnJheShub2RlLmZmdFNpemUpO1xuICAgICAgICBmLnNldChub2RlLmdldEZyZXF1ZW5jaWVzKHRydWUpKTtcbiAgICAgICAgYW1wbGl0dWRlV29ya2VyLnBvc3RNZXNzYWdlKHtcbiAgICAgICAgICAgIHN1bTogMCxcbiAgICAgICAgICAgIGxlbmd0aDogZi5ieXRlTGVuZ3RoLFxuICAgICAgICAgICAgbnVtU2FtcGxlczogbm9kZS5mZnRTaXplIC8gMixcbiAgICAgICAgICAgIGI6IGYuYnVmZmVyXG4gICAgICAgIH0sIFtmLmJ1ZmZlcl0pO1xuICAgIH07XG5cbiAgICBub2RlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbm9kZS5nZXRXYXZlZm9ybSgpO1xuICAgICAgICBub2RlLmdldEZyZXF1ZW5jaWVzKCk7XG4gICAgfTtcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKG5vZGUsIHtcbiAgICAgICAgc21vb3RoaW5nOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbm9kZS5zbW9vdGhpbmdUaW1lQ29uc3RhbnQ7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBub2RlLnNtb290aGluZ1RpbWVDb25zdGFudCA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gbm9kZTtcbn1cblxuZnVuY3Rpb24gbnVtYmVyKHZhbHVlLCBkZWZhdWx0VmFsdWUpIHtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDIpIHtcbiAgICAgICAgZGVmYXVsdFZhbHVlID0gMDtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ251bWJlcicgfHwgaXNOYU4odmFsdWUpKSB7XG4gICAgICAgIHJldHVybiBkZWZhdWx0VmFsdWU7XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbn1cblxudmFyIG4gPSAyMjA1MDtcblxuZnVuY3Rpb24gRGlzdG9ydGlvbihjb250ZXh0LCBhbW91bnQpIHtcblxuICAgIGFtb3VudCA9IG51bWJlcihhbW91bnQsIDEpO1xuXG4gICAgdmFyIG5vZGUgPSBjb250ZXh0LmNyZWF0ZVdhdmVTaGFwZXIoKTtcbiAgICB2YXIgY3VydmUgPSBuZXcgRmxvYXQzMkFycmF5KG4pO1xuXG4gICAgLy8gY3JlYXRlIHdhdmVTaGFwZXIgZGlzdG9ydGlvbiBjdXJ2ZSBmcm9tIDAgdG8gMVxuICAgIG5vZGUudXBkYXRlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGFtb3VudCA9IHZhbHVlO1xuICAgICAgICBpZiAoYW1vdW50IDw9IDApIHtcbiAgICAgICAgICAgIGFtb3VudCA9IDA7XG4gICAgICAgICAgICB0aGlzLmN1cnZlID0gbnVsbDtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgayA9IHZhbHVlICogMTAwO1xuICAgICAgICB2YXIgZGVnID0gTWF0aC5QSSAvIDE4MDtcbiAgICAgICAgdmFyIHggPSB2b2lkIDA7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgICAgIHggPSBpICogMiAvIG4gLSAxO1xuICAgICAgICAgICAgY3VydmVbaV0gPSAoMyArIGspICogeCAqIDIwICogZGVnIC8gKE1hdGguUEkgKyBrICogTWF0aC5hYnMoeCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5jdXJ2ZSA9IGN1cnZlO1xuICAgIH07XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhub2RlLCB7XG4gICAgICAgIGFtb3VudDoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFtb3VudDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKHR5cGVvZiBhbW91bnQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIG5vZGUudXBkYXRlKGFtb3VudCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5vZGU7XG59XG5cbmZ1bmN0aW9uIEVjaG8oY29udGV4dCwgY29uZmlnKSB7XG4gICAgY29uZmlnID0gY29uZmlnIHx8IHt9O1xuXG4gICAgdmFyIGlucHV0ID0gY29udGV4dC5jcmVhdGVHYWluKCk7XG4gICAgdmFyIGRlbGF5ID0gY29udGV4dC5jcmVhdGVEZWxheSgpO1xuICAgIHZhciBnYWluID0gY29udGV4dC5jcmVhdGVHYWluKCk7XG4gICAgdmFyIG91dHB1dCA9IGNvbnRleHQuY3JlYXRlR2FpbigpO1xuXG4gICAgZGVsYXkuZGVsYXlUaW1lLnZhbHVlID0gbnVtYmVyKGNvbmZpZy5kZWxheVRpbWUsIDAuNSk7XG4gICAgZ2Fpbi5nYWluLnZhbHVlID0gbnVtYmVyKGNvbmZpZy5mZWVkYmFjaywgMC41KTtcblxuICAgIGlucHV0LmNvbm5lY3QoZGVsYXkpO1xuICAgIGlucHV0LmNvbm5lY3Qob3V0cHV0KTtcbiAgICBkZWxheS5jb25uZWN0KGdhaW4pO1xuICAgIGdhaW4uY29ubmVjdChkZWxheSk7XG4gICAgZ2Fpbi5jb25uZWN0KG91dHB1dCk7XG5cbiAgICB2YXIgbm9kZSA9IGlucHV0O1xuICAgIG5vZGUubmFtZSA9ICdFY2hvJztcbiAgICBub2RlLl9vdXRwdXQgPSBvdXRwdXQ7XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhub2RlLCB7XG4gICAgICAgIGRlbGF5OiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVsYXkuZGVsYXlUaW1lLnZhbHVlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgZGVsYXkuZGVsYXlUaW1lLnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGZlZWRiYWNrOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2Fpbi5nYWluLnZhbHVlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgZ2Fpbi5nYWluLnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBub2RlO1xufVxuXG5mdW5jdGlvbiBGYWtlQ29udGV4dCgpIHtcblxuICAgIHZhciBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgZnVuY3Rpb24gZm4oKSB7fVxuXG4gICAgZnVuY3Rpb24gcGFyYW0oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWx1ZTogMSxcbiAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogMSxcbiAgICAgICAgICAgIGxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lOiBmbixcbiAgICAgICAgICAgIHNldFZhbHVlQXRUaW1lOiBmbixcbiAgICAgICAgICAgIGV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWU6IGZuLFxuICAgICAgICAgICAgc2V0VGFyZ2V0QXRUaW1lOiBmbixcbiAgICAgICAgICAgIHNldFZhbHVlQ3VydmVBdFRpbWU6IGZuLFxuICAgICAgICAgICAgY2FuY2VsU2NoZWR1bGVkVmFsdWVzOiBmblxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZha2VOb2RlKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY29ubmVjdDogZm4sXG4gICAgICAgICAgICBkaXNjb25uZWN0OiBmbixcbiAgICAgICAgICAgIC8vIGFuYWx5c2VyXG4gICAgICAgICAgICBmcmVxdWVuY3lCaW5Db3VudDogMCxcbiAgICAgICAgICAgIHNtb290aGluZ1RpbWVDb25zdGFudDogMCxcbiAgICAgICAgICAgIGZmdFNpemU6IDAsXG4gICAgICAgICAgICBtaW5EZWNpYmVsczogMCxcbiAgICAgICAgICAgIG1heERlY2liZWxzOiAwLFxuICAgICAgICAgICAgZ2V0Qnl0ZVRpbWVEb21haW5EYXRhOiBmbixcbiAgICAgICAgICAgIGdldEJ5dGVGcmVxdWVuY3lEYXRhOiBmbixcbiAgICAgICAgICAgIGdldEZsb2F0VGltZURvbWFpbkRhdGE6IGZuLFxuICAgICAgICAgICAgZ2V0RmxvYXRGcmVxdWVuY3lEYXRhOiBmbixcbiAgICAgICAgICAgIC8vIGdhaW5cbiAgICAgICAgICAgIGdhaW46IHBhcmFtKCksXG4gICAgICAgICAgICAvLyBwYW5uZXJcbiAgICAgICAgICAgIHBhbm5pbmdNb2RlbDogMCxcbiAgICAgICAgICAgIHNldFBvc2l0aW9uOiBmbixcbiAgICAgICAgICAgIHNldE9yaWVudGF0aW9uOiBmbixcbiAgICAgICAgICAgIHNldFZlbG9jaXR5OiBmbixcbiAgICAgICAgICAgIGRpc3RhbmNlTW9kZWw6IDAsXG4gICAgICAgICAgICByZWZEaXN0YW5jZTogMCxcbiAgICAgICAgICAgIG1heERpc3RhbmNlOiAwLFxuICAgICAgICAgICAgcm9sbG9mZkZhY3RvcjogMCxcbiAgICAgICAgICAgIGNvbmVJbm5lckFuZ2xlOiAzNjAsXG4gICAgICAgICAgICBjb25lT3V0ZXJBbmdsZTogMzYwLFxuICAgICAgICAgICAgY29uZU91dGVyR2FpbjogMCxcbiAgICAgICAgICAgIC8vIGZpbHRlcjpcbiAgICAgICAgICAgIHR5cGU6IDAsXG4gICAgICAgICAgICBmcmVxdWVuY3k6IHBhcmFtKCksXG4gICAgICAgICAgICBROiBwYXJhbSgpLFxuICAgICAgICAgICAgZGV0dW5lOiBwYXJhbSgpLFxuICAgICAgICAgICAgLy8gZGVsYXlcbiAgICAgICAgICAgIGRlbGF5VGltZTogcGFyYW0oKSxcbiAgICAgICAgICAgIC8vIGNvbnZvbHZlclxuICAgICAgICAgICAgYnVmZmVyOiAwLFxuICAgICAgICAgICAgLy8gY29tcHJlc3NvclxuICAgICAgICAgICAgdGhyZXNob2xkOiBwYXJhbSgpLFxuICAgICAgICAgICAga25lZTogcGFyYW0oKSxcbiAgICAgICAgICAgIHJhdGlvOiBwYXJhbSgpLFxuICAgICAgICAgICAgYXR0YWNrOiBwYXJhbSgpLFxuICAgICAgICAgICAgcmVsZWFzZTogcGFyYW0oKSxcbiAgICAgICAgICAgIHJlZHVjdGlvbjogcGFyYW0oKSxcbiAgICAgICAgICAgIC8vIGRpc3RvcnRpb25cbiAgICAgICAgICAgIG92ZXJzYW1wbGU6IDAsXG4gICAgICAgICAgICBjdXJ2ZTogMCxcbiAgICAgICAgICAgIC8vIGJ1ZmZlclxuICAgICAgICAgICAgc2FtcGxlUmF0ZTogMSxcbiAgICAgICAgICAgIGxlbmd0aDogMCxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAwLFxuICAgICAgICAgICAgbnVtYmVyT2ZDaGFubmVsczogMCxcbiAgICAgICAgICAgIGdldENoYW5uZWxEYXRhOiBmdW5jdGlvbiBnZXRDaGFubmVsRGF0YSgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY29weUZyb21DaGFubmVsOiBmbixcbiAgICAgICAgICAgIGNvcHlUb0NoYW5uZWw6IGZuLFxuICAgICAgICAgICAgLy8gbGlzdGVuZXJcbiAgICAgICAgICAgIGRvcHBsZXJGYWN0b3I6IDAsXG4gICAgICAgICAgICBzcGVlZE9mU291bmQ6IDAsXG4gICAgICAgICAgICAvLyBvc2NcbiAgICAgICAgICAgIHN0YXJ0OiBmblxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8vIGllOVxuICAgIGlmICghd2luZG93LlVpbnQ4QXJyYXkpIHtcbiAgICAgICAgd2luZG93LlVpbnQ4QXJyYXkgPSB3aW5kb3cuRmxvYXQzMkFycmF5ID0gQXJyYXk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgY3JlYXRlQW5hbHlzZXI6IGZha2VOb2RlLFxuICAgICAgICBjcmVhdGVCdWZmZXI6IGZha2VOb2RlLFxuICAgICAgICBjcmVhdGVCaXF1YWRGaWx0ZXI6IGZha2VOb2RlLFxuICAgICAgICBjcmVhdGVDaGFubmVsTWVyZ2VyOiBmYWtlTm9kZSxcbiAgICAgICAgY3JlYXRlQ2hhbm5lbFNwbGl0dGVyOiBmYWtlTm9kZSxcbiAgICAgICAgY3JlYXRlRHluYW1pY3NDb21wcmVzc29yOiBmYWtlTm9kZSxcbiAgICAgICAgY3JlYXRlQ29udm9sdmVyOiBmYWtlTm9kZSxcbiAgICAgICAgY3JlYXRlRGVsYXk6IGZha2VOb2RlLFxuICAgICAgICBjcmVhdGVHYWluOiBmYWtlTm9kZSxcbiAgICAgICAgY3JlYXRlT3NjaWxsYXRvcjogZmFrZU5vZGUsXG4gICAgICAgIGNyZWF0ZVBhbm5lcjogZmFrZU5vZGUsXG4gICAgICAgIGNyZWF0ZVNjcmlwdFByb2Nlc3NvcjogZmFrZU5vZGUsXG4gICAgICAgIGNyZWF0ZVdhdmVTaGFwZXI6IGZha2VOb2RlLFxuICAgICAgICBsaXN0ZW5lcjogZmFrZU5vZGUoKSxcbiAgICAgICAgZ2V0IGN1cnJlbnRUaW1lKCkge1xuICAgICAgICAgICAgcmV0dXJuIChEYXRlLm5vdygpIC0gc3RhcnRUaW1lKSAvIDEwMDA7XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG4vLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvQmlxdWFkRmlsdGVyTm9kZVxuLy8gRm9yIGxvd3Bhc3MgYW5kIGhpZ2hwYXNzIFEgaW5kaWNhdGVzIGhvdyBwZWFrZWQgdGhlIGZyZXF1ZW5jeSBpcyBhcm91bmQgdGhlIGN1dG9mZi5cbi8vIFRoZSBncmVhdGVyIHRoZSB2YWx1ZSBpcywgdGhlIGdyZWF0ZXIgaXMgdGhlIHBlYWtcblxuZnVuY3Rpb24gRmlsdGVyKGNvbnRleHQpIHtcbiAgICB2YXIgY29uZmlnID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMV07XG5cbiAgICAvLyBGcmVxdWVuY3kgYmV0d2VlbiA0MEh6IGFuZCBoYWxmIG9mIHRoZSBzYW1wbGluZyByYXRlXG4gICAgdmFyIG1pbkZyZXF1ZW5jeSA9IDQwO1xuICAgIHZhciBtYXhGcmVxdWVuY3kgPSBjb250ZXh0LnNhbXBsZVJhdGUgLyAyO1xuXG4gICAgdmFyIG5vZGUgPSBjb250ZXh0LmNyZWF0ZUJpcXVhZEZpbHRlcigpO1xuICAgIG5vZGUudHlwZSA9IGNvbmZpZy50eXBlO1xuXG4gICAgZnVuY3Rpb24gZ2V0RnJlcXVlbmN5KHZhbHVlKSB7XG4gICAgICAgIC8vIExvZ2FyaXRobSAoYmFzZSAyKSB0byBjb21wdXRlIGhvdyBtYW55IG9jdGF2ZXMgZmFsbCBpbiB0aGUgcmFuZ2UuXG4gICAgICAgIHZhciBudW1iZXJPZk9jdGF2ZXMgPSBNYXRoLmxvZyhtYXhGcmVxdWVuY3kgLyBtaW5GcmVxdWVuY3kpIC8gTWF0aC5MTjI7XG4gICAgICAgIC8vIENvbXB1dGUgYSBtdWx0aXBsaWVyIGZyb20gMCB0byAxIGJhc2VkIG9uIGFuIGV4cG9uZW50aWFsIHNjYWxlLlxuICAgICAgICB2YXIgbXVsdGlwbGllciA9IE1hdGgucG93KDIsIG51bWJlck9mT2N0YXZlcyAqICh2YWx1ZSAtIDEuMCkpO1xuICAgICAgICAvLyBHZXQgYmFjayB0byB0aGUgZnJlcXVlbmN5IHZhbHVlIGJldHdlZW4gbWluIGFuZCBtYXguXG4gICAgICAgIHJldHVybiBtYXhGcmVxdWVuY3kgKiBtdWx0aXBsaWVyO1xuICAgIH1cblxuICAgIG5vZGUuc2V0ID0gZnVuY3Rpb24gKGZyZXF1ZW5jeSwgcSwgZ2Fpbikge1xuICAgICAgICBpZiAodHlwZW9mIGZyZXF1ZW5jeSAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIGZyZXF1ZW5jeSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgIG5vZGUuZnJlcXVlbmN5LnZhbHVlID0gZnJlcXVlbmN5O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgcSAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHEgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICBub2RlLlEudmFsdWUgPSBxO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgZ2FpbiAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIGdhaW4gPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICBub2RlLmdhaW4udmFsdWUgPSBnYWluO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBub2RlO1xuICAgIH07XG5cbiAgICAvLyBzZXQgZmlsdGVyIGZyZXF1ZW5jeSBiYXNlZCBvbiB2YWx1ZSBmcm9tIDAgdG8gMVxuICAgIG5vZGUuc2V0QnlQZXJjZW50ID0gZnVuY3Rpb24gKHBlcmNlbnQsIHEsIGdhaW4pIHtcbiAgICAgICAgcmV0dXJuIG5vZGUuc2V0KGdldEZyZXF1ZW5jeShwZXJjZW50KSwgcSwgZ2Fpbik7XG4gICAgfTtcblxuICAgIHJldHVybiBub2RlLnNldChjb25maWcuZnJlcXVlbmN5LCBjb25maWcucSwgY29uZmlnLmdhaW4pO1xufVxuXG5mdW5jdGlvbiBNb25vRmxhbmdlcihjb250ZXh0LCBjb25maWcpIHtcbiAgICB2YXIgaW5wdXQgPSBjb250ZXh0LmNyZWF0ZUdhaW4oKTtcbiAgICB2YXIgZGVsYXkgPSBjb250ZXh0LmNyZWF0ZURlbGF5KCk7XG4gICAgdmFyIGZlZWRiYWNrID0gY29udGV4dC5jcmVhdGVHYWluKCk7XG4gICAgdmFyIGxmbyA9IGNvbnRleHQuY3JlYXRlT3NjaWxsYXRvcigpO1xuICAgIHZhciBnYWluID0gY29udGV4dC5jcmVhdGVHYWluKCk7XG4gICAgdmFyIG91dHB1dCA9IGNvbnRleHQuY3JlYXRlR2FpbigpO1xuXG4gICAgZGVsYXkuZGVsYXlUaW1lLnZhbHVlID0gbnVtYmVyKGNvbmZpZy5kZWxheSwgMC4wMDUpOyAvLyA1LTI1bXMgZGVsYXkgKDAuMDA1ID4gMC4wMjUpXG4gICAgZmVlZGJhY2suZ2Fpbi52YWx1ZSA9IG51bWJlcihjb25maWcuZmVlZGJhY2ssIDAuNSk7IC8vIDAgPiAxXG5cbiAgICBsZm8udHlwZSA9ICdzaW5lJztcbiAgICBsZm8uZnJlcXVlbmN5LnZhbHVlID0gbnVtYmVyKGNvbmZpZy5mcmVxdWVuY3ksIDAuMDAyKTsgLy8gMC4wNSA+IDVcbiAgICBnYWluLmdhaW4udmFsdWUgPSBudW1iZXIoY29uZmlnLmdhaW4sIDAuMjUpOyAvLyAwLjAwMDUgPiAwLjAwNVxuXG4gICAgaW5wdXQuY29ubmVjdChvdXRwdXQpO1xuICAgIGlucHV0LmNvbm5lY3QoZGVsYXkpO1xuICAgIGRlbGF5LmNvbm5lY3Qob3V0cHV0KTtcbiAgICBkZWxheS5jb25uZWN0KGZlZWRiYWNrKTtcbiAgICBmZWVkYmFjay5jb25uZWN0KGlucHV0KTtcblxuICAgIGxmby5jb25uZWN0KGdhaW4pO1xuICAgIGdhaW4uY29ubmVjdChkZWxheS5kZWxheVRpbWUpO1xuICAgIGxmby5zdGFydCgwKTtcblxuICAgIHZhciBub2RlID0gaW5wdXQ7XG4gICAgbm9kZS5uYW1lID0gJ0ZsYW5nZXInO1xuICAgIG5vZGUuX291dHB1dCA9IG91dHB1dDtcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKG5vZGUsIHtcbiAgICAgICAgZGVsYXk6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWxheS5kZWxheVRpbWUudmFsdWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBkZWxheS5kZWxheVRpbWUudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgbGZvRnJlcXVlbmN5OiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbGZvLmZyZXF1ZW5jeS52YWx1ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGxmby5mcmVxdWVuY3kudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgbGZvR2Fpbjoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdhaW4uZ2Fpbi52YWx1ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGdhaW4uZ2Fpbi52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBmZWVkYmFjazoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZlZWRiYWNrLmdhaW4udmFsdWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBmZWVkYmFjay5nYWluLnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBub2RlO1xufVxuXG5mdW5jdGlvbiBTdGVyZW9GbGFuZ2VyKGNvbnRleHQsIGNvbmZpZykge1xuICAgIHZhciBpbnB1dCA9IGNvbnRleHQuY3JlYXRlR2FpbigpO1xuICAgIHZhciBzcGxpdHRlciA9IGNvbnRleHQuY3JlYXRlQ2hhbm5lbFNwbGl0dGVyKDIpO1xuICAgIHZhciBtZXJnZXIgPSBjb250ZXh0LmNyZWF0ZUNoYW5uZWxNZXJnZXIoMik7XG4gICAgdmFyIGZlZWRiYWNrTCA9IGNvbnRleHQuY3JlYXRlR2FpbigpO1xuICAgIHZhciBmZWVkYmFja1IgPSBjb250ZXh0LmNyZWF0ZUdhaW4oKTtcbiAgICB2YXIgbGZvID0gY29udGV4dC5jcmVhdGVPc2NpbGxhdG9yKCk7XG4gICAgdmFyIGxmb0dhaW5MID0gY29udGV4dC5jcmVhdGVHYWluKCk7XG4gICAgdmFyIGxmb0dhaW5SID0gY29udGV4dC5jcmVhdGVHYWluKCk7XG4gICAgdmFyIGRlbGF5TCA9IGNvbnRleHQuY3JlYXRlRGVsYXkoKTtcbiAgICB2YXIgZGVsYXlSID0gY29udGV4dC5jcmVhdGVEZWxheSgpO1xuICAgIHZhciBvdXRwdXQgPSBjb250ZXh0LmNyZWF0ZUdhaW4oKTtcblxuICAgIGZlZWRiYWNrTC5nYWluLnZhbHVlID0gZmVlZGJhY2tSLmdhaW4udmFsdWUgPSBudW1iZXIoY29uZmlnLmZlZWRiYWNrLCAwLjUpO1xuICAgIGRlbGF5TC5kZWxheVRpbWUudmFsdWUgPSBkZWxheVIuZGVsYXlUaW1lLnZhbHVlID0gbnVtYmVyKGNvbmZpZy5kZWxheSwgMC4wMDMpO1xuXG4gICAgbGZvLnR5cGUgPSAnc2luZSc7XG4gICAgbGZvLmZyZXF1ZW5jeS52YWx1ZSA9IG51bWJlcihjb25maWcuZnJlcXVlbmN5LCAwLjUpO1xuICAgIGxmb0dhaW5MLmdhaW4udmFsdWUgPSBudW1iZXIoY29uZmlnLmdhaW4sIDAuMDA1KTtcbiAgICBsZm9HYWluUi5nYWluLnZhbHVlID0gMCAtIGxmb0dhaW5MLmdhaW4udmFsdWU7XG5cbiAgICBpbnB1dC5jb25uZWN0KHNwbGl0dGVyKTtcblxuICAgIHNwbGl0dGVyLmNvbm5lY3QoZGVsYXlMLCAwKTtcbiAgICBzcGxpdHRlci5jb25uZWN0KGRlbGF5UiwgMSk7XG5cbiAgICBkZWxheUwuY29ubmVjdChmZWVkYmFja0wpO1xuICAgIGRlbGF5Ui5jb25uZWN0KGZlZWRiYWNrUik7XG5cbiAgICBmZWVkYmFja0wuY29ubmVjdChkZWxheVIpO1xuICAgIGZlZWRiYWNrUi5jb25uZWN0KGRlbGF5TCk7XG5cbiAgICBkZWxheUwuY29ubmVjdChtZXJnZXIsIDAsIDApO1xuICAgIGRlbGF5Ui5jb25uZWN0KG1lcmdlciwgMCwgMSk7XG5cbiAgICBtZXJnZXIuY29ubmVjdChvdXRwdXQpO1xuICAgIGlucHV0LmNvbm5lY3Qob3V0cHV0KTtcblxuICAgIGxmby5jb25uZWN0KGxmb0dhaW5MKTtcbiAgICBsZm8uY29ubmVjdChsZm9HYWluUik7XG4gICAgbGZvR2FpbkwuY29ubmVjdChkZWxheUwuZGVsYXlUaW1lKTtcbiAgICBsZm9HYWluUi5jb25uZWN0KGRlbGF5Ui5kZWxheVRpbWUpO1xuICAgIGxmby5zdGFydCgwKTtcblxuICAgIHZhciBub2RlID0gaW5wdXQ7XG4gICAgbm9kZS5uYW1lID0gJ1N0ZXJlb0ZsYW5nZXInO1xuICAgIG5vZGUuX291dHB1dCA9IG91dHB1dDtcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKG5vZGUsIHtcbiAgICAgICAgZGVsYXk6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWxheUwuZGVsYXlUaW1lLnZhbHVlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgZGVsYXlMLmRlbGF5VGltZS52YWx1ZSA9IGRlbGF5Ui5kZWxheVRpbWUudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgbGZvRnJlcXVlbmN5OiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbGZvLmZyZXF1ZW5jeS52YWx1ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGxmby5mcmVxdWVuY3kudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgbGZvR2Fpbjoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxmb0dhaW5MLmdhaW4udmFsdWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBsZm9HYWluTC5nYWluLnZhbHVlID0gbGZvR2FpblIuZ2Fpbi52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBmZWVkYmFjazoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZlZWRiYWNrTC5nYWluLnZhbHVlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgZmVlZGJhY2tMLmdhaW4udmFsdWUgPSBmZWVkYmFja1IuZ2Fpbi52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gbm9kZTtcbn1cblxuZnVuY3Rpb24gRmxhbmdlcihjb250ZXh0LCBjb25maWcpIHtcbiAgICBjb25maWcgPSBjb25maWcgfHwge307XG4gICAgcmV0dXJuIGNvbmZpZy5zdGVyZW8gPyBuZXcgU3RlcmVvRmxhbmdlcihjb250ZXh0LCBjb25maWcpIDogbmV3IE1vbm9GbGFuZ2VyKGNvbnRleHQsIGNvbmZpZyk7XG59XG5cbmZ1bmN0aW9uIFBhbm5lcihjb250ZXh0KSB7XG4gICAgdmFyIG5vZGUgPSBjb250ZXh0LmNyZWF0ZVBhbm5lcigpO1xuXG4gICAgLy8gRGVmYXVsdCBmb3Igc3RlcmVvIGlzICdIUlRGJyBjYW4gYWxzbyBiZSAnZXF1YWxwb3dlcidcbiAgICBub2RlLnBhbm5pbmdNb2RlbCA9IFBhbm5lci5kZWZhdWx0cy5wYW5uaW5nTW9kZWw7XG5cbiAgICAvLyBEaXN0YW5jZSBtb2RlbCBhbmQgYXR0cmlidXRlc1xuICAgIC8vIENhbiBiZSAnbGluZWFyJyAnaW52ZXJzZScgJ2V4cG9uZW50aWFsJ1xuICAgIG5vZGUuZGlzdGFuY2VNb2RlbCA9IFBhbm5lci5kZWZhdWx0cy5kaXN0YW5jZU1vZGVsO1xuICAgIG5vZGUucmVmRGlzdGFuY2UgPSBQYW5uZXIuZGVmYXVsdHMucmVmRGlzdGFuY2U7XG4gICAgbm9kZS5tYXhEaXN0YW5jZSA9IFBhbm5lci5kZWZhdWx0cy5tYXhEaXN0YW5jZTtcbiAgICBub2RlLnJvbGxvZmZGYWN0b3IgPSBQYW5uZXIuZGVmYXVsdHMucm9sbG9mZkZhY3RvcjtcbiAgICBub2RlLmNvbmVJbm5lckFuZ2xlID0gUGFubmVyLmRlZmF1bHRzLmNvbmVJbm5lckFuZ2xlO1xuICAgIG5vZGUuY29uZU91dGVyQW5nbGUgPSBQYW5uZXIuZGVmYXVsdHMuY29uZU91dGVyQW5nbGU7XG4gICAgbm9kZS5jb25lT3V0ZXJHYWluID0gUGFubmVyLmRlZmF1bHRzLmNvbmVPdXRlckdhaW47XG4gICAgLy8gc2V0IHRvIGRlZmF1bHRzIChuZWVkZWQgaW4gRmlyZWZveClcbiAgICBub2RlLnNldFBvc2l0aW9uKDAsIDAsIDEpO1xuICAgIG5vZGUuc2V0T3JpZW50YXRpb24oMCwgMCwgMCk7XG5cbiAgICAvLyBzaW1wbGUgdmVjMyBvYmplY3QgcG9vbFxuICAgIHZhciB2ZWNQb29sID0ge1xuICAgICAgICBwb29sOiBbXSxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoeCwgeSwgeikge1xuICAgICAgICAgICAgdmFyIHYgPSB0aGlzLnBvb2wubGVuZ3RoID8gdGhpcy5wb29sLnBvcCgpIDoge1xuICAgICAgICAgICAgICAgIHg6IDAsXG4gICAgICAgICAgICAgICAgeTogMCxcbiAgICAgICAgICAgICAgICB6OiAwXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgYSB2ZWN0b3IgaGFzIGJlZW4gcGFzc2VkIGluXG4gICAgICAgICAgICBpZiAodHlwZW9mIHggIT09ICd1bmRlZmluZWQnICYmIGlzTmFOKHgpICYmICd4JyBpbiB4ICYmICd5JyBpbiB4ICYmICd6JyBpbiB4KSB7XG4gICAgICAgICAgICAgICAgdi54ID0gbnVtYmVyKHgueCk7XG4gICAgICAgICAgICAgICAgdi55ID0gbnVtYmVyKHgueSk7XG4gICAgICAgICAgICAgICAgdi56ID0gbnVtYmVyKHgueik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHYueCA9IG51bWJlcih4KTtcbiAgICAgICAgICAgICAgICB2LnkgPSBudW1iZXIoeSk7XG4gICAgICAgICAgICAgICAgdi56ID0gbnVtYmVyKHopO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHY7XG4gICAgICAgIH0sXG4gICAgICAgIGRpc3Bvc2U6IGZ1bmN0aW9uIGRpc3Bvc2UoaW5zdGFuY2UpIHtcbiAgICAgICAgICAgIHRoaXMucG9vbC5wdXNoKGluc3RhbmNlKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB2YXIgZ2xvYmFsVXAgPSB2ZWNQb29sLmdldCgwLCAxLCAwKSxcbiAgICAgICAgYW5nbGU0NSA9IE1hdGguUEkgLyA0LFxuICAgICAgICBhbmdsZTkwID0gTWF0aC5QSSAvIDI7XG5cbiAgICAvLyBjcm9zcyBwcm9kdWN0IG9mIDIgdmVjdG9yc1xuICAgIGZ1bmN0aW9uIGNyb3NzKGEsIGIpIHtcbiAgICAgICAgdmFyIGF4ID0gYS54LFxuICAgICAgICAgICAgYXkgPSBhLnksXG4gICAgICAgICAgICBheiA9IGEuejtcbiAgICAgICAgdmFyIGJ4ID0gYi54LFxuICAgICAgICAgICAgYnkgPSBiLnksXG4gICAgICAgICAgICBieiA9IGIuejtcbiAgICAgICAgYS54ID0gYXkgKiBieiAtIGF6ICogYnk7XG4gICAgICAgIGEueSA9IGF6ICogYnggLSBheCAqIGJ6O1xuICAgICAgICBhLnogPSBheCAqIGJ5IC0gYXkgKiBieDtcbiAgICB9XG5cbiAgICAvLyBub3JtYWxpc2UgdG8gdW5pdCB2ZWN0b3JcbiAgICBmdW5jdGlvbiBub3JtYWxpemUodmVjMykge1xuICAgICAgICBpZiAodmVjMy54ID09PSAwICYmIHZlYzMueSA9PT0gMCAmJiB2ZWMzLnogPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB2ZWMzO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsZW5ndGggPSBNYXRoLnNxcnQodmVjMy54ICogdmVjMy54ICsgdmVjMy55ICogdmVjMy55ICsgdmVjMy56ICogdmVjMy56KTtcbiAgICAgICAgdmFyIGludlNjYWxhciA9IDEgLyBsZW5ndGg7XG4gICAgICAgIHZlYzMueCAqPSBpbnZTY2FsYXI7XG4gICAgICAgIHZlYzMueSAqPSBpbnZTY2FsYXI7XG4gICAgICAgIHZlYzMueiAqPSBpbnZTY2FsYXI7XG4gICAgICAgIHJldHVybiB2ZWMzO1xuICAgIH1cblxuICAgIC8vIHNldCB0aGUgb3JpZW50YXRpb24gb2YgdGhlIHNvdXJjZSAod2hlcmUgdGhlIGF1ZGlvIGlzIGNvbWluZyBmcm9tKVxuICAgIGZ1bmN0aW9uIHNldE9yaWVudGF0aW9uKHBhbm5lck5vZGUsIGZ3KSB7XG4gICAgICAgIC8vIGNhbGN1bGF0ZSB1cCB2ZWMgKCB1cCA9IChmb3J3YXJkIGNyb3NzICgwLCAxLCAwKSkgY3Jvc3MgZm9yd2FyZCApXG4gICAgICAgIHZhciB1cCA9IHZlY1Bvb2wuZ2V0KGZ3LngsIGZ3LnksIGZ3LnopO1xuICAgICAgICBjcm9zcyh1cCwgZ2xvYmFsVXApO1xuICAgICAgICBjcm9zcyh1cCwgZncpO1xuICAgICAgICBub3JtYWxpemUodXApO1xuICAgICAgICBub3JtYWxpemUoZncpO1xuICAgICAgICAvLyBzZXQgdGhlIGF1ZGlvIGNvbnRleHQncyBsaXN0ZW5lciBwb3NpdGlvbiB0byBtYXRjaCB0aGUgY2FtZXJhIHBvc2l0aW9uXG4gICAgICAgIHBhbm5lck5vZGUuc2V0T3JpZW50YXRpb24oZncueCwgZncueSwgZncueiwgdXAueCwgdXAueSwgdXAueik7XG4gICAgICAgIC8vIHJldHVybiB0aGUgdmVjcyB0byB0aGUgcG9vbFxuICAgICAgICB2ZWNQb29sLmRpc3Bvc2UoZncpO1xuICAgICAgICB2ZWNQb29sLmRpc3Bvc2UodXApO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldFBvc2l0aW9uKG5vZGVPckxpc3RlbmVyLCB2ZWMpIHtcbiAgICAgICAgbm9kZU9yTGlzdGVuZXIuc2V0UG9zaXRpb24odmVjLngsIHZlYy55LCB2ZWMueik7XG4gICAgICAgIHZlY1Bvb2wuZGlzcG9zZSh2ZWMpO1xuICAgIH1cblxuICAgIG5vZGUuc2V0ID0gZnVuY3Rpb24gKHgsIHksIHopIHtcbiAgICAgICAgdmFyIHYgPSB2ZWNQb29sLmdldCh4LCB5LCB6KTtcblxuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSAmJiB2LngpIHtcbiAgICAgICAgICAgIC8vIHBhbiBsZWZ0IHRvIHJpZ2h0IHdpdGggdmFsdWUgZnJvbSAtMSB0byAxXG4gICAgICAgICAgICB4ID0gdi54O1xuXG4gICAgICAgICAgICBpZiAoeCA+IDEpIHtcbiAgICAgICAgICAgICAgICB4ID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh4IDwgLTEpIHtcbiAgICAgICAgICAgICAgICB4ID0gLTE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGNyZWF0ZXMgYSBuaWNlIGN1cnZlIHdpdGggelxuICAgICAgICAgICAgeCA9IHggKiBhbmdsZTQ1O1xuICAgICAgICAgICAgeiA9IHggKyBhbmdsZTkwO1xuXG4gICAgICAgICAgICBpZiAoeiA+IGFuZ2xlOTApIHtcbiAgICAgICAgICAgICAgICB6ID0gTWF0aC5QSSAtIHo7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHYueCA9IE1hdGguc2luKHgpO1xuICAgICAgICAgICAgdi56ID0gTWF0aC5zaW4oeik7XG4gICAgICAgIH1cbiAgICAgICAgc2V0UG9zaXRpb24obm9kZSwgdik7XG4gICAgfTtcblxuICAgIC8vIHNldCB0aGUgcG9zaXRpb24gdGhlIGF1ZGlvIGlzIGNvbWluZyBmcm9tKVxuICAgIG5vZGUuc2V0U291cmNlUG9zaXRpb24gPSBmdW5jdGlvbiAoeCwgeSwgeikge1xuICAgICAgICBzZXRQb3NpdGlvbihub2RlLCB2ZWNQb29sLmdldCh4LCB5LCB6KSk7XG4gICAgfTtcblxuICAgIC8vIHNldCB0aGUgZGlyZWN0aW9uIHRoZSBhdWRpbyBpcyBjb21pbmcgZnJvbSlcbiAgICBub2RlLnNldFNvdXJjZU9yaWVudGF0aW9uID0gZnVuY3Rpb24gKHgsIHksIHopIHtcbiAgICAgICAgc2V0T3JpZW50YXRpb24obm9kZSwgdmVjUG9vbC5nZXQoeCwgeSwgeikpO1xuICAgIH07XG5cbiAgICAvLyBzZXQgdGhlIHBvc2l0aW9uIG9mIHdobyBvciB3aGF0IGlzIGhlYXJpbmcgdGhlIGF1ZGlvIChjb3VsZCBiZSBjYW1lcmEgb3Igc29tZSBjaGFyYWN0ZXIpXG4gICAgbm9kZS5zZXRMaXN0ZW5lclBvc2l0aW9uID0gZnVuY3Rpb24gKHgsIHksIHopIHtcbiAgICAgICAgc2V0UG9zaXRpb24oY29udGV4dC5saXN0ZW5lciwgdmVjUG9vbC5nZXQoeCwgeSwgeikpO1xuICAgIH07XG5cbiAgICAvLyBzZXQgdGhlIHBvc2l0aW9uIG9mIHdobyBvciB3aGF0IGlzIGhlYXJpbmcgdGhlIGF1ZGlvIChjb3VsZCBiZSBjYW1lcmEgb3Igc29tZSBjaGFyYWN0ZXIpXG4gICAgbm9kZS5zZXRMaXN0ZW5lck9yaWVudGF0aW9uID0gZnVuY3Rpb24gKHgsIHksIHopIHtcbiAgICAgICAgc2V0T3JpZW50YXRpb24oY29udGV4dC5saXN0ZW5lciwgdmVjUG9vbC5nZXQoeCwgeSwgeikpO1xuICAgIH07XG5cbiAgICBub2RlLmdldERlZmF1bHRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gUGFubmVyLmRlZmF1bHRzO1xuICAgIH07XG5cbiAgICBub2RlLnNldERlZmF1bHRzID0gZnVuY3Rpb24gKGRlZmF1bHRzKSB7XG4gICAgICAgIE9iamVjdC5rZXlzKGRlZmF1bHRzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgIFBhbm5lci5kZWZhdWx0c1trZXldID0gZGVmYXVsdHNba2V5XTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHJldHVybiBub2RlO1xufVxuXG5QYW5uZXIuZGVmYXVsdHMgPSB7XG4gICAgcGFubmluZ01vZGVsOiAnSFJURicsXG4gICAgZGlzdGFuY2VNb2RlbDogJ2xpbmVhcicsXG4gICAgcmVmRGlzdGFuY2U6IDEsXG4gICAgbWF4RGlzdGFuY2U6IDEwMDAsXG4gICAgcm9sbG9mZkZhY3RvcjogMSxcbiAgICBjb25lSW5uZXJBbmdsZTogMzYwLFxuICAgIGNvbmVPdXRlckFuZ2xlOiAwLFxuICAgIGNvbmVPdXRlckdhaW46IDBcbn07XG5cbmZ1bmN0aW9uIFBoYXNlcihjb250ZXh0KSB7XG4gICAgdmFyIGNvbmZpZyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/IHt9IDogYXJndW1lbnRzWzFdO1xuXG4gICAgdmFyIHN0YWdlcyA9IG51bWJlcihjb25maWcuc3RhZ2VzLCA4KTtcbiAgICB2YXIgZmlsdGVycyA9IFtdO1xuICAgIHZhciBmaWx0ZXIgPSB2b2lkIDA7XG5cbiAgICB2YXIgaW5wdXQgPSBjb250ZXh0LmNyZWF0ZUdhaW4oKTtcbiAgICB2YXIgZmVlZGJhY2sgPSBjb250ZXh0LmNyZWF0ZUdhaW4oKTtcbiAgICB2YXIgbGZvID0gY29udGV4dC5jcmVhdGVPc2NpbGxhdG9yKCk7XG4gICAgdmFyIGxmb0dhaW4gPSBjb250ZXh0LmNyZWF0ZUdhaW4oKTtcbiAgICB2YXIgb3V0cHV0ID0gY29udGV4dC5jcmVhdGVHYWluKCk7XG5cbiAgICBmZWVkYmFjay5nYWluLnZhbHVlID0gbnVtYmVyKGNvbmZpZy5mZWVkYmFjaywgMC41KTtcblxuICAgIGxmby50eXBlID0gJ3NpbmUnO1xuICAgIGxmby5mcmVxdWVuY3kudmFsdWUgPSBudW1iZXIoY29uZmlnLmZyZXF1ZW5jeSwgMC41KTtcbiAgICBsZm9HYWluLmdhaW4udmFsdWUgPSBudW1iZXIoY29uZmlnLmdhaW4sIDMwMCk7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0YWdlczsgaSsrKSB7XG4gICAgICAgIGZpbHRlciA9IGNvbnRleHQuY3JlYXRlQmlxdWFkRmlsdGVyKCk7XG4gICAgICAgIGZpbHRlci50eXBlID0gJ2FsbHBhc3MnO1xuICAgICAgICBmaWx0ZXIuZnJlcXVlbmN5LnZhbHVlID0gMTAwMCAqIGk7XG4gICAgICAgIC8vZmlsdGVyLlEudmFsdWUgPSAxMDtcbiAgICAgICAgaWYgKGkgPiAwKSB7XG4gICAgICAgICAgICBmaWx0ZXJzW2kgLSAxXS5jb25uZWN0KGZpbHRlcik7XG4gICAgICAgIH1cbiAgICAgICAgbGZvR2Fpbi5jb25uZWN0KGZpbHRlci5mcmVxdWVuY3kpO1xuXG4gICAgICAgIGZpbHRlcnMucHVzaChmaWx0ZXIpO1xuICAgIH1cblxuICAgIHZhciBmaXJzdCA9IGZpbHRlcnNbMF07XG4gICAgdmFyIGxhc3QgPSBmaWx0ZXJzW2ZpbHRlcnMubGVuZ3RoIC0gMV07XG5cbiAgICBpbnB1dC5jb25uZWN0KGZpcnN0KTtcbiAgICBpbnB1dC5jb25uZWN0KG91dHB1dCk7XG4gICAgbGFzdC5jb25uZWN0KG91dHB1dCk7XG4gICAgbGFzdC5jb25uZWN0KGZlZWRiYWNrKTtcbiAgICBmZWVkYmFjay5jb25uZWN0KGZpcnN0KTtcbiAgICBsZm8uY29ubmVjdChsZm9HYWluKTtcbiAgICBsZm8uc3RhcnQoMCk7XG5cbiAgICB2YXIgbm9kZSA9IGlucHV0O1xuICAgIG5vZGUubmFtZSA9ICdQaGFzZXInO1xuICAgIG5vZGUuX291dHB1dCA9IG91dHB1dDtcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKG5vZGUsIHtcbiAgICAgICAgbGZvRnJlcXVlbmN5OiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbGZvLmZyZXF1ZW5jeS52YWx1ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGxmby5mcmVxdWVuY3kudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgbGZvR2Fpbjoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxmb0dhaW4uZ2Fpbi52YWx1ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGxmb0dhaW4uZ2Fpbi52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBmZWVkYmFjazoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZlZWRiYWNrLmdhaW4udmFsdWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBmZWVkYmFjay5nYWluLnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBub2RlO1xufVxuXG5mdW5jdGlvbiBSZWNvcmRlcihjb250ZXh0LCBwYXNzVGhyb3VnaCkge1xuICAgIHZhciBidWZmZXJMZW5ndGggPSA0MDk2LFxuICAgICAgICBidWZmZXJzTCA9IFtdLFxuICAgICAgICBidWZmZXJzUiA9IFtdO1xuICAgIHZhciBzdGFydGVkQXQgPSAwLFxuICAgICAgICBzdG9wcGVkQXQgPSAwO1xuXG4gICAgdmFyIGlucHV0ID0gY29udGV4dC5jcmVhdGVHYWluKCk7XG4gICAgdmFyIG91dHB1dCA9IGNvbnRleHQuY3JlYXRlR2FpbigpO1xuICAgIHZhciBzY3JpcHQgPSB2b2lkIDA7XG5cbiAgICB2YXIgbm9kZSA9IGlucHV0O1xuICAgIG5vZGUubmFtZSA9ICdSZWNvcmRlcic7XG4gICAgbm9kZS5fb3V0cHV0ID0gb3V0cHV0O1xuXG4gICAgbm9kZS5pc1JlY29yZGluZyA9IGZhbHNlO1xuXG4gICAgZnVuY3Rpb24gbWVyZ2VCdWZmZXJzKGJ1ZmZlcnMsIGxlbmd0aCkge1xuICAgICAgICB2YXIgYnVmZmVyID0gbmV3IEZsb2F0MzJBcnJheShsZW5ndGgpO1xuICAgICAgICB2YXIgb2Zmc2V0ID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBidWZmZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBidWZmZXIuc2V0KGJ1ZmZlcnNbaV0sIG9mZnNldCk7XG4gICAgICAgICAgICBvZmZzZXQgKz0gYnVmZmVyc1tpXS5sZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJ1ZmZlcjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRCdWZmZXIoKSB7XG4gICAgICAgIGlmICghYnVmZmVyc0wubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gY29udGV4dC5jcmVhdGVCdWZmZXIoMiwgYnVmZmVyTGVuZ3RoLCBjb250ZXh0LnNhbXBsZVJhdGUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZWNvcmRpbmdMZW5ndGggPSBidWZmZXJzTC5sZW5ndGggKiBidWZmZXJMZW5ndGg7XG4gICAgICAgIHZhciBidWZmZXIgPSBjb250ZXh0LmNyZWF0ZUJ1ZmZlcigyLCByZWNvcmRpbmdMZW5ndGgsIGNvbnRleHQuc2FtcGxlUmF0ZSk7XG4gICAgICAgIGJ1ZmZlci5nZXRDaGFubmVsRGF0YSgwKS5zZXQobWVyZ2VCdWZmZXJzKGJ1ZmZlcnNMLCByZWNvcmRpbmdMZW5ndGgpKTtcbiAgICAgICAgYnVmZmVyLmdldENoYW5uZWxEYXRhKDEpLnNldChtZXJnZUJ1ZmZlcnMoYnVmZmVyc1IsIHJlY29yZGluZ0xlbmd0aCkpO1xuICAgICAgICByZXR1cm4gYnVmZmVyO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlc3Ryb3lTY3JpcHRQcm9jZXNzb3IoKSB7XG4gICAgICAgIGlmIChzY3JpcHQpIHtcbiAgICAgICAgICAgIHNjcmlwdC5vbmF1ZGlvcHJvY2VzcyA9IG51bGw7XG4gICAgICAgICAgICBpbnB1dC5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICBzY3JpcHQuZGlzY29ubmVjdCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlU2NyaXB0UHJvY2Vzc29yKCkge1xuICAgICAgICBkZXN0cm95U2NyaXB0UHJvY2Vzc29yKCk7XG5cbiAgICAgICAgc2NyaXB0ID0gY29udGV4dC5jcmVhdGVTY3JpcHRQcm9jZXNzb3IoYnVmZmVyTGVuZ3RoLCAyLCAyKTtcbiAgICAgICAgaW5wdXQuY29ubmVjdChzY3JpcHQpO1xuICAgICAgICBzY3JpcHQuY29ubmVjdChjb250ZXh0LmRlc3RpbmF0aW9uKTtcbiAgICAgICAgc2NyaXB0LmNvbm5lY3Qob3V0cHV0KTtcblxuICAgICAgICBzY3JpcHQub25hdWRpb3Byb2Nlc3MgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIHZhciBpbnB1dEwgPSBldmVudC5pbnB1dEJ1ZmZlci5nZXRDaGFubmVsRGF0YSgwKTtcbiAgICAgICAgICAgIHZhciBpbnB1dFIgPSBldmVudC5pbnB1dEJ1ZmZlci5nZXRDaGFubmVsRGF0YSgxKTtcblxuICAgICAgICAgICAgaWYgKHBhc3NUaHJvdWdoKSB7XG4gICAgICAgICAgICAgICAgdmFyIG91dHB1dEwgPSBldmVudC5vdXRwdXRCdWZmZXIuZ2V0Q2hhbm5lbERhdGEoMCk7XG4gICAgICAgICAgICAgICAgdmFyIG91dHB1dFIgPSBldmVudC5vdXRwdXRCdWZmZXIuZ2V0Q2hhbm5lbERhdGEoMSk7XG4gICAgICAgICAgICAgICAgb3V0cHV0TC5zZXQoaW5wdXRMKTtcbiAgICAgICAgICAgICAgICBvdXRwdXRSLnNldChpbnB1dFIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobm9kZS5pc1JlY29yZGluZykge1xuICAgICAgICAgICAgICAgIGJ1ZmZlcnNMLnB1c2gobmV3IEZsb2F0MzJBcnJheShpbnB1dEwpKTtcbiAgICAgICAgICAgICAgICBidWZmZXJzUi5wdXNoKG5ldyBGbG9hdDMyQXJyYXkoaW5wdXRSKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgbm9kZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY3JlYXRlU2NyaXB0UHJvY2Vzc29yKCk7XG4gICAgICAgIGJ1ZmZlcnNMLmxlbmd0aCA9IDA7XG4gICAgICAgIGJ1ZmZlcnNSLmxlbmd0aCA9IDA7XG4gICAgICAgIHN0YXJ0ZWRBdCA9IGNvbnRleHQuY3VycmVudFRpbWU7XG4gICAgICAgIHN0b3BwZWRBdCA9IDA7XG4gICAgICAgIHRoaXMuaXNSZWNvcmRpbmcgPSB0cnVlO1xuICAgIH07XG5cbiAgICBub2RlLnN0b3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHN0b3BwZWRBdCA9IGNvbnRleHQuY3VycmVudFRpbWU7XG4gICAgICAgIHRoaXMuaXNSZWNvcmRpbmcgPSBmYWxzZTtcbiAgICAgICAgZGVzdHJveVNjcmlwdFByb2Nlc3NvcigpO1xuICAgICAgICByZXR1cm4gZ2V0QnVmZmVyKCk7XG4gICAgfTtcblxuICAgIG5vZGUuZ2V0RHVyYXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc1JlY29yZGluZykge1xuICAgICAgICAgICAgcmV0dXJuIHN0b3BwZWRBdCAtIHN0YXJ0ZWRBdDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29udGV4dC5jdXJyZW50VGltZSAtIHN0YXJ0ZWRBdDtcbiAgICB9O1xuXG4gICAgcmV0dXJuIG5vZGU7XG59XG5cbmZ1bmN0aW9uIFJldmVyYihjb250ZXh0KSB7XG4gICAgdmFyIGNvbmZpZyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/IHt9IDogYXJndW1lbnRzWzFdO1xuXG4gICAgdmFyIHJhdGUgPSBjb250ZXh0LnNhbXBsZVJhdGU7XG5cbiAgICB2YXIgdGltZSA9IG51bWJlcihjb25maWcudGltZSwgMSk7XG4gICAgdmFyIGRlY2F5ID0gbnVtYmVyKGNvbmZpZy5kZWNheSwgNSk7XG4gICAgdmFyIHJldmVyc2UgPSAhIWNvbmZpZy5yZXZlcnNlO1xuICAgIHZhciBsZW5ndGggPSB2b2lkIDA7XG4gICAgdmFyIGltcHVsc2VSZXNwb25zZSA9IHZvaWQgMDtcblxuICAgIHZhciBpbnB1dCA9IGNvbnRleHQuY3JlYXRlR2FpbigpO1xuICAgIHZhciByZXZlcmIgPSBjb250ZXh0LmNyZWF0ZUNvbnZvbHZlcigpO1xuICAgIHZhciBvdXRwdXQgPSBjb250ZXh0LmNyZWF0ZUdhaW4oKTtcblxuICAgIGlucHV0LmNvbm5lY3QocmV2ZXJiKTtcbiAgICBpbnB1dC5jb25uZWN0KG91dHB1dCk7XG4gICAgcmV2ZXJiLmNvbm5lY3Qob3V0cHV0KTtcblxuICAgIHZhciBub2RlID0gaW5wdXQ7XG4gICAgbm9kZS5uYW1lID0gJ1JldmVyYic7XG4gICAgbm9kZS5fb3V0cHV0ID0gb3V0cHV0O1xuXG4gICAgbm9kZS51cGRhdGUgPSBmdW5jdGlvbiAob3B0KSB7XG4gICAgICAgIGlmICh0eXBlb2Ygb3B0LnRpbWUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICB0aW1lID0gb3B0LnRpbWU7XG4gICAgICAgICAgICBsZW5ndGggPSBNYXRoLmZsb29yKHJhdGUgKiB0aW1lKTtcbiAgICAgICAgICAgIGltcHVsc2VSZXNwb25zZSA9IGxlbmd0aCA/IGNvbnRleHQuY3JlYXRlQnVmZmVyKDIsIGxlbmd0aCwgcmF0ZSkgOiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2Ygb3B0LmRlY2F5ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgZGVjYXkgPSBvcHQuZGVjYXk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBvcHQucmV2ZXJzZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHJldmVyc2UgPSBvcHQucmV2ZXJzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghaW1wdWxzZVJlc3BvbnNlKSB7XG4gICAgICAgICAgICByZXZlcmIuYnVmZmVyID0gbnVsbDtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBsZWZ0ID0gaW1wdWxzZVJlc3BvbnNlLmdldENoYW5uZWxEYXRhKDApO1xuICAgICAgICB2YXIgcmlnaHQgPSBpbXB1bHNlUmVzcG9uc2UuZ2V0Q2hhbm5lbERhdGEoMSk7XG4gICAgICAgIHZhciBuID0gdm9pZCAwLFxuICAgICAgICAgICAgZSA9IHZvaWQgMDtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBuID0gcmV2ZXJzZSA/IGxlbmd0aCAtIGkgOiBpO1xuICAgICAgICAgICAgZSA9IE1hdGgucG93KDEgLSBuIC8gbGVuZ3RoLCBkZWNheSk7XG4gICAgICAgICAgICBsZWZ0W2ldID0gKE1hdGgucmFuZG9tKCkgKiAyIC0gMSkgKiBlO1xuICAgICAgICAgICAgcmlnaHRbaV0gPSAoTWF0aC5yYW5kb20oKSAqIDIgLSAxKSAqIGU7XG4gICAgICAgIH1cblxuICAgICAgICByZXZlcmIuYnVmZmVyID0gaW1wdWxzZVJlc3BvbnNlO1xuICAgIH07XG5cbiAgICBub2RlLnVwZGF0ZSh7XG4gICAgICAgIHRpbWU6IHRpbWUsXG4gICAgICAgIGRlY2F5OiBkZWNheSxcbiAgICAgICAgcmV2ZXJzZTogcmV2ZXJzZVxuICAgIH0pO1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMobm9kZSwge1xuICAgICAgICB0aW1lOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGltZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gdGltZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgdGltZTogdmFsdWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZGVjYXk6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWNheTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gZGVjYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIGRlY2F5OiB2YWx1ZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXZlcnNlOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmV2ZXJzZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gcmV2ZXJzZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgcmV2ZXJzZTogISF2YWx1ZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gbm9kZTtcbn1cblxuZnVuY3Rpb24gRWZmZWN0KGNvbnRleHQpIHtcbiAgICBjb250ZXh0ID0gY29udGV4dCB8fCBuZXcgRmFrZUNvbnRleHQoKTtcbiAgICB2YXIgcGFubmluZyA9IG5ldyBQYW5uZXIoY29udGV4dCk7XG5cbiAgICB2YXIgYXBpID0gbnVsbCxcbiAgICAgICAgZGVzdGluYXRpb24gPSB2b2lkIDAsXG4gICAgICAgIG5vZGVMaXN0ID0gW10sXG4gICAgICAgIHNvdXJjZU5vZGUgPSB2b2lkIDA7XG5cbiAgICBmdW5jdGlvbiBjb25uZWN0KGEsIGIpIHtcbiAgICAgICAgLy9jb25zb2xlLmxvZygnPiBjb25uZWN0JywgKGEubmFtZSB8fCBhLmNvbnN0cnVjdG9yLm5hbWUpLCAndG8nLCAoYi5uYW1lIHx8IGIuY29uc3RydWN0b3IubmFtZSkpO1xuXG4gICAgICAgIHZhciBvdXRwdXQgPSBhLl9vdXRwdXQgfHwgYTtcbiAgICAgICAgLy9jb25zb2xlLmxvZygnPiBkaXNjb25uZWN0IG91dHB1dDogJywgKGEubmFtZSB8fCBhLmNvbnN0cnVjdG9yLm5hbWUpKTtcbiAgICAgICAgb3V0cHV0LmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgLy9jb25zb2xlLmxvZygnPiBjb25uZWN0IG91dHB1dDogJywoYS5uYW1lIHx8IGEuY29uc3RydWN0b3IubmFtZSksICd0byBpbnB1dDonLCAoYi5uYW1lIHx8IGIuY29uc3RydWN0b3IubmFtZSkpO1xuICAgICAgICBvdXRwdXQuY29ubmVjdChiKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb25uZWN0VG9EZXN0aW5hdGlvbihub2RlKSB7XG4gICAgICAgIHZhciBsID0gbm9kZUxpc3QubGVuZ3RoO1xuICAgICAgICB2YXIgbGFzdE5vZGUgPSBsID8gbm9kZUxpc3RbbCAtIDFdIDogc291cmNlTm9kZTtcblxuICAgICAgICBpZiAobGFzdE5vZGUpIHtcbiAgICAgICAgICAgIGNvbm5lY3QobGFzdE5vZGUsIG5vZGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgZGVzdGluYXRpb24gPSBub2RlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVwZGF0ZUNvbm5lY3Rpb25zKCkge1xuICAgICAgICBpZiAoIXNvdXJjZU5vZGUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vY29uc29sZS5sb2coJ3VwZGF0ZUNvbm5lY3Rpb25zOicsIG5vZGVMaXN0Lmxlbmd0aCk7XG5cbiAgICAgICAgdmFyIG5vZGUgPSB2b2lkIDAsXG4gICAgICAgICAgICBwcmV2ID0gdm9pZCAwO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZUxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG5vZGUgPSBub2RlTGlzdFtpXTtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coaSwgbm9kZSk7XG4gICAgICAgICAgICBwcmV2ID0gaSA9PT0gMCA/IHNvdXJjZU5vZGUgOiBub2RlTGlzdFtpIC0gMV07XG4gICAgICAgICAgICBjb25uZWN0KHByZXYsIG5vZGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRlc3RpbmF0aW9uKSB7XG4gICAgICAgICAgICBjb25uZWN0VG9EZXN0aW5hdGlvbihkZXN0aW5hdGlvbik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBoYXMobm9kZSkge1xuICAgICAgICBpZiAoIW5vZGUpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbm9kZUxpc3QuaW5kZXhPZihub2RlKSA+IC0xO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZChub2RlKSB7XG4gICAgICAgIGlmICghbm9kZSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGhhcyhub2RlKSkge1xuICAgICAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICAgIH1cbiAgICAgICAgbm9kZUxpc3QucHVzaChub2RlKTtcbiAgICAgICAgdXBkYXRlQ29ubmVjdGlvbnMoKTtcbiAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVtb3ZlKG5vZGUpIHtcbiAgICAgICAgaWYgKCFub2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWhhcyhub2RlKSkge1xuICAgICAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGwgPSBub2RlTGlzdC5sZW5ndGg7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAobm9kZSA9PT0gbm9kZUxpc3RbaV0pIHtcbiAgICAgICAgICAgICAgICBub2RlTGlzdC5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG91dHB1dCA9IG5vZGUuX291dHB1dCB8fCBub2RlO1xuICAgICAgICBvdXRwdXQuZGlzY29ubmVjdCgpO1xuICAgICAgICB1cGRhdGVDb25uZWN0aW9ucygpO1xuICAgICAgICByZXR1cm4gbm9kZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB0b2dnbGUobm9kZSwgZm9yY2UpIHtcbiAgICAgICAgZm9yY2UgPSAhIWZvcmNlO1xuICAgICAgICB2YXIgaGFzTm9kZSA9IGhhcyhub2RlKTtcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGhhc05vZGUgPT09IGZvcmNlKSB7XG4gICAgICAgICAgICByZXR1cm4gYXBpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChoYXNOb2RlKSB7XG4gICAgICAgICAgICByZW1vdmUobm9kZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhZGQobm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFwaTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZW1vdmVBbGwoKSB7XG4gICAgICAgIHdoaWxlIChub2RlTGlzdC5sZW5ndGgpIHtcbiAgICAgICAgICAgIG5vZGVMaXN0LnBvcCgpLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgfVxuICAgICAgICB1cGRhdGVDb25uZWN0aW9ucygpO1xuICAgICAgICByZXR1cm4gYXBpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgIHJlbW92ZUFsbCgpO1xuICAgICAgICBjb250ZXh0ID0gbnVsbDtcbiAgICAgICAgZGVzdGluYXRpb24gPSBudWxsO1xuICAgICAgICBub2RlTGlzdCA9IFtdO1xuICAgICAgICBpZiAoc291cmNlTm9kZSkge1xuICAgICAgICAgICAgc291cmNlTm9kZS5kaXNjb25uZWN0KCk7XG4gICAgICAgIH1cbiAgICAgICAgc291cmNlTm9kZSA9IG51bGw7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBFZmZlY3RzXG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBhbmFseXNlcihjb25maWcpIHtcbiAgICAgICAgcmV0dXJuIGFkZChuZXcgQW5hbHlzZXIoY29udGV4dCwgY29uZmlnKSk7XG4gICAgfVxuXG4gICAgLy8gbG93ZXJzIHRoZSB2b2x1bWUgb2YgdGhlIGxvdWRlc3QgcGFydHMgb2YgdGhlIHNpZ25hbCBhbmQgcmFpc2VzIHRoZSB2b2x1bWUgb2YgdGhlIHNvZnRlc3QgcGFydHNcbiAgICBmdW5jdGlvbiBjb21wcmVzc29yKG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIG5vZGUgPSBjb250ZXh0LmNyZWF0ZUR5bmFtaWNzQ29tcHJlc3NvcigpO1xuXG4gICAgICAgIG5vZGUudXBkYXRlID0gZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICAgICAgLy8gbWluIGRlY2liZWxzIHRvIHN0YXJ0IGNvbXByZXNzaW5nIGF0IGZyb20gLTEwMCB0byAwXG4gICAgICAgICAgICBub2RlLnRocmVzaG9sZC52YWx1ZSA9IHR5cGVvZiBjb25maWcudGhyZXNob2xkICE9PSAndW5kZWZpbmVkJyA/IGNvbmZpZy50aHJlc2hvbGQgOiAtMjQ7XG4gICAgICAgICAgICAvLyBkZWNpYmVsIHZhbHVlIHRvIHN0YXJ0IGN1cnZlIHRvIGNvbXByZXNzZWQgdmFsdWUgZnJvbSAwIHRvIDQwXG4gICAgICAgICAgICBub2RlLmtuZWUudmFsdWUgPSB0eXBlb2YgY29uZmlnLmtuZWUgIT09ICd1bmRlZmluZWQnID8gY29uZmlnLmtuZWUgOiAzMDtcbiAgICAgICAgICAgIC8vIGFtb3VudCBvZiBjaGFuZ2UgcGVyIGRlY2liZWwgZnJvbSAxIHRvIDIwXG4gICAgICAgICAgICBub2RlLnJhdGlvLnZhbHVlID0gdHlwZW9mIGNvbmZpZy5yYXRpbyAhPT0gJ3VuZGVmaW5lZCcgPyBjb25maWcucmF0aW8gOiAxMjtcbiAgICAgICAgICAgIC8vIGdhaW4gcmVkdWN0aW9uIGN1cnJlbnRseSBhcHBsaWVkIGJ5IGNvbXByZXNzb3IgZnJvbSAtMjAgdG8gMFxuICAgICAgICAgICAgLy8gbm9kZS5yZWR1Y3Rpb24udmFsdWUgPSB0eXBlb2YgY29uZmlnLnJlZHVjdGlvbiAhPT0gJ3VuZGVmaW5lZCcgPyBjb25maWcucmVkdWN0aW9uIDogLTEwOylcbiAgICAgICAgICAgIC8vIHNlY29uZHMgdG8gcmVkdWNlIGdhaW4gYnkgMTBkYiBmcm9tIDAgdG8gMSAtIGhvdyBxdWlja2x5IHNpZ25hbCBhZGFwdGVkIHdoZW4gdm9sdW1lIGluY3JlYXNlZFxuICAgICAgICAgICAgbm9kZS5hdHRhY2sudmFsdWUgPSB0eXBlb2YgY29uZmlnLmF0dGFjayAhPT0gJ3VuZGVmaW5lZCcgPyBjb25maWcuYXR0YWNrIDogMC4wMDAzO1xuICAgICAgICAgICAgLy8gc2Vjb25kcyB0byBpbmNyZWFzZSBnYWluIGJ5IDEwZGIgZnJvbSAwIHRvIDEgLSBob3cgcXVpY2tseSBzaWduYWwgYWRhcHRlZCB3aGVuIHZvbHVtZSByZWRjdWNlZFxuICAgICAgICAgICAgbm9kZS5yZWxlYXNlLnZhbHVlID0gdHlwZW9mIGNvbmZpZy5yZWxlYXNlICE9PSAndW5kZWZpbmVkJyA/IGNvbmZpZy5yZWxlYXNlIDogMC4yNTtcbiAgICAgICAgfTtcblxuICAgICAgICBub2RlLnVwZGF0ZShvcHRpb25zIHx8IHt9KTtcblxuICAgICAgICByZXR1cm4gYWRkKG5vZGUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNvbnZvbHZlcihpbXB1bHNlUmVzcG9uc2UpIHtcbiAgICAgICAgLy8gaW1wdWxzZVJlc3BvbnNlIGlzIGFuIGF1ZGlvIGZpbGUgYnVmZmVyXG4gICAgICAgIHZhciBub2RlID0gY29udGV4dC5jcmVhdGVDb252b2x2ZXIoKTtcbiAgICAgICAgbm9kZS5idWZmZXIgPSBpbXB1bHNlUmVzcG9uc2U7XG4gICAgICAgIHJldHVybiBhZGQobm9kZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVsYXkodGltZSkge1xuICAgICAgICB2YXIgbm9kZSA9IGNvbnRleHQuY3JlYXRlRGVsYXkoKTtcbiAgICAgICAgaWYgKHR5cGVvZiB0aW1lICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgbm9kZS5kZWxheVRpbWUudmFsdWUgPSB0aW1lO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhZGQobm9kZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZWNobyhjb25maWcpIHtcbiAgICAgICAgcmV0dXJuIGFkZChuZXcgRWNobyhjb250ZXh0LCBjb25maWcpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkaXN0b3J0aW9uKGFtb3VudCkge1xuICAgICAgICAvLyBGbG9hdDMyQXJyYXkgZGVmaW5pbmcgY3VydmUgKHZhbHVlcyBhcmUgaW50ZXJwb2xhdGVkKVxuICAgICAgICAvL25vZGUuY3VydmVcbiAgICAgICAgLy8gdXAtc2FtcGxlIGJlZm9yZSBhcHBseWluZyBjdXJ2ZSBmb3IgYmV0dGVyIHJlc29sdXRpb24gcmVzdWx0ICdub25lJywgJzJ4JyBvciAnNHgnXG4gICAgICAgIC8vbm9kZS5vdmVyc2FtcGxlID0gJzJ4JztcbiAgICAgICAgcmV0dXJuIGFkZChuZXcgRGlzdG9ydGlvbihjb250ZXh0LCBhbW91bnQpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmaWx0ZXIodHlwZSwgZnJlcXVlbmN5LCBxLCBnYWluKSB7XG4gICAgICAgIHJldHVybiBhZGQobmV3IEZpbHRlcihjb250ZXh0LCB7IHR5cGU6IHR5cGUsIGZyZXF1ZW5jeTogZnJlcXVlbmN5LCBxOiBxLCBnYWluOiBnYWluIH0pKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsb3dwYXNzKGZyZXF1ZW5jeSwgcGVhaykge1xuICAgICAgICByZXR1cm4gZmlsdGVyKCdsb3dwYXNzJywgeyBmcmVxdWVuY3k6IGZyZXF1ZW5jeSwgcTogcGVhayB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBoaWdocGFzcyhmcmVxdWVuY3ksIHBlYWspIHtcbiAgICAgICAgcmV0dXJuIGZpbHRlcignaGlnaHBhc3MnLCB7IGZyZXF1ZW5jeTogZnJlcXVlbmN5LCBxOiBwZWFrIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGJhbmRwYXNzKGZyZXF1ZW5jeSwgd2lkdGgpIHtcbiAgICAgICAgcmV0dXJuIGZpbHRlcignYmFuZHBhc3MnLCB7IGZyZXF1ZW5jeTogZnJlcXVlbmN5LCBxOiB3aWR0aCB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsb3dzaGVsZihmcmVxdWVuY3ksIGdhaW4pIHtcbiAgICAgICAgcmV0dXJuIGZpbHRlcignbG93c2hlbGYnLCB7IGZyZXF1ZW5jeTogZnJlcXVlbmN5LCBxOiAwLCBnYWluOiBnYWluIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGhpZ2hzaGVsZihmcmVxdWVuY3ksIGdhaW4pIHtcbiAgICAgICAgcmV0dXJuIGZpbHRlcignaGlnaHNoZWxmJywgeyBmcmVxdWVuY3k6IGZyZXF1ZW5jeSwgcTogMCwgZ2FpbjogZ2FpbiB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwZWFraW5nKGZyZXF1ZW5jeSwgd2lkdGgsIGdhaW4pIHtcbiAgICAgICAgcmV0dXJuIGZpbHRlcigncGVha2luZycsIHsgZnJlcXVlbmN5OiBmcmVxdWVuY3ksIHE6IHdpZHRoLCBnYWluOiBnYWluIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5vdGNoKGZyZXF1ZW5jeSwgd2lkdGgsIGdhaW4pIHtcbiAgICAgICAgcmV0dXJuIGZpbHRlcignbm90Y2gnLCB7IGZyZXF1ZW5jeTogZnJlcXVlbmN5LCBxOiB3aWR0aCwgZ2FpbjogZ2FpbiB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhbGxwYXNzKGZyZXF1ZW5jeSwgc2hhcnBuZXNzKSB7XG4gICAgICAgIHJldHVybiBmaWx0ZXIoJ2FsbHBhc3MnLCB7IGZyZXF1ZW5jeTogZnJlcXVlbmN5LCBxOiBzaGFycG5lc3MgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZmxhbmdlcihjb25maWcpIHtcbiAgICAgICAgcmV0dXJuIGFkZChuZXcgRmxhbmdlcihjb250ZXh0LCBjb25maWcpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnYWluTm9kZSh2YWx1ZSkge1xuICAgICAgICB2YXIgbm9kZSA9IGNvbnRleHQuY3JlYXRlR2FpbigpO1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgbm9kZS5nYWluLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGFubmVyKCkge1xuICAgICAgICByZXR1cm4gYWRkKG5ldyBQYW5uZXIoY29udGV4dCkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBoYXNlcihjb25maWcpIHtcbiAgICAgICAgcmV0dXJuIGFkZChuZXcgUGhhc2VyKGNvbnRleHQsIGNvbmZpZykpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlY29yZGVyKHBhc3NUaHJvdWdoKSB7XG4gICAgICAgIHJldHVybiBhZGQobmV3IFJlY29yZGVyKGNvbnRleHQsIHBhc3NUaHJvdWdoKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmV2ZXJiKHNlY29uZHMsIGRlY2F5LCByZXZlcnNlKSB7XG4gICAgICAgIHJldHVybiBhZGQobmV3IFJldmVyYihjb250ZXh0LCBzZWNvbmRzLCBkZWNheSwgcmV2ZXJzZSkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNjcmlwdCgpIHtcbiAgICAgICAgdmFyIGNvbmZpZyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMCB8fCBhcmd1bWVudHNbMF0gPT09IHVuZGVmaW5lZCA/IHt9IDogYXJndW1lbnRzWzBdO1xuXG4gICAgICAgIC8vIGJ1ZmZlclNpemUgMjU2IC0gMTYzODQgKHBvdyAyKVxuICAgICAgICB2YXIgYnVmZmVyU2l6ZSA9IGNvbmZpZy5idWZmZXJTaXplIHx8IDEwMjQ7XG4gICAgICAgIHZhciBpbnB1dENoYW5uZWxzID0gdHlwZW9mIGNvbmZpZy5pbnB1dENoYW5uZWxzID09PSAndW5kZWZpbmVkJyA/IDAgOiBjb25maWcuaW5wdXRDaGFubmVscztcbiAgICAgICAgdmFyIG91dHB1dENoYW5uZWxzID0gdHlwZW9mIGNvbmZpZy5vdXRwdXRDaGFubmVscyA9PT0gJ3VuZGVmaW5lZCcgPyAxIDogY29uZmlnLm91dHB1dENoYW5uZWxzO1xuXG4gICAgICAgIHZhciBub2RlID0gY29udGV4dC5jcmVhdGVTY3JpcHRQcm9jZXNzb3IoYnVmZmVyU2l6ZSwgaW5wdXRDaGFubmVscywgb3V0cHV0Q2hhbm5lbHMpO1xuXG4gICAgICAgIHZhciB0aGlzQXJnID0gY29uZmlnLnRoaXNBcmcgfHwgY29uZmlnLmNvbnRleHQgfHwgbm9kZTtcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gY29uZmlnLmNhbGxiYWNrIHx8IGZ1bmN0aW9uICgpIHt9O1xuXG4gICAgICAgIC8vIGF2YWlsYWJsZSBwcm9wczpcbiAgICAgICAgLypcbiAgICAgICAgZXZlbnQuaW5wdXRCdWZmZXJcbiAgICAgICAgZXZlbnQub3V0cHV0QnVmZmVyXG4gICAgICAgIGV2ZW50LnBsYXliYWNrVGltZVxuICAgICAgICAqL1xuICAgICAgICAvLyBFeGFtcGxlOiBnZW5lcmF0ZSBub2lzZVxuICAgICAgICAvKlxuICAgICAgICBjb25zdCBvdXRwdXQgPSBldmVudC5vdXRwdXRCdWZmZXIuZ2V0Q2hhbm5lbERhdGEoMCk7XG4gICAgICAgIGNvbnN0IGwgPSBvdXRwdXQubGVuZ3RoO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgb3V0cHV0W2ldID0gTWF0aC5yYW5kb20oKTtcbiAgICAgICAgfVxuICAgICAgICAqL1xuICAgICAgICBub2RlLm9uYXVkaW9wcm9jZXNzID0gY2FsbGJhY2suYmluZCh0aGlzQXJnKTtcblxuICAgICAgICByZXR1cm4gYWRkKG5vZGUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldFNvdXJjZShub2RlKSB7XG4gICAgICAgIHNvdXJjZU5vZGUgPSBub2RlO1xuICAgICAgICB1cGRhdGVDb25uZWN0aW9ucygpO1xuICAgICAgICByZXR1cm4gbm9kZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXREZXN0aW5hdGlvbihub2RlKSB7XG4gICAgICAgIGNvbm5lY3RUb0Rlc3RpbmF0aW9uKG5vZGUpO1xuICAgICAgICByZXR1cm4gbm9kZTtcbiAgICB9XG5cbiAgICAvL1xuXG4gICAgYXBpID0ge1xuICAgICAgICBjb250ZXh0OiBjb250ZXh0LFxuICAgICAgICBub2RlTGlzdDogbm9kZUxpc3QsXG4gICAgICAgIHBhbm5pbmc6IHBhbm5pbmcsXG5cbiAgICAgICAgaGFzOiBoYXMsXG4gICAgICAgIGFkZDogYWRkLFxuICAgICAgICByZW1vdmU6IHJlbW92ZSxcbiAgICAgICAgdG9nZ2xlOiB0b2dnbGUsXG4gICAgICAgIHJlbW92ZUFsbDogcmVtb3ZlQWxsLFxuICAgICAgICBkZXN0cm95OiBkZXN0cm95LFxuICAgICAgICBzZXRTb3VyY2U6IHNldFNvdXJjZSxcbiAgICAgICAgc2V0RGVzdGluYXRpb246IHNldERlc3RpbmF0aW9uLFxuXG4gICAgICAgIGFuYWx5c2VyOiBhbmFseXNlcixcbiAgICAgICAgY29tcHJlc3NvcjogY29tcHJlc3NvcixcbiAgICAgICAgY29udm9sdmVyOiBjb252b2x2ZXIsXG4gICAgICAgIGRlbGF5OiBkZWxheSxcbiAgICAgICAgZWNobzogZWNobyxcbiAgICAgICAgZGlzdG9ydGlvbjogZGlzdG9ydGlvbixcbiAgICAgICAgZmlsdGVyOiBmaWx0ZXIsXG4gICAgICAgIGxvd3Bhc3M6IGxvd3Bhc3MsXG4gICAgICAgIGhpZ2hwYXNzOiBoaWdocGFzcyxcbiAgICAgICAgYmFuZHBhc3M6IGJhbmRwYXNzLFxuICAgICAgICBsb3dzaGVsZjogbG93c2hlbGYsXG4gICAgICAgIGhpZ2hzaGVsZjogaGlnaHNoZWxmLFxuICAgICAgICBwZWFraW5nOiBwZWFraW5nLFxuICAgICAgICBub3RjaDogbm90Y2gsXG4gICAgICAgIGFsbHBhc3M6IGFsbHBhc3MsXG4gICAgICAgIGZsYW5nZXI6IGZsYW5nZXIsXG4gICAgICAgIGdhaW46IGdhaW5Ob2RlLFxuICAgICAgICBwYW5uZXI6IHBhbm5lcixcbiAgICAgICAgcGhhc2VyOiBwaGFzZXIsXG4gICAgICAgIHJlY29yZGVyOiByZWNvcmRlcixcbiAgICAgICAgcmV2ZXJiOiByZXZlcmIsXG4gICAgICAgIHNjcmlwdDogc2NyaXB0XG4gICAgfTtcblxuICAgIHJldHVybiBPYmplY3QuZnJlZXplKGFwaSk7XG59XG5cbmZ1bmN0aW9uIEdyb3VwKGNvbnRleHQsIGRlc3RpbmF0aW9uKSB7XG4gICAgdmFyIHNvdW5kcyA9IFtdO1xuICAgIHZhciBlZmZlY3QgPSBuZXcgRWZmZWN0KGNvbnRleHQpO1xuICAgIHZhciBnYWluID0gZWZmZWN0LmdhaW4oKTtcbiAgICB2YXIgcHJlTXV0ZVZvbHVtZSA9IDE7XG4gICAgdmFyIGdyb3VwID0gbnVsbDtcblxuICAgIGlmIChjb250ZXh0KSB7XG4gICAgICAgIGVmZmVjdC5zZXRTb3VyY2UoZ2Fpbik7XG4gICAgICAgIGVmZmVjdC5zZXREZXN0aW5hdGlvbihkZXN0aW5hdGlvbiB8fCBjb250ZXh0LmRlc3RpbmF0aW9uKTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIEFkZCAvIHJlbW92ZVxuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gZmluZChzb3VuZE9ySWQsIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBmb3VuZCA9IHZvaWQgMDtcblxuICAgICAgICBpZiAoIXNvdW5kT3JJZCAmJiBzb3VuZE9ySWQgIT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBmb3VuZDtcbiAgICAgICAgfVxuXG4gICAgICAgIHNvdW5kcy5zb21lKGZ1bmN0aW9uIChzb3VuZCkge1xuICAgICAgICAgICAgaWYgKHNvdW5kID09PSBzb3VuZE9ySWQgfHwgc291bmQuaWQgPT09IHNvdW5kT3JJZCkge1xuICAgICAgICAgICAgICAgIGZvdW5kID0gc291bmQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChmb3VuZCAmJiBjYWxsYmFjaykge1xuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGZvdW5kKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmb3VuZDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZW1vdmUoc291bmRPcklkKSB7XG4gICAgICAgIGZpbmQoc291bmRPcklkLCBmdW5jdGlvbiAoc291bmQpIHtcbiAgICAgICAgICAgIHJldHVybiBzb3VuZHMuc3BsaWNlKHNvdW5kcy5pbmRleE9mKHNvdW5kKSwgMSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZ3JvdXA7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWRkKHNvdW5kKSB7XG4gICAgICAgIHNvdW5kLmdhaW4uZGlzY29ubmVjdCgpO1xuICAgICAgICBzb3VuZC5nYWluLmNvbm5lY3QoZ2Fpbik7XG5cbiAgICAgICAgc291bmRzLnB1c2goc291bmQpO1xuXG4gICAgICAgIHNvdW5kLm9uY2UoJ2Rlc3Ryb3knLCByZW1vdmUpO1xuXG4gICAgICAgIHJldHVybiBncm91cDtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIENvbnRyb2xzXG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBwbGF5KGRlbGF5LCBvZmZzZXQpIHtcbiAgICAgICAgc291bmRzLmZvckVhY2goZnVuY3Rpb24gKHNvdW5kKSB7XG4gICAgICAgICAgICByZXR1cm4gc291bmQucGxheShkZWxheSwgb2Zmc2V0KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBncm91cDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICAgICAgc291bmRzLmZvckVhY2goZnVuY3Rpb24gKHNvdW5kKSB7XG4gICAgICAgICAgICBpZiAoc291bmQucGxheWluZykge1xuICAgICAgICAgICAgICAgIHNvdW5kLnBhdXNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZ3JvdXA7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVzdW1lKCkge1xuICAgICAgICBzb3VuZHMuZm9yRWFjaChmdW5jdGlvbiAoc291bmQpIHtcbiAgICAgICAgICAgIGlmIChzb3VuZC5wYXVzZWQpIHtcbiAgICAgICAgICAgICAgICBzb3VuZC5wbGF5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZ3JvdXA7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICAgICAgc291bmRzLmZvckVhY2goZnVuY3Rpb24gKHNvdW5kKSB7XG4gICAgICAgICAgICByZXR1cm4gc291bmQuc3RvcCgpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGdyb3VwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNlZWsocGVyY2VudCkge1xuICAgICAgICBzb3VuZHMuZm9yRWFjaChmdW5jdGlvbiAoc291bmQpIHtcbiAgICAgICAgICAgIHJldHVybiBzb3VuZC5zZWVrKHBlcmNlbnQpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGdyb3VwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG11dGUoKSB7XG4gICAgICAgIHByZU11dGVWb2x1bWUgPSBncm91cC52b2x1bWU7XG4gICAgICAgIGdyb3VwLnZvbHVtZSA9IDA7XG4gICAgICAgIHJldHVybiBncm91cDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1bk11dGUoKSB7XG4gICAgICAgIGdyb3VwLnZvbHVtZSA9IHByZU11dGVWb2x1bWUgfHwgMTtcbiAgICAgICAgcmV0dXJuIGdyb3VwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldFZvbHVtZSh2YWx1ZSkge1xuICAgICAgICBncm91cC52b2x1bWUgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGdyb3VwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZhZGUodm9sdW1lLCBkdXJhdGlvbikge1xuICAgICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICAgICAgdmFyIHBhcmFtID0gZ2Fpbi5nYWluO1xuICAgICAgICAgICAgdmFyIHRpbWUgPSBjb250ZXh0LmN1cnJlbnRUaW1lO1xuXG4gICAgICAgICAgICBwYXJhbS5jYW5jZWxTY2hlZHVsZWRWYWx1ZXModGltZSk7XG4gICAgICAgICAgICBwYXJhbS5zZXRWYWx1ZUF0VGltZShwYXJhbS52YWx1ZSwgdGltZSk7XG4gICAgICAgICAgICAvLyBwYXJhbS5zZXRWYWx1ZUF0VGltZSh2b2x1bWUsIHRpbWUgKyBkdXJhdGlvbik7XG4gICAgICAgICAgICBwYXJhbS5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSh2b2x1bWUsIHRpbWUgKyBkdXJhdGlvbik7XG4gICAgICAgICAgICAvLyBwYXJhbS5zZXRUYXJnZXRBdFRpbWUodm9sdW1lLCB0aW1lLCBkdXJhdGlvbik7XG4gICAgICAgICAgICAvLyBwYXJhbS5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lKE1hdGgubWF4KHZvbHVtZSwgMC4wMDAxKSwgdGltZSArIGR1cmF0aW9uKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNvdW5kcy5mb3JFYWNoKGZ1bmN0aW9uIChzb3VuZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzb3VuZC5mYWRlKHZvbHVtZSwgZHVyYXRpb24pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZ3JvdXA7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBMb2FkXG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBsb2FkKCkge1xuICAgICAgICBzb3VuZHMuZm9yRWFjaChmdW5jdGlvbiAoc291bmQpIHtcbiAgICAgICAgICAgIHJldHVybiBzb3VuZC5sb2FkKG51bGwsIHRydWUpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIFVubG9hZFxuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gdW5sb2FkKCkge1xuICAgICAgICBzb3VuZHMuZm9yRWFjaChmdW5jdGlvbiAoc291bmQpIHtcbiAgICAgICAgICAgIHJldHVybiBzb3VuZC51bmxvYWQoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBEZXN0cm95XG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICB3aGlsZSAoc291bmRzLmxlbmd0aCkge1xuICAgICAgICAgICAgc291bmRzLnBvcCgpLmRlc3Ryb3koKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qXG4gICAgICogQXBpXG4gICAgICovXG5cbiAgICBncm91cCA9IHtcbiAgICAgICAgYWRkOiBhZGQsXG4gICAgICAgIGZpbmQ6IGZpbmQsXG4gICAgICAgIHJlbW92ZTogcmVtb3ZlLFxuICAgICAgICBwbGF5OiBwbGF5LFxuICAgICAgICBwYXVzZTogcGF1c2UsXG4gICAgICAgIHJlc3VtZTogcmVzdW1lLFxuICAgICAgICBzdG9wOiBzdG9wLFxuICAgICAgICBzZWVrOiBzZWVrLFxuICAgICAgICBzZXRWb2x1bWU6IHNldFZvbHVtZSxcbiAgICAgICAgbXV0ZTogbXV0ZSxcbiAgICAgICAgdW5NdXRlOiB1bk11dGUsXG4gICAgICAgIGZhZGU6IGZhZGUsXG4gICAgICAgIGxvYWQ6IGxvYWQsXG4gICAgICAgIHVubG9hZDogdW5sb2FkLFxuICAgICAgICBkZXN0cm95OiBkZXN0cm95XG4gICAgfTtcblxuICAgIC8qXG4gICAgICogR2V0dGVycyAmIFNldHRlcnNcbiAgICAgKi9cblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGdyb3VwLCB7XG4gICAgICAgIGVmZmVjdDoge1xuICAgICAgICAgICAgdmFsdWU6IGVmZmVjdFxuICAgICAgICB9LFxuICAgICAgICBnYWluOiB7XG4gICAgICAgICAgICB2YWx1ZTogZ2FpblxuICAgICAgICB9LFxuICAgICAgICBzb3VuZHM6IHtcbiAgICAgICAgICAgIHZhbHVlOiBzb3VuZHNcbiAgICAgICAgfSxcbiAgICAgICAgdm9sdW1lOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2Fpbi5nYWluLnZhbHVlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzTmFOKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFsdWUgPSBNYXRoLm1pbihNYXRoLm1heCh2YWx1ZSwgMCksIDEpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2Fpbi5nYWluLmNhbmNlbFNjaGVkdWxlZFZhbHVlcyhjb250ZXh0LmN1cnJlbnRUaW1lKTtcbiAgICAgICAgICAgICAgICAgICAgZ2Fpbi5nYWluLnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGdhaW4uZ2Fpbi5zZXRWYWx1ZUF0VGltZSh2YWx1ZSwgY29udGV4dC5jdXJyZW50VGltZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZ2Fpbi5nYWluLnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNvdW5kcy5mb3JFYWNoKGZ1bmN0aW9uIChzb3VuZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXNvdW5kLmNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdW5kLmdyb3VwVm9sdW1lID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIGdyb3VwO1xufVxuXG5Hcm91cC5FZmZlY3QgPSBFZmZlY3Q7XG5cbi8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLlxuLy9cbi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhXG4vLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlXG4vLyBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmdcbi8vIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCxcbi8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXRcbi8vIHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZVxuLy8gZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWRcbi8vIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1Ncbi8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0Zcbi8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU5cbi8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLFxuLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SXG4vLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFXG4vLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG5mdW5jdGlvbiBFdmVudEVtaXR0ZXIkMSgpIHtcbiAgdGhpcy5fZXZlbnRzID0gdGhpcy5fZXZlbnRzIHx8IHt9O1xuICB0aGlzLl9tYXhMaXN0ZW5lcnMgPSB0aGlzLl9tYXhMaXN0ZW5lcnMgfHwgdW5kZWZpbmVkO1xufVxudmFyIGV2ZW50cyA9IEV2ZW50RW1pdHRlciQxO1xuXG4vLyBCYWNrd2FyZHMtY29tcGF0IHdpdGggbm9kZSAwLjEwLnhcbkV2ZW50RW1pdHRlciQxLkV2ZW50RW1pdHRlciA9IEV2ZW50RW1pdHRlciQxO1xuXG5FdmVudEVtaXR0ZXIkMS5wcm90b3R5cGUuX2V2ZW50cyA9IHVuZGVmaW5lZDtcbkV2ZW50RW1pdHRlciQxLnByb3RvdHlwZS5fbWF4TGlzdGVuZXJzID0gdW5kZWZpbmVkO1xuXG4vLyBCeSBkZWZhdWx0IEV2ZW50RW1pdHRlcnMgd2lsbCBwcmludCBhIHdhcm5pbmcgaWYgbW9yZSB0aGFuIDEwIGxpc3RlbmVycyBhcmVcbi8vIGFkZGVkIHRvIGl0LiBUaGlzIGlzIGEgdXNlZnVsIGRlZmF1bHQgd2hpY2ggaGVscHMgZmluZGluZyBtZW1vcnkgbGVha3MuXG5FdmVudEVtaXR0ZXIkMS5kZWZhdWx0TWF4TGlzdGVuZXJzID0gMTA7XG5cbi8vIE9idmlvdXNseSBub3QgYWxsIEVtaXR0ZXJzIHNob3VsZCBiZSBsaW1pdGVkIHRvIDEwLiBUaGlzIGZ1bmN0aW9uIGFsbG93c1xuLy8gdGhhdCB0byBiZSBpbmNyZWFzZWQuIFNldCB0byB6ZXJvIGZvciB1bmxpbWl0ZWQuXG5FdmVudEVtaXR0ZXIkMS5wcm90b3R5cGUuc2V0TWF4TGlzdGVuZXJzID0gZnVuY3Rpb24obikge1xuICBpZiAoIWlzTnVtYmVyKG4pIHx8IG4gPCAwIHx8IGlzTmFOKG4pKVxuICAgIHRocm93IFR5cGVFcnJvcignbiBtdXN0IGJlIGEgcG9zaXRpdmUgbnVtYmVyJyk7XG4gIHRoaXMuX21heExpc3RlbmVycyA9IG47XG4gIHJldHVybiB0aGlzO1xufTtcblxuRXZlbnRFbWl0dGVyJDEucHJvdG90eXBlLmVtaXQgPSBmdW5jdGlvbih0eXBlKSB7XG4gIHZhciBlciwgaGFuZGxlciwgbGVuLCBhcmdzLCBpLCBsaXN0ZW5lcnM7XG5cbiAgaWYgKCF0aGlzLl9ldmVudHMpXG4gICAgdGhpcy5fZXZlbnRzID0ge307XG5cbiAgLy8gSWYgdGhlcmUgaXMgbm8gJ2Vycm9yJyBldmVudCBsaXN0ZW5lciB0aGVuIHRocm93LlxuICBpZiAodHlwZSA9PT0gJ2Vycm9yJykge1xuICAgIGlmICghdGhpcy5fZXZlbnRzLmVycm9yIHx8XG4gICAgICAgIChpc09iamVjdCh0aGlzLl9ldmVudHMuZXJyb3IpICYmICF0aGlzLl9ldmVudHMuZXJyb3IubGVuZ3RoKSkge1xuICAgICAgZXIgPSBhcmd1bWVudHNbMV07XG4gICAgICBpZiAoZXIgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICB0aHJvdyBlcjsgLy8gVW5oYW5kbGVkICdlcnJvcicgZXZlbnRcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEF0IGxlYXN0IGdpdmUgc29tZSBraW5kIG9mIGNvbnRleHQgdG8gdGhlIHVzZXJcbiAgICAgICAgdmFyIGVyciA9IG5ldyBFcnJvcignVW5jYXVnaHQsIHVuc3BlY2lmaWVkIFwiZXJyb3JcIiBldmVudC4gKCcgKyBlciArICcpJyk7XG4gICAgICAgIGVyci5jb250ZXh0ID0gZXI7XG4gICAgICAgIHRocm93IGVycjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBoYW5kbGVyID0gdGhpcy5fZXZlbnRzW3R5cGVdO1xuXG4gIGlmIChpc1VuZGVmaW5lZChoYW5kbGVyKSlcbiAgICByZXR1cm4gZmFsc2U7XG5cbiAgaWYgKGlzRnVuY3Rpb24oaGFuZGxlcikpIHtcbiAgICBzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgIC8vIGZhc3QgY2FzZXNcbiAgICAgIGNhc2UgMTpcbiAgICAgICAgaGFuZGxlci5jYWxsKHRoaXMpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMjpcbiAgICAgICAgaGFuZGxlci5jYWxsKHRoaXMsIGFyZ3VtZW50c1sxXSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAzOlxuICAgICAgICBoYW5kbGVyLmNhbGwodGhpcywgYXJndW1lbnRzWzFdLCBhcmd1bWVudHNbMl0pO1xuICAgICAgICBicmVhaztcbiAgICAgIC8vIHNsb3dlclxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG4gICAgICAgIGhhbmRsZXIuYXBwbHkodGhpcywgYXJncyk7XG4gICAgfVxuICB9IGVsc2UgaWYgKGlzT2JqZWN0KGhhbmRsZXIpKSB7XG4gICAgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG4gICAgbGlzdGVuZXJzID0gaGFuZGxlci5zbGljZSgpO1xuICAgIGxlbiA9IGxpc3RlbmVycy5sZW5ndGg7XG4gICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKVxuICAgICAgbGlzdGVuZXJzW2ldLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59O1xuXG5FdmVudEVtaXR0ZXIkMS5wcm90b3R5cGUuYWRkTGlzdGVuZXIgPSBmdW5jdGlvbih0eXBlLCBsaXN0ZW5lcikge1xuICB2YXIgbTtcblxuICBpZiAoIWlzRnVuY3Rpb24obGlzdGVuZXIpKVxuICAgIHRocm93IFR5cGVFcnJvcignbGlzdGVuZXIgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG5cbiAgaWYgKCF0aGlzLl9ldmVudHMpXG4gICAgdGhpcy5fZXZlbnRzID0ge307XG5cbiAgLy8gVG8gYXZvaWQgcmVjdXJzaW9uIGluIHRoZSBjYXNlIHRoYXQgdHlwZSA9PT0gXCJuZXdMaXN0ZW5lclwiISBCZWZvcmVcbiAgLy8gYWRkaW5nIGl0IHRvIHRoZSBsaXN0ZW5lcnMsIGZpcnN0IGVtaXQgXCJuZXdMaXN0ZW5lclwiLlxuICBpZiAodGhpcy5fZXZlbnRzLm5ld0xpc3RlbmVyKVxuICAgIHRoaXMuZW1pdCgnbmV3TGlzdGVuZXInLCB0eXBlLFxuICAgICAgICAgICAgICBpc0Z1bmN0aW9uKGxpc3RlbmVyLmxpc3RlbmVyKSA/XG4gICAgICAgICAgICAgIGxpc3RlbmVyLmxpc3RlbmVyIDogbGlzdGVuZXIpO1xuXG4gIGlmICghdGhpcy5fZXZlbnRzW3R5cGVdKVxuICAgIC8vIE9wdGltaXplIHRoZSBjYXNlIG9mIG9uZSBsaXN0ZW5lci4gRG9uJ3QgbmVlZCB0aGUgZXh0cmEgYXJyYXkgb2JqZWN0LlxuICAgIHRoaXMuX2V2ZW50c1t0eXBlXSA9IGxpc3RlbmVyO1xuICBlbHNlIGlmIChpc09iamVjdCh0aGlzLl9ldmVudHNbdHlwZV0pKVxuICAgIC8vIElmIHdlJ3ZlIGFscmVhZHkgZ290IGFuIGFycmF5LCBqdXN0IGFwcGVuZC5cbiAgICB0aGlzLl9ldmVudHNbdHlwZV0ucHVzaChsaXN0ZW5lcik7XG4gIGVsc2VcbiAgICAvLyBBZGRpbmcgdGhlIHNlY29uZCBlbGVtZW50LCBuZWVkIHRvIGNoYW5nZSB0byBhcnJheS5cbiAgICB0aGlzLl9ldmVudHNbdHlwZV0gPSBbdGhpcy5fZXZlbnRzW3R5cGVdLCBsaXN0ZW5lcl07XG5cbiAgLy8gQ2hlY2sgZm9yIGxpc3RlbmVyIGxlYWtcbiAgaWYgKGlzT2JqZWN0KHRoaXMuX2V2ZW50c1t0eXBlXSkgJiYgIXRoaXMuX2V2ZW50c1t0eXBlXS53YXJuZWQpIHtcbiAgICBpZiAoIWlzVW5kZWZpbmVkKHRoaXMuX21heExpc3RlbmVycykpIHtcbiAgICAgIG0gPSB0aGlzLl9tYXhMaXN0ZW5lcnM7XG4gICAgfSBlbHNlIHtcbiAgICAgIG0gPSBFdmVudEVtaXR0ZXIkMS5kZWZhdWx0TWF4TGlzdGVuZXJzO1xuICAgIH1cblxuICAgIGlmIChtICYmIG0gPiAwICYmIHRoaXMuX2V2ZW50c1t0eXBlXS5sZW5ndGggPiBtKSB7XG4gICAgICB0aGlzLl9ldmVudHNbdHlwZV0ud2FybmVkID0gdHJ1ZTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJyhub2RlKSB3YXJuaW5nOiBwb3NzaWJsZSBFdmVudEVtaXR0ZXIgbWVtb3J5ICcgK1xuICAgICAgICAgICAgICAgICAgICAnbGVhayBkZXRlY3RlZC4gJWQgbGlzdGVuZXJzIGFkZGVkLiAnICtcbiAgICAgICAgICAgICAgICAgICAgJ1VzZSBlbWl0dGVyLnNldE1heExpc3RlbmVycygpIHRvIGluY3JlYXNlIGxpbWl0LicsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2V2ZW50c1t0eXBlXS5sZW5ndGgpO1xuICAgICAgaWYgKHR5cGVvZiBjb25zb2xlLnRyYWNlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIC8vIG5vdCBzdXBwb3J0ZWQgaW4gSUUgMTBcbiAgICAgICAgY29uc29sZS50cmFjZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0aGlzO1xufTtcblxuRXZlbnRFbWl0dGVyJDEucHJvdG90eXBlLm9uID0gRXZlbnRFbWl0dGVyJDEucHJvdG90eXBlLmFkZExpc3RlbmVyO1xuXG5FdmVudEVtaXR0ZXIkMS5wcm90b3R5cGUub25jZSA9IGZ1bmN0aW9uKHR5cGUsIGxpc3RlbmVyKSB7XG4gIGlmICghaXNGdW5jdGlvbihsaXN0ZW5lcikpXG4gICAgdGhyb3cgVHlwZUVycm9yKCdsaXN0ZW5lciBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcblxuICB2YXIgZmlyZWQgPSBmYWxzZTtcblxuICBmdW5jdGlvbiBnKCkge1xuICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIodHlwZSwgZyk7XG5cbiAgICBpZiAoIWZpcmVkKSB7XG4gICAgICBmaXJlZCA9IHRydWU7XG4gICAgICBsaXN0ZW5lci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cbiAgfVxuXG4gIGcubGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgdGhpcy5vbih0eXBlLCBnKTtcblxuICByZXR1cm4gdGhpcztcbn07XG5cbi8vIGVtaXRzIGEgJ3JlbW92ZUxpc3RlbmVyJyBldmVudCBpZmYgdGhlIGxpc3RlbmVyIHdhcyByZW1vdmVkXG5FdmVudEVtaXR0ZXIkMS5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXIgPSBmdW5jdGlvbih0eXBlLCBsaXN0ZW5lcikge1xuICB2YXIgbGlzdCwgcG9zaXRpb24sIGxlbmd0aCwgaTtcblxuICBpZiAoIWlzRnVuY3Rpb24obGlzdGVuZXIpKVxuICAgIHRocm93IFR5cGVFcnJvcignbGlzdGVuZXIgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG5cbiAgaWYgKCF0aGlzLl9ldmVudHMgfHwgIXRoaXMuX2V2ZW50c1t0eXBlXSlcbiAgICByZXR1cm4gdGhpcztcblxuICBsaXN0ID0gdGhpcy5fZXZlbnRzW3R5cGVdO1xuICBsZW5ndGggPSBsaXN0Lmxlbmd0aDtcbiAgcG9zaXRpb24gPSAtMTtcblxuICBpZiAobGlzdCA9PT0gbGlzdGVuZXIgfHxcbiAgICAgIChpc0Z1bmN0aW9uKGxpc3QubGlzdGVuZXIpICYmIGxpc3QubGlzdGVuZXIgPT09IGxpc3RlbmVyKSkge1xuICAgIGRlbGV0ZSB0aGlzLl9ldmVudHNbdHlwZV07XG4gICAgaWYgKHRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lcilcbiAgICAgIHRoaXMuZW1pdCgncmVtb3ZlTGlzdGVuZXInLCB0eXBlLCBsaXN0ZW5lcik7XG5cbiAgfSBlbHNlIGlmIChpc09iamVjdChsaXN0KSkge1xuICAgIGZvciAoaSA9IGxlbmd0aDsgaS0tID4gMDspIHtcbiAgICAgIGlmIChsaXN0W2ldID09PSBsaXN0ZW5lciB8fFxuICAgICAgICAgIChsaXN0W2ldLmxpc3RlbmVyICYmIGxpc3RbaV0ubGlzdGVuZXIgPT09IGxpc3RlbmVyKSkge1xuICAgICAgICBwb3NpdGlvbiA9IGk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChwb3NpdGlvbiA8IDApXG4gICAgICByZXR1cm4gdGhpcztcblxuICAgIGlmIChsaXN0Lmxlbmd0aCA9PT0gMSkge1xuICAgICAgbGlzdC5sZW5ndGggPSAwO1xuICAgICAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTtcbiAgICB9IGVsc2Uge1xuICAgICAgbGlzdC5zcGxpY2UocG9zaXRpb24sIDEpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLl9ldmVudHMucmVtb3ZlTGlzdGVuZXIpXG4gICAgICB0aGlzLmVtaXQoJ3JlbW92ZUxpc3RlbmVyJywgdHlwZSwgbGlzdGVuZXIpO1xuICB9XG5cbiAgcmV0dXJuIHRoaXM7XG59O1xuXG5FdmVudEVtaXR0ZXIkMS5wcm90b3R5cGUucmVtb3ZlQWxsTGlzdGVuZXJzID0gZnVuY3Rpb24odHlwZSkge1xuICB2YXIga2V5LCBsaXN0ZW5lcnM7XG5cbiAgaWYgKCF0aGlzLl9ldmVudHMpXG4gICAgcmV0dXJuIHRoaXM7XG5cbiAgLy8gbm90IGxpc3RlbmluZyBmb3IgcmVtb3ZlTGlzdGVuZXIsIG5vIG5lZWQgdG8gZW1pdFxuICBpZiAoIXRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lcikge1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKVxuICAgICAgdGhpcy5fZXZlbnRzID0ge307XG4gICAgZWxzZSBpZiAodGhpcy5fZXZlbnRzW3R5cGVdKVxuICAgICAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8vIGVtaXQgcmVtb3ZlTGlzdGVuZXIgZm9yIGFsbCBsaXN0ZW5lcnMgb24gYWxsIGV2ZW50c1xuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgIGZvciAoa2V5IGluIHRoaXMuX2V2ZW50cykge1xuICAgICAgaWYgKGtleSA9PT0gJ3JlbW92ZUxpc3RlbmVyJykgY29udGludWU7XG4gICAgICB0aGlzLnJlbW92ZUFsbExpc3RlbmVycyhrZXkpO1xuICAgIH1cbiAgICB0aGlzLnJlbW92ZUFsbExpc3RlbmVycygncmVtb3ZlTGlzdGVuZXInKTtcbiAgICB0aGlzLl9ldmVudHMgPSB7fTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGxpc3RlbmVycyA9IHRoaXMuX2V2ZW50c1t0eXBlXTtcblxuICBpZiAoaXNGdW5jdGlvbihsaXN0ZW5lcnMpKSB7XG4gICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcnMpO1xuICB9IGVsc2UgaWYgKGxpc3RlbmVycykge1xuICAgIC8vIExJRk8gb3JkZXJcbiAgICB3aGlsZSAobGlzdGVuZXJzLmxlbmd0aClcbiAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIodHlwZSwgbGlzdGVuZXJzW2xpc3RlbmVycy5sZW5ndGggLSAxXSk7XG4gIH1cbiAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTtcblxuICByZXR1cm4gdGhpcztcbn07XG5cbkV2ZW50RW1pdHRlciQxLnByb3RvdHlwZS5saXN0ZW5lcnMgPSBmdW5jdGlvbih0eXBlKSB7XG4gIHZhciByZXQ7XG4gIGlmICghdGhpcy5fZXZlbnRzIHx8ICF0aGlzLl9ldmVudHNbdHlwZV0pXG4gICAgcmV0ID0gW107XG4gIGVsc2UgaWYgKGlzRnVuY3Rpb24odGhpcy5fZXZlbnRzW3R5cGVdKSlcbiAgICByZXQgPSBbdGhpcy5fZXZlbnRzW3R5cGVdXTtcbiAgZWxzZVxuICAgIHJldCA9IHRoaXMuX2V2ZW50c1t0eXBlXS5zbGljZSgpO1xuICByZXR1cm4gcmV0O1xufTtcblxuRXZlbnRFbWl0dGVyJDEucHJvdG90eXBlLmxpc3RlbmVyQ291bnQgPSBmdW5jdGlvbih0eXBlKSB7XG4gIGlmICh0aGlzLl9ldmVudHMpIHtcbiAgICB2YXIgZXZsaXN0ZW5lciA9IHRoaXMuX2V2ZW50c1t0eXBlXTtcblxuICAgIGlmIChpc0Z1bmN0aW9uKGV2bGlzdGVuZXIpKVxuICAgICAgcmV0dXJuIDE7XG4gICAgZWxzZSBpZiAoZXZsaXN0ZW5lcilcbiAgICAgIHJldHVybiBldmxpc3RlbmVyLmxlbmd0aDtcbiAgfVxuICByZXR1cm4gMDtcbn07XG5cbkV2ZW50RW1pdHRlciQxLmxpc3RlbmVyQ291bnQgPSBmdW5jdGlvbihlbWl0dGVyLCB0eXBlKSB7XG4gIHJldHVybiBlbWl0dGVyLmxpc3RlbmVyQ291bnQodHlwZSk7XG59O1xuXG5mdW5jdGlvbiBpc0Z1bmN0aW9uKGFyZykge1xuICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ2Z1bmN0aW9uJztcbn1cblxuZnVuY3Rpb24gaXNOdW1iZXIoYXJnKSB7XG4gIHJldHVybiB0eXBlb2YgYXJnID09PSAnbnVtYmVyJztcbn1cblxuZnVuY3Rpb24gaXNPYmplY3QoYXJnKSB7XG4gIHJldHVybiB0eXBlb2YgYXJnID09PSAnb2JqZWN0JyAmJiBhcmcgIT09IG51bGw7XG59XG5cbmZ1bmN0aW9uIGlzVW5kZWZpbmVkKGFyZykge1xuICByZXR1cm4gYXJnID09PSB2b2lkIDA7XG59XG5cbnZhciBFdmVudEVtaXR0ZXIgPSBldmVudHMuRXZlbnRFbWl0dGVyO1xuXG52YXIgRW1pdHRlciA9IGZ1bmN0aW9uIChfRXZlbnRFbWl0dGVyKSB7XG4gICAgaW5oZXJpdHMoRW1pdHRlciwgX0V2ZW50RW1pdHRlcik7XG5cbiAgICBmdW5jdGlvbiBFbWl0dGVyKCkge1xuICAgICAgICBjbGFzc0NhbGxDaGVjayh0aGlzLCBFbWl0dGVyKTtcbiAgICAgICAgcmV0dXJuIHBvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX0V2ZW50RW1pdHRlci5jYWxsKHRoaXMpKTtcbiAgICB9XG5cbiAgICBFbWl0dGVyLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbiBvZmYodHlwZSwgbGlzdGVuZXIpIHtcbiAgICAgICAgaWYgKGxpc3RlbmVyKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbW92ZUFsbExpc3RlbmVycyh0eXBlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIEVtaXR0ZXI7XG59KEV2ZW50RW1pdHRlcik7XG5cbmZ1bmN0aW9uIExvYWRlcih1cmwsIGRlZmVyTG9hZCkge1xuICAgIHZhciBFUlJPUl9TVEFURSA9IFsnJywgJ0FCT1JURUQnLCAnTkVUV09SSycsICdERUNPREUnLCAnU1JDX05PVF9TVVBQT1JURUQnXTtcbiAgICB2YXIgZW1pdHRlciA9IG5ldyBFbWl0dGVyKCk7XG4gICAgdmFyIHByb2dyZXNzID0gMCxcbiAgICAgICAgYXVkaW9Db250ZXh0ID0gdm9pZCAwLFxuICAgICAgICBpc1RvdWNoTG9ja2VkID0gdm9pZCAwLFxuICAgICAgICByZXF1ZXN0ID0gdm9pZCAwLFxuICAgICAgICB0aW1lb3V0ID0gdm9pZCAwLFxuICAgICAgICBkYXRhID0gdm9pZCAwO1xuXG4gICAgLy8gY2xlYW4gdXBcblxuICAgIGZ1bmN0aW9uIHJlbW92ZUxpc3RlbmVycygpIHtcbiAgICAgICAgZW1pdHRlci5vZmYoJ2Vycm9yJyk7XG4gICAgICAgIGVtaXR0ZXIub2ZmKCdwcm9ncmVzcycpO1xuICAgICAgICBlbWl0dGVyLm9mZignY29tcGxldGUnKTtcbiAgICAgICAgZW1pdHRlci5vZmYoJ2xvYWRlZCcpO1xuXG4gICAgICAgIGlmIChkYXRhICYmIHR5cGVvZiBkYXRhLnJlbW92ZUV2ZW50TGlzdGVuZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGRhdGEucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2FucGxheXRocm91Z2gnLCByZWFkeUhhbmRsZXIpO1xuICAgICAgICAgICAgZGF0YS5yZW1vdmVFdmVudExpc3RlbmVyKCdlcnJvcicsIGVycm9ySGFuZGxlcik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocmVxdWVzdCkge1xuICAgICAgICAgICAgcmVxdWVzdC5yZW1vdmVFdmVudExpc3RlbmVyKCdwcm9ncmVzcycsIHByb2dyZXNzSGFuZGxlcik7XG4gICAgICAgICAgICByZXF1ZXN0LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBsb2FkSGFuZGxlcik7XG4gICAgICAgICAgICByZXF1ZXN0LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZXJyb3JIYW5kbGVyKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRpc3BhdGNoQ29tcGxldGUoYnVmZmVyKSB7XG4gICAgICAgIGVtaXR0ZXIuZW1pdCgncHJvZ3Jlc3MnLCAxKTtcbiAgICAgICAgZW1pdHRlci5lbWl0KCdsb2FkZWQnLCBidWZmZXIpO1xuICAgICAgICBlbWl0dGVyLmVtaXQoJ2NvbXBsZXRlJywgYnVmZmVyKTtcblxuICAgICAgICByZW1vdmVMaXN0ZW5lcnMoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwcm9ncmVzc0hhbmRsZXIoZXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50Lmxlbmd0aENvbXB1dGFibGUpIHtcbiAgICAgICAgICAgIHByb2dyZXNzID0gZXZlbnQubG9hZGVkIC8gZXZlbnQudG90YWw7XG4gICAgICAgICAgICBlbWl0dGVyLmVtaXQoJ3Byb2dyZXNzJywgcHJvZ3Jlc3MpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gZXJyb3JcblxuICAgIGZ1bmN0aW9uIGVycm9ySGFuZGxlcihldmVudCkge1xuICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuXG4gICAgICAgIHZhciBtZXNzYWdlID0gZXZlbnQ7XG5cbiAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5lcnJvcikge1xuICAgICAgICAgICAgbWVzc2FnZSA9ICdNZWRpYSBFcnJvcjogJyArIEVSUk9SX1NUQVRFW2RhdGEuZXJyb3IuY29kZV0gKyAnICcgKyB1cmw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocmVxdWVzdCkge1xuICAgICAgICAgICAgbWVzc2FnZSA9ICdYSFIgRXJyb3I6ICcgKyByZXF1ZXN0LnN0YXR1cyArICcgJyArIHJlcXVlc3Quc3RhdHVzVGV4dCArICcgJyArIHVybDtcbiAgICAgICAgfVxuXG4gICAgICAgIGVtaXR0ZXIuZW1pdCgnZXJyb3InLCBtZXNzYWdlKTtcblxuICAgICAgICByZW1vdmVMaXN0ZW5lcnMoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZWNvZGVBcnJheUJ1ZmZlcihhcnJheWJ1ZmZlcikge1xuICAgICAgICBhdWRpb0NvbnRleHQuZGVjb2RlQXVkaW9EYXRhKGFycmF5YnVmZmVyLCBmdW5jdGlvbiAoYnVmZmVyKSB7XG4gICAgICAgICAgICBkYXRhID0gYnVmZmVyO1xuICAgICAgICAgICAgcmVxdWVzdCA9IG51bGw7XG4gICAgICAgICAgICBwcm9ncmVzcyA9IDE7XG4gICAgICAgICAgICBkaXNwYXRjaENvbXBsZXRlKGJ1ZmZlcik7XG4gICAgICAgIH0sIGVycm9ySGFuZGxlcik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG9hZEhhbmRsZXIoKSB7XG4gICAgICAgIGRlY29kZUFycmF5QnVmZmVyKHJlcXVlc3QucmVzcG9uc2UpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlYWR5SGFuZGxlcigpIHtcbiAgICAgICAgd2luZG93LmNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICAgICAgaWYgKCFkYXRhKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgcHJvZ3Jlc3MgPSAxO1xuICAgICAgICBkaXNwYXRjaENvbXBsZXRlKGRhdGEpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNhbmNlbCgpIHtcbiAgICAgICAgcmVtb3ZlTGlzdGVuZXJzKCk7XG5cbiAgICAgICAgaWYgKHJlcXVlc3QgJiYgcmVxdWVzdC5yZWFkeVN0YXRlICE9PSA0KSB7XG4gICAgICAgICAgICByZXF1ZXN0LmFib3J0KCk7XG4gICAgICAgIH1cbiAgICAgICAgcmVxdWVzdCA9IG51bGw7XG5cbiAgICAgICAgd2luZG93LmNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICBjYW5jZWwoKTtcbiAgICAgICAgcmVxdWVzdCA9IG51bGw7XG4gICAgICAgIGRhdGEgPSBudWxsO1xuICAgICAgICBhdWRpb0NvbnRleHQgPSBudWxsO1xuICAgIH1cblxuICAgIC8vIGF1ZGlvIGJ1ZmZlclxuXG4gICAgZnVuY3Rpb24gbG9hZEFycmF5QnVmZmVyKCkge1xuICAgICAgICBpZiAodXJsIGluc3RhbmNlb2Ygd2luZG93LkFycmF5QnVmZmVyKSB7XG4gICAgICAgICAgICBkZWNvZGVBcnJheUJ1ZmZlcih1cmwpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgcmVxdWVzdC5vcGVuKCdHRVQnLCB1cmwsIHRydWUpO1xuICAgICAgICByZXF1ZXN0LnJlc3BvbnNlVHlwZSA9ICdhcnJheWJ1ZmZlcic7XG4gICAgICAgIHJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcigncHJvZ3Jlc3MnLCBwcm9ncmVzc0hhbmRsZXIpO1xuICAgICAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBsb2FkSGFuZGxlcik7XG4gICAgICAgIHJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCBlcnJvckhhbmRsZXIpO1xuICAgICAgICByZXF1ZXN0LnNlbmQoKTtcbiAgICB9XG5cbiAgICAvLyBhdWRpbyBlbGVtZW50XG5cbiAgICBmdW5jdGlvbiBsb2FkQXVkaW9FbGVtZW50KCkge1xuICAgICAgICBpZiAoIWRhdGEgfHwgIWRhdGEudGFnTmFtZSkge1xuICAgICAgICAgICAgZGF0YSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2F1ZGlvJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWlzVG91Y2hMb2NrZWQpIHtcbiAgICAgICAgICAgIC8vIHRpbWVvdXQgYmVjYXVzZSBzb21ldGltZXMgY2FucGxheXRocm91Z2ggZG9lc24ndCBmaXJlXG4gICAgICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgICAgICAgICAgdGltZW91dCA9IHdpbmRvdy5zZXRUaW1lb3V0KHJlYWR5SGFuZGxlciwgMjAwMCk7XG4gICAgICAgICAgICBkYXRhLmFkZEV2ZW50TGlzdGVuZXIoJ2NhbnBsYXl0aHJvdWdoJywgcmVhZHlIYW5kbGVyLCBmYWxzZSk7XG4gICAgICAgIH1cblxuICAgICAgICBkYXRhLmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZXJyb3JIYW5kbGVyLCBmYWxzZSk7XG4gICAgICAgIGRhdGEucHJlbG9hZCA9ICdhdXRvJztcbiAgICAgICAgZGF0YS5zcmMgPSB1cmw7XG4gICAgICAgIGRhdGEubG9hZCgpO1xuXG4gICAgICAgIGlmIChpc1RvdWNoTG9ja2VkKSB7XG4gICAgICAgICAgICBkaXNwYXRjaENvbXBsZXRlKGRhdGEpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3RhcnQoKSB7XG4gICAgICAgIHZhciBmb3JjZSA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMCB8fCBhcmd1bWVudHNbMF0gPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogYXJndW1lbnRzWzBdO1xuXG4gICAgICAgIGlmIChkZWZlckxvYWQgJiYgIWZvcmNlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGF1ZGlvQ29udGV4dCkge1xuICAgICAgICAgICAgbG9hZEFycmF5QnVmZmVyKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsb2FkQXVkaW9FbGVtZW50KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyByZWxvYWRcblxuICAgIGZ1bmN0aW9uIGxvYWQobmV3VXJsKSB7XG4gICAgICAgIHVybCA9IG5ld1VybDtcbiAgICAgICAgc3RhcnQoKTtcbiAgICB9XG5cbiAgICB2YXIgYXBpID0ge1xuICAgICAgICBvbjogZW1pdHRlci5vbi5iaW5kKGVtaXR0ZXIpLFxuICAgICAgICBvbmNlOiBlbWl0dGVyLm9uY2UuYmluZChlbWl0dGVyKSxcbiAgICAgICAgb2ZmOiBlbWl0dGVyLm9mZi5iaW5kKGVtaXR0ZXIpLFxuICAgICAgICBsb2FkOiBsb2FkLFxuICAgICAgICBzdGFydDogc3RhcnQsXG4gICAgICAgIGNhbmNlbDogY2FuY2VsLFxuICAgICAgICBkZXN0cm95OiBkZXN0cm95XG4gICAgfTtcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGFwaSwge1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcHJvZ3Jlc3M6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwcm9ncmVzcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYXVkaW9Db250ZXh0OiB7XG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGF1ZGlvQ29udGV4dCA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBpc1RvdWNoTG9ja2VkOiB7XG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlzVG91Y2hMb2NrZWQgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIE9iamVjdC5mcmVlemUoYXBpKTtcbn1cblxuTG9hZGVyLkdyb3VwID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBlbWl0dGVyID0gbmV3IEVtaXR0ZXIoKTtcbiAgICB2YXIgcXVldWUgPSBbXTtcbiAgICB2YXIgbnVtTG9hZGVkID0gMCxcbiAgICAgICAgbnVtVG90YWwgPSAwLFxuICAgICAgICBjdXJyZW50TG9hZGVyID0gdm9pZCAwO1xuXG4gICAgZnVuY3Rpb24gcHJvZ3Jlc3NIYW5kbGVyKHByb2dyZXNzKSB7XG4gICAgICAgIHZhciBsb2FkZWQgPSBudW1Mb2FkZWQgKyBwcm9ncmVzcztcbiAgICAgICAgZW1pdHRlci5lbWl0KCdwcm9ncmVzcycsIGxvYWRlZCAvIG51bVRvdGFsKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb21wbGV0ZUhhbmRsZXIoKSB7XG4gICAgICAgIG51bUxvYWRlZCsrO1xuICAgICAgICByZW1vdmVMaXN0ZW5lcnMoKTtcbiAgICAgICAgZW1pdHRlci5lbWl0KCdwcm9ncmVzcycsIG51bUxvYWRlZCAvIG51bVRvdGFsKTtcbiAgICAgICAgbmV4dCgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGVycm9ySGFuZGxlcihlKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XG4gICAgICAgIHJlbW92ZUxpc3RlbmVycygpO1xuICAgICAgICBlbWl0dGVyLmVtaXQoJ2Vycm9yJywgZSk7XG4gICAgICAgIG5leHQoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBuZXh0KCkge1xuICAgICAgICBpZiAocXVldWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBjdXJyZW50TG9hZGVyID0gbnVsbDtcbiAgICAgICAgICAgIGVtaXR0ZXIuZW1pdCgnY29tcGxldGUnKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGN1cnJlbnRMb2FkZXIgPSBxdWV1ZS5wb3AoKTtcbiAgICAgICAgY3VycmVudExvYWRlci5vbigncHJvZ3Jlc3MnLCBwcm9ncmVzc0hhbmRsZXIpO1xuICAgICAgICBjdXJyZW50TG9hZGVyLm9uY2UoJ2xvYWRlZCcsIGNvbXBsZXRlSGFuZGxlcik7XG4gICAgICAgIGN1cnJlbnRMb2FkZXIub25jZSgnZXJyb3InLCBlcnJvckhhbmRsZXIpO1xuICAgICAgICBjdXJyZW50TG9hZGVyLnN0YXJ0KCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVtb3ZlTGlzdGVuZXJzKCkge1xuICAgICAgICBjdXJyZW50TG9hZGVyLm9mZigncHJvZ3Jlc3MnLCBwcm9ncmVzc0hhbmRsZXIpO1xuICAgICAgICBjdXJyZW50TG9hZGVyLm9mZignbG9hZGVkJywgY29tcGxldGVIYW5kbGVyKTtcbiAgICAgICAgY3VycmVudExvYWRlci5vZmYoJ2Vycm9yJywgZXJyb3JIYW5kbGVyKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhZGQobG9hZGVyKSB7XG4gICAgICAgIHF1ZXVlLnB1c2gobG9hZGVyKTtcbiAgICAgICAgbnVtVG90YWwrKztcbiAgICAgICAgcmV0dXJuIGxvYWRlcjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdGFydCgpIHtcbiAgICAgICAgbnVtVG90YWwgPSBxdWV1ZS5sZW5ndGg7XG4gICAgICAgIG5leHQoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gT2JqZWN0LmZyZWV6ZSh7XG4gICAgICAgIG9uOiBlbWl0dGVyLm9uLmJpbmQoZW1pdHRlciksXG4gICAgICAgIG9uY2U6IGVtaXR0ZXIub25jZS5iaW5kKGVtaXR0ZXIpLFxuICAgICAgICBvZmY6IGVtaXR0ZXIub2ZmLmJpbmQoZW1pdHRlciksXG4gICAgICAgIGFkZDogYWRkLFxuICAgICAgICBzdGFydDogc3RhcnRcbiAgICB9KTtcbn07XG5cbmZ1bmN0aW9uIEJ1ZmZlclNvdXJjZShidWZmZXIsIGNvbnRleHQsIG9uRW5kZWQpIHtcbiAgICB2YXIgYXBpID0ge307XG4gICAgdmFyIGVuZGVkID0gZmFsc2UsXG4gICAgICAgIGVuZGVkQ2FsbGJhY2sgPSBvbkVuZGVkLFxuICAgICAgICBsb29wID0gZmFsc2UsXG4gICAgICAgIHBhdXNlZCA9IGZhbHNlLFxuICAgICAgICBwYXVzZWRBdCA9IDAsXG4gICAgICAgIHBsYXliYWNrUmF0ZSA9IDEsXG4gICAgICAgIHBsYXlpbmcgPSBmYWxzZSxcbiAgICAgICAgc291cmNlTm9kZSA9IG51bGwsXG4gICAgICAgIHN0YXJ0ZWRBdCA9IDA7XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVTb3VyY2VOb2RlKCkge1xuICAgICAgICBpZiAoIXNvdXJjZU5vZGUgJiYgY29udGV4dCkge1xuICAgICAgICAgICAgc291cmNlTm9kZSA9IGNvbnRleHQuY3JlYXRlQnVmZmVyU291cmNlKCk7XG4gICAgICAgICAgICBzb3VyY2VOb2RlLmJ1ZmZlciA9IGJ1ZmZlcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc291cmNlTm9kZTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIENvbnRyb2xzXG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBzdG9wKCkge1xuICAgICAgICBpZiAoc291cmNlTm9kZSkge1xuICAgICAgICAgICAgc291cmNlTm9kZS5vbmVuZGVkID0gbnVsbDtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgc291cmNlTm9kZS5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICAgICAgc291cmNlTm9kZS5zdG9wKDApO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge31cbiAgICAgICAgICAgIHNvdXJjZU5vZGUgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgcGF1c2VkID0gZmFsc2U7XG4gICAgICAgIHBhdXNlZEF0ID0gMDtcbiAgICAgICAgcGxheWluZyA9IGZhbHNlO1xuICAgICAgICBzdGFydGVkQXQgPSAwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgICAgICB2YXIgZWxhcHNlZCA9IGNvbnRleHQuY3VycmVudFRpbWUgLSBzdGFydGVkQXQ7XG4gICAgICAgIHN0b3AoKTtcbiAgICAgICAgcGF1c2VkQXQgPSBlbGFwc2VkO1xuICAgICAgICBwbGF5aW5nID0gZmFsc2U7XG4gICAgICAgIHBhdXNlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZW5kZWRIYW5kbGVyKCkge1xuICAgICAgICBzdG9wKCk7XG4gICAgICAgIGVuZGVkID0gdHJ1ZTtcbiAgICAgICAgaWYgKHR5cGVvZiBlbmRlZENhbGxiYWNrID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBlbmRlZENhbGxiYWNrKGFwaSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwbGF5KGRlbGF5KSB7XG4gICAgICAgIHZhciBvZmZzZXQgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyAwIDogYXJndW1lbnRzWzFdO1xuXG4gICAgICAgIGlmIChwbGF5aW5nKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBkZWxheSA9IGRlbGF5ID8gY29udGV4dC5jdXJyZW50VGltZSArIGRlbGF5IDogMDtcbiAgICAgICAgaWYgKG9mZnNldCkge1xuICAgICAgICAgICAgcGF1c2VkQXQgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXVzZWRBdCkge1xuICAgICAgICAgICAgb2Zmc2V0ID0gcGF1c2VkQXQ7XG4gICAgICAgIH1cbiAgICAgICAgd2hpbGUgKG9mZnNldCA+IGFwaS5kdXJhdGlvbikge1xuICAgICAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0ICUgYXBpLmR1cmF0aW9uO1xuICAgICAgICB9XG5cbiAgICAgICAgY3JlYXRlU291cmNlTm9kZSgpO1xuICAgICAgICBzb3VyY2VOb2RlLm9uZW5kZWQgPSBlbmRlZEhhbmRsZXI7XG4gICAgICAgIHNvdXJjZU5vZGUuc3RhcnQoZGVsYXksIG9mZnNldCk7XG5cbiAgICAgICAgc291cmNlTm9kZS5sb29wID0gbG9vcDtcbiAgICAgICAgc291cmNlTm9kZS5wbGF5YmFja1JhdGUudmFsdWUgPSBwbGF5YmFja1JhdGU7XG5cbiAgICAgICAgc3RhcnRlZEF0ID0gY29udGV4dC5jdXJyZW50VGltZSAtIG9mZnNldDtcbiAgICAgICAgZW5kZWQgPSBmYWxzZTtcbiAgICAgICAgcGF1c2VkID0gZmFsc2U7XG4gICAgICAgIHBhdXNlZEF0ID0gMDtcbiAgICAgICAgcGxheWluZyA9IHRydWU7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBEZXN0cm95XG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICBzdG9wKCk7XG4gICAgICAgIGJ1ZmZlciA9IG51bGw7XG4gICAgICAgIGNvbnRleHQgPSBudWxsO1xuICAgICAgICBlbmRlZENhbGxiYWNrID0gbnVsbDtcbiAgICAgICAgc291cmNlTm9kZSA9IG51bGw7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBHZXR0ZXJzICYgU2V0dGVyc1xuICAgICAqL1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoYXBpLCB7XG4gICAgICAgIHBsYXk6IHtcbiAgICAgICAgICAgIHZhbHVlOiBwbGF5XG4gICAgICAgIH0sXG4gICAgICAgIHBhdXNlOiB7XG4gICAgICAgICAgICB2YWx1ZTogcGF1c2VcbiAgICAgICAgfSxcbiAgICAgICAgc3RvcDoge1xuICAgICAgICAgICAgdmFsdWU6IHN0b3BcbiAgICAgICAgfSxcbiAgICAgICAgZGVzdHJveToge1xuICAgICAgICAgICAgdmFsdWU6IGRlc3Ryb3lcbiAgICAgICAgfSxcbiAgICAgICAgY3VycmVudFRpbWU6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIGlmIChwYXVzZWRBdCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGF1c2VkQXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChzdGFydGVkQXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRpbWUgPSBjb250ZXh0LmN1cnJlbnRUaW1lIC0gc3RhcnRlZEF0O1xuICAgICAgICAgICAgICAgICAgICBpZiAodGltZSA+IGFwaS5kdXJhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGltZSA9IHRpbWUgJSBhcGkuZHVyYXRpb247XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRpbWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBkdXJhdGlvbjoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGJ1ZmZlciA/IGJ1ZmZlci5kdXJhdGlvbiA6IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVuZGVkOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZW5kZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGxvb3A6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBsb29wO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgbG9vcCA9ICEhdmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKHNvdXJjZU5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlTm9kZS5sb29wID0gbG9vcDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHBhdXNlZDoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhdXNlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcGxheWJhY2tSYXRlOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGxheWJhY2tSYXRlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcGxheWJhY2tSYXRlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKHNvdXJjZU5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlTm9kZS5wbGF5YmFja1JhdGUudmFsdWUgPSBwbGF5YmFja1JhdGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBwbGF5aW5nOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGxheWluZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcHJvZ3Jlc3M6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhcGkuZHVyYXRpb24gPyBhcGkuY3VycmVudFRpbWUgLyBhcGkuZHVyYXRpb24gOiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBzb3VyY2VOb2RlOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY3JlYXRlU291cmNlTm9kZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gT2JqZWN0LmZyZWV6ZShhcGkpO1xufVxuXG5mdW5jdGlvbiBNZWRpYVNvdXJjZShlbCwgY29udGV4dCwgb25FbmRlZCkge1xuICAgIHZhciBhcGkgPSB7fTtcbiAgICB2YXIgZW5kZWQgPSBmYWxzZSxcbiAgICAgICAgZW5kZWRDYWxsYmFjayA9IG9uRW5kZWQsXG4gICAgICAgIGRlbGF5VGltZW91dCA9IHZvaWQgMCxcbiAgICAgICAgZmFkZVRpbWVvdXQgPSB2b2lkIDAsXG4gICAgICAgIGxvb3AgPSBmYWxzZSxcbiAgICAgICAgcGF1c2VkID0gZmFsc2UsXG4gICAgICAgIHBsYXliYWNrUmF0ZSA9IDEsXG4gICAgICAgIHBsYXlpbmcgPSBmYWxzZSxcbiAgICAgICAgc291cmNlTm9kZSA9IG51bGwsXG4gICAgICAgIGdyb3VwVm9sdW1lID0gMSxcbiAgICAgICAgdm9sdW1lID0gMTtcblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVNvdXJjZU5vZGUoKSB7XG4gICAgICAgIGlmICghc291cmNlTm9kZSAmJiBjb250ZXh0KSB7XG4gICAgICAgICAgICBzb3VyY2VOb2RlID0gY29udGV4dC5jcmVhdGVNZWRpYUVsZW1lbnRTb3VyY2UoZWwpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzb3VyY2VOb2RlO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogTG9hZFxuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gbG9hZCh1cmwpIHtcbiAgICAgICAgZWwuc3JjID0gdXJsO1xuICAgICAgICBlbC5sb2FkKCk7XG4gICAgICAgIGVuZGVkID0gZmFsc2U7XG4gICAgICAgIHBhdXNlZCA9IGZhbHNlO1xuICAgICAgICBwbGF5aW5nID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBDb250cm9sc1xuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gcmVhZHlIYW5kbGVyKCkge1xuICAgICAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKCdjYW5wbGF5dGhyb3VnaCcsIHJlYWR5SGFuZGxlcik7XG4gICAgICAgIGlmIChwbGF5aW5nKSB7XG4gICAgICAgICAgICBlbC5wbGF5KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKlxuICAgICAqIEVuZGVkIGhhbmRsZXJcbiAgICAgKi9cblxuICAgIGZ1bmN0aW9uIGVuZGVkSGFuZGxlcigpIHtcblxuICAgICAgICBpZiAobG9vcCkge1xuICAgICAgICAgICAgZWwuY3VycmVudFRpbWUgPSAwO1xuICAgICAgICAgICAgLy8gZml4ZXMgYnVnIHdoZXJlIHNlcnZlciBkb2Vzbid0IHN1cHBvcnQgc2VlazpcbiAgICAgICAgICAgIGlmIChlbC5jdXJyZW50VGltZSA+IDApIHtcbiAgICAgICAgICAgICAgICBlbC5sb2FkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbC5wbGF5KCk7XG5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGVuZGVkID0gdHJ1ZTtcbiAgICAgICAgcGF1c2VkID0gZmFsc2U7XG4gICAgICAgIHBsYXlpbmcgPSBmYWxzZTtcblxuICAgICAgICBpZiAodHlwZW9mIGVuZGVkQ2FsbGJhY2sgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGVuZGVkQ2FsbGJhY2soYXBpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBsYXkoZGVsYXksIG9mZnNldCkge1xuICAgICAgICBjbGVhclRpbWVvdXQoZGVsYXlUaW1lb3V0KTtcblxuICAgICAgICBlbC52b2x1bWUgPSB2b2x1bWUgKiBncm91cFZvbHVtZTtcbiAgICAgICAgZWwucGxheWJhY2tSYXRlID0gcGxheWJhY2tSYXRlO1xuXG4gICAgICAgIGlmIChvZmZzZXQpIHtcbiAgICAgICAgICAgIGVsLmN1cnJlbnRUaW1lID0gb2Zmc2V0O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRlbGF5KSB7XG4gICAgICAgICAgICBkZWxheVRpbWVvdXQgPSBzZXRUaW1lb3V0KHBsYXksIGRlbGF5KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGVsLmxvYWQoKTtcbiAgICAgICAgICAgIGVsLnBsYXkoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGVuZGVkID0gZmFsc2U7XG4gICAgICAgIHBhdXNlZCA9IGZhbHNlO1xuICAgICAgICBwbGF5aW5nID0gdHJ1ZTtcblxuICAgICAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKCdlbmRlZCcsIGVuZGVkSGFuZGxlcik7XG4gICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2VuZGVkJywgZW5kZWRIYW5kbGVyLCBmYWxzZSk7XG5cbiAgICAgICAgaWYgKGVsLnJlYWR5U3RhdGUgPCAxKSB7XG4gICAgICAgICAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKCdjYW5wbGF5dGhyb3VnaCcsIHJlYWR5SGFuZGxlcik7XG4gICAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjYW5wbGF5dGhyb3VnaCcsIHJlYWR5SGFuZGxlciwgZmFsc2UpO1xuICAgICAgICAgICAgZWwubG9hZCgpO1xuICAgICAgICAgICAgZWwucGxheSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgICAgIGNsZWFyVGltZW91dChkZWxheVRpbWVvdXQpO1xuXG4gICAgICAgIGlmICghZWwpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGVsLnBhdXNlKCk7XG4gICAgICAgIHBsYXlpbmcgPSBmYWxzZTtcbiAgICAgICAgcGF1c2VkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdG9wKCkge1xuICAgICAgICBjbGVhclRpbWVvdXQoZGVsYXlUaW1lb3V0KTtcblxuICAgICAgICBpZiAoIWVsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBlbC5wYXVzZSgpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBlbC5jdXJyZW50VGltZSA9IDA7XG4gICAgICAgICAgICAvLyBmaXhlcyBidWcgd2hlcmUgc2VydmVyIGRvZXNuJ3Qgc3VwcG9ydCBzZWVrOlxuICAgICAgICAgICAgaWYgKGVsLmN1cnJlbnRUaW1lID4gMCkge1xuICAgICAgICAgICAgICAgIGVsLmxvYWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZSkge31cblxuICAgICAgICBwbGF5aW5nID0gZmFsc2U7XG4gICAgICAgIHBhdXNlZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogRmFkZSBmb3Igbm8gd2ViYXVkaW9cbiAgICAgKi9cblxuICAgIGZ1bmN0aW9uIGZhZGUodG9Wb2x1bWUsIGR1cmF0aW9uKSB7XG4gICAgICAgIGlmIChjb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4gYXBpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcmFtcCh2YWx1ZSwgc3RlcCkge1xuICAgICAgICAgICAgZmFkZVRpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgYXBpLnZvbHVtZSA9IGFwaS52b2x1bWUgKyAodmFsdWUgLSBhcGkudm9sdW1lKSAqIDAuMjtcbiAgICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoYXBpLnZvbHVtZSAtIHZhbHVlKSA+IDAuMDUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmFtcCh2YWx1ZSwgc3RlcCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYXBpLnZvbHVtZSA9IHZhbHVlO1xuICAgICAgICAgICAgfSwgc3RlcCAqIDEwMDApO1xuICAgICAgICB9XG5cbiAgICAgICAgd2luZG93LmNsZWFyVGltZW91dChmYWRlVGltZW91dCk7XG4gICAgICAgIHJhbXAodG9Wb2x1bWUsIGR1cmF0aW9uIC8gMTApO1xuXG4gICAgICAgIHJldHVybiBhcGk7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBEZXN0cm95XG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKCdlbmRlZCcsIGVuZGVkSGFuZGxlcik7XG4gICAgICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NhbnBsYXl0aHJvdWdoJywgcmVhZHlIYW5kbGVyKTtcbiAgICAgICAgc3RvcCgpO1xuICAgICAgICBlbCA9IG51bGw7XG4gICAgICAgIGNvbnRleHQgPSBudWxsO1xuICAgICAgICBlbmRlZENhbGxiYWNrID0gbnVsbDtcbiAgICAgICAgc291cmNlTm9kZSA9IG51bGw7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBHZXR0ZXJzICYgU2V0dGVyc1xuICAgICAqL1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoYXBpLCB7XG4gICAgICAgIHBsYXk6IHtcbiAgICAgICAgICAgIHZhbHVlOiBwbGF5XG4gICAgICAgIH0sXG4gICAgICAgIHBhdXNlOiB7XG4gICAgICAgICAgICB2YWx1ZTogcGF1c2VcbiAgICAgICAgfSxcbiAgICAgICAgc3RvcDoge1xuICAgICAgICAgICAgdmFsdWU6IHN0b3BcbiAgICAgICAgfSxcbiAgICAgICAgbG9hZDoge1xuICAgICAgICAgICAgdmFsdWU6IGxvYWRcbiAgICAgICAgfSxcbiAgICAgICAgZmFkZToge1xuICAgICAgICAgICAgdmFsdWU6IGZhZGVcbiAgICAgICAgfSxcbiAgICAgICAgZGVzdHJveToge1xuICAgICAgICAgICAgdmFsdWU6IGRlc3Ryb3lcbiAgICAgICAgfSxcbiAgICAgICAgY3VycmVudFRpbWU6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlbCA/IGVsLmN1cnJlbnRUaW1lIDogMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZHVyYXRpb246IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlbCA/IGVsLmR1cmF0aW9uIDogMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW5kZWQ6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlbmRlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgbG9vcDoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvb3A7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBsb29wID0gISF2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcGF1c2VkOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGF1c2VkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBwbGF5YmFja1JhdGU6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwbGF5YmFja1JhdGU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBwbGF5YmFja1JhdGUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBpZiAoZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgZWwucGxheWJhY2tSYXRlID0gcGxheWJhY2tSYXRlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcGxheWluZzoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBsYXlpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHByb2dyZXNzOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZWwgJiYgZWwuZHVyYXRpb24gPyBlbC5jdXJyZW50VGltZSAvIGVsLmR1cmF0aW9uIDogMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgc291cmNlTm9kZToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZVNvdXJjZU5vZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgdm9sdW1lOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdm9sdW1lO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmNsZWFyVGltZW91dChmYWRlVGltZW91dCk7XG4gICAgICAgICAgICAgICAgdm9sdW1lID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKGVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGVsLnZvbHVtZSA9IHZvbHVtZSAqIGdyb3VwVm9sdW1lO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZ3JvdXBWb2x1bWU6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBncm91cFZvbHVtZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGdyb3VwVm9sdW1lID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKGVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGVsLnZvbHVtZSA9IHZvbHVtZSAqIGdyb3VwVm9sdW1lO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIE9iamVjdC5mcmVlemUoYXBpKTtcbn1cblxuZnVuY3Rpb24gTWljcm9waG9uZVNvdXJjZShzdHJlYW0sIGNvbnRleHQpIHtcbiAgICB2YXIgZW5kZWQgPSBmYWxzZSxcbiAgICAgICAgcGF1c2VkID0gZmFsc2UsXG4gICAgICAgIHBhdXNlZEF0ID0gMCxcbiAgICAgICAgcGxheWluZyA9IGZhbHNlLFxuICAgICAgICBzb3VyY2VOb2RlID0gbnVsbCxcbiAgICAgICAgLy8gTWljcm9waG9uZVNvdXJjZU5vZGVcbiAgICBzdGFydGVkQXQgPSAwO1xuXG4gICAgZnVuY3Rpb24gY3JlYXRlU291cmNlTm9kZSgpIHtcbiAgICAgICAgaWYgKCFzb3VyY2VOb2RlICYmIGNvbnRleHQpIHtcbiAgICAgICAgICAgIHNvdXJjZU5vZGUgPSBjb250ZXh0LmNyZWF0ZU1lZGlhU3RyZWFtU291cmNlKHN0cmVhbSk7XG4gICAgICAgICAgICAvLyBIQUNLOiBzdG9wcyBtb3ogZ2FyYmFnZSBjb2xsZWN0aW9uIGtpbGxpbmcgdGhlIHN0cmVhbVxuICAgICAgICAgICAgLy8gc2VlIGh0dHBzOi8vc3VwcG9ydC5tb3ppbGxhLm9yZy9lbi1VUy9xdWVzdGlvbnMvOTg0MTc5XG4gICAgICAgICAgICBpZiAobmF2aWdhdG9yLm1vekdldFVzZXJNZWRpYSkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5tb3pIYWNrID0gc291cmNlTm9kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc291cmNlTm9kZTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIENvbnRyb2xzXG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBwbGF5KGRlbGF5KSB7XG4gICAgICAgIGRlbGF5ID0gZGVsYXkgPyBjb250ZXh0LmN1cnJlbnRUaW1lICsgZGVsYXkgOiAwO1xuXG4gICAgICAgIGNyZWF0ZVNvdXJjZU5vZGUoKTtcbiAgICAgICAgc291cmNlTm9kZS5zdGFydChkZWxheSk7XG5cbiAgICAgICAgc3RhcnRlZEF0ID0gY29udGV4dC5jdXJyZW50VGltZSAtIHBhdXNlZEF0O1xuICAgICAgICBlbmRlZCA9IGZhbHNlO1xuICAgICAgICBwbGF5aW5nID0gdHJ1ZTtcbiAgICAgICAgcGF1c2VkID0gZmFsc2U7XG4gICAgICAgIHBhdXNlZEF0ID0gMDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdG9wKCkge1xuICAgICAgICBpZiAoc291cmNlTm9kZSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBzb3VyY2VOb2RlLnN0b3AoMCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7fVxuICAgICAgICAgICAgc291cmNlTm9kZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgZW5kZWQgPSB0cnVlO1xuICAgICAgICBwYXVzZWQgPSBmYWxzZTtcbiAgICAgICAgcGF1c2VkQXQgPSAwO1xuICAgICAgICBwbGF5aW5nID0gZmFsc2U7XG4gICAgICAgIHN0YXJ0ZWRBdCA9IDA7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgICAgIHZhciBlbGFwc2VkID0gY29udGV4dC5jdXJyZW50VGltZSAtIHN0YXJ0ZWRBdDtcbiAgICAgICAgc3RvcCgpO1xuICAgICAgICBwYXVzZWRBdCA9IGVsYXBzZWQ7XG4gICAgICAgIHBsYXlpbmcgPSBmYWxzZTtcbiAgICAgICAgcGF1c2VkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIERlc3Ryb3lcbiAgICAgKi9cblxuICAgIGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgIHN0b3AoKTtcbiAgICAgICAgY29udGV4dCA9IG51bGw7XG4gICAgICAgIHNvdXJjZU5vZGUgPSBudWxsO1xuICAgICAgICBzdHJlYW0gPSBudWxsO1xuICAgICAgICB3aW5kb3cubW96SGFjayA9IG51bGw7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBBcGlcbiAgICAgKi9cblxuICAgIHZhciBhcGkgPSB7XG4gICAgICAgIHBsYXk6IHBsYXksXG4gICAgICAgIHBhdXNlOiBwYXVzZSxcbiAgICAgICAgc3RvcDogc3RvcCxcbiAgICAgICAgZGVzdHJveTogZGVzdHJveSxcblxuICAgICAgICBkdXJhdGlvbjogMCxcbiAgICAgICAgcHJvZ3Jlc3M6IDBcbiAgICB9O1xuXG4gICAgLypcbiAgICAgKiBHZXR0ZXJzICYgU2V0dGVyc1xuICAgICAqL1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoYXBpLCB7XG4gICAgICAgIGN1cnJlbnRUaW1lOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICBpZiAocGF1c2VkQXQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhdXNlZEF0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc3RhcnRlZEF0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0LmN1cnJlbnRUaW1lIC0gc3RhcnRlZEF0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW5kZWQ6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlbmRlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcGF1c2VkOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGF1c2VkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBwbGF5aW5nOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGxheWluZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgc291cmNlTm9kZToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZVNvdXJjZU5vZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIE9iamVjdC5mcmVlemUoYXBpKTtcbn1cblxuZnVuY3Rpb24gT3NjaWxsYXRvclNvdXJjZSh0eXBlLCBjb250ZXh0KSB7XG4gICAgdmFyIGVuZGVkID0gZmFsc2UsXG4gICAgICAgIHBhdXNlZCA9IGZhbHNlLFxuICAgICAgICBwYXVzZWRBdCA9IDAsXG4gICAgICAgIHBsYXlpbmcgPSBmYWxzZSxcbiAgICAgICAgc291cmNlTm9kZSA9IG51bGwsXG4gICAgICAgIC8vIE9zY2lsbGF0b3JTb3VyY2VOb2RlXG4gICAgc3RhcnRlZEF0ID0gMCxcbiAgICAgICAgZnJlcXVlbmN5ID0gMjAwLFxuICAgICAgICBhcGkgPSBudWxsO1xuXG4gICAgZnVuY3Rpb24gY3JlYXRlU291cmNlTm9kZSgpIHtcbiAgICAgICAgaWYgKCFzb3VyY2VOb2RlICYmIGNvbnRleHQpIHtcbiAgICAgICAgICAgIHNvdXJjZU5vZGUgPSBjb250ZXh0LmNyZWF0ZU9zY2lsbGF0b3IoKTtcbiAgICAgICAgICAgIHNvdXJjZU5vZGUudHlwZSA9IHR5cGU7XG4gICAgICAgICAgICBzb3VyY2VOb2RlLmZyZXF1ZW5jeS52YWx1ZSA9IGZyZXF1ZW5jeTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc291cmNlTm9kZTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIENvbnRyb2xzXG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBwbGF5KGRlbGF5KSB7XG4gICAgICAgIGRlbGF5ID0gZGVsYXkgfHwgMDtcbiAgICAgICAgaWYgKGRlbGF5KSB7XG4gICAgICAgICAgICBkZWxheSA9IGNvbnRleHQuY3VycmVudFRpbWUgKyBkZWxheTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNyZWF0ZVNvdXJjZU5vZGUoKTtcbiAgICAgICAgc291cmNlTm9kZS5zdGFydChkZWxheSk7XG5cbiAgICAgICAgaWYgKHBhdXNlZEF0KSB7XG4gICAgICAgICAgICBzdGFydGVkQXQgPSBjb250ZXh0LmN1cnJlbnRUaW1lIC0gcGF1c2VkQXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdGFydGVkQXQgPSBjb250ZXh0LmN1cnJlbnRUaW1lO1xuICAgICAgICB9XG5cbiAgICAgICAgZW5kZWQgPSBmYWxzZTtcbiAgICAgICAgcGxheWluZyA9IHRydWU7XG4gICAgICAgIHBhdXNlZCA9IGZhbHNlO1xuICAgICAgICBwYXVzZWRBdCA9IDA7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICAgICAgaWYgKHNvdXJjZU5vZGUpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgc291cmNlTm9kZS5zdG9wKDApO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge31cbiAgICAgICAgICAgIHNvdXJjZU5vZGUgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGVuZGVkID0gdHJ1ZTtcbiAgICAgICAgcGF1c2VkID0gZmFsc2U7XG4gICAgICAgIHBhdXNlZEF0ID0gMDtcbiAgICAgICAgcGxheWluZyA9IGZhbHNlO1xuICAgICAgICBzdGFydGVkQXQgPSAwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgICAgICB2YXIgZWxhcHNlZCA9IGNvbnRleHQuY3VycmVudFRpbWUgLSBzdGFydGVkQXQ7XG4gICAgICAgIHN0b3AoKTtcbiAgICAgICAgcGF1c2VkQXQgPSBlbGFwc2VkO1xuICAgICAgICBwbGF5aW5nID0gZmFsc2U7XG4gICAgICAgIHBhdXNlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBEZXN0cm95XG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICBzdG9wKCk7XG4gICAgICAgIGNvbnRleHQgPSBudWxsO1xuICAgICAgICBzb3VyY2VOb2RlID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIEFwaVxuICAgICAqL1xuXG4gICAgYXBpID0ge1xuICAgICAgICBwbGF5OiBwbGF5LFxuICAgICAgICBwYXVzZTogcGF1c2UsXG4gICAgICAgIHN0b3A6IHN0b3AsXG4gICAgICAgIGRlc3Ryb3k6IGRlc3Ryb3lcbiAgICB9O1xuXG4gICAgLypcbiAgICAgKiBHZXR0ZXJzICYgU2V0dGVyc1xuICAgICAqL1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoYXBpLCB7XG4gICAgICAgIGN1cnJlbnRUaW1lOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICBpZiAocGF1c2VkQXQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhdXNlZEF0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc3RhcnRlZEF0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0LmN1cnJlbnRUaW1lIC0gc3RhcnRlZEF0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZHVyYXRpb246IHtcbiAgICAgICAgICAgIHZhbHVlOiAwXG4gICAgICAgIH0sXG4gICAgICAgIGVuZGVkOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZW5kZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGZyZXF1ZW5jeToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZyZXF1ZW5jeTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGZyZXF1ZW5jeSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGlmIChzb3VyY2VOb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZU5vZGUuZnJlcXVlbmN5LnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBwYXVzZWQ6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwYXVzZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHBsYXlpbmc6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwbGF5aW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBwcm9ncmVzczoge1xuICAgICAgICAgICAgdmFsdWU6IDBcbiAgICAgICAgfSxcbiAgICAgICAgc291cmNlTm9kZToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZVNvdXJjZU5vZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIE9iamVjdC5mcmVlemUoYXBpKTtcbn1cblxuZnVuY3Rpb24gU2NyaXB0U291cmNlKGRhdGEsIGNvbnRleHQpIHtcbiAgICB2YXIgYnVmZmVyU2l6ZSA9IGRhdGEuYnVmZmVyU2l6ZSB8fCAxMDI0O1xuICAgIHZhciBjaGFubmVscyA9IGRhdGEuY2hhbm5lbHMgfHwgMTtcbiAgICB2YXIgZW5kZWQgPSBmYWxzZSxcbiAgICAgICAgb25Qcm9jZXNzID0gZGF0YS5jYWxsYmFjay5iaW5kKGRhdGEudGhpc0FyZyB8fCB0aGlzKSxcbiAgICAgICAgcGF1c2VkID0gZmFsc2UsXG4gICAgICAgIHBhdXNlZEF0ID0gMCxcbiAgICAgICAgcGxheWluZyA9IGZhbHNlLFxuICAgICAgICBzb3VyY2VOb2RlID0gbnVsbCxcbiAgICAgICAgLy8gU2NyaXB0U291cmNlTm9kZVxuICAgIHN0YXJ0ZWRBdCA9IDAsXG4gICAgICAgIGFwaSA9IG51bGw7XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVTb3VyY2VOb2RlKCkge1xuICAgICAgICBpZiAoIXNvdXJjZU5vZGUgJiYgY29udGV4dCkge1xuICAgICAgICAgICAgc291cmNlTm9kZSA9IGNvbnRleHQuY3JlYXRlU2NyaXB0UHJvY2Vzc29yKGJ1ZmZlclNpemUsIDAsIGNoYW5uZWxzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc291cmNlTm9kZTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIENvbnRyb2xzXG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBwbGF5KCkge1xuICAgICAgICBjcmVhdGVTb3VyY2VOb2RlKCk7XG4gICAgICAgIHNvdXJjZU5vZGUub25hdWRpb3Byb2Nlc3MgPSBvblByb2Nlc3M7XG5cbiAgICAgICAgc3RhcnRlZEF0ID0gY29udGV4dC5jdXJyZW50VGltZSAtIHBhdXNlZEF0O1xuICAgICAgICBlbmRlZCA9IGZhbHNlO1xuICAgICAgICBwYXVzZWQgPSBmYWxzZTtcbiAgICAgICAgcGF1c2VkQXQgPSAwO1xuICAgICAgICBwbGF5aW5nID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvblBhdXNlZChldmVudCkge1xuICAgICAgICB2YXIgYnVmZmVyID0gZXZlbnQub3V0cHV0QnVmZmVyO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJ1ZmZlci5udW1iZXJPZkNoYW5uZWxzOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBjaGFubmVsID0gYnVmZmVyLmdldENoYW5uZWxEYXRhKGkpO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBjaGFubmVsLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgY2hhbm5lbFtqXSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdG9wKCkge1xuICAgICAgICBpZiAoc291cmNlTm9kZSkge1xuICAgICAgICAgICAgc291cmNlTm9kZS5vbmF1ZGlvcHJvY2VzcyA9IG9uUGF1c2VkO1xuICAgICAgICB9XG4gICAgICAgIGVuZGVkID0gdHJ1ZTtcbiAgICAgICAgcGF1c2VkID0gZmFsc2U7XG4gICAgICAgIHBhdXNlZEF0ID0gMDtcbiAgICAgICAgcGxheWluZyA9IGZhbHNlO1xuICAgICAgICBzdGFydGVkQXQgPSAwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgICAgICB2YXIgZWxhcHNlZCA9IGNvbnRleHQuY3VycmVudFRpbWUgLSBzdGFydGVkQXQ7XG4gICAgICAgIHN0b3AoKTtcbiAgICAgICAgcGF1c2VkQXQgPSBlbGFwc2VkO1xuICAgICAgICBwbGF5aW5nID0gZmFsc2U7XG4gICAgICAgIHBhdXNlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBEZXN0cm95XG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICBzdG9wKCk7XG4gICAgICAgIGNvbnRleHQgPSBudWxsO1xuICAgICAgICBvblByb2Nlc3MgPSBudWxsO1xuICAgICAgICBzb3VyY2VOb2RlID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIEFwaVxuICAgICAqL1xuXG4gICAgYXBpID0ge1xuICAgICAgICBwbGF5OiBwbGF5LFxuICAgICAgICBwYXVzZTogcGF1c2UsXG4gICAgICAgIHN0b3A6IHN0b3AsXG4gICAgICAgIGRlc3Ryb3k6IGRlc3Ryb3ksXG5cbiAgICAgICAgZHVyYXRpb246IDAsXG4gICAgICAgIHByb2dyZXNzOiAwXG4gICAgfTtcblxuICAgIC8qXG4gICAgICogR2V0dGVycyAmIFNldHRlcnNcbiAgICAgKi9cblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGFwaSwge1xuICAgICAgICBjdXJyZW50VGltZToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhdXNlZEF0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXVzZWRBdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHN0YXJ0ZWRBdCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5jdXJyZW50VGltZSAtIHN0YXJ0ZWRBdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVuZGVkOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZW5kZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHBhdXNlZDoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhdXNlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcGxheWluZzoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBsYXlpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHNvdXJjZU5vZGU6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjcmVhdGVTb3VyY2VOb2RlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBPYmplY3QuZnJlZXplKGFwaSk7XG59XG5cbmZ1bmN0aW9uIHdhdmVmb3JtKCkge1xuICAgIHZhciBidWZmZXIgPSB2b2lkIDAsXG4gICAgICAgIHdhdmUgPSB2b2lkIDA7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKGF1ZGlvQnVmZmVyLCBsZW5ndGgpIHtcbiAgICAgICAgaWYgKCF3aW5kb3cuRmxvYXQzMkFycmF5IHx8ICF3aW5kb3cuQXVkaW9CdWZmZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzYW1lQnVmZmVyID0gYnVmZmVyID09PSBhdWRpb0J1ZmZlcjtcbiAgICAgICAgdmFyIHNhbWVMZW5ndGggPSB3YXZlICYmIHdhdmUubGVuZ3RoID09PSBsZW5ndGg7XG4gICAgICAgIGlmIChzYW1lQnVmZmVyICYmIHNhbWVMZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiB3YXZlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9jb25zb2xlLnRpbWUoJ3dhdmVEYXRhJyk7XG4gICAgICAgIGlmICghd2F2ZSB8fCB3YXZlLmxlbmd0aCAhPT0gbGVuZ3RoKSB7XG4gICAgICAgICAgICB3YXZlID0gbmV3IEZsb2F0MzJBcnJheShsZW5ndGgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFhdWRpb0J1ZmZlcikge1xuICAgICAgICAgICAgcmV0dXJuIHdhdmU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBjYWNoZSBmb3IgcmVwZWF0ZWQgY2FsbHNcbiAgICAgICAgYnVmZmVyID0gYXVkaW9CdWZmZXI7XG5cbiAgICAgICAgdmFyIGNodW5rID0gTWF0aC5mbG9vcihidWZmZXIubGVuZ3RoIC8gbGVuZ3RoKSxcbiAgICAgICAgICAgIHJlc29sdXRpb24gPSA1LFxuICAgICAgICAgICAgLy8gMTBcbiAgICAgICAgaW5jciA9IE1hdGgubWF4KE1hdGguZmxvb3IoY2h1bmsgLyByZXNvbHV0aW9uKSwgMSk7XG4gICAgICAgIHZhciBncmVhdGVzdCA9IDA7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBidWZmZXIubnVtYmVyT2ZDaGFubmVsczsgaSsrKSB7XG4gICAgICAgICAgICAvLyBjaGVjayBlYWNoIGNoYW5uZWxcbiAgICAgICAgICAgIHZhciBjaGFubmVsID0gYnVmZmVyLmdldENoYW5uZWxEYXRhKGkpO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBsZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIC8vIGdldCBoaWdoZXN0IHZhbHVlIHdpdGhpbiB0aGUgY2h1bmtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gaiAqIGNodW5rLCBsID0gayArIGNodW5rOyBrIDwgbDsgayArPSBpbmNyKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHNlbGVjdCBoaWdoZXN0IHZhbHVlIGZyb20gY2hhbm5lbHNcbiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBjaGFubmVsW2tdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYSA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGEgPSAtYTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoYSA+IHdhdmVbal0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdhdmVbal0gPSBhO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBoaWdoZXN0IG92ZXJhbGwgZm9yIHNjYWxpbmdcbiAgICAgICAgICAgICAgICAgICAgaWYgKGEgPiBncmVhdGVzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JlYXRlc3QgPSBhO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIHNjYWxlIHVwXG4gICAgICAgIHZhciBzY2FsZSA9IDEgLyBncmVhdGVzdDtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IHdhdmUubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB3YXZlW19pXSAqPSBzY2FsZTtcbiAgICAgICAgfVxuICAgICAgICAvL2NvbnNvbGUudGltZUVuZCgnd2F2ZURhdGEnKTtcblxuICAgICAgICByZXR1cm4gd2F2ZTtcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBTb3VuZChjb25maWcpIHtcbiAgICB2YXIgY29udGV4dCA9IGNvbmZpZy5jb250ZXh0O1xuICAgIHZhciBkZXN0aW5hdGlvbiA9IGNvbmZpZy5kZXN0aW5hdGlvbjtcbiAgICB2YXIgZWZmZWN0ID0gbmV3IEVmZmVjdChjb250ZXh0KTtcbiAgICB2YXIgZ2FpbiA9IGVmZmVjdC5nYWluKCk7XG4gICAgdmFyIHdhdmUgPSB3YXZlZm9ybSgpO1xuXG4gICAgdmFyIGlkID0gbnVsbDtcbiAgICB2YXIgZGF0YSA9IG51bGw7XG4gICAgdmFyIGlzVG91Y2hMb2NrZWQgPSBmYWxzZTtcbiAgICB2YXIgbG9hZGVyID0gbnVsbDtcbiAgICB2YXIgbG9vcCA9IGZhbHNlO1xuICAgIHZhciBwbGF5YmFja1JhdGUgPSAxO1xuICAgIHZhciBwbGF5V2hlblJlYWR5ID0gbnVsbDtcbiAgICB2YXIgc291cmNlID0gbnVsbDtcbiAgICB2YXIgc291bmQgPSBudWxsO1xuXG4gICAgaWYgKGNvbnRleHQpIHtcbiAgICAgICAgZWZmZWN0LnNldERlc3RpbmF0aW9uKGdhaW4pO1xuICAgICAgICBnYWluLmNvbm5lY3QoZGVzdGluYXRpb24gfHwgY29udGV4dC5kZXN0aW5hdGlvbik7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBDcmVhdGUgc291cmNlXG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBjcmVhdGVTb3VyY2UodmFsdWUpIHtcbiAgICAgICAgZGF0YSA9IHZhbHVlO1xuXG4gICAgICAgIGlmIChmaWxlLmlzQXVkaW9CdWZmZXIoZGF0YSkpIHtcbiAgICAgICAgICAgIHNvdXJjZSA9IG5ldyBCdWZmZXJTb3VyY2UoZGF0YSwgY29udGV4dCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzb3VuZC5lbWl0KCdlbmRlZCcsIHNvdW5kKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKGZpbGUuaXNNZWRpYUVsZW1lbnQoZGF0YSkpIHtcbiAgICAgICAgICAgIHNvdXJjZSA9IG5ldyBNZWRpYVNvdXJjZShkYXRhLCBjb250ZXh0LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNvdW5kLmVtaXQoJ2VuZGVkJywgc291bmQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZmlsZS5pc01lZGlhU3RyZWFtKGRhdGEpKSB7XG4gICAgICAgICAgICBzb3VyY2UgPSBuZXcgTWljcm9waG9uZVNvdXJjZShkYXRhLCBjb250ZXh0KTtcbiAgICAgICAgfSBlbHNlIGlmIChmaWxlLmlzT3NjaWxsYXRvclR5cGUoZGF0YSAmJiBkYXRhLnR5cGUgfHwgZGF0YSkpIHtcbiAgICAgICAgICAgIHNvdXJjZSA9IG5ldyBPc2NpbGxhdG9yU291cmNlKGRhdGEudHlwZSB8fCBkYXRhLCBjb250ZXh0KTtcbiAgICAgICAgfSBlbHNlIGlmIChmaWxlLmlzU2NyaXB0Q29uZmlnKGRhdGEpKSB7XG4gICAgICAgICAgICBzb3VyY2UgPSBuZXcgU2NyaXB0U291cmNlKGRhdGEsIGNvbnRleHQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgZGV0ZWN0IGRhdGEgdHlwZTogJyArIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgZWZmZWN0LnNldFNvdXJjZShzb3VyY2Uuc291cmNlTm9kZSk7XG5cbiAgICAgICAgc291bmQuZW1pdCgncmVhZHknLCBzb3VuZCk7XG5cbiAgICAgICAgaWYgKHBsYXlXaGVuUmVhZHkpIHtcbiAgICAgICAgICAgIHBsYXlXaGVuUmVhZHkoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qXG4gICAgICogTG9hZFxuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gb25Mb2FkKGZpbGVEYXRhKSB7XG4gICAgICAgIGNyZWF0ZVNvdXJjZShmaWxlRGF0YSk7XG4gICAgICAgIHNvdW5kLmVtaXQoJ2xvYWRlZCcsIHNvdW5kKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvbkxvYWRFcnJvcihlcnIpIHtcbiAgICAgICAgc291bmQuZW1pdCgnZXJyb3InLCBzb3VuZCwgZXJyKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsb2FkKCkge1xuICAgICAgICB2YXIgbmV3Q29uZmlnID0gYXJndW1lbnRzLmxlbmd0aCA8PSAwIHx8IGFyZ3VtZW50c1swXSA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IGFyZ3VtZW50c1swXTtcbiAgICAgICAgdmFyIGZvcmNlID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8gZmFsc2UgOiBhcmd1bWVudHNbMV07XG5cbiAgICAgICAgdmFyIHNraXBMb2FkID0gIWZvcmNlICYmICFzb3VyY2UgJiYgISFjb25maWcuZGVmZXJMb2FkO1xuXG4gICAgICAgIGlmIChuZXdDb25maWcpIHtcbiAgICAgICAgICAgIHZhciBzcmMgPSBmaWxlLmdldFN1cHBvcnRlZEZpbGUoY29uZmlnLnNyYyB8fCBjb25maWcudXJsIHx8IGNvbmZpZy5kYXRhIHx8IGNvbmZpZykgfHwgY29uZmlnLnNyYztcbiAgICAgICAgICAgIGNvbmZpZyA9IE9iamVjdC5hc3NpZ24oY29uZmlnLCBuZXdDb25maWcsIHsgc3JjOiBzcmMgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc291cmNlICYmIGRhdGEgJiYgZGF0YS50YWdOYW1lKSB7XG4gICAgICAgICAgICBzb3VyY2UubG9hZChjb25maWcuc3JjKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxvYWRlciA9IGxvYWRlciB8fCBuZXcgTG9hZGVyKGNvbmZpZy5zcmMsIHNraXBMb2FkKTtcbiAgICAgICAgICAgIGxvYWRlci5hdWRpb0NvbnRleHQgPSAhIWNvbmZpZy5hc01lZGlhRWxlbWVudCA/IG51bGwgOiBjb250ZXh0O1xuICAgICAgICAgICAgbG9hZGVyLmlzVG91Y2hMb2NrZWQgPSBpc1RvdWNoTG9ja2VkO1xuICAgICAgICAgICAgbG9hZGVyLm9mZignbG9hZGVkJywgb25Mb2FkKTtcbiAgICAgICAgICAgIGxvYWRlci5vbmNlKCdsb2FkZWQnLCBvbkxvYWQpO1xuICAgICAgICAgICAgbG9hZGVyLm9mZignZXJyb3InLCBvbkxvYWRFcnJvcik7XG4gICAgICAgICAgICBsb2FkZXIub24oJ2Vycm9yJywgb25Mb2FkRXJyb3IpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzb3VuZDtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIENvbnRyb2xzXG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBwbGF5KGRlbGF5LCBvZmZzZXQpIHtcbiAgICAgICAgaWYgKCFzb3VyY2UgfHwgaXNUb3VjaExvY2tlZCkge1xuICAgICAgICAgICAgcGxheVdoZW5SZWFkeSA9IGZ1bmN0aW9uIHBsYXlXaGVuUmVhZHkoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNvdXJjZSkge1xuICAgICAgICAgICAgICAgICAgICBwbGF5KGRlbGF5LCBvZmZzZXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoISFjb25maWcuZGVmZXJMb2FkKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFsb2FkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9hZChudWxsLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbG9hZGVyLnN0YXJ0KHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHNvdW5kO1xuICAgICAgICB9XG4gICAgICAgIHBsYXlXaGVuUmVhZHkgPSBudWxsO1xuICAgICAgICBlZmZlY3Quc2V0U291cmNlKHNvdXJjZS5zb3VyY2VOb2RlKTtcblxuICAgICAgICAvLyB1cGRhdGUgdm9sdW1lIG5lZWRlZCBmb3Igbm8gd2ViYXVkaW9cbiAgICAgICAgaWYgKCFjb250ZXh0KSB7XG4gICAgICAgICAgICBzb3VuZC52b2x1bWUgPSBnYWluLmdhaW4udmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICBzb3VyY2UucGxheShkZWxheSwgb2Zmc2V0KTtcblxuICAgICAgICBpZiAoc291cmNlLmhhc093blByb3BlcnR5KCdsb29wJykpIHtcbiAgICAgICAgICAgIHNvdXJjZS5sb29wID0gbG9vcDtcbiAgICAgICAgfVxuXG4gICAgICAgIHNvdW5kLmVtaXQoJ3BsYXknLCBzb3VuZCk7XG5cbiAgICAgICAgcmV0dXJuIHNvdW5kO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgICAgICBzb3VyY2UgJiYgc291cmNlLnBhdXNlKCk7XG4gICAgICAgIHNvdW5kLmVtaXQoJ3BhdXNlJywgc291bmQpO1xuICAgICAgICByZXR1cm4gc291bmQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3RvcChkZWxheSkge1xuICAgICAgICBzb3VyY2UgJiYgc291cmNlLnN0b3AoZGVsYXkgfHwgMCk7XG4gICAgICAgIHNvdW5kLmVtaXQoJ3N0b3AnLCBzb3VuZCk7XG4gICAgICAgIHJldHVybiBzb3VuZDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZWVrKHBlcmNlbnQpIHtcbiAgICAgICAgaWYgKHNvdXJjZSkge1xuICAgICAgICAgICAgc291cmNlLnN0b3AoKTtcbiAgICAgICAgICAgIHBsYXkoMCwgc291cmNlLmR1cmF0aW9uICogcGVyY2VudCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNvdW5kO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZhZGUodm9sdW1lLCBkdXJhdGlvbikge1xuICAgICAgICBpZiAoIXNvdXJjZSkge1xuICAgICAgICAgICAgcmV0dXJuIHNvdW5kO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHBhcmFtID0gZ2Fpbi5nYWluO1xuXG4gICAgICAgIGlmIChjb250ZXh0KSB7XG4gICAgICAgICAgICB2YXIgdGltZSA9IGNvbnRleHQuY3VycmVudFRpbWU7XG4gICAgICAgICAgICBwYXJhbS5jYW5jZWxTY2hlZHVsZWRWYWx1ZXModGltZSk7XG4gICAgICAgICAgICBwYXJhbS5zZXRWYWx1ZUF0VGltZShwYXJhbS52YWx1ZSwgdGltZSk7XG4gICAgICAgICAgICBwYXJhbS5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSh2b2x1bWUsIHRpbWUgKyBkdXJhdGlvbik7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHNvdXJjZS5mYWRlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBzb3VyY2UuZmFkZSh2b2x1bWUsIGR1cmF0aW9uKTtcbiAgICAgICAgICAgIHBhcmFtLnZhbHVlID0gdm9sdW1lO1xuICAgICAgICB9XG5cbiAgICAgICAgc291bmQuZW1pdCgnZmFkZScsIHNvdW5kLCB2b2x1bWUpO1xuXG4gICAgICAgIHJldHVybiBzb3VuZDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1bmxvYWQoKSB7XG4gICAgICAgIHNvdXJjZSAmJiBzb3VyY2UuZGVzdHJveSgpO1xuICAgICAgICBsb2FkZXIgJiYgbG9hZGVyLmRlc3Ryb3koKTtcbiAgICAgICAgZGF0YSA9IG51bGw7XG4gICAgICAgIHBsYXlXaGVuUmVhZHkgPSBudWxsO1xuICAgICAgICBzb3VyY2UgPSBudWxsO1xuICAgICAgICBsb2FkZXIgPSBudWxsO1xuICAgICAgICBjb25maWcuZGVmZXJMb2FkID0gdHJ1ZTtcbiAgICAgICAgc291bmQuZW1pdCgndW5sb2FkJywgc291bmQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlbG9hZCgpIHtcbiAgICAgICAgbG9hZChudWxsLCB0cnVlKTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIERlc3Ryb3lcbiAgICAgKi9cblxuICAgIGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgIHNvdXJjZSAmJiBzb3VyY2UuZGVzdHJveSgpO1xuICAgICAgICBlZmZlY3QgJiYgZWZmZWN0LmRlc3Ryb3koKTtcbiAgICAgICAgZ2FpbiAmJiBnYWluLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgbG9hZGVyICYmIGxvYWRlci5vZmYoJ2xvYWRlZCcpO1xuICAgICAgICBsb2FkZXIgJiYgbG9hZGVyLm9mZignZXJyb3InKTtcbiAgICAgICAgbG9hZGVyICYmIGxvYWRlci5kZXN0cm95KCk7XG4gICAgICAgIHNvdW5kLm9mZignbG9hZGVkJyk7XG4gICAgICAgIHNvdW5kLm9mZignZW5kZWQnKTtcbiAgICAgICAgc291bmQub2ZmKCdlcnJvcicpO1xuICAgICAgICBnYWluID0gbnVsbDtcbiAgICAgICAgY29udGV4dCA9IG51bGw7XG4gICAgICAgIGRlc3RpbmF0aW9uID0gbnVsbDtcbiAgICAgICAgZGF0YSA9IG51bGw7XG4gICAgICAgIHBsYXlXaGVuUmVhZHkgPSBudWxsO1xuICAgICAgICBzb3VyY2UgPSBudWxsO1xuICAgICAgICBlZmZlY3QgPSBudWxsO1xuICAgICAgICBsb2FkZXIgPSBudWxsO1xuICAgICAgICB3YXZlID0gbnVsbDtcbiAgICAgICAgY29uZmlnID0gbnVsbDtcbiAgICAgICAgc291bmQuZW1pdCgnZGVzdHJveScsIHNvdW5kKTtcbiAgICAgICAgc291bmQub2ZmKCdkZXN0cm95Jyk7XG4gICAgfVxuXG4gICAgc291bmQgPSBPYmplY3QuY3JlYXRlKEVtaXR0ZXIucHJvdG90eXBlLCB7XG4gICAgICAgIF9ldmVudHM6IHtcbiAgICAgICAgICAgIHZhbHVlOiB7fVxuICAgICAgICB9LFxuICAgICAgICBjb25zdHJ1Y3Rvcjoge1xuICAgICAgICAgICAgdmFsdWU6IFNvdW5kXG4gICAgICAgIH0sXG4gICAgICAgIHBsYXk6IHtcbiAgICAgICAgICAgIHZhbHVlOiBwbGF5XG4gICAgICAgIH0sXG4gICAgICAgIHBhdXNlOiB7XG4gICAgICAgICAgICB2YWx1ZTogcGF1c2VcbiAgICAgICAgfSxcbiAgICAgICAgbG9hZDoge1xuICAgICAgICAgICAgdmFsdWU6IGxvYWRcbiAgICAgICAgfSxcbiAgICAgICAgc2Vlazoge1xuICAgICAgICAgICAgdmFsdWU6IHNlZWtcbiAgICAgICAgfSxcbiAgICAgICAgc3RvcDoge1xuICAgICAgICAgICAgdmFsdWU6IHN0b3BcbiAgICAgICAgfSxcbiAgICAgICAgZmFkZToge1xuICAgICAgICAgICAgdmFsdWU6IGZhZGVcbiAgICAgICAgfSxcbiAgICAgICAgdW5sb2FkOiB7XG4gICAgICAgICAgICB2YWx1ZTogdW5sb2FkXG4gICAgICAgIH0sXG4gICAgICAgIHJlbG9hZDoge1xuICAgICAgICAgICAgdmFsdWU6IHJlbG9hZFxuICAgICAgICB9LFxuICAgICAgICBkZXN0cm95OiB7XG4gICAgICAgICAgICB2YWx1ZTogZGVzdHJveVxuICAgICAgICB9LFxuICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgICB2YWx1ZTogY29udGV4dFxuICAgICAgICB9LFxuICAgICAgICBjdXJyZW50VGltZToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNvdXJjZSA/IHNvdXJjZS5jdXJyZW50VGltZSA6IDA7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAvLyBjb25zdCBzaWxlbnQgPSBzb3VuZC5wbGF5aW5nO1xuICAgICAgICAgICAgICAgIHNvdXJjZSAmJiBzb3VyY2Uuc3RvcCgpO1xuICAgICAgICAgICAgICAgIC8vIHBsYXkoMCwgdmFsdWUsIHNpbGVudCk7XG4gICAgICAgICAgICAgICAgcGxheSgwLCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNyZWF0ZVNvdXJjZSh2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGR1cmF0aW9uOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc291cmNlID8gc291cmNlLmR1cmF0aW9uIDogMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZWZmZWN0OiB7XG4gICAgICAgICAgICB2YWx1ZTogZWZmZWN0XG4gICAgICAgIH0sXG4gICAgICAgIGVuZGVkOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gISFzb3VyY2UgJiYgc291cmNlLmVuZGVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBmcmVxdWVuY3k6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzb3VyY2UgPyBzb3VyY2UuZnJlcXVlbmN5IDogMDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmIChzb3VyY2UgJiYgc291cmNlLmhhc093blByb3BlcnR5KCdmcmVxdWVuY3knKSkge1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2UuZnJlcXVlbmN5ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBnYWluOiB7XG4gICAgICAgICAgICB2YWx1ZTogZ2FpblxuICAgICAgICB9LFxuICAgICAgICBpZDoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlkO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWQgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgaXNUb3VjaExvY2tlZDoge1xuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpc1RvdWNoTG9ja2VkID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKGxvYWRlcikge1xuICAgICAgICAgICAgICAgICAgICBsb2FkZXIuaXNUb3VjaExvY2tlZCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIXZhbHVlICYmIHBsYXlXaGVuUmVhZHkpIHtcbiAgICAgICAgICAgICAgICAgICAgcGxheVdoZW5SZWFkeSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgbG9hZGVyOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbG9hZGVyO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBsb29wOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbG9vcDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGxvb3AgPSAhIXZhbHVlO1xuXG4gICAgICAgICAgICAgICAgaWYgKHNvdXJjZSAmJiBzb3VyY2UuaGFzT3duUHJvcGVydHkoJ2xvb3AnKSAmJiBzb3VyY2UubG9vcCAhPT0gbG9vcCkge1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2UubG9vcCA9IGxvb3A7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjb25maWc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHBhdXNlZDoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICEhc291cmNlICYmIHNvdXJjZS5wYXVzZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHBsYXlpbmc6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAhIXNvdXJjZSAmJiBzb3VyY2UucGxheWluZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcGxheWJhY2tSYXRlOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGxheWJhY2tSYXRlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcGxheWJhY2tSYXRlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKHNvdXJjZSkge1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2UucGxheWJhY2tSYXRlID0gcGxheWJhY2tSYXRlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcHJvZ3Jlc3M6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzb3VyY2UgPyBzb3VyY2UucHJvZ3Jlc3MgOiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBzb3VyY2VOb2RlOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc291cmNlID8gc291cmNlLnNvdXJjZU5vZGUgOiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB2b2x1bWU6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIGlmIChjb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnYWluLmdhaW4udmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChzb3VyY2UgJiYgc291cmNlLmhhc093blByb3BlcnR5KCd2b2x1bWUnKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc291cmNlLnZvbHVtZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4odmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YWx1ZSA9IE1hdGgubWluKE1hdGgubWF4KHZhbHVlLCAwKSwgMSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcGFyYW0gPSBnYWluLmdhaW47XG5cbiAgICAgICAgICAgICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGltZSA9IGNvbnRleHQuY3VycmVudFRpbWU7XG4gICAgICAgICAgICAgICAgICAgIHBhcmFtLmNhbmNlbFNjaGVkdWxlZFZhbHVlcyh0aW1lKTtcbiAgICAgICAgICAgICAgICAgICAgcGFyYW0udmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgcGFyYW0uc2V0VmFsdWVBdFRpbWUodmFsdWUsIHRpbWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcmFtLnZhbHVlID0gdmFsdWU7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZSAmJiBzb3VyY2UuaGFzT3duUHJvcGVydHkoJ3ZvbHVtZScpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2Uudm9sdW1lID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIC8vIGZvciBtZWRpYSBlbGVtZW50IHNvdXJjZVxuICAgICAgICBncm91cFZvbHVtZToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNvdXJjZS5ncm91cFZvbHVtZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmIChzb3VyY2UgJiYgc291cmNlLmhhc093blByb3BlcnR5KCdncm91cFZvbHVtZScpKSB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZS5ncm91cFZvbHVtZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgd2F2ZWZvcm06IHtcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShsZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgc291bmQub25jZSgncmVhZHknLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gd2F2ZShkYXRhLCBsZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHdhdmUoZGF0YSwgbGVuZ3RoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgdXNlckRhdGE6IHtcbiAgICAgICAgICAgIHZhbHVlOiB7fVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc291bmQ7XG59XG5cbi8vIGV4cG9zZSBmb3IgdW5pdCB0ZXN0c1xuU291bmQuX19zb3VyY2UgPSB7XG4gICAgQnVmZmVyU291cmNlOiBCdWZmZXJTb3VyY2UsXG4gICAgTWVkaWFTb3VyY2U6IE1lZGlhU291cmNlLFxuICAgIE1pY3JvcGhvbmVTb3VyY2U6IE1pY3JvcGhvbmVTb3VyY2UsXG4gICAgT3NjaWxsYXRvclNvdXJjZTogT3NjaWxsYXRvclNvdXJjZSxcbiAgICBTY3JpcHRTb3VyY2U6IFNjcmlwdFNvdXJjZVxufTtcblxuZnVuY3Rpb24gU291bmRHcm91cChjb250ZXh0LCBkZXN0aW5hdGlvbikge1xuICAgIHZhciBncm91cCA9IG5ldyBHcm91cChjb250ZXh0LCBkZXN0aW5hdGlvbik7XG4gICAgdmFyIHNvdW5kcyA9IGdyb3VwLnNvdW5kcztcbiAgICB2YXIgcGxheWJhY2tSYXRlID0gMSxcbiAgICAgICAgbG9vcCA9IGZhbHNlLFxuICAgICAgICBzcmMgPSB2b2lkIDA7XG5cbiAgICBmdW5jdGlvbiBnZXRTb3VyY2UoKSB7XG4gICAgICAgIGlmICghc291bmRzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgc3JjID0gc291bmRzLnNsaWNlKDApLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgIHJldHVybiBiLmR1cmF0aW9uIC0gYS5kdXJhdGlvbjtcbiAgICAgICAgfSlbMF07XG4gICAgfVxuXG4gICAgdmFyIGFkZCA9IGdyb3VwLmFkZDtcbiAgICBncm91cC5hZGQgPSBmdW5jdGlvbiAoc291bmQpIHtcbiAgICAgICAgYWRkKHNvdW5kKTtcbiAgICAgICAgZ2V0U291cmNlKCk7XG4gICAgICAgIHJldHVybiBncm91cDtcbiAgICB9O1xuXG4gICAgdmFyIHJlbW92ZSA9IGdyb3VwLnJtZW92ZTtcbiAgICBncm91cC5yZW1vdmUgPSBmdW5jdGlvbiAoc291bmRPcklkKSB7XG4gICAgICAgIHJlbW92ZShzb3VuZE9ySWQpO1xuICAgICAgICBnZXRTb3VyY2UoKTtcbiAgICAgICAgcmV0dXJuIGdyb3VwO1xuICAgIH07XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhncm91cCwge1xuICAgICAgICBjdXJyZW50VGltZToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNyYyA/IHNyYy5jdXJyZW50VGltZSA6IDA7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3AoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBsYXkoMCwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBkdXJhdGlvbjoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNyYyA/IHNyYy5kdXJhdGlvbiA6IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIC8vIGVuZGVkOiB7XG4gICAgICAgIC8vICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyAgICAgICAgIHJldHVybiBzcmMgPyBzcmMuZW5kZWQgOiBmYWxzZTtcbiAgICAgICAgLy8gICAgIH1cbiAgICAgICAgLy8gfSxcbiAgICAgICAgbG9vcDoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvb3A7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBsb29wID0gISF2YWx1ZTtcbiAgICAgICAgICAgICAgICBzb3VuZHMuZm9yRWFjaChmdW5jdGlvbiAoc291bmQpIHtcbiAgICAgICAgICAgICAgICAgICAgc291bmQubG9vcCA9IGxvb3A7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHBhdXNlZDoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIHNyYyA/IHNyYy5wYXVzZWQgOiBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gISFzcmMgJiYgc3JjLnBhdXNlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcHJvZ3Jlc3M6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzcmMgPyBzcmMucHJvZ3Jlc3MgOiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBwbGF5YmFja1JhdGU6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwbGF5YmFja1JhdGU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBwbGF5YmFja1JhdGUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBzb3VuZHMuZm9yRWFjaChmdW5jdGlvbiAoc291bmQpIHtcbiAgICAgICAgICAgICAgICAgICAgc291bmQucGxheWJhY2tSYXRlID0gcGxheWJhY2tSYXRlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBwbGF5aW5nOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICAvLyByZXR1cm4gc3JjID8gc3JjLnBsYXlpbmcgOiBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gISFzcmMgJiYgc3JjLnBsYXlpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBncm91cDtcbn1cblxuZnVuY3Rpb24gTWljcm9waG9uZShjb25uZWN0ZWQsIGRlbmllZCwgZXJyb3IpIHtcbiAgICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhID0gbmF2aWdhdG9yLmdldFVzZXJNZWRpYSB8fCBuYXZpZ2F0b3Iud2Via2l0R2V0VXNlck1lZGlhIHx8IG5hdmlnYXRvci5tb3pHZXRVc2VyTWVkaWEgfHwgbmF2aWdhdG9yLm1zR2V0VXNlck1lZGlhO1xuICAgIGVycm9yID0gZXJyb3IgfHwgZnVuY3Rpb24gKCkge307XG5cbiAgICB2YXIgaXNTdXBwb3J0ZWQgPSAhIW5hdmlnYXRvci5nZXRVc2VyTWVkaWE7XG4gICAgdmFyIGFwaSA9IHt9O1xuICAgIHZhciBzdHJlYW0gPSBudWxsO1xuXG4gICAgZnVuY3Rpb24gY29ubmVjdCgpIHtcbiAgICAgICAgaWYgKCFpc1N1cHBvcnRlZCkge1xuICAgICAgICAgICAgcmV0dXJuIGFwaTtcbiAgICAgICAgfVxuXG4gICAgICAgIG5hdmlnYXRvci5nZXRVc2VyTWVkaWEoe1xuICAgICAgICAgICAgYXVkaW86IHRydWVcbiAgICAgICAgfSwgZnVuY3Rpb24gKG1pY1N0cmVhbSkge1xuICAgICAgICAgICAgc3RyZWFtID0gbWljU3RyZWFtO1xuICAgICAgICAgICAgY29ubmVjdGVkKHN0cmVhbSk7XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBpZiAoZGVuaWVkICYmIGUubmFtZSA9PT0gJ1Blcm1pc3Npb25EZW5pZWRFcnJvcicgfHwgZSA9PT0gJ1BFUk1JU1NJT05fREVOSUVEJykge1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdQZXJtaXNzaW9uIGRlbmllZC4gUmVzZXQgYnkgY2xpY2tpbmcgdGhlIGNhbWVyYSBpY29uIHdpdGggdGhlIHJlZCBjcm9zcy4nKTtcbiAgICAgICAgICAgICAgICBkZW5pZWQoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZXJyb3IoZS5tZXNzYWdlIHx8IGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGFwaTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkaXNjb25uZWN0KCkge1xuICAgICAgICBpZiAoc3RyZWFtKSB7XG4gICAgICAgICAgICBzdHJlYW0uc3RvcCgpO1xuICAgICAgICAgICAgc3RyZWFtID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXBpO1xuICAgIH1cblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGFwaSwge1xuICAgICAgICBjb25uZWN0OiB7XG4gICAgICAgICAgICB2YWx1ZTogY29ubmVjdFxuICAgICAgICB9LFxuICAgICAgICBkaXNjb25uZWN0OiB7XG4gICAgICAgICAgICB2YWx1ZTogZGlzY29ubmVjdFxuICAgICAgICB9LFxuICAgICAgICBpc1N1cHBvcnRlZDoge1xuICAgICAgICAgICAgdmFsdWU6IGlzU3VwcG9ydGVkXG4gICAgICAgIH0sXG4gICAgICAgIHN0cmVhbToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0cmVhbTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIE9iamVjdC5mcmVlemUoYXBpKTtcbn1cblxudmFyIGhhbGZQSSA9IE1hdGguUEkgLyAyO1xudmFyIHR3b1BJID0gTWF0aC5QSSAqIDI7XG5cbmZ1bmN0aW9uIHdhdmVmb3JtZXIoY29uZmlnKSB7XG5cbiAgICB2YXIgc3R5bGUgPSBjb25maWcuc3R5bGUgfHwgJ2ZpbGwnLFxuICAgICAgICAvLyAnZmlsbCcgb3IgJ2xpbmUnXG4gICAgc2hhcGUgPSBjb25maWcuc2hhcGUgfHwgJ2xpbmVhcicsXG4gICAgICAgIC8vICdjaXJjdWxhcicgb3IgJ2xpbmVhcidcbiAgICBjb2xvciA9IGNvbmZpZy5jb2xvciB8fCAwLFxuICAgICAgICBiZ0NvbG9yID0gY29uZmlnLmJnQ29sb3IsXG4gICAgICAgIGxpbmVXaWR0aCA9IGNvbmZpZy5saW5lV2lkdGggfHwgMSxcbiAgICAgICAgcGVyY2VudCA9IGNvbmZpZy5wZXJjZW50IHx8IDEsXG4gICAgICAgIG9yaWdpblggPSBjb25maWcueCB8fCAwLFxuICAgICAgICBvcmlnaW5ZID0gY29uZmlnLnkgfHwgMCxcbiAgICAgICAgdHJhbnNmb3JtID0gY29uZmlnLnRyYW5zZm9ybTtcblxuICAgIHZhciBjYW52YXMgPSBjb25maWcuY2FudmFzLFxuICAgICAgICB3aWR0aCA9IGNvbmZpZy53aWR0aCB8fCBjYW52YXMgJiYgY2FudmFzLndpZHRoLFxuICAgICAgICBoZWlnaHQgPSBjb25maWcuaGVpZ2h0IHx8IGNhbnZhcyAmJiBjYW52YXMuaGVpZ2h0O1xuXG4gICAgdmFyIGN0eCA9IG51bGwsXG4gICAgICAgIGN1cnJlbnRDb2xvciA9IHZvaWQgMCxcbiAgICAgICAgaSA9IHZvaWQgMCxcbiAgICAgICAgeCA9IHZvaWQgMCxcbiAgICAgICAgeSA9IHZvaWQgMCxcbiAgICAgICAgcmFkaXVzID0gdm9pZCAwLFxuICAgICAgICBpbm5lclJhZGl1cyA9IHZvaWQgMCxcbiAgICAgICAgY2VudGVyWCA9IHZvaWQgMCxcbiAgICAgICAgY2VudGVyWSA9IHZvaWQgMDtcblxuICAgIGlmICghY2FudmFzICYmICFjb25maWcuY29udGV4dCkge1xuICAgICAgICBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICAgICAgd2lkdGggPSB3aWR0aCB8fCBjYW52YXMud2lkdGg7XG4gICAgICAgIGhlaWdodCA9IGhlaWdodCB8fCBjYW52YXMuaGVpZ2h0O1xuICAgICAgICBjYW52YXMud2lkdGggPSBoZWlnaHQ7XG4gICAgICAgIGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgfVxuXG4gICAgaWYgKHNoYXBlID09PSAnY2lyY3VsYXInKSB7XG4gICAgICAgIHJhZGl1cyA9IGNvbmZpZy5yYWRpdXMgfHwgTWF0aC5taW4oaGVpZ2h0IC8gMiwgd2lkdGggLyAyKTtcbiAgICAgICAgaW5uZXJSYWRpdXMgPSBjb25maWcuaW5uZXJSYWRpdXMgfHwgcmFkaXVzIC8gMjtcbiAgICAgICAgY2VudGVyWCA9IG9yaWdpblggKyB3aWR0aCAvIDI7XG4gICAgICAgIGNlbnRlclkgPSBvcmlnaW5ZICsgaGVpZ2h0IC8gMjtcbiAgICB9XG5cbiAgICBjdHggPSBjb25maWcuY29udGV4dCB8fCBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcblxuICAgIGZ1bmN0aW9uIGNsZWFyKCkge1xuICAgICAgICBpZiAoYmdDb2xvcikge1xuICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGJnQ29sb3I7XG4gICAgICAgICAgICBjdHguZmlsbFJlY3Qob3JpZ2luWCwgb3JpZ2luWSwgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjdHguY2xlYXJSZWN0KG9yaWdpblgsIG9yaWdpblksIHdpZHRoLCBoZWlnaHQpO1xuICAgICAgICB9XG5cbiAgICAgICAgY3R4LmxpbmVXaWR0aCA9IGxpbmVXaWR0aDtcblxuICAgICAgICBjdXJyZW50Q29sb3IgPSBudWxsO1xuXG4gICAgICAgIGlmICh0eXBlb2YgY29sb3IgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IGNvbG9yO1xuICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdXBkYXRlQ29sb3IocG9zaXRpb24sIGxlbmd0aCwgdmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBjb2xvciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdmFyIG5ld0NvbG9yID0gY29sb3IocG9zaXRpb24sIGxlbmd0aCwgdmFsdWUpO1xuICAgICAgICAgICAgaWYgKG5ld0NvbG9yICE9PSBjdXJyZW50Q29sb3IpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50Q29sb3IgPSBuZXdDb2xvcjtcbiAgICAgICAgICAgICAgICBjdHguc3Ryb2tlKCk7XG4gICAgICAgICAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gY3VycmVudENvbG9yO1xuICAgICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFZhbHVlKHZhbHVlLCBwb3NpdGlvbiwgbGVuZ3RoKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdHJhbnNmb3JtID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJhbnNmb3JtKHZhbHVlLCBwb3NpdGlvbiwgbGVuZ3RoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0V2F2ZWZvcm0odmFsdWUsIGxlbmd0aCkge1xuICAgICAgICBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlLndhdmVmb3JtID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWUud2F2ZWZvcm0obGVuZ3RoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29uZmlnLndhdmVmb3JtKSB7XG4gICAgICAgICAgICByZXR1cm4gY29uZmlnLndhdmVmb3JtO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb25maWcuc291bmQpIHtcbiAgICAgICAgICAgIHJldHVybiBjb25maWcuc291bmQud2F2ZWZvcm0obGVuZ3RoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1cGRhdGUod2F2ZSkge1xuXG4gICAgICAgIGNsZWFyKCk7XG5cbiAgICAgICAgaWYgKHNoYXBlID09PSAnY2lyY3VsYXInKSB7XG4gICAgICAgICAgICB2YXIgd2F2ZWZvcm0gPSBnZXRXYXZlZm9ybSh3YXZlLCAzNjApO1xuICAgICAgICAgICAgdmFyIGxlbmd0aCA9IE1hdGguZmxvb3Iod2F2ZWZvcm0ubGVuZ3RoICogcGVyY2VudCk7XG5cbiAgICAgICAgICAgIHZhciBzdGVwID0gdHdvUEkgLyBsZW5ndGg7XG4gICAgICAgICAgICB2YXIgYW5nbGUgPSB2b2lkIDAsXG4gICAgICAgICAgICAgICAgbWFnbml0dWRlID0gdm9pZCAwLFxuICAgICAgICAgICAgICAgIHNpbmUgPSB2b2lkIDAsXG4gICAgICAgICAgICAgICAgY29zaW5lID0gdm9pZCAwO1xuXG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBnZXRWYWx1ZSh3YXZlZm9ybVtpXSwgaSwgbGVuZ3RoKTtcbiAgICAgICAgICAgICAgICB1cGRhdGVDb2xvcihpLCBsZW5ndGgsIHZhbHVlKTtcblxuICAgICAgICAgICAgICAgIGFuZ2xlID0gaSAqIHN0ZXAgLSBoYWxmUEk7XG4gICAgICAgICAgICAgICAgY29zaW5lID0gTWF0aC5jb3MoYW5nbGUpO1xuICAgICAgICAgICAgICAgIHNpbmUgPSBNYXRoLnNpbihhbmdsZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3R5bGUgPT09ICdmaWxsJykge1xuICAgICAgICAgICAgICAgICAgICB4ID0gY2VudGVyWCArIGlubmVyUmFkaXVzICogY29zaW5lO1xuICAgICAgICAgICAgICAgICAgICB5ID0gY2VudGVyWSArIGlubmVyUmFkaXVzICogc2luZTtcbiAgICAgICAgICAgICAgICAgICAgY3R4Lm1vdmVUbyh4LCB5KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBtYWduaXR1ZGUgPSBpbm5lclJhZGl1cyArIChyYWRpdXMgLSBpbm5lclJhZGl1cykgKiB2YWx1ZTtcbiAgICAgICAgICAgICAgICB4ID0gY2VudGVyWCArIG1hZ25pdHVkZSAqIGNvc2luZTtcbiAgICAgICAgICAgICAgICB5ID0gY2VudGVyWSArIG1hZ25pdHVkZSAqIHNpbmU7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3R5bGUgPT09ICdsaW5lJyAmJiBpID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5tb3ZlVG8oeCwgeSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY3R4LmxpbmVUbyh4LCB5KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHN0eWxlID09PSAnbGluZScpIHtcbiAgICAgICAgICAgICAgICBjdHguY2xvc2VQYXRoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgIHZhciBfd2F2ZWZvcm0gPSBnZXRXYXZlZm9ybSh3YXZlLCB3aWR0aCk7XG4gICAgICAgICAgICB2YXIgX2xlbmd0aCA9IE1hdGgubWluKF93YXZlZm9ybS5sZW5ndGgsIHdpZHRoIC0gbGluZVdpZHRoIC8gMik7XG4gICAgICAgICAgICBfbGVuZ3RoID0gTWF0aC5mbG9vcihfbGVuZ3RoICogcGVyY2VudCk7XG5cbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBfbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgX3ZhbHVlID0gZ2V0VmFsdWUoX3dhdmVmb3JtW2ldLCBpLCBfbGVuZ3RoKTtcbiAgICAgICAgICAgICAgICB1cGRhdGVDb2xvcihpLCBfbGVuZ3RoLCBfdmFsdWUpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0eWxlID09PSAnbGluZScgJiYgaSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY3R4LmxpbmVUbyh4LCB5KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB4ID0gb3JpZ2luWCArIGk7XG4gICAgICAgICAgICAgICAgeSA9IG9yaWdpblkgKyBoZWlnaHQgLSBNYXRoLnJvdW5kKGhlaWdodCAqIF92YWx1ZSk7XG4gICAgICAgICAgICAgICAgeSA9IE1hdGguZmxvb3IoTWF0aC5taW4oeSwgb3JpZ2luWSArIGhlaWdodCAtIGxpbmVXaWR0aCAvIDIpKTtcblxuICAgICAgICAgICAgICAgIGlmIChzdHlsZSA9PT0gJ2ZpbGwnKSB7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5tb3ZlVG8oeCwgeSk7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5saW5lVG8oeCwgb3JpZ2luWSArIGhlaWdodCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY3R4LmxpbmVUbyh4LCB5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY3R4LnN0cm9rZSgpO1xuICAgIH1cblxuICAgIHVwZGF0ZS5jYW52YXMgPSBjYW52YXM7XG5cbiAgICBpZiAoY29uZmlnLndhdmVmb3JtIHx8IGNvbmZpZy5zb3VuZCkge1xuICAgICAgICB1cGRhdGUoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdXBkYXRlO1xufVxuXG4vKlxuICogYXVkaW8gY3R4XG4gKi9cbnZhciBjdHggPSB2b2lkIDA7XG52YXIgb2ZmbGluZUN0eCA9IHZvaWQgMDtcblxuZnVuY3Rpb24gZ2V0Q29udGV4dCgpIHtcblx0aWYgKGN0eCkge1xuXHRcdHJldHVybiBjdHg7XG5cdH1cblxuXHR2YXIgZGVzaXJlZFNhbXBsZVJhdGUgPSA0NDEwMDtcblxuXHR2YXIgQ3R4ID0gd2luZG93LkF1ZGlvQ29udGV4dCB8fCB3aW5kb3cud2Via2l0QXVkaW9Db250ZXh0O1xuXG5cdGN0eCA9IEN0eCA/IG5ldyBDdHgoKSA6IG51bGw7XG5cblx0Ly8gQ2hlY2sgaWYgaGFjayBpcyBuZWNlc3NhcnkuIE9ubHkgb2NjdXJzIGluIGlPUzYrIGRldmljZXNcblx0Ly8gYW5kIG9ubHkgd2hlbiB5b3UgZmlyc3QgYm9vdCB0aGUgaVBob25lLCBvciBwbGF5IGEgYXVkaW8vdmlkZW9cblx0Ly8gd2l0aCBhIGRpZmZlcmVudCBzYW1wbGUgcmF0ZVxuXHQvLyBodHRwczovL2dpdGh1Yi5jb20vSmFtMy9pb3Mtc2FmZS1hdWRpby1jb250ZXh0L2Jsb2IvbWFzdGVyL2luZGV4LmpzXG5cdGlmICgvKGlQaG9uZXxpUGFkKS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkgJiYgY3R4LnNhbXBsZVJhdGUgIT09IGRlc2lyZWRTYW1wbGVSYXRlKSB7XG5cdFx0dmFyIGJ1ZmZlciA9IGN0eC5jcmVhdGVCdWZmZXIoMSwgMSwgZGVzaXJlZFNhbXBsZVJhdGUpO1xuXHRcdHZhciBkdW1teSA9IGN0eC5jcmVhdGVCdWZmZXJTb3VyY2UoKTtcblx0XHRkdW1teS5idWZmZXIgPSBidWZmZXI7XG5cdFx0ZHVtbXkuY29ubmVjdChjdHguZGVzdGluYXRpb24pO1xuXHRcdGR1bW15LnN0YXJ0KDApO1xuXHRcdGR1bW15LmRpc2Nvbm5lY3QoKTtcblxuXHRcdGN0eC5jbG9zZSgpOyAvLyBkaXNwb3NlIG9sZCBjb250ZXh0XG5cdFx0Y3R4ID0gQ3R4ID8gbmV3IEN0eCgpIDogbnVsbDtcblx0fVxuXG5cdC8vIEhhbmRsZXMgYnVnIGluIFNhZmFyaSA5IE9TWCB3aGVyZSBBdWRpb0NvbnRleHQgaW5zdGFuY2Ugc3RhcnRzIGluICdzdXNwZW5kZWQnIHN0YXRlXG5cblx0dmFyIGlzU3VzcGVuZGVkID0gY3R4ICYmIGN0eC5zdGF0ZSA9PT0gJ3N1c3BlbmRlZCc7XG5cblx0aWYgKGlzU3VzcGVuZGVkICYmIHR5cGVvZiBjdHgucmVzdW1lID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0d2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0Y3R4LnJlc3VtZSgpO1xuXHRcdH0sIDEwMDApO1xuXHR9XG5cblx0cmV0dXJuIGN0eDtcbn1cblxuLypcbkluIGNvbnRyYXN0IHdpdGggYSBzdGFuZGFyZCBBdWRpb0NvbnRleHQsIGFuIE9mZmxpbmVBdWRpb0NvbnRleHQgZG9lc24ndCByZW5kZXJcbnRoZSBhdWRpbyB0byB0aGUgZGV2aWNlIGhhcmR3YXJlO1xuaW5zdGVhZCwgaXQgZ2VuZXJhdGVzIGl0LCBhcyBmYXN0IGFzIGl0IGNhbiwgYW5kIG91dHB1dHMgdGhlIHJlc3VsdCB0byBhbiBBdWRpb0J1ZmZlci5cbiovXG5mdW5jdGlvbiBnZXRPZmZsaW5lQ29udGV4dChudW1PZkNoYW5uZWxzLCBsZW5ndGgsIHNhbXBsZVJhdGUpIHtcblx0aWYgKG9mZmxpbmVDdHgpIHtcblx0XHRyZXR1cm4gb2ZmbGluZUN0eDtcblx0fVxuXHRudW1PZkNoYW5uZWxzID0gbnVtT2ZDaGFubmVscyB8fCAyO1xuXHRzYW1wbGVSYXRlID0gc2FtcGxlUmF0ZSB8fCA0NDEwMDtcblx0bGVuZ3RoID0gc2FtcGxlUmF0ZSB8fCBudW1PZkNoYW5uZWxzO1xuXG5cdHZhciBPZmZsaW5lQ3R4ID0gd2luZG93Lk9mZmxpbmVBdWRpb0NvbnRleHQgfHwgd2luZG93LndlYmtpdE9mZmxpbmVBdWRpb0NvbnRleHQ7XG5cblx0b2ZmbGluZUN0eCA9IE9mZmxpbmVDdHggPyBuZXcgT2ZmbGluZUN0eChudW1PZkNoYW5uZWxzLCBsZW5ndGgsIHNhbXBsZVJhdGUpIDogbnVsbDtcblxuXHRyZXR1cm4gb2ZmbGluZUN0eDtcbn1cblxuLypcbiAqIGNsb25lIGF1ZGlvIGJ1ZmZlclxuICovXG5cbmZ1bmN0aW9uIGNsb25lQnVmZmVyKGJ1ZmZlcikge1xuXHRpZiAoIWN0eCkge1xuXHRcdHJldHVybiBidWZmZXI7XG5cdH1cblxuXHR2YXIgbnVtQ2hhbm5lbHMgPSBidWZmZXIubnVtYmVyT2ZDaGFubmVscyxcblx0ICAgIGNsb25lZCA9IGN0eC5jcmVhdGVCdWZmZXIobnVtQ2hhbm5lbHMsIGJ1ZmZlci5sZW5ndGgsIGJ1ZmZlci5zYW1wbGVSYXRlKTtcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBudW1DaGFubmVsczsgaSsrKSB7XG5cdFx0Y2xvbmVkLmdldENoYW5uZWxEYXRhKGkpLnNldChidWZmZXIuZ2V0Q2hhbm5lbERhdGEoaSkpO1xuXHR9XG5cdHJldHVybiBjbG9uZWQ7XG59XG5cbi8qXG4gKiByZXZlcnNlIGF1ZGlvIGJ1ZmZlclxuICovXG5cbmZ1bmN0aW9uIHJldmVyc2VCdWZmZXIoYnVmZmVyKSB7XG5cdHZhciBudW1DaGFubmVscyA9IGJ1ZmZlci5udW1iZXJPZkNoYW5uZWxzO1xuXHRmb3IgKHZhciBpID0gMDsgaSA8IG51bUNoYW5uZWxzOyBpKyspIHtcblx0XHRBcnJheS5wcm90b3R5cGUucmV2ZXJzZS5jYWxsKGJ1ZmZlci5nZXRDaGFubmVsRGF0YShpKSk7XG5cdH1cblx0cmV0dXJuIGJ1ZmZlcjtcbn1cblxuLypcbiAqIHJhbXAgYXVkaW8gcGFyYW1cbiAqL1xuXG5mdW5jdGlvbiByYW1wKHBhcmFtLCBmcm9tVmFsdWUsIHRvVmFsdWUsIGR1cmF0aW9uLCBsaW5lYXIpIHtcblx0aWYgKCFjdHgpIHtcblx0XHRyZXR1cm47XG5cdH1cblxuXHRwYXJhbS5zZXRWYWx1ZUF0VGltZShmcm9tVmFsdWUsIGN0eC5jdXJyZW50VGltZSk7XG5cblx0aWYgKGxpbmVhcikge1xuXHRcdHBhcmFtLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKHRvVmFsdWUsIGN0eC5jdXJyZW50VGltZSArIGR1cmF0aW9uKTtcblx0fSBlbHNlIHtcblx0XHRwYXJhbS5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lKHRvVmFsdWUsIGN0eC5jdXJyZW50VGltZSArIGR1cmF0aW9uKTtcblx0fVxufVxuXG4vKlxuICogZ2V0IGZyZXF1ZW5jeSBmcm9tIG1pbiB0byBtYXggYnkgcGFzc2luZyAwIHRvIDFcbiAqL1xuXG5mdW5jdGlvbiBnZXRGcmVxdWVuY3kodmFsdWUpIHtcblx0aWYgKCFjdHgpIHtcblx0XHRyZXR1cm4gMDtcblx0fVxuXHQvLyBnZXQgZnJlcXVlbmN5IGJ5IHBhc3NpbmcgbnVtYmVyIGZyb20gMCB0byAxXG5cdC8vIENsYW1wIHRoZSBmcmVxdWVuY3kgYmV0d2VlbiB0aGUgbWluaW11bSB2YWx1ZSAoNDAgSHopIGFuZCBoYWxmIG9mIHRoZVxuXHQvLyBzYW1wbGluZyByYXRlLlxuXHR2YXIgbWluVmFsdWUgPSA0MDtcblx0dmFyIG1heFZhbHVlID0gY3R4LnNhbXBsZVJhdGUgLyAyO1xuXHQvLyBMb2dhcml0aG0gKGJhc2UgMikgdG8gY29tcHV0ZSBob3cgbWFueSBvY3RhdmVzIGZhbGwgaW4gdGhlIHJhbmdlLlxuXHR2YXIgbnVtYmVyT2ZPY3RhdmVzID0gTWF0aC5sb2cobWF4VmFsdWUgLyBtaW5WYWx1ZSkgLyBNYXRoLkxOMjtcblx0Ly8gQ29tcHV0ZSBhIG11bHRpcGxpZXIgZnJvbSAwIHRvIDEgYmFzZWQgb24gYW4gZXhwb25lbnRpYWwgc2NhbGUuXG5cdHZhciBtdWx0aXBsaWVyID0gTWF0aC5wb3coMiwgbnVtYmVyT2ZPY3RhdmVzICogKHZhbHVlIC0gMS4wKSk7XG5cdC8vIEdldCBiYWNrIHRvIHRoZSBmcmVxdWVuY3kgdmFsdWUgYmV0d2VlbiBtaW4gYW5kIG1heC5cblx0cmV0dXJuIG1heFZhbHVlICogbXVsdGlwbGllcjtcbn1cblxuLypcbiAqIG1pY3JvcGhvbmUgdXRpbFxuICovXG5cbmZ1bmN0aW9uIG1pY3JvcGhvbmUoY29ubmVjdGVkLCBkZW5pZWQsIGVycm9yKSB7XG5cdHJldHVybiBuZXcgTWljcm9waG9uZShjb25uZWN0ZWQsIGRlbmllZCwgZXJyb3IpO1xufVxuXG4vKlxuICogRm9ybWF0IHNlY29uZHMgYXMgdGltZWNvZGUgc3RyaW5nXG4gKi9cblxuZnVuY3Rpb24gdGltZUNvZGUoc2Vjb25kcykge1xuXHR2YXIgZGVsaW0gPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyAnOicgOiBhcmd1bWVudHNbMV07XG5cblx0Ly8gY29uc3QgaCA9IE1hdGguZmxvb3Ioc2Vjb25kcyAvIDM2MDApO1xuXHQvLyBjb25zdCBtID0gTWF0aC5mbG9vcigoc2Vjb25kcyAlIDM2MDApIC8gNjApO1xuXHR2YXIgbSA9IE1hdGguZmxvb3Ioc2Vjb25kcyAvIDYwKTtcblx0dmFyIHMgPSBNYXRoLmZsb29yKHNlY29uZHMgJSAzNjAwICUgNjApO1xuXHQvLyBjb25zdCBociA9IChoIDwgMTAgPyAnMCcgKyBoICsgZGVsaW0gOiBoICsgZGVsaW0pO1xuXHR2YXIgbW4gPSAobSA8IDEwID8gJzAnICsgbSA6IG0pICsgZGVsaW07XG5cdHZhciBzYyA9IHMgPCAxMCA/ICcwJyArIHMgOiBzO1xuXHQvLyByZXR1cm4gaHIgKyBtbiArIHNjO1xuXHRyZXR1cm4gbW4gKyBzYztcbn1cblxudmFyIHV0aWxzID0gT2JqZWN0LmZyZWV6ZSh7XG5cdGdldENvbnRleHQ6IGdldENvbnRleHQsXG5cdGdldE9mZmxpbmVDb250ZXh0OiBnZXRPZmZsaW5lQ29udGV4dCxcblx0Y2xvbmVCdWZmZXI6IGNsb25lQnVmZmVyLFxuXHRyZXZlcnNlQnVmZmVyOiByZXZlcnNlQnVmZmVyLFxuXHRyYW1wOiByYW1wLFxuXHRnZXRGcmVxdWVuY3k6IGdldEZyZXF1ZW5jeSxcblx0bWljcm9waG9uZTogbWljcm9waG9uZSxcblx0dGltZUNvZGU6IHRpbWVDb2RlLFxuXHR3YXZlZm9ybWVyOiB3YXZlZm9ybWVyXG59KTtcblxuZnVuY3Rpb24gU29ubygpIHtcbiAgICB2YXIgVkVSU0lPTiA9ICcwLjEuODUnO1xuICAgIHZhciBjb250ZXh0ID0gdXRpbHMuZ2V0Q29udGV4dCgpO1xuICAgIHZhciBkZXN0aW5hdGlvbiA9IGNvbnRleHQgPyBjb250ZXh0LmRlc3RpbmF0aW9uIDogbnVsbDtcbiAgICB2YXIgZ3JvdXAgPSBuZXcgR3JvdXAoY29udGV4dCwgZGVzdGluYXRpb24pO1xuXG4gICAgdmFyIGFwaSA9IG51bGw7XG4gICAgdmFyIGlzVG91Y2hMb2NrZWQgPSBmYWxzZTtcblxuICAgIC8qXG4gICAgICogR2V0IFNvdW5kIGJ5IGlkXG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBnZXRTb3VuZChpZCkge1xuICAgICAgICByZXR1cm4gZ3JvdXAuZmluZChpZCk7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBDcmVhdGUgZ3JvdXBcbiAgICAgKi9cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUdyb3VwKHNvdW5kcykge1xuICAgICAgICB2YXIgc291bmRHcm91cCA9IG5ldyBTb3VuZEdyb3VwKGNvbnRleHQsIGdyb3VwLmdhaW4pO1xuICAgICAgICBpZiAoc291bmRzKSB7XG4gICAgICAgICAgICBzb3VuZHMuZm9yRWFjaChmdW5jdGlvbiAoc291bmQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc291bmRHcm91cC5hZGQoc291bmQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNvdW5kR3JvdXA7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBMb2FkaW5nXG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBhZGQoY29uZmlnKSB7XG4gICAgICAgIHZhciBzb3VuZENvbnRleHQgPSBjb25maWcgJiYgY29uZmlnLndlYkF1ZGlvID09PSBmYWxzZSA/IG51bGwgOiBjb250ZXh0O1xuICAgICAgICAvLyBjb25zdCBzb3VuZCA9IG5ldyBTb3VuZChzb3VuZENvbnRleHQsIGdyb3VwLmdhaW4pO1xuICAgICAgICB2YXIgc3JjID0gZmlsZS5nZXRTdXBwb3J0ZWRGaWxlKGNvbmZpZy5zcmMgfHwgY29uZmlnLnVybCB8fCBjb25maWcuZGF0YSB8fCBjb25maWcpO1xuICAgICAgICB2YXIgc291bmQgPSBuZXcgU291bmQoT2JqZWN0LmFzc2lnbih7fSwgY29uZmlnIHx8IHt9LCB7XG4gICAgICAgICAgICBzcmM6IHNyYyxcbiAgICAgICAgICAgIGNvbnRleHQ6IHNvdW5kQ29udGV4dCxcbiAgICAgICAgICAgIGRlc3RpbmF0aW9uOiBncm91cC5nYWluXG4gICAgICAgIH0pKTtcbiAgICAgICAgc291bmQuaXNUb3VjaExvY2tlZCA9IGlzVG91Y2hMb2NrZWQ7XG4gICAgICAgIGlmIChjb25maWcpIHtcbiAgICAgICAgICAgIHNvdW5kLmlkID0gY29uZmlnLmlkIHx8IGNvbmZpZy5uYW1lIHx8ICcnO1xuICAgICAgICAgICAgc291bmQubG9vcCA9ICEhY29uZmlnLmxvb3A7XG4gICAgICAgICAgICBzb3VuZC52b2x1bWUgPSBjb25maWcudm9sdW1lO1xuICAgICAgICB9XG4gICAgICAgIGdyb3VwLmFkZChzb3VuZCk7XG4gICAgICAgIHJldHVybiBzb3VuZDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBxdWV1ZShjb25maWcsIGxvYWRlckdyb3VwKSB7XG4gICAgICAgIHZhciBzb3VuZCA9IGFkZChjb25maWcpLmxvYWQoKTtcblxuICAgICAgICBpZiAobG9hZGVyR3JvdXApIHtcbiAgICAgICAgICAgIGxvYWRlckdyb3VwLmFkZChzb3VuZC5sb2FkZXIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzb3VuZDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsb2FkKGNvbmZpZykge1xuICAgICAgICB2YXIgc3JjID0gY29uZmlnLnNyYyB8fCBjb25maWcudXJsIHx8IGNvbmZpZy5kYXRhIHx8IGNvbmZpZztcbiAgICAgICAgdmFyIHNvdW5kID0gdm9pZCAwLFxuICAgICAgICAgICAgbG9hZGVyID0gdm9pZCAwO1xuXG4gICAgICAgIGlmIChmaWxlLmNvbnRhaW5zVVJMKHNyYykpIHtcbiAgICAgICAgICAgIHNvdW5kID0gcXVldWUoY29uZmlnKTtcbiAgICAgICAgICAgIGxvYWRlciA9IHNvdW5kLmxvYWRlcjtcbiAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHNyYykgJiYgZmlsZS5jb250YWluc1VSTChzcmNbMF0uc3JjIHx8IHNyY1swXS51cmwpKSB7XG4gICAgICAgICAgICBzb3VuZCA9IFtdO1xuICAgICAgICAgICAgbG9hZGVyID0gbmV3IExvYWRlci5Hcm91cCgpO1xuICAgICAgICAgICAgc3JjLmZvckVhY2goZnVuY3Rpb24gKHVybCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzb3VuZC5wdXNoKHF1ZXVlKHVybCwgbG9hZGVyKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBlcnJvck1lc3NhZ2UgPSAnc29uby5sb2FkOiBObyBhdWRpbyBmaWxlIFVSTHMgZm91bmQgaW4gY29uZmlnLic7XG4gICAgICAgICAgICBpZiAoY29uZmlnLm9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25maWcub25FcnJvcignW0VSUk9SXSAnICsgZXJyb3JNZXNzYWdlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29uZmlnLm9uUHJvZ3Jlc3MpIHtcbiAgICAgICAgICAgIGxvYWRlci5vbigncHJvZ3Jlc3MnLCBmdW5jdGlvbiAocHJvZ3Jlc3MpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uZmlnLm9uUHJvZ3Jlc3MocHJvZ3Jlc3MpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbmZpZy5vbkNvbXBsZXRlKSB7XG4gICAgICAgICAgICBsb2FkZXIub25jZSgnY29tcGxldGUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgbG9hZGVyLm9mZigncHJvZ3Jlc3MnKTtcbiAgICAgICAgICAgICAgICBjb25maWcub25Db21wbGV0ZShzb3VuZCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBsb2FkZXIub25jZSgnZXJyb3InLCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICBsb2FkZXIub2ZmKCdlcnJvcicpO1xuICAgICAgICAgICAgaWYgKGNvbmZpZy5vbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLm9uRXJyb3IoZXJyKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignW0VSUk9SXSBzb25vLmxvYWQ6ICcgKyBlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgbG9hZGVyLnN0YXJ0KCk7XG5cbiAgICAgICAgcmV0dXJuIHNvdW5kO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogQ3JlYXRlIFNvdW5kXG4gICAgICpcbiAgICAgKiBBY2NlcHRlZCB2YWx1ZXMgZm9yIHBhcmFtIGNvbmZpZzpcbiAgICAgKiBPYmplY3QgY29uZmlnIGUuZy4geyBpZDonZm9vJywgdXJsOlsnZm9vLm9nZycsICdmb28ubXAzJ10gfVxuICAgICAqIEFycmF5IChvZiBmaWxlcyBlLmcuIFsnZm9vLm9nZycsICdmb28ubXAzJ10pXG4gICAgICogQXJyYXlCdWZmZXJcbiAgICAgKiBIVE1MTWVkaWFFbGVtZW50XG4gICAgICogRmlsZW5hbWUgc3RyaW5nIChlLmcuICdmb28ub2dnJylcbiAgICAgKiBPc2NpbGxhdG9yIHR5cGUgc3RyaW5nIChpLmUuICdzaW5lJywgJ3NxdWFyZScsICdzYXd0b290aCcsICd0cmlhbmdsZScpXG4gICAgICogU2NyaXB0UHJvY2Vzc29yIGNvbmZpZyBvYmplY3QgKGUuZy4geyBidWZmZXJTaXplOiAxMDI0LCBjaGFubmVsczogMSwgY2FsbGJhY2s6IGZuIH0pXG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBjcmVhdGVTb3VuZChjb25maWcpIHtcbiAgICAgICAgLy8gdHJ5IHRvIGxvYWQgaWYgY29uZmlnIGNvbnRhaW5zIFVSTHNcbiAgICAgICAgaWYgKGZpbGUuY29udGFpbnNVUkwoY29uZmlnKSkge1xuICAgICAgICAgICAgcmV0dXJuIGxvYWQoY29uZmlnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzb3VuZCA9IGFkZChjb25maWcpO1xuICAgICAgICBzb3VuZC5kYXRhID0gY29uZmlnLmRhdGEgfHwgY29uZmlnO1xuXG4gICAgICAgIHJldHVybiBzb3VuZDtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIERlc3Ryb3lcbiAgICAgKi9cblxuICAgIGZ1bmN0aW9uIGRlc3Ryb3lTb3VuZChzb3VuZE9ySWQpIHtcbiAgICAgICAgZ3JvdXAuZmluZChzb3VuZE9ySWQsIGZ1bmN0aW9uIChzb3VuZCkge1xuICAgICAgICAgICAgcmV0dXJuIHNvdW5kLmRlc3Ryb3koKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBhcGk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVzdHJveUFsbCgpIHtcbiAgICAgICAgZ3JvdXAuZGVzdHJveSgpO1xuICAgICAgICByZXR1cm4gYXBpO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogQ29udHJvbHNcbiAgICAgKi9cblxuICAgIGZ1bmN0aW9uIG11dGUoKSB7XG4gICAgICAgIGdyb3VwLm11dGUoKTtcbiAgICAgICAgcmV0dXJuIGFwaTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1bk11dGUoKSB7XG4gICAgICAgIGdyb3VwLnVuTXV0ZSgpO1xuICAgICAgICByZXR1cm4gYXBpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZhZGUodm9sdW1lLCBkdXJhdGlvbikge1xuICAgICAgICBncm91cC5mYWRlKHZvbHVtZSwgZHVyYXRpb24pO1xuICAgICAgICByZXR1cm4gYXBpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhdXNlQWxsKCkge1xuICAgICAgICBncm91cC5wYXVzZSgpO1xuICAgICAgICByZXR1cm4gYXBpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlc3VtZUFsbCgpIHtcbiAgICAgICAgZ3JvdXAucmVzdW1lKCk7XG4gICAgICAgIHJldHVybiBhcGk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3RvcEFsbCgpIHtcbiAgICAgICAgZ3JvdXAuc3RvcCgpO1xuICAgICAgICByZXR1cm4gYXBpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBsYXkoaWQsIGRlbGF5LCBvZmZzZXQpIHtcbiAgICAgICAgZ3JvdXAuZmluZChpZCwgZnVuY3Rpb24gKHNvdW5kKSB7XG4gICAgICAgICAgICByZXR1cm4gc291bmQucGxheShkZWxheSwgb2Zmc2V0KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBhcGk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGF1c2UoaWQpIHtcbiAgICAgICAgZ3JvdXAuZmluZChpZCwgZnVuY3Rpb24gKHNvdW5kKSB7XG4gICAgICAgICAgICByZXR1cm4gc291bmQucGF1c2UoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBhcGk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3RvcChpZCkge1xuICAgICAgICBncm91cC5maW5kKGlkLCBmdW5jdGlvbiAoc291bmQpIHtcbiAgICAgICAgICAgIHJldHVybiBzb3VuZC5zdG9wKCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gYXBpO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogTW9iaWxlIHRvdWNoIGxvY2tcbiAgICAgKi9cblxuICAgIGlzVG91Y2hMb2NrZWQgPSBicm93c2VyLmhhbmRsZVRvdWNoTG9jayhjb250ZXh0LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlzVG91Y2hMb2NrZWQgPSBmYWxzZTtcbiAgICAgICAgZ3JvdXAuc291bmRzLmZvckVhY2goZnVuY3Rpb24gKHNvdW5kKSB7XG4gICAgICAgICAgICByZXR1cm4gc291bmQuaXNUb3VjaExvY2tlZCA9IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8qXG4gICAgICogUGFnZSB2aXNpYmlsaXR5IGV2ZW50c1xuICAgICAqL1xuXG4gICAgKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHBhZ2VIaWRkZW5QYXVzZWQgPSBbXTtcblxuICAgICAgICAvLyBwYXVzZSBjdXJyZW50bHkgcGxheWluZyBzb3VuZHMgYW5kIHN0b3JlIHJlZnNcbiAgICAgICAgZnVuY3Rpb24gb25IaWRkZW4oKSB7XG4gICAgICAgICAgICBncm91cC5zb3VuZHMuZm9yRWFjaChmdW5jdGlvbiAoc291bmQpIHtcbiAgICAgICAgICAgICAgICBpZiAoc291bmQucGxheWluZykge1xuICAgICAgICAgICAgICAgICAgICBzb3VuZC5wYXVzZSgpO1xuICAgICAgICAgICAgICAgICAgICBwYWdlSGlkZGVuUGF1c2VkLnB1c2goc291bmQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcGxheSBzb3VuZHMgdGhhdCBnb3QgcGF1c2VkIHdoZW4gcGFnZSB3YXMgaGlkZGVuXG4gICAgICAgIGZ1bmN0aW9uIG9uU2hvd24oKSB7XG4gICAgICAgICAgICB3aGlsZSAocGFnZUhpZGRlblBhdXNlZC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBwYWdlSGlkZGVuUGF1c2VkLnBvcCgpLnBsYXkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGJyb3dzZXIuaGFuZGxlUGFnZVZpc2liaWxpdHkob25IaWRkZW4sIG9uU2hvd24pO1xuICAgIH0pKCk7XG5cbiAgICAvKlxuICAgICAqIExvZyB2ZXJzaW9uICYgZGV2aWNlIHN1cHBvcnQgaW5mb1xuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gbG9nKCkge1xuICAgICAgICB2YXIgdGl0bGUgPSAnc29ubyAnICsgVkVSU0lPTixcbiAgICAgICAgICAgIGluZm8gPSAnU3VwcG9ydGVkOicgKyBhcGkuaXNTdXBwb3J0ZWQgKyAnIFdlYkF1ZGlvQVBJOicgKyBhcGkuaGFzV2ViQXVkaW8gKyAnIFRvdWNoTG9ja2VkOicgKyBpc1RvdWNoTG9ja2VkICsgJyBTdGF0ZTonICsgKGNvbnRleHQgJiYgY29udGV4dC5zdGF0ZSkgKyAnIEV4dGVuc2lvbnM6JyArIGZpbGUuZXh0ZW5zaW9ucztcblxuICAgICAgICBpZiAobmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCdDaHJvbWUnKSA+IC0xKSB7XG4gICAgICAgICAgICB2YXIgYXJncyA9IFsnJWMg4pmrICcgKyB0aXRsZSArICcg4pmrICVjICcgKyBpbmZvICsgJyAnLCAnY29sb3I6ICNGRkZGRkY7IGJhY2tncm91bmQ6ICMzNzlGN0EnLCAnY29sb3I6ICMxRjFDMEQ7IGJhY2tncm91bmQ6ICNFMEZCQUMnXTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nLmFwcGx5KGNvbnNvbGUsIGFyZ3MpO1xuICAgICAgICB9IGVsc2UgaWYgKHdpbmRvdy5jb25zb2xlICYmIHdpbmRvdy5jb25zb2xlLmxvZy5jYWxsKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZy5jYWxsKGNvbnNvbGUsIHRpdGxlICsgJyAnICsgaW5mbyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhcGkgPSB7XG4gICAgICAgIGNyZWF0ZVNvdW5kOiBjcmVhdGVTb3VuZCxcbiAgICAgICAgY3JlYXRlOiBjcmVhdGVTb3VuZCxcbiAgICAgICAgZGVzdHJveVNvdW5kOiBkZXN0cm95U291bmQsXG4gICAgICAgIGRlc3Ryb3lBbGw6IGRlc3Ryb3lBbGwsXG4gICAgICAgIGdldFNvdW5kOiBnZXRTb3VuZCxcbiAgICAgICAgY3JlYXRlR3JvdXA6IGNyZWF0ZUdyb3VwLFxuICAgICAgICBmaWxlOiBmaWxlLFxuICAgICAgICBsb2FkOiBsb2FkLFxuICAgICAgICBtdXRlOiBtdXRlLFxuICAgICAgICB1bk11dGU6IHVuTXV0ZSxcbiAgICAgICAgZmFkZTogZmFkZSxcbiAgICAgICAgcGF1c2VBbGw6IHBhdXNlQWxsLFxuICAgICAgICByZXN1bWVBbGw6IHJlc3VtZUFsbCxcbiAgICAgICAgc3RvcEFsbDogc3RvcEFsbCxcbiAgICAgICAgcGxheTogcGxheSxcbiAgICAgICAgcGF1c2U6IHBhdXNlLFxuICAgICAgICBzdG9wOiBzdG9wLFxuICAgICAgICBsb2c6IGxvZyxcblxuICAgICAgICBjYW5QbGF5OiBmaWxlLmNhblBsYXksXG4gICAgICAgIGNvbnRleHQ6IGNvbnRleHQsXG4gICAgICAgIGdldE9mZmxpbmVDb250ZXh0OiB1dGlscy5nZXRPZmZsaW5lQ29udGV4dCxcbiAgICAgICAgZWZmZWN0OiBncm91cC5lZmZlY3QsXG4gICAgICAgIGV4dGVuc2lvbnM6IGZpbGUuZXh0ZW5zaW9ucyxcbiAgICAgICAgaGFzV2ViQXVkaW86ICEhY29udGV4dCxcbiAgICAgICAgaXNTdXBwb3J0ZWQ6IGZpbGUuZXh0ZW5zaW9ucy5sZW5ndGggPiAwLFxuICAgICAgICBnYWluOiBncm91cC5nYWluLFxuICAgICAgICB1dGlsczogdXRpbHMsXG4gICAgICAgIFZFUlNJT046IFZFUlNJT04sXG5cbiAgICAgICAgU291bmQ6IFNvdW5kLFxuICAgICAgICBHcm91cDogR3JvdXBcbiAgICB9O1xuXG4gICAgLypcbiAgICAgKiBHZXR0ZXJzICYgU2V0dGVyc1xuICAgICAqL1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoYXBpLCB7XG4gICAgICAgIGlzVG91Y2hMb2NrZWQ6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpc1RvdWNoTG9ja2VkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBzb3VuZHM6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBncm91cC5zb3VuZHMuc2xpY2UoMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHZvbHVtZToge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdyb3VwLnZvbHVtZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGdyb3VwLnZvbHVtZSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gT2JqZWN0LmZyZWV6ZShhcGkpO1xufVxuXG52YXIgc29ubyA9IG5ldyBTb25vKCk7XG5cbnJldHVybiBzb25vO1xuXG59KSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c29uby5qcy5tYXBcbiJdfQ=="}